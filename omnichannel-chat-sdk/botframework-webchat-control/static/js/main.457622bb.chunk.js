(this["webpackJsonpbotframework-webchat-control"]=this["webpackJsonpbotframework-webchat-control"]||[]).push([[0],{1008:function(e,t){},1026:function(e,t){},1028:function(e,t){},1653:function(e,t){},1654:function(e,t){},1655:function(e,t){},1755:function(e,t){},1765:function(e,t){},1766:function(e,t){},1767:function(e,t){},1782:function(e,t){},1894:function(e,t,a){},1895:function(e,t,a){},1896:function(e,t,a){},1897:function(e,t,a){},1898:function(e,t,a){},1899:function(e,t,a){},1909:function(e,t,a){},1911:function(e,t,a){"use strict";a.r(t);var n,c=a(0),o=a.n(c),i=a(191),l=a.n(i),r=(a(778),a(19)),s=a.n(r),u=a(58),d=a(51),b=a(39),g=a(250),v=a.n(g),f=a(768),h=a(7);!function(e){e[e.SET_CHAT_STARTED=0]="SET_CHAT_STARTED",e[e.SET_MESSAGES=1]="SET_MESSAGES",e[e.SET_TYPING=2]="SET_TYPING",e[e.SET_AGENT_END_SESSION_EVENT=3]="SET_AGENT_END_SESSION_EVENT",e[e.SET_LOADING=4]="SET_LOADING"}(n||(n={}));var j={hasChatStarted:!1,messages:[],isTyping:!1,agentEndSessionEvent:!1,isLoading:!1},C=function(e,t){switch(t.type){case n.SET_CHAT_STARTED:return Object(u.a)(Object(u.a)({},e),{},{type:t.type,hasChatStarted:t.payload});case n.SET_MESSAGES:return Object(u.a)(Object(u.a)({},e),{},{type:t.type,messages:t.payload});case n.SET_TYPING:return Object(u.a)(Object(u.a)({},e),{},{type:t.type,isTyping:t.payload});case n.SET_AGENT_END_SESSION_EVENT:return Object(u.a)(Object(u.a)({},e),{},{type:t.type,agentEndSessionEvent:t.payload});case n.SET_LOADING:return Object(u.a)(Object(u.a)({},e),{},{type:t.type,isLoading:t.payload});default:return e}},p=Object(c.createContext)({}),m=p.Provider,O=function(e){var t=Object(c.useReducer)(C,j),a=Object(b.a)(t,2),n=a[0],o=a[1];return Object(h.jsx)(m,{value:{state:n,dispatch:o},children:e.children})},S=a(769),y=a.n(S);a(1893),a(1894);var x=function(){return Object(h.jsx)("div",{className:"loading",children:Object(h.jsx)(y.a,{type:"Puff",color:"#00BFFF",height:100,width:100})})},k=a(1915);a(1895);var E=function(e){return Object(h.jsx)("div",{className:"chat-button",onClick:e.onClick,children:Object(h.jsx)(k.a,{color:"white"})})},w=a(1916);a(1896);var V=function(e){return Object(h.jsxs)("div",{className:"chat-header",children:[Object(h.jsxs)("span",{children:[" ",e.title," "]}),Object(h.jsx)("div",{onClick:e.onClick,children:Object(h.jsx)(w.a,{})})]})},T=a(1920),M=a(1918),N=a(1921),A=a(1922),_=a(1917),D=a(1919);a(1897);var L=function(e){return Object(h.jsxs)("div",{className:"incoming-call-pop-up",children:[Object(h.jsx)("span",{children:" Incoming call "}),Object(h.jsxs)("div",{children:[Object(h.jsx)(_.a,{className:"reject-call-button",onClick:e.rejectCall}),Object(h.jsx)(M.a,{className:"accept-video-call-button",onClick:e.acceptVideoCall}),Object(h.jsx)(D.a,{className:"accept-voice-call-button",onClick:e.acceptVoiceCall})]})]})},I=(a(1898),function(){console.log("[WebChat][adjustWebChatHeightInVideoCall]");var e=document.getElementsByClassName("webchat__basic-transcript")[0],t=document.getElementById("remoteVideo"),a=document.getElementsByClassName("current-call-action-bar")[0],n=e.clientHeight-t.clientHeight-a.clientHeight;e.style.marginTop="".concat(t.clientHeight+a.clientHeight,"px"),e.style.height="".concat(n,"px")}),R=function(){console.log("[WebChat][adjustWebChatHeightIncomingCall]");var e=document.getElementsByClassName("webchat__basic-transcript")[0],t=document.getElementsByClassName("incoming-call-pop-up")[0],a=e.clientHeight-t.clientHeight;e.style.height="".concat(a,"px")},W=function(){console.log("[WebChat][adjustWebChatHeightInVoiceCall]");var e=document.getElementsByClassName("webchat__basic-transcript")[0],t=document.getElementsByClassName("current-call-action-bar")[0],a=e.clientHeight-t.clientHeight;e.style.marginTop="".concat(t.clientHeight,"px"),e.style.height="".concat(a,"px")},H=function(){console.log("[WebChat][adjustWebChatHeightNoCall]");var e=document.getElementsByClassName("webchat__basic-transcript")[0];e.style.marginTop="",e.style.height=""};var U=function(e){var t=Object(c.useState)(!1),a=Object(b.a)(t,2),n=a[0],o=a[1],i=Object(c.useState)(!1),l=Object(b.a)(i,2),r=l[0],u=l[1],g=Object(c.useState)(!1),v=Object(b.a)(g,2),f=v[0],j=v[1],C=Object(c.useState)(!1),p=Object(b.a)(C,2),m=p[0],O=p[1],S=Object(c.useState)(!1),y=Object(b.a)(S,2),x=(y[0],y[1]),k=Object(c.useState)(!1),E=Object(b.a)(k,2),w=E[0],V=E[1];Object(c.useEffect)((function(){(function(){var t=Object(d.a)(s.a.mark((function t(){var a,n,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.VoiceVideoCallingSDK,n=e.OCClient,c=e.chatToken,t.prev=1,t.next=4,a.initialize({chatToken:c,selfVideoHTMLElementId:"selfVideo",remoteVideoHTMLElementId:"remoteVideo",environment:"test",OCClient:n});case 4:console.log("[WebChat][Calling] VoiceVideoCallingProxy initialized!"),console.log(a),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("[WebChat][Calling] Failed to initialize VoiceVideoCalling!"),console.error(t.t0);case 12:a.onCallAdded((function(){console.log("[WebChat][Calling][CallAdded]"),o(!0),R()})),a.onCallDisconnected((function(){console.log("[WebChat][Calling][CallDisconnected]"),H(),o(!1),u(!1),j(!1)})),a.onLocalVideoStreamAdded((function(){console.log("[WebChat][Calling][LocalVideoStreamAdded]");var e=a.isMicrophoneMuted();O(e);var t=a.isRemoteVideoEnabled();x(t);var n=a.isLocalVideoEnabled();V(n),n||t?(o(!1),u(!0),j(!1)):(o(!1),u(!1),j(!0))})),a.onLocalVideoStreamRemoved((function(){console.log("[WebChat][Calling][LocalVideoStreamRemoved]");var e=a.isMicrophoneMuted();O(e);var t=a.isRemoteVideoEnabled();x(t);var n=a.isLocalVideoEnabled();V(n),n||t?(o(!1),u(!0),j(!1)):(o(!1),u(!1),j(!0))})),a.onRemoteVideoStreamAdded((function(){console.log("[WebChat][Calling][RemoteVideoStreamAdded]");var e=a.isMicrophoneMuted();O(e);var t=a.isRemoteVideoEnabled();x(t);var n=a.isLocalVideoEnabled();V(n),n||t?(o(!1),u(!0),j(!1)):(o(!1),u(!1),j(!0))})),a.onRemoteVideoStreamRemoved((function(){console.log("[WebChat][Calling][RemoteVideoStreamRemoved]");var e=a.isMicrophoneMuted();O(e);var t=a.isRemoteVideoEnabled();x(t);var n=a.isLocalVideoEnabled();V(n),n||t?(o(!1),u(!0),j(!1)):(o(!1),u(!1),j(!0))}));case 18:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}})()()}),[e]);var D=Object(c.useCallback)(Object(d.a)(s.a.mark((function t(){var a,n,c,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[WebChat][Calling][Accept][Voice]"),a=e.VoiceVideoCallingSDK,t.next=4,a.acceptCall({withVideo:!1});case 4:o(!1),u(!1),j(!0),W(),n=a.isMicrophoneMuted(),O(n),c=a.isRemoteVideoEnabled(),x(c),i=a.isLocalVideoEnabled(),V(i);case 14:case"end":return t.stop()}}),t)}))),[e]),U=Object(c.useCallback)(Object(d.a)(s.a.mark((function t(){var a,n,c,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[WebChat][Calling][Accept][Video]"),a=e.VoiceVideoCallingSDK,t.next=4,a.acceptCall({withVideo:!0});case 4:o(!1),u(!0),j(!1),I(),n=a.isMicrophoneMuted(),O(n),c=a.isRemoteVideoEnabled(),x(c),i=a.isLocalVideoEnabled(),V(i);case 14:case"end":return t.stop()}}),t)}))),[e]),F=Object(c.useCallback)(Object(d.a)(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[WebChat][Calling][Reject]"),a=e.VoiceVideoCallingSDK,t.next=4,a.rejectCall();case 4:o(!1),u(!1),j(!1);case 7:case"end":return t.stop()}}),t)}))),[e]),G=Object(c.useCallback)(Object(d.a)(s.a.mark((function t(){var a,n,c,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[WebChat][Calling][toggleLocalVideo]"),a=e.VoiceVideoCallingSDK,t.next=4,a.toggleLocalVideo();case 4:n=a.isMicrophoneMuted(),O(n),c=a.isRemoteVideoEnabled(),x(c),i=a.isLocalVideoEnabled(),V(i),i||c?(o(!1),u(!0),j(!1)):(o(!1),u(!1),j(!0));case 11:case"end":return t.stop()}}),t)}))),[e]),B=Object(c.useCallback)(Object(d.a)(s.a.mark((function t(){var a,n,c,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[WebChat][Calling][toggleMute]"),a=e.VoiceVideoCallingSDK,t.next=4,a.toggleMute();case 4:n=a.isMicrophoneMuted(),O(n),c=a.isRemoteVideoEnabled(),x(c),i=a.isLocalVideoEnabled(),V(i),i||c?(o(!1),u(!0),j(!1)):(o(!1),u(!1),j(!0));case 11:case"end":return t.stop()}}),t)}))),[e]),K=Object(c.useCallback)(Object(d.a)(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("[WebChat][Calling][stopCall]"),a=e.VoiceVideoCallingSDK,t.next=4,a.stopCall();case 4:case"end":return t.stop()}}),t)}))),[e]);return Object(h.jsxs)(h.Fragment,{children:[n&&Object(h.jsx)(L,{rejectCall:F,acceptVideoCall:U,acceptVoiceCall:D}),Object(h.jsxs)("div",{className:"calling ".concat(r||f?"active":""),children:[Object(h.jsxs)("div",{className:"video-container ".concat(r?"active":""),children:[Object(h.jsx)("div",{id:"remoteVideo"}),Object(h.jsx)("div",{id:"selfVideo"})]}),Object(h.jsx)("div",{children:(r||f)&&Object(h.jsxs)("div",{className:"current-call-action-bar",children:[w?Object(h.jsx)(M.a,{className:"toggle-video-button",onClick:G}):Object(h.jsx)(T.a,{className:"toggle-video-button",onClick:G}),m?Object(h.jsx)(N.a,{className:"toggle-mute-button",onClick:B}):Object(h.jsx)(A.a,{className:"toggle-mute-button",onClick:B}),Object(h.jsx)(_.a,{className:"stop-call-button",onClick:K})]})})]})]})},F=a(1923),G=a(1924);a(1899);var B=function(e){var t=Object(c.useState)(!1),a=Object(b.a)(t,2),n=a[0],o=a[1],i=Object(c.useState)(!1),l=Object(b.a)(i,2),r=l[0],s=l[1],u=Object(c.useCallback)((function(){o(!0)}),[]),d=Object(c.useCallback)((function(){o(!1)}),[]),g=Object(c.useCallback)((function(){s(!0)}),[]),v=Object(c.useCallback)((function(){s(!1)}),[]);return Object(h.jsxs)("div",{className:"action-bar",children:[Object(h.jsx)(F.a,{size:"16",color:n?"rgb(22, 27, 34)":"rgb(22, 27, 34, 0.5)",className:"download-button",onClick:e.onDownloadClick,onMouseEnter:u,onMouseLeave:d}),Object(h.jsx)(G.a,{size:"16",color:r?"rgb(22, 27, 34)":"rgb(22, 27, 34, 0.5)",className:"email-button",onClick:e.onEmailTranscriptClick,onMouseEnter:g,onMouseLeave:v})]})},K=a(1),P=a(2),z=function(){function e(){Object(K.a)(this,e),this.middlewares=void 0,this.middlewares={}}return Object(P.a)(e,[{key:"subscribe",value:function(e,t){this.middlewares[e]=t}},{key:"create",value:function(){var e=this;return console.log("[CustomStore][create]"),Object(g.createStore)({},(function(t){var a=t.dispatch;return function(t){return function(n){var c=n;if(n&&n.payload)for(var o=0,i=Object.keys(e.middlewares);o<i.length;o++){var l=i[o],r=e.middlewares[l];if(r.applicable(c)){var s=r.apply(c);s.dispatchAction&&a(s.dispatchAction),s.nextAction&&(c=s.nextAction)}}return t(c)}}}))}}],[{key:"getInstance",value:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();z._instance=void 0;var J,Y=function(){return console.log("[createCustomStore]"),z.getInstance()},q=function(){function e(t){Object(K.a)(this,e),this.dataMaskingRules=void 0,this.dataMaskingRules=t,console.log("[DataMaskingRules]"),console.log(this.dataMaskingRules)}return Object(P.a)(e,[{key:"applicable",value:function(e){var t=e.payload.text;return!!(Object.keys(this.dataMaskingRules).length>0&&t&&"WEB_CHAT/SEND_MESSAGE"===e.type)}},{key:"apply",value:function(e){return{dispatchAction:null,nextAction:this.applyDataMasking(e)}}},{key:"applyDataMasking",value:function(e){var t=e.payload.text;if(Object.keys(this.dataMaskingRules).length>0)for(var a=0,n=Object.values(this.dataMaskingRules);a<n.length;a++)for(var c=n[a],o=new RegExp(c,"g"),i=void 0;i=o.exec(t);){var l=i[0].replace(/./g,"#");t=t.replace(i[0],l)}return e.payload.text=t,e}}]),e}(),Q=function(e){return console.log("[createDataMaskingMiddleware]"),new q(e)},X=function(){console.log("[createActivityMiddleware]");return function(){return function(e){return function(t){if(console.log("%c [ActivityMiddleware]","background: #2a9fd4; color: #fff"),console.log(t),t.activity){if(t.activity.channelData&&t.activity.channelData.tags&&t.activity.channelData.tags.includes("system"))return console.log("%c [ActivityMiddleware][Message][System] ".concat(t.activity.text),"background: #2a9fd4; color: #fff"),function(a){return Object(h.jsx)("div",{className:"system-message",children:e(t)(a)},t.activity.id)};if(void 0===t.activity.text||null==t.activity.text)return e(t);"bot"===t.activity.from.role&&console.log("%c [ActivityMiddleware][Message][Agent] ".concat(t.activity.text),"background: #2a9fd4; color: #fff"),"user"===t.activity.from.role&&console.log("%c [ActivityMiddleware][Message][Customer] ".concat(t.activity.text),"background: #2a9fd4; color: #fff")}return e(t)}}}},Z=a(1925),$=function(e){if(e){var t=e.split(/\s/).reduce((function(e,t){return e+t.slice(0,1)}),"");return t.length>1?t.substring(0,2).toUpperCase():e.substring(0,2).toUpperCase()}return""},ee=function(){console.log("[createAvatarMiddleware]");return function(){return function(e){return function(t){console.log("[AvatarMiddleware]");var a=t.activity,n=a.channelData.tags,c=a.from.name,o=a.text,i=t.fromUser;return console.log(t),n&&n.includes("system")?(console.log("[AvatarMiddleware][Message][System] ".concat(o)),Object(h.jsx)("div",{children:Object(h.jsx)(Z.a,{color:"red",size:20})})):void 0!==i&&null!==i&&(i?i?(console.log("[AvatarMiddleware][Message][Customer] ".concat(o)),Object(h.jsx)("div",{className:"webchat__avatar",children:Object(h.jsxs)("p",{className:"webchat__avatar_initials",children:[" ",$(c)||"CU","  "]})})):e(t):(console.log("[AvatarMiddleware][Message][Agent] ".concat(o)),Object(h.jsx)("div",{className:"webchat__avatar",children:Object(h.jsxs)("p",{className:"webchat__avatar_initials",children:[" ",$(c)," "]})})))}}}};!function(e){e.Sending="sending",e.SendFailed="send failed",e.Sent="sent"}(J||(J={}));var te=function(){return function(){return function(e){return function(e){console.log("%c [activityStatusMiddleware]","background: #238636; color: #fff"),console.log(e);var t="";!function(e){return e.activity.channelData&&e.activity.channelData.tags&&e.activity.channelData.tags.includes("system")}(e)?!function(e){return"bot"===e.activity.from.role}(e)?function(e){return"user"===e.activity.from.role}(e)&&(t="Customer"):t="Agent":t="System",console.log("%c [activityStatusMiddleware][Message][".concat(t,"] ").concat(e.activity.text),"background: #238636; color: #fff"),e.sendState===J.Sent?console.log("%c [activityStatusMiddleware][Message][".concat(t,"][Status] Sent!"),"background: #238636; color: #fff"):e.sendState===J.Sending?console.log("%c [activityStatusMiddleware][Message][".concat(t,"][Status] Sending..."),"background: #238636; color: #fff"):e.sendState===J.SendFailed&&console.log("%c [activityStatusMiddleware][Message][".concat(t,"][Status] Failed :("),"background: #238636; color: #fff")}}}},ae=function(){var e={orgId:"d367c413-e0b9-408b-ae1c-382499b369ae",orgUrl:"https://omnichannel-crm.omnichannelengagementhub.com",widgetId:"3a352b95-5d67-4e47-af28-eca029b03928"},t=new URLSearchParams(window.location.search);return null!==t.get("orgUrl")&&(e.orgUrl=t.get("orgUrl")),null!==t.get("orgId")&&(e.orgId=t.get("orgId")),null!==t.get("widgetId")&&(e.widgetId=t.get("widgetId")),e},ne=function(){var e={telemetry:{disable:!1,ariaTelemetryKey:""}},t=new URLSearchParams(window.location.search);return null!==t.get("telemetry")&&(e.telemetry.disable="true"!=t.get("telemetry")),null!==t.get("ariaTelemetryKey")&&(e.telemetry.ariaTelemetryKey=t.get("ariaTelemetryKey")||""),e},ce=function(){var e={disable:!0},t=new URLSearchParams(window.location.search);return null!==t.get("calling")&&(e.disable="false"==t.get("calling")),e},oe=function(){var e={disable:!0},t=new URLSearchParams(window.location.search);return null!==t.get("debug")&&(e.disable="true"!=t.get("debug")),e},ie=function e(){Object(K.a)(this,e)};ie.canUploadAttachment=!1;var le=function(e){var t="true"===e.LiveWSAndLiveChatEngJoin.msdyn_enablefileattachmentsforcustomers||!1;return ie.canUploadAttachment=t,ie},re=a(770),se=(a(1909),ae()),ue=ne(),de=ce(),be=oe();console.log("%c [OmnichannelConfig]","background-color:#001433;color:#fff"),console.log(se),console.log("%c [telemetryConfig]","background-color:#001433;color:#fff"),console.log(ue),console.log("%c [callingConfig]","background-color:#001433;color:#fff"),console.log(de),console.log("%c [debugConfig]","background-color:#001433;color:#fff"),console.log(be);var ge=X(),ve=ee(),fe=te(),he={bubbleBorderRadius:10,bubbleNubSize:10,bubbleNubOffset:15,bubbleFromUserBorderRadius:10,bubbleFromUserNubSize:10,bubbleFromUserNubOffset:15,bubbleFromUserBackground:"rgb(246, 246, 246)"};var je=function(){var e=Object(c.useContext)(p),t=e.state,a=e.dispatch,o=Object(c.useState)(),i=Object(b.a)(o,2),l=i[0],r=i[1],g=Object(c.useState)(void 0),j=Object(b.a)(g,2),C=j[0],m=j[1],O=Object(c.useState)(void 0),S=Object(b.a)(O,2),y=S[0],k=S[1],w=Object(c.useState)(void 0),T=Object(b.a)(w,2),M=T[0],N=T[1],A=Object(c.useState)(void 0),_=Object(b.a)(A,2),D=_[0],L=_[1],I=Object(c.useState)(void 0),R=Object(b.a)(I,2),W=R[0],H=R[1],F=Object(c.useState)(void 0),G=Object(b.a)(F,2),K=G[0],P=G[1];Object(c.useEffect)((function(){var e=function(){var e=Object(d.a)(s.a.mark((function e(){var t,a,n,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new f.OmnichannelChatSDK(se,Object(u.a)({},ue))).setDebug(!be.disable),e.next=4,t.initialize();case 4:return r(t),e.next=7,t.getLiveChatConfig();case 7:if(a=e.sent,le(a),he.hideUploadButton=!ie.canUploadAttachment,(n=localStorage.getItem("liveChatContext"))&&Object.keys(JSON.parse(n)).length>0&&(console.log("[liveChatContext]"),console.log(n)),!t.getVoiceVideoCalling||de.disable){e.next=25;break}return e.prev=13,e.next=16,t.getVoiceVideoCalling();case 16:(c=e.sent).setDebug(!0),P(c),console.log("VoiceVideoCalling loaded"),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),console.log("Failed to load VoiceVideoCalling: ".concat(e.t0));case 25:return e.next=27,t.getPreChatSurvey(!1);case 27:(o=e.sent)&&(console.info("[PreChatSurvey]"),i=o,o=JSON.parse(i.replaceAll("&#42;","*")),console.log(o),m(o));case 29:case"end":return e.stop()}var i}),e,null,[[13,22]])})));return function(){return e.apply(this,arguments)}}();console.log(t),e()}),[]);var z=Object(c.useCallback)((function(e){console.log("[onNewMessage] ".concat(e.content)),a({type:n.SET_LOADING,payload:!1})}),[a]),J=Object(c.useCallback)((function(){console.log("[onTypingEvent]")}),[]),q=Object(c.useCallback)((function(){console.log("[onAgentEndSession]")}),[]),X=Object(c.useCallback)(function(){var e=Object(d.a)(s.a.mark((function e(c){var o,i,r,u,d,b,g,v=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=v.length>1&&void 0!==v[1]?v[1]:{},!t.hasChatStarted){e.next=3;break}return e.abrupt("return");case 3:return console.log("[startChat]"),e.next=6,null===l||void 0===l?void 0:l.getDataMaskingRules();case 6:if(i=e.sent,r=Y(),L(r.create()),r.subscribe("DataMasking",Q(i)),(u=localStorage.getItem("liveChatContext"))&&Object.keys(JSON.parse(u)).length>0&&(console.log("[liveChatContext]"),o.liveChatContext=JSON.parse(u)),a({type:n.SET_CHAT_STARTED,payload:!0}),!u&&C){e.next=41;break}return a({type:n.SET_LOADING,payload:!0}),e.prev=15,e.next=18,null===l||void 0===l?void 0:l.startChat(o);case 18:e.next=24;break;case 20:return e.prev=20,e.t0=e.catch(15),console.log("Unable to start chat: ".concat(e.t0.message)),e.abrupt("return");case 24:return e.next=26,null===l||void 0===l?void 0:l.getCurrentLiveChatContext();case 26:return(d=e.sent)&&Object.keys(d).length&&localStorage.setItem("liveChatContext",JSON.stringify(d)),null===l||void 0===l||l.onNewMessage(z,{rehydrate:!0}),null===l||void 0===l||l.onTypingEvent(J),null===l||void 0===l||l.onAgentEndSession(q),e.next=33,null===l||void 0===l?void 0:l.createChatAdapter();case 33:if(b=e.sent,N(b),a({type:n.SET_LOADING,payload:!1}),!(null===l||void 0===l?void 0:l.getVoiceVideoCalling)){e.next=41;break}return e.next=39,null===l||void 0===l?void 0:l.getChatToken();case 39:g=e.sent,H(g);case 41:case"end":return e.stop()}}),e,null,[[15,20]])})));return function(t){return e.apply(this,arguments)}}(),[l,t,a,q,z,J,C]),Z=Object(c.useCallback)(Object(d.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[endChat]"),e.next=3,null===l||void 0===l?void 0:l.endChat();case 3:null===K||void 0===K||K.close(),N(void 0),H(void 0),m(void 0),k(void 0),localStorage.removeItem("liveChatContext"),a({type:n.SET_CHAT_STARTED,payload:!1});case 10:case"end":return e.stop()}}),e)}))),[l,a,K]),$=Object(c.useCallback)(Object(d.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[downloadTranscript]"),e.next=3,null===l||void 0===l?void 0:l.getLiveChatTranscript();case 3:t=e.sent,console.log(t);case 5:case"end":return e.stop()}}),e)}))),[l]),ee=Object(c.useCallback)(Object(d.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[emailTranscript]"),t={emailAddress:"foo@bar.com",attachmentMessage:"Transcript",locale:"en"},e.next=4,null===l||void 0===l?void 0:l.emailLiveChatTranscript(t);case 4:case"end":return e.stop()}}),e)}))),[l]),te=Object(c.useCallback)((function(){var e=new re.AdaptiveCard;e.parse(C),e.onExecuteAction=function(){var e=Object(d.a)(s.a.mark((function e(t){var c,o,i,r,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.data,k(c),o={},c&&(o.preChatResponse=c),a({type:n.SET_LOADING,payload:!0}),e.prev=5,e.next=8,null===l||void 0===l?void 0:l.startChat(o);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(5),console.log("Unable to start chat: ".concat(e.t0.message)),e.abrupt("return");case 14:return e.next=16,null===l||void 0===l?void 0:l.getCurrentLiveChatContext();case 16:return(i=e.sent)&&Object.keys(i).length&&localStorage.setItem("liveChatContext",JSON.stringify(i)),null===l||void 0===l||l.onNewMessage(z,{rehydrate:!0}),null===l||void 0===l||l.onTypingEvent(J),null===l||void 0===l||l.onAgentEndSession(q),e.next=23,null===l||void 0===l?void 0:l.createChatAdapter();case 23:if(r=e.sent,N(r),a({type:n.SET_LOADING,payload:!1}),!(null===l||void 0===l?void 0:l.getVoiceVideoCalling)){e.next=31;break}return e.next=29,null===l||void 0===l?void 0:l.getChatToken();case 29:u=e.sent,H(u);case 31:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}();var t=e.render();return Object(h.jsx)("div",{ref:function(e){e&&e.firstChild&&e.removeChild(e.firstChild),t&&e&&e.appendChild(t)}})}),[l,C]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{children:!t.hasChatStarted&&Object(h.jsx)(E,{onClick:X})}),t.hasChatStarted&&Object(h.jsxs)("div",{className:"chat-container",children:[Object(h.jsx)(V,{title:"Live Chat via Chat SDK",onClick:Z}),C&&!y&&te(),t.isLoading&&Object(h.jsx)(x,{}),!de.disable&&K&&W&&Object(h.jsx)(U,{VoiceVideoCallingSDK:K,OCClient:null===l||void 0===l?void 0:l.OCClient,chatToken:W}),!t.isLoading&&t.hasChatStarted&&M&&D&&ge&&Object(h.jsx)(v.a,{activityMiddleware:ge,avatarMiddleware:ve,activityStatusMiddleware:fe,userID:"teamsvisitor",directLine:M,sendTypingIndicator:!0,store:D,styleOptions:he}),!t.isLoading&&t.hasChatStarted&&M&&Object(h.jsx)(B,{onDownloadClick:$,onEmailTranscriptClick:ee})]})]})},Ce=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,1926)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),o(e),i(e)}))};l.a.render(Object(h.jsx)(o.a.StrictMode,{children:Object(h.jsx)(O,{children:Object(h.jsx)(je,{})})}),document.getElementById("root")),Ce()},391:function(e,t){},392:function(e,t){},767:function(e,t){},778:function(e,t,a){},928:function(e,t){},930:function(e,t){},952:function(e,t){},954:function(e,t){},982:function(e,t){},983:function(e,t){},989:function(e,t){}},[[1911,1,2]]]);
//# sourceMappingURL=main.457622bb.chunk.js.map