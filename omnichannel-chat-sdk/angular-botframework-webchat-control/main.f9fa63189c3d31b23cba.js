(self.webpackChunkangular_botframework_webchat_control=self.webpackChunkangular_botframework_webchat_control||[]).push([[179],{8255:Q=>{function u(c){return Promise.resolve().then(()=>{var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s})}u.keys=()=>[],u.resolve=u,u.id=8255,Q.exports=u},4637:(Q,u,c)=>{"use strict";c.d(u,{_:()=>l});var s=c(4762),_=new WeakMap,d=new WeakMap,p=function(){function P(){this.onabort=null,_.set(this,[]),d.set(this,!1)}return Object.defineProperty(P.prototype,"aborted",{get:function(){if(!d.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return d.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(P,"none",{get:function(){return new P},enumerable:!1,configurable:!0}),P.prototype.addEventListener=function(S,f){if(!_.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");_.get(this).push(f)},P.prototype.removeEventListener=function(S,f){if(!_.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");var g=_.get(this),E=g.indexOf(f);E>-1&&g.splice(E,1)},P.prototype.dispatchEvent=function(S){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")},P}();function T(P){if(!P.aborted){P.onabort&&P.onabort.call(P);var S=_.get(P);S&&S.slice().forEach(function(f){f.call(P,{type:"abort"})}),d.set(P,!0)}}var l=function(P){function S(f){var g=P.call(this,f)||this;return g.name="AbortError",g}return(0,s.ZT)(S,P),S}(Error);!function(){function P(S){var f=this;if(this._signal=new p,S){Array.isArray(S)||(S=arguments);for(var g=0,E=S;g<E.length;g++){var b=E[g];b.aborted?this.abort():b.addEventListener("abort",function(){f.abort()})}}}Object.defineProperty(P.prototype,"signal",{get:function(){return this._signal},enumerable:!1,configurable:!0}),P.prototype.abort=function(){T(this._signal)},P.timeout=function(S){var f=new p,g=setTimeout(T,S,f);return"function"==typeof g.unref&&g.unref(),f}}()},351:(Q,u,c)=>{"use strict";c.r(u),c.d(u,{ChatClient:()=>ks,ChatThreadClient:()=>Ns});var s={};c.r(s),c.d(s,{AddChatParticipantsRequest:()=>Rn,AddChatParticipantsResult:()=>Sn,ChatError:()=>He,ChatMessage:()=>it,ChatMessageContent:()=>yt,ChatMessageReadReceipt:()=>le,ChatMessageReadReceiptsCollection:()=>X,ChatMessagesCollection:()=>pt,ChatParticipant:()=>qt,ChatParticipantsCollection:()=>wn,ChatThreadItem:()=>Zt,ChatThreadProperties:()=>Xn,ChatThreadsItemCollection:()=>ln,CommunicationErrorResponse:()=>_e,CommunicationIdentifierModel:()=>me,CommunicationUserIdentifierModel:()=>Re,CreateChatThreadRequest:()=>Cn,CreateChatThreadResult:()=>An,MicrosoftTeamsUserIdentifierModel:()=>Oe,PhoneNumberIdentifierModel:()=>we,SendChatMessageRequest:()=>nt,SendChatMessageResult:()=>ct,SendReadReceiptRequest:()=>Je,SendTypingNotificationRequest:()=>Bt,UpdateChatMessageRequest:()=>cn,UpdateChatThreadRequest:()=>kt});var _=c(8239),d=c(4762),p=c(1326);const T=(0,p.YR)("communication-chat");var l=c(3105);const C="1.1.0-beta.2";var P=c(2305),f=c(434),g=c(1126);const E=(0,p.YR)("core-http");var b=c(369),m=c(7694);const I="REDACTED",x=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent"],N=["api-version"];class F{constructor({allowedHeaderNames:y=[],allowedQueryParameters:R=[]}={}){y=Array.isArray(y)?x.concat(y):x,R=Array.isArray(R)?N.concat(R):N,this.allowedHeaderNames=new Set(y.map(B=>B.toLowerCase())),this.allowedQueryParameters=new Set(R.map(B=>B.toLowerCase()))}sanitize(y){const R=new Set;return JSON.stringify(y,(B,G)=>{if(G instanceof Error)return Object.assign(Object.assign({},G),{name:G.name,message:G.message});if("_headersMap"===B)return this.sanitizeHeaders(G);if("url"===B)return this.sanitizeUrl(G);if("query"===B)return this.sanitizeQuery(G);if("body"!==B&&"response"!==B&&"operationSpec"!==B){if(Array.isArray(G)||(0,m.Kn)(G)){if(R.has(G))return"[Circular]";R.add(G)}return G}},2)}sanitizeHeaders(y){return this.sanitizeObject(y,this.allowedHeaderNames,(R,B)=>R[B].value)}sanitizeQuery(y){return this.sanitizeObject(y,this.allowedQueryParameters,(R,B)=>R[B])}sanitizeObject(y,R,B){if("object"!=typeof y||null===y)return y;const G={};for(const ee of Object.keys(y))G[ee]=R.has(ee.toLowerCase())?B(y,ee):I;return G}sanitizeUrl(y){if("string"!=typeof y||null===y)return y;const R=b.UK.parse(y),B=R.getQuery();if(!B)return y;const G=b.$4.parse(B);for(const ee of G.keys())this.allowedQueryParameters.has(ee.toLowerCase())||G.set(ee,I);return R.setQuery(G.toString()),R.toString()}}function U(L={}){return{create:(y,R)=>new k(y,R,L)}}class k extends g.U{constructor(y,R,{logger:B=E.info,allowedHeaderNames:G=[],allowedQueryParameters:ee=[]}={}){super(y,R),this.logger=B,this.sanitizer=new F({allowedHeaderNames:G,allowedQueryParameters:ee})}get allowedHeaderNames(){return this.sanitizer.allowedHeaderNames}set allowedHeaderNames(y){this.sanitizer.allowedHeaderNames=y}get allowedQueryParameters(){return this.sanitizer.allowedQueryParameters}set allowedQueryParameters(y){this.sanitizer.allowedQueryParameters=y}sendRequest(y){return this.logger.enabled?(this.logRequest(y),this._nextPolicy.sendRequest(y).then(R=>this.logResponse(R))):this._nextPolicy.sendRequest(y)}logRequest(y){this.logger(`Request: ${this.sanitizer.sanitize(y)}`)}logResponse(y){return this.logger(`Response status code: ${y.status}`),this.logger(`Headers: ${this.sanitizer.sanitize(y.headers)}`),y}}function D(L){return M(L.parameterPath,L.mapper)}function M(L,y){let R;return R="string"==typeof L?L:Array.isArray(L)?L.join("."):y.serializedName,R}function W(L){let y="";for(let R=0;R<L.length;R++)y+=String.fromCharCode(L[R]);return btoa(y)}function $(L){const y=atob(L),R=new Uint8Array(y.length);for(let B=0;B<y.length;B++)R[B]=y.charCodeAt(B);return R}var ce=c(4510);class oe{constructor(y={},R){this.modelMappers=y,this.isXML=R}validateConstraints(y,R,B){const G=(ee,fe)=>{throw new Error(`"${B}" with value "${R}" should satisfy the constraint "${ee}": ${fe}.`)};if(y.constraints&&null!=R){const ee=R,{ExclusiveMaximum:fe,ExclusiveMinimum:Te,InclusiveMaximum:De,InclusiveMinimum:Pe,MaxItems:Me,MaxLength:et,MinItems:st,MinLength:lt,MultipleOf:Qt,Pattern:Jt,UniqueItems:ft}=y.constraints;null!=fe&&ee>=fe&&G("ExclusiveMaximum",fe),null!=Te&&ee<=Te&&G("ExclusiveMinimum",Te),null!=De&&ee>De&&G("InclusiveMaximum",De),null!=Pe&&ee<Pe&&G("InclusiveMinimum",Pe);const dt=R;if(null!=Me&&dt.length>Me&&G("MaxItems",Me),null!=et&&dt.length>et&&G("MaxLength",et),null!=st&&dt.length<st&&G("MinItems",st),null!=lt&&dt.length<lt&&G("MinLength",lt),null!=Qt&&ee%Qt!=0&&G("MultipleOf",Qt),Jt){const ut="string"==typeof Jt?new RegExp(Jt):Jt;("string"!=typeof R||null===R.match(ut))&&G("Pattern",Jt)}ft&&dt.some((ut,nn,Or)=>Or.indexOf(ut)!==nn)&&G("UniqueItems",ft)}}serialize(y,R,B,G={}){var ee,fe,Te;const De={rootName:null!==(ee=G.rootName)&&void 0!==ee?ee:"",includeRoot:null!==(fe=G.includeRoot)&&void 0!==fe&&fe,xmlCharKey:null!==(Te=G.xmlCharKey)&&void 0!==Te?Te:ce.I};let Pe={};const Me=y.type.name;B||(B=y.serializedName),null!==Me.match(/^Sequence$/i)&&(Pe=[]),y.isConstant&&(R=y.defaultValue);const{required:et,nullable:st}=y;if(et&&st&&void 0===R)throw new Error(`${B} cannot be undefined.`);if(et&&!st&&null==R)throw new Error(`${B} cannot be null or undefined.`);if(!et&&!1===st&&null===R)throw new Error(`${B} cannot be null.`);return null==R?Pe=R:(this.validateConstraints(y,R,B),null!==Me.match(/^any$/i)?Pe=R:null!==Me.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?Pe=function(L,y,R){if(null!=R)if(null!==L.match(/^Number$/i)){if("number"!=typeof R)throw new Error(`${y} with value ${R} must be of type number.`)}else if(null!==L.match(/^String$/i)){if("string"!=typeof R.valueOf())throw new Error(`${y} with value "${R}" must be of type string.`)}else if(null!==L.match(/^Uuid$/i)){if("string"!=typeof R.valueOf()||!m.TP(R))throw new Error(`${y} with value "${R}" must be of type string and a valid uuid.`)}else if(null!==L.match(/^Boolean$/i)){if("boolean"!=typeof R)throw new Error(`${y} with value ${R} must be of type boolean.`)}else if(null!==L.match(/^Stream$/i)){const B=typeof R;if(!("string"===B||"function"===B||R instanceof ArrayBuffer||ArrayBuffer.isView(R)||("function"==typeof Blob||"object"==typeof Blob)&&R instanceof Blob))throw new Error(`${y} must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.`)}return R}(Me,B,R):null!==Me.match(/^Enum$/i)?Pe=function(L,y,R){if(!y)throw new Error(`Please provide a set of allowedValues to validate ${L} as an Enum Type.`);if(!y.some(G=>"string"==typeof G.valueOf()?G.toLowerCase()===R.toLowerCase():G===R))throw new Error(`${R} is not a valid value for ${L}. The valid values are: ${JSON.stringify(y)}.`);return R}(B,y.type.allowedValues,R):null!==Me.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?Pe=function(L,y,R){if(null!=y)if(null!==L.match(/^Date$/i)){if(!(y instanceof Date||"string"==typeof y.valueOf()&&!isNaN(Date.parse(y))))throw new Error(`${R} must be an instanceof Date or a string in ISO8601 format.`);y=y instanceof Date?y.toISOString().substring(0,10):new Date(y).toISOString().substring(0,10)}else if(null!==L.match(/^DateTime$/i)){if(!(y instanceof Date||"string"==typeof y.valueOf()&&!isNaN(Date.parse(y))))throw new Error(`${R} must be an instanceof Date or a string in ISO8601 format.`);y=y instanceof Date?y.toISOString():new Date(y).toISOString()}else if(null!==L.match(/^DateTimeRfc1123$/i)){if(!(y instanceof Date||"string"==typeof y.valueOf()&&!isNaN(Date.parse(y))))throw new Error(`${R} must be an instanceof Date or a string in RFC-1123 format.`);y=y instanceof Date?y.toUTCString():new Date(y).toUTCString()}else if(null!==L.match(/^UnixTime$/i)){if(!(y instanceof Date||"string"==typeof y.valueOf()&&!isNaN(Date.parse(y))))throw new Error(`${R} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);y=function(L){if(L)return"string"==typeof L.valueOf()&&(L=new Date(L)),Math.floor(L.getTime()/1e3)}(y)}else if(null!==L.match(/^TimeSpan$/i)&&!m._9(y))throw new Error(`${R} must be a string in ISO 8601 format. Instead was "${y}".`);return y}(Me,R,B):null!==Me.match(/^ByteArray$/i)?Pe=function(L,y){let R="";if(null!=y){if(!(y instanceof Uint8Array))throw new Error(`${L} must be of type Uint8Array.`);R=W(y)}return R}(B,R):null!==Me.match(/^Base64Url$/i)?Pe=function(L,y){let R="";if(null!=y){if(!(y instanceof Uint8Array))throw new Error(`${L} must be of type Uint8Array.`);R=function(L){if(L){if(!(L instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(L,y){let R=L.length;for(;R-1>=0&&"="===L[R-1];)--R;return L.substr(0,R)}(W(L)).replace(/\+/g,"-").replace(/\//g,"_")}}(y)||""}return R}(B,R):null!==Me.match(/^Sequence$/i)?Pe=function(L,y,R,B,G,ee){if(!Array.isArray(R))throw new Error(`${B} must be of type Array.`);const fe=y.type.element;if(!fe||"object"!=typeof fe)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${B}.`);const Te=[];for(let De=0;De<R.length;De++){const Pe=L.serialize(fe,R[De],B,ee);if(G&&fe.xmlNamespace){const Me=fe.xmlNamespacePrefix?`xmlns:${fe.xmlNamespacePrefix}`:"xmlns";"Composite"===fe.type.name?(Te[De]=Object.assign({},Pe),Te[De][ce.c]={[Me]:fe.xmlNamespace}):(Te[De]={},Te[De][ee.xmlCharKey]=Pe,Te[De][ce.c]={[Me]:fe.xmlNamespace})}else Te[De]=Pe}return Te}(this,y,R,B,Boolean(this.isXML),De):null!==Me.match(/^Dictionary$/i)?Pe=function(L,y,R,B,G,ee){if("object"!=typeof R)throw new Error(`${B} must be of type object.`);const fe=y.type.value;if(!fe||"object"!=typeof fe)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${B}.`);const Te={};for(const De of Object.keys(R)){const Pe=L.serialize(fe,R[De],B,ee);Te[De]=xe(fe,Pe,G,ee)}if(G&&y.xmlNamespace){const Pe=Te;return Pe[ce.c]={[y.xmlNamespacePrefix?`xmlns:${y.xmlNamespacePrefix}`:"xmlns"]:y.xmlNamespace},Pe}return Te}(this,y,R,B,Boolean(this.isXML),De):null!==Me.match(/^Composite$/i)&&(Pe=function(L,y,R,B,G,ee){if($e(L,y)&&(y=Be(L,y,R,"clientName")),null!=R){const fe={},Te=be(L,y,B);for(const Pe of Object.keys(Te)){const Me=Te[Pe];if(Me.readOnly)continue;let et,st=fe;if(L.isXML)et=Me.xmlIsWrapped?Me.xmlName:Me.xmlElementName||Me.xmlName;else{const lt=Ee(Me.serializedName);et=lt.pop();for(const Qt of lt)null==st[Qt]&&(null!=R[Pe]||void 0!==Me.defaultValue)&&(st[Qt]={}),st=st[Qt]}if(null!=st){if(G&&y.xmlNamespace){const dt=y.xmlNamespacePrefix?`xmlns:${y.xmlNamespacePrefix}`:"xmlns";st[ce.c]=Object.assign(Object.assign({},st[ce.c]),{[dt]:y.xmlNamespace})}const lt=""!==Me.serializedName?B+"."+Me.serializedName:B;let Qt=R[Pe];const Jt=$e(L,y);Jt&&Jt.clientName===Pe&&null==Qt&&(Qt=y.serializedName);const ft=L.serialize(Me,Qt,lt,ee);if(void 0!==ft&&null!=et){const dt=xe(Me,ft,G,ee);G&&Me.xmlIsAttribute?(st[ce.c]=st[ce.c]||{},st[ce.c][et]=ft):st[et]=G&&Me.xmlIsWrapped?{[Me.xmlElementName]:dt}:dt}}}const De=function(L,y,R){const B=y.type.additionalProperties;if(!B&&y.type.className){const G=ge(L,y,R);return null==G?void 0:G.type.additionalProperties}return B}(L,y,B);if(De){const Pe=Object.keys(Te);for(const Me in R)Pe.every(st=>st!==Me)&&(fe[Me]=L.serialize(De,R[Me],B+'["'+Me+'"]',ee))}return fe}return R}(this,y,R,B,Boolean(this.isXML),De))),Pe}deserialize(y,R,B,G={}){var ee,fe,Te;const De={rootName:null!==(ee=G.rootName)&&void 0!==ee?ee:"",includeRoot:null!==(fe=G.includeRoot)&&void 0!==fe&&fe,xmlCharKey:null!==(Te=G.xmlCharKey)&&void 0!==Te?Te:ce.I};if(null==R)return this.isXML&&"Sequence"===y.type.name&&!y.xmlIsWrapped&&(R=[]),void 0!==y.defaultValue&&(R=y.defaultValue),R;let Pe;const Me=y.type.name;if(B||(B=y.serializedName),null!==Me.match(/^Composite$/i))Pe=function(L,y,R,B,G){var ee;$e(L,y)&&(y=Be(L,y,R,"serializedName"));const fe=be(L,y,B);let Te={};const De=[];for(const Me of Object.keys(fe)){const et=fe[Me],st=Ee(fe[Me].serializedName);De.push(st[0]);const{serializedName:lt,xmlName:Qt,xmlElementName:Jt}=et;let ft=B;""!==lt&&void 0!==lt&&(ft=B+"."+lt);const dt=et.headerCollectionPrefix;if(dt){const ut={};for(const nn of Object.keys(R))nn.startsWith(dt)&&(ut[nn.substring(dt.length)]=L.deserialize(et.type.value,R[nn],ft,G)),De.push(nn);Te[Me]=ut}else if(L.isXML)if(et.xmlIsAttribute&&R[ce.c])Te[Me]=L.deserialize(et,R[ce.c][Qt],ft,G);else{const ut=Jt||Qt||lt;if(et.xmlIsWrapped){const nn=R[Qt],Or=null!==(ee=null==nn?void 0:nn[Jt])&&void 0!==ee?ee:[];Te[Me]=L.deserialize(et,Or,ft,G)}else Te[Me]=L.deserialize(et,R[ut],ft,G)}else{let ut,nn=R;for(const _o of st){if(!nn)break;nn=nn[_o]}ut=nn;const Or=y.type.polymorphicDiscriminator;let xs;if(Or&&Me===Or.clientName&&null==ut&&(ut=y.serializedName),Array.isArray(R[Me])&&""===fe[Me].serializedName){ut=R[Me];const _o=L.deserialize(et,ut,ft,G);for(const[ba,Gu]of Object.entries(Te))Object.prototype.hasOwnProperty.call(_o,ba)||(_o[ba]=Gu);Te=_o}else(void 0!==ut||void 0!==et.defaultValue)&&(xs=L.deserialize(et,ut,ft,G),Te[Me]=xs)}}const Pe=y.type.additionalProperties;if(Pe){const Me=et=>{for(const st in fe)if(Ee(fe[st].serializedName)[0]===et)return!1;return!0};for(const et in R)Me(et)&&(Te[et]=L.deserialize(Pe,R[et],B+'["'+et+'"]',G))}else if(R)for(const Me of Object.keys(R))void 0===Te[Me]&&!De.includes(Me)&&!Ie(Me,G)&&(Te[Me]=R[Me]);return Te}(this,y,R,B,De);else{if(this.isXML){const et=De.xmlCharKey,st=R;null!=st[ce.c]&&null!=st[et]&&(R=st[et])}null!==Me.match(/^Number$/i)?(Pe=parseFloat(R),isNaN(Pe)&&(Pe=R)):null!==Me.match(/^Boolean$/i)?Pe="true"===R||"false"!==R&&R:null!==Me.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?Pe=R:null!==Me.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?Pe=new Date(R):null!==Me.match(/^UnixTime$/i)?Pe=function(L){if(L)return new Date(1e3*L)}(R):null!==Me.match(/^ByteArray$/i)?Pe=$(R):null!==Me.match(/^Base64Url$/i)?Pe=function(L){if(L){if(L&&"string"!=typeof L.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return $(L=L.replace(/-/g,"+").replace(/_/g,"/"))}}(R):null!==Me.match(/^Sequence$/i)?Pe=function(L,y,R,B,G){const ee=y.type.element;if(!ee||"object"!=typeof ee)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${B}`);if(R){Array.isArray(R)||(R=[R]);const fe=[];for(let Te=0;Te<R.length;Te++)fe[Te]=L.deserialize(ee,R[Te],`${B}[${Te}]`,G);return fe}return R}(this,y,R,B,De):null!==Me.match(/^Dictionary$/i)&&(Pe=function(L,y,R,B,G){const ee=y.type.value;if(!ee||"object"!=typeof ee)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${B}`);if(R){const fe={};for(const Te of Object.keys(R))fe[Te]=L.deserialize(ee,R[Te],B,G);return fe}return R}(this,y,R,B,De))}return y.isConstant&&(Pe=y.defaultValue),Pe}}function Ee(L){const y=[];let R="";if(L){const B=L.split(".");for(const G of B)"\\"===G.charAt(G.length-1)?R+=G.substr(0,G.length-1)+".":(R+=G,y.push(R),R="")}return y}function ge(L,y,R){const B=y.type.className;if(!B)throw new Error(`Class name for model "${R}" is not provided in the mapper "${JSON.stringify(y,void 0,2)}".`);return L.modelMappers[B]}function be(L,y,R){let B=y.type.modelProperties;if(!B){const G=ge(L,y,R);if(!G)throw new Error(`mapper() cannot be null or undefined for model "${y.type.className}".`);if(B=null==G?void 0:G.type.modelProperties,!B)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(G)}" of type "${y.type.className}" for object "${R}".`)}return B}function xe(L,y,R,B){if(!R||!L.xmlNamespace)return y;const ee={[L.xmlNamespacePrefix?`xmlns:${L.xmlNamespacePrefix}`:"xmlns"]:L.xmlNamespace};if(["Composite"].includes(L.type.name)){if(y[ce.c])return y;{const Te=Object.assign({},y);return Te[ce.c]=ee,Te}}const fe={};return fe[B.xmlCharKey]=y,fe[ce.c]=ee,fe}function Ie(L,y){return[ce.c,y.xmlCharKey].includes(L)}function Be(L,y,R,B){const G=$e(L,y);if(G){const ee=G[B];if(null!=ee){const fe=R[ee];if(null!=fe){const Te=y.type.uberParent||y.type.className,Pe=L.modelMappers.discriminators[fe===Te?fe:Te+"."+fe];Pe&&(y=Pe)}}}return y}function $e(L,y){return y.type.polymorphicDiscriminator||Ye(L,y.type.uberParent)||Ye(L,y.type.className)}function Ye(L,y){return y&&L.modelMappers[y]&&L.modelMappers[y].type.polymorphicDiscriminator}const Qe=function(L){const y={};for(const R of["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"])y[R]=R;return y}(),Gt={},rr=new F;let Tn=(()=>{class L extends Error{constructor(R,B,G,ee,fe){super(R),this.name="RestError",this.code=B,this.statusCode=G,this.request=ee,this.response=fe,Object.setPrototypeOf(this,L.prototype)}[Gt](){return`RestError: ${this.message} \n ${rr.sanitize(this)}`}}return L.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",L.PARSE_ERROR="PARSE_ERROR",L})();if(!(self.document&&self.DOMParser&&self.Node&&self.XMLSerializer))throw new Error('This library depends on the following DOM objects: ["document", "DOMParser", "Node", "XMLSerializer"] to parse XML, but some of these are undefined. You may provide a polyfill to make these globally available in order to support your environment. For more information, please refer to https://aka.ms/azsdk/js/web-workers. ');const Nr=document.implementation.createDocument(null,null,null),ke=new DOMParser;function ze(L,y={}){var R,B,G;try{const ee={rootName:null!==(R=y.rootName)&&void 0!==R?R:"",includeRoot:null!==(B=y.includeRoot)&&void 0!==B&&B,xmlCharKey:null!==(G=y.xmlCharKey)&&void 0!==G?G:ce.I},fe=ke.parseFromString(L,"application/xml");let Te;return function(L){const y=L.getElementsByTagName("parsererror");if(y.length>0&&function(){var L;if(void 0===Xe)try{Xe=null!==(L=ke.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==L?L:""}catch(y){Xe=""}return Xe}())for(let R=0;R<y.length;R++)if(y[R].namespaceURI===Xe)throw new Error(y[R].innerHTML)}(fe),Te=Ot(ee.includeRoot?fe:fe.childNodes[0],ee),Promise.resolve(Te)}catch(ee){return Promise.reject(ee)}}let Xe;function Ot(L,y){let R={};const B=L.childNodes.length,G=L.childNodes[0],ee=G&&1===B&&G.nodeType===Node.TEXT_NODE&&G.nodeValue||void 0,fe=function(L){return function(L){return!!L.attributes}(L)&&L.hasAttributes()?L:void 0}(L);if(fe){R[ce.c]={};for(let Te=0;Te<fe.attributes.length;Te++){const De=fe.attributes[Te];R[ce.c][De.nodeName]=De.nodeValue}ee&&(R[y.xmlCharKey]=ee)}else 0===B?R="":ee&&(R=ee);if(!ee)for(let Te=0;Te<B;Te++){const De=L.childNodes[Te];if(De.nodeType!==Node.TEXT_NODE){const Pe=Ot(De,y);R[De.nodeName]?Array.isArray(R[De.nodeName])?R[De.nodeName].push(Pe):R[De.nodeName]=[R[De.nodeName],Pe]:R[De.nodeName]=Pe}}return R}const si=new XMLSerializer;function du(L,y={}){var R,B,G;const ee={rootName:null!==(R=y.rootName)&&void 0!==R?R:"root",includeRoot:null!==(B=y.includeRoot)&&void 0!==B&&B,xmlCharKey:null!==(G=y.xmlCharKey)&&void 0!==G?G:ce.I},fe=as(L,ee.rootName,ee)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+si.serializeToString(fe)}function ss(L){const y=[];for(const R of Object.keys(L)){const B=Nr.createAttribute(R);B.value=L[R].toString(),y.push(B)}return y}function as(L,y,R){if(null==L||"string"==typeof L||"number"==typeof L||"boolean"==typeof L){const B=Nr.createElement(y);return B.textContent=null==L?"":L.toString(),[B]}if(Array.isArray(L)){const B=[];for(const G of L)for(const ee of as(G,y,R))B.push(ee);return B}if("object"==typeof L){const B=Nr.createElement(y);for(const G of Object.keys(L))if(G===ce.c)for(const ee of ss(L[G]))B.attributes.setNamedItem(ee);else if(G===R.xmlCharKey)B.textContent=L[G].toString();else for(const ee of as(L[G],G,R))B.appendChild(ee);return[B]}throw new Error(`Illegal value passed to buildObject: ${L}`)}function Js(L,y){return{create:(R,B)=>new us(R,B,L,y)}}const Ys=["application/json","text/json"],Xs=["application/xml","application/atom+xml"],Ht={expectedContentTypes:{json:Ys,xml:Xs}};class us extends g.U{constructor(y,R,B,G={}){var ee;super(y,R),this.jsonContentTypes=B&&B.json||Ys,this.xmlContentTypes=B&&B.xml||Xs,this.xmlCharKey=null!==(ee=G.xmlCharKey)&&void 0!==ee?ee:ce.I}sendRequest(y){var R=this;return(0,_.Z)(function*(){return R._nextPolicy.sendRequest(y).then(B=>function(L,y,R,B={}){var G,ee,fe;const Te={rootName:null!==(G=B.rootName)&&void 0!==G?G:"",includeRoot:null!==(ee=B.includeRoot)&&void 0!==ee&&ee,xmlCharKey:null!==(fe=B.xmlCharKey)&&void 0!==fe?fe:ce.I};return function(L,y,R,B){var G;const ee=Te=>{const Me=new Tn(`Error "${Te}" occurred while parsing the response body - ${R.bodyAsText}.`,Te.code||Tn.PARSE_ERROR,R.status,R.request,R);return Promise.reject(Me)};if(!(null===(G=R.request.streamResponseStatusCodes)||void 0===G?void 0:G.has(R.status))&&!R.request.streamResponseBody&&R.bodyAsText){const Te=R.bodyAsText,De=R.headers.get("Content-Type")||"",Pe=De?De.split(";").map(Me=>Me.toLowerCase()):[];if(0===Pe.length||Pe.some(Me=>-1!==L.indexOf(Me)))return new Promise(Me=>{R.parsedBody=JSON.parse(Te),Me(R)}).catch(ee);if(Pe.some(Me=>-1!==y.indexOf(Me)))return ze(Te,B).then(Me=>(R.parsedBody=Me,R)).catch(ee)}return Promise.resolve(R)}(L,y,R,Te).then(De=>{if(!function(L){const y=L.request.shouldDeserialize;let R;return R=void 0===y||("boolean"==typeof y?y:y(L)),R}(De))return De;const Pe=De.request.operationSpec;if(!Pe||!Pe.responses)return De;const Me=function(L){let y;const R=L.request,B=R.operationSpec;if(B){const G=R.operationResponseGetter;y=G?G(B,L):B.responses[L.status]}return y}(De),{error:et,shouldReturnResponse:st}=function(L,y,R){var B;const G=200<=L.status&&L.status<300;if(function(L){const y=Object.keys(L.responses);return 0===y.length||1===y.length&&"default"===y[0]}(y)?G:R){if(!R)return{error:null,shouldReturnResponse:!1};if(!R.isError)return{error:null,shouldReturnResponse:!1}}const fe=null!=R?R:y.responses.default,De=(null===(B=L.request.streamResponseStatusCodes)||void 0===B?void 0:B.has(L.status))||L.request.streamResponseBody?`Unexpected status code: ${L.status}`:L.bodyAsText,Pe=new Tn(De,void 0,L.status,L.request,L);if(!fe)throw Pe;const Me=fe.bodyMapper,et=fe.headersMapper;try{if(L.parsedBody){const st=L.parsedBody;let lt;if(Me){let Jt=st;y.isXML&&Me.type.name===Qe.Sequence&&(Jt="object"==typeof st?st[Me.xmlElementName]:[]),lt=y.serializer.deserialize(Me,Jt,"error.response.parsedBody")}const Qt=st.error||lt||st;Pe.code=Qt.code,Qt.message&&(Pe.message=Qt.message),Me&&(Pe.response.parsedBody=lt)}L.headers&&et&&(Pe.response.parsedHeaders=y.serializer.deserialize(et,L.headers.rawHeaders(),"operationRes.parsedHeaders"))}catch(st){Pe.message=`Error "${st.message}" occurred in deserializing the responseBody - "${L.bodyAsText}" for the default response.`}return{error:Pe,shouldReturnResponse:!1}}(De,Pe,Me);if(et)throw et;if(st)return De;if(Me){if(Me.bodyMapper){let lt=De.parsedBody;Pe.isXML&&Me.bodyMapper.type.name===Qe.Sequence&&(lt="object"==typeof lt?lt[Me.bodyMapper.xmlElementName]:[]);try{De.parsedBody=Pe.serializer.deserialize(Me.bodyMapper,lt,"operationRes.parsedBody",B)}catch(Qt){throw new Tn(`Error ${Qt} occurred in deserializing the responseBody - ${De.bodyAsText}`,void 0,De.status,De.request,De)}}else"HEAD"===Pe.httpMethod&&(De.parsedBody=R.status>=200&&R.status<300);Me.headersMapper&&(De.parsedHeaders=Pe.serializer.deserialize(Me.headersMapper,De.headers.rawHeaders(),"operationRes.parsedHeaders",B))}return De})}(R.jsonContentTypes,R.xmlContentTypes,B,{xmlCharKey:R.xmlCharKey}))})()}}function ht(L){return"number"==typeof L}function On(L,y,R,B,G){return!!y(B,G)&&R.retryCount<L}function hs(L,y={retryCount:0,retryInterval:0},R){R&&(y.error&&(R.innerError=y.error),y.error=R),y.retryCount++;let B=Math.pow(2,y.retryCount-1)-1;return B*=.8*L.retryInterval+Math.floor(Math.random()*(.4*L.retryInterval)),y.retryInterval=Math.min(L.minRetryInterval+B,L.maxRetryInterval),y}var xi=c(8006),Mo=c(969);function ai(L,y,R){return{create:(B,G)=>new hu(B,G,L,y,R)}}const Li={maxRetries:3,retryDelayInMs:3e4,maxRetryDelayInMs:9e4};class hu extends g.U{constructor(y,R,B,G,ee){super(y,R),this.retryCount=ht(B)?B:3,this.retryInterval=ht(G)?G:3e4,this.maxRetryInterval=ht(ee)?ee:9e4}sendRequest(y){return this._nextPolicy.sendRequest(y.clone()).then(R=>fo(this,y,R)).catch(R=>fo(this,y,R.response,void 0,R))}}function fo(L,y,R,B,G){return or.apply(this,arguments)}function or(){return(or=(0,_.Z)(function*(L,y,R,B,G){B=hs({retryInterval:L.retryInterval,minRetryInterval:0,maxRetryInterval:L.maxRetryInterval},B,G);const fe=y.abortSignal&&y.abortSignal.aborted;if(fe||!On(L.retryCount,function(Te){const De=null==Te?void 0:Te.status;return!(503===De&&(null==R?void 0:R.headers.get(xi.g.HeaderConstants.RETRY_AFTER))||void 0===De||De<500&&408!==De||501===De||505===De)},B,R)){if(fe||G||!R)throw B.error||new Tn("Failed to send the request.",Tn.REQUEST_SEND_ERROR,R&&R.status,R&&R.request,R);return R}E.info(`Retrying request in ${B.retryInterval}`);try{yield(0,Mo.g)(B.retryInterval);const Te=yield L._nextPolicy.sendRequest(y.clone());return fo(L,y,Te,B)}catch(Te){return fo(L,y,R,B,Te)}})).apply(this,arguments)}function pu(L="x-ms-client-request-id"){return{create:(y,R)=>new No(y,R,L)}}class No extends g.U{constructor(y,R,B){super(y,R),this._requestIdHeaderName=B}sendRequest(y){return y.headers.contains(this._requestIdHeaderName)||y.headers.set(this._requestIdHeaderName,y.requestId),this._nextPolicy.sendRequest(y)}}function ui(L){return L.toLowerCase()}function kr(L){if(L&&"object"==typeof L){const y=L;if("function"==typeof y.rawHeaders&&"function"==typeof y.clone&&"function"==typeof y.get&&"function"==typeof y.set&&"function"==typeof y.contains&&"function"==typeof y.remove&&"function"==typeof y.headersArray&&"function"==typeof y.headerValues&&"function"==typeof y.headerNames&&"function"==typeof y.toJson)return!0}return!1}class ho{constructor(y){if(this._headersMap={},y)for(const R in y)this.set(R,y[R])}set(y,R){this._headersMap[ui(y)]={name:y,value:R.toString()}}get(y){const R=this._headersMap[ui(y)];return R?R.value:void 0}contains(y){return!!this._headersMap[ui(y)]}remove(y){const R=this.contains(y);return delete this._headersMap[ui(y)],R}rawHeaders(){const y={};for(const R in this._headersMap){const B=this._headersMap[R];y[B.name.toLowerCase()]=B.value}return y}headersArray(){const y=[];for(const R in this._headersMap)y.push(this._headersMap[R]);return y}headerNames(){const y=[],R=this.headersArray();for(let B=0;B<R.length;++B)y.push(R[B].name);return y}headerValues(){const y=[],R=this.headersArray();for(let B=0;B<R.length;++B)y.push(R[B].value);return y}toJson(){return this.rawHeaders()}toString(){return JSON.stringify(this.toJson())}clone(){return new ho(this.rawHeaders())}}const Xt=function(){return"x-ms-useragent"};function ko(){const L=[{key:"core-http",value:xi.g.coreHttpVersion}],y=function(){const L=self.navigator;return[{key:"OS",value:(L.oscpu||L.platform).replace(" ","")}]}();return function(L,y=" ",R="/"){return L.map(B=>`${B.key}${B.value?`${R}${B.value}`:""}`).join(y)}(L.concat(y))}function ta(L){const y=L&&null!=L.key?L.key:"x-ms-useragent",R=L&&null!=L.value?L.value:ko();return{create:(B,G)=>new Gc(B,G,y,R)}}class Gc extends g.U{constructor(y,R,B,G){super(y,R),this._nextPolicy=y,this._options=R,this.headerKey=B,this.headerValue=G}sendRequest(y){return this.addUserAgentHeader(y),this._nextPolicy.sendRequest(y)}addUserAgentHeader(y){y.headers||(y.headers=new ho),!y.headers.get(this.headerKey)&&this.headerValue&&y.headers.set(this.headerKey,this.headerValue)}}const Ft=["GET","HEAD"],$c={handleRedirects:!0,maxRetries:20};function Wr(L=20){return{create:(y,R)=>new xr(y,R,L)}}class xr extends g.U{constructor(y,R,B=20){super(y,R),this.maxRetries=B}sendRequest(y){return this._nextPolicy.sendRequest(y).then(R=>ps(this,R,0))}}function ps(L,y,R){const{request:B,status:G}=y,ee=y.headers.get("location");if(ee&&(300===G||301===G&&Ft.includes(B.method)||302===G&&Ft.includes(B.method)||303===G&&"POST"===B.method||307===G)&&(!L.maxRetries||R<L.maxRetries)){const fe=b.UK.parse(B.url);return fe.setPath(ee),B.url=fe.toString(),303===G&&(B.method="GET",delete B.body),L._nextPolicy.sendRequest(B).then(Te=>ps(L,Te,R+1))}return Promise.resolve(y)}class vu extends g.U{constructor(y,R,B=30){super(y,R),this._retryTimeout=B}sendRequest(y){return this._nextPolicy.sendRequest(y.clone()).then(R=>function(L,y,R){if(409===R.status){const B=function(L){let y,R;if(L){try{R=JSON.parse(L)}catch(B){}if(R&&R.error&&R.error.message&&R.error.code&&"MissingSubscriptionRegistration"===R.error.code){const B=R.error.message.match(/.*'(.*)'/i);B&&(y=B.pop())}}return y}(R.bodyAsText);if(B){const G=function(L){let y;const R=L.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!R||!R[0])throw new Error(`Unable to extract subscriptionId from the given url - ${L}.`);return y=R[0],y}(y.url);return function(L,y,R,B){return rt.apply(this,arguments)}(L,G,B,y).catch(()=>!1).then(ee=>ee?(y.headers.set("x-ms-client-request-id",m.Rl()),L._nextPolicy.sendRequest(y.clone())):R)}}return Promise.resolve(R)}(this,y,R))}}function Fi(L,y=!1){const R=L.clone();return y&&(R.url=L.url),R.headers.set("x-ms-client-request-id",m.Rl()),R.headers.set("Content-Type","application/json; charset=utf-8"),R}function rt(){return(rt=(0,_.Z)(function*(L,y,R,B){const G=`${y}providers/${R}/register?api-version=2016-02-01`,ee=`${y}providers/${R}?api-version=2016-02-01`,fe=Fi(B);if(fe.method="POST",fe.url=G,200!==(yield L._nextPolicy.sendRequest(fe)).status)throw new Error(`Autoregistration of ${R} failed. Please try registering manually.`);return po(L,ee,B)})).apply(this,arguments)}function po(L,y,R){return ys.apply(this,arguments)}function ys(){return(ys=(0,_.Z)(function*(L,y,R){const B=Fi(R);B.url=y,B.method="GET";const G=yield L._nextPolicy.sendRequest(B),ee=G.parsedBody;return!(!G.parsedBody||!ee.registrationState||"Registered"!==ee.registrationState)||(yield(0,Mo.g)(1e3*L._retryTimeout),po(L,y,R))})).apply(this,arguments)}var _r=c(6354);function Ui(L,y,R,B){return{create:(G,ee)=>new na(G,ee,L,y,R,B)}}class na extends g.U{constructor(y,R,B,G,ee,fe){super(y,R),this.retryCount=ht(B)?B:3,this.retryInterval=ht(G)?G:3e4,this.minRetryInterval=ht(ee)?ee:3e3,this.maxRetryInterval=ht(fe)?fe:9e4}sendRequest(y){return this._nextPolicy.sendRequest(y.clone()).catch(R=>Qn(this,y,R.response,R))}}function Qn(L,y,R,B,G){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,_.Z)(function*(L,y,R,B,G){if(G=hs(L,G,B),!On(L.retryCount,function(fe,Te){return!(!Te||!Te.code||"ETIMEDOUT"!==Te.code&&"ESOCKETTIMEDOUT"!==Te.code&&"ECONNREFUSED"!==Te.code&&"ECONNRESET"!==Te.code&&"ENOENT"!==Te.code)},G,R,B))return B?Promise.reject(G.error):R;try{return yield(0,Mo.g)(G.retryInterval),L._nextPolicy.sendRequest(y.clone())}catch(fe){return Qn(L,y,R,fe,G)}})).apply(this,arguments)}var Lr=(()=>{return(L=Lr||(Lr={})).Csv=",",L.Ssv=" ",L.Tsv="\t",L.Pipes="|",L.Multi="Multi",Lr;var L})();class rn{constructor(y,R,B,G,ee,fe,Te,De,Pe,Me,et,st,lt,Qt,Jt){this.streamResponseBody=fe,this.streamResponseStatusCodes=Jt,this.url=y||"",this.method=R||"GET",this.headers=kr(ee)?ee:new ho(ee),this.body=B,this.query=G,this.formData=void 0,this.withCredentials=Te||!1,this.abortSignal=De,this.timeout=Pe||0,this.onUploadProgress=Me,this.onDownloadProgress=et,this.proxySettings=st,this.keepAlive=lt,this.decompressResponse=Qt,this.requestId=this.headers.get("x-ms-client-request-id")||(0,m.Rl)()}validateRequestProperties(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")}prepare(y){if(!y)throw new Error("options object is required");if(null==y.method||"string"!=typeof y.method.valueOf())throw new Error("options.method must be a string.");if(y.url&&y.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=y.pathTemplate&&"string"==typeof y.pathTemplate.valueOf()||null!=y.url&&"string"==typeof y.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(y.url){if("string"!=typeof y.url)throw new Error('options.url must be of type "string".');this.url=y.url}if(y.method){const R=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===R.indexOf(y.method.toUpperCase()))throw new Error('The provided method "'+y.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(R))}if(this.method=y.method.toUpperCase(),y.pathTemplate){const{pathTemplate:R,pathParameters:B}=y;if("string"!=typeof R)throw new Error('options.pathTemplate must be of type "string".');y.baseUrl||(y.baseUrl="https://management.azure.com");const G=y.baseUrl;let ee=G+(G.endsWith("/")?"":"/")+(R.startsWith("/")?R.slice(1):R);const fe=ee.match(/({[\w-]*\s*[\w-]*})/gi);if(fe&&fe.length){if(!B)throw new Error(`pathTemplate: ${R} has been provided. Hence, options.pathParameters must also be provided.`);fe.forEach(function(Te){const De=Te.slice(1,-1),Pe=B[De];if(null==Pe||"string"!=typeof Pe&&"object"!=typeof Pe){const Me=JSON.stringify(B,void 0,2);throw new Error(`pathTemplate: ${R} contains the path parameter ${De} however, it is not present in parameters: ${Me}.The value of the path parameter can either be a "string" of the form { ${De}: "some sample value" } or it can be an "object" of the form { "${De}": { value: "some sample value", skipUrlEncoding: true } }.`)}if("string"==typeof Pe.valueOf()&&(ee=ee.replace(Te,encodeURIComponent(Pe))),"object"==typeof Pe.valueOf()){if(!Pe.value)throw new Error(`options.pathParameters[${De}] is of type "object" but it does not contain a "value" property.`);ee=ee.replace(Te,Pe.skipUrlEncoding?Pe.value:encodeURIComponent(Pe.value))}})}this.url=ee}if(y.queryParameters){const R=y.queryParameters;if("object"!=typeof R)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");const B=[];this.query={};for(const G in R){const ee=R[G];if(ee)if("string"==typeof ee)B.push(G+"="+encodeURIComponent(ee)),this.query[G]=encodeURIComponent(ee);else if("object"==typeof ee){if(!ee.value)throw new Error(`options.queryParameters[${G}] is of type "object" but it does not contain a "value" property.`);ee.skipUrlEncoding?(B.push(G+"="+ee.value),this.query[G]=ee.value):(B.push(G+"="+encodeURIComponent(ee.value)),this.query[G]=encodeURIComponent(ee.value))}}this.url+=B.join("&")}if(y.headers){const R=y.headers;for(const B of Object.keys(y.headers))this.headers.set(B,R[B])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),!this.headers.get("x-ms-client-request-id")&&!y.disableClientRequestId&&this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=y.body,null!=y.body&&(y.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(y.serializationMapper&&(this.body=new oe(y.mappers).serialize(y.serializationMapper,y.body,"requestBody")),y.disableJsonStringifyOnBody||(this.body=JSON.stringify(y.body)))),y.spanOptions&&(this.spanOptions=y.spanOptions),y.tracingContext&&(this.tracingContext=y.tracingContext),this.abortSignal=y.abortSignal,this.onDownloadProgress=y.onDownloadProgress,this.onUploadProgress=y.onUploadProgress,this}clone(){const y=new rn(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse,this.streamResponseStatusCodes);return this.formData&&(y.formData=this.formData),this.operationSpec&&(y.operationSpec=this.operationSpec),this.shouldDeserialize&&(y.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(y.operationResponseGetter=this.operationResponseGetter),y}}const vs=new Error("ProxyPolicy is not supported in browser environment");function Lo(L){return{create:(y,R)=>{throw vs}}}var Dt=c(4637);const Tu=xi.g.HttpConstants.StatusCodes;function Fr(){return{create:(L,y)=>new zr(L,y)}}const $t="The operation was aborted.";class zr extends g.U{constructor(y,R,B){super(y,R),this.numberOfRetries=0,this._handleResponse=B||this._defaultResponseHandler}sendRequest(y){var R=this;return(0,_.Z)(function*(){const B=yield R._nextPolicy.sendRequest(y.clone());return B.status!==Tu.TooManyRequests&&B.status!==Tu.ServiceUnavailable?B:R._handleResponse(y,B)})()}_defaultResponseHandler(y,R){var B=this;return(0,_.Z)(function*(){var G;const ee=R.headers.get(xi.g.HeaderConstants.RETRY_AFTER);if(ee){const fe=zr.parseRetryAfterHeader(ee);if(fe){if(B.numberOfRetries+=1,yield(0,Mo.g)(fe,void 0,{abortSignal:y.abortSignal,abortErrorMsg:$t}),null===(G=y.abortSignal)||void 0===G?void 0:G.aborted)throw new Dt._($t);return B.numberOfRetries<3?B.sendRequest(y):B._nextPolicy.sendRequest(y)}}return R})()}static parseRetryAfterHeader(y){const R=Number(y);return Number.isNaN(R)?zr.parseDateRetryAfterHeader(y):1e3*R}static parseDateRetryAfterHeader(y){try{const R=Date.now(),G=Date.parse(y)-R;return Number.isNaN(G)?void 0:G}catch(R){return}}}class Cs extends g.U{constructor(y,R,B){super(y,R),this.authenticationProvider=B}signRequest(y){return this.authenticationProvider.signRequest(y)}sendRequest(y){return this.signRequest(y).then(R=>this._nextPolicy.sendRequest(R))}}const Ts={enable:!0};class Ur extends g.U{constructor(y,R,B){super(y,R),this.keepAliveOptions=B}sendRequest(y){var R=this;return(0,_.Z)(function*(){return y.keepAlive=R.keepAliveOptions.enable,R._nextPolicy.sendRequest(y)})()}}var di="object"==typeof globalThis?globalThis:window,Bi="1.0.3",ji=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,Fo=function(L){var y=new Set([L]),R=new Set,B=L.match(ji);if(!B)return function(){return!1};var G_major=+B[1],G_minor=+B[2],G_patch=+B[3];if(null!=B[4])return function(De){return De===L};function ee(Te){return R.add(Te),!1}function fe(Te){return y.add(Te),!0}return function(De){if(y.has(De))return!0;if(R.has(De))return!1;var Pe=De.match(ji);if(!Pe)return ee(De);var Me_minor=+Pe[2],Me_patch=+Pe[3];return null!=Pe[4]||G_major!==+Pe[1]?ee(De):0===G_major?G_minor===Me_minor&&G_patch<=Me_patch?fe(De):ee(De):G_minor<=Me_minor?fe(De):ee(De)}}(Bi),Uo=Bi.split(".")[0],fi=Symbol.for("opentelemetry.js.api."+Uo),wr=di;function Vo(L,y,R,B){var G;void 0===B&&(B=!1);var ee=wr[fi]=null!==(G=wr[fi])&&void 0!==G?G:{version:Bi};if(!B&&ee[L]){var fe=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+L);return R.error(fe.stack||fe.message),!1}return ee.version!==Bi?(fe=new Error("@opentelemetry/api: All API registration versions must match"),R.error(fe.stack||fe.message),!1):(ee[L]=y,R.debug("@opentelemetry/api: Registered a global for "+L+" v"+Bi+"."),!0)}function hi(L){var y,R,B=null===(y=wr[fi])||void 0===y?void 0:y.version;if(B&&Fo(B))return null===(R=wr[fi])||void 0===R?void 0:R[L]}function Ln(L,y){y.debug("@opentelemetry/api: Unregistering a global for "+L+" v"+Bi+".");var R=wr[fi];R&&delete R[L]}var qn=function(){function L(y){this._namespace=y.namespace||"DiagComponentLogger"}return L.prototype.debug=function(){for(var y=[],R=0;R<arguments.length;R++)y[R]=arguments[R];return pn("debug",this._namespace,y)},L.prototype.error=function(){for(var y=[],R=0;R<arguments.length;R++)y[R]=arguments[R];return pn("error",this._namespace,y)},L.prototype.info=function(){for(var y=[],R=0;R<arguments.length;R++)y[R]=arguments[R];return pn("info",this._namespace,y)},L.prototype.warn=function(){for(var y=[],R=0;R<arguments.length;R++)y[R]=arguments[R];return pn("warn",this._namespace,y)},L.prototype.verbose=function(){for(var y=[],R=0;R<arguments.length;R++)y[R]=arguments[R];return pn("verbose",this._namespace,y)},L}();function pn(L,y,R){var B=hi("diag");if(B)return R.unshift(y),B[L].apply(B,R)}var gn=(()=>{return(L=gn||(gn={}))[L.NONE=0]="NONE",L[L.ERROR=30]="ERROR",L[L.WARN=50]="WARN",L[L.INFO=60]="INFO",L[L.DEBUG=70]="DEBUG",L[L.VERBOSE=80]="VERBOSE",L[L.ALL=9999]="ALL",gn;var L})(),Sr=function(){function L(){function y(B){return function(){var G=hi("diag");if(G)return G[B].apply(G,arguments)}}var R=this;R.setLogger=function(B,G){var ee,fe;if(void 0===G&&(G=gn.INFO),B===R){var Te=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return R.error(null!==(ee=Te.stack)&&void 0!==ee?ee:Te.message),!1}var De=hi("diag"),Pe=function(L,y){function R(B,G){var ee=y[B];return"function"==typeof ee&&L>=G?ee.bind(y):function(){}}return L<gn.NONE?L=gn.NONE:L>gn.ALL&&(L=gn.ALL),y=y||{},{error:R("error",gn.ERROR),warn:R("warn",gn.WARN),info:R("info",gn.INFO),debug:R("debug",gn.DEBUG),verbose:R("verbose",gn.VERBOSE)}}(G,B);if(De){var Me=null!==(fe=(new Error).stack)&&void 0!==fe?fe:"<failed to generate stacktrace>";De.warn("Current logger will be overwritten from "+Me),Pe.warn("Current logger will overwrite one already registered from "+Me)}return Vo("diag",Pe,R,!0)},R.disable=function(){Ln("diag",R)},R.createComponentLogger=function(B){return new qn(B)},R.verbose=y("verbose"),R.debug=y("debug"),R.info=y("info"),R.warn=y("warn"),R.error=y("error")}return L.instance=function(){return this._instance||(this._instance=new L),this._instance},L}(),Gn=function(){function L(y){this._entries=y?new Map(y):new Map}return L.prototype.getEntry=function(y){var R=this._entries.get(y);if(R)return Object.assign({},R)},L.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(y){return[y[0],y[1]]})},L.prototype.setEntry=function(y,R){var B=new L(this._entries);return B._entries.set(y,R),B},L.prototype.removeEntry=function(y){var R=new L(this._entries);return R._entries.delete(y),R},L.prototype.removeEntries=function(){for(var y=[],R=0;R<arguments.length;R++)y[R]=arguments[R];for(var B=new L(this._entries),G=0,ee=y;G<ee.length;G++){var fe=ee[G];B._entries.delete(fe)}return B},L.prototype.clear=function(){return new L},L}();function Wt(L){return void 0===L&&(L={}),new Gn(new Map(Object.entries(L)))}Symbol("BaggageEntryMetadata"),Sr.instance();var Dr={get:function(L,y){if(null!=L)return L[y]},keys:function(L){return null==L?[]:Object.keys(L)}},fn={set:function(L,y,R){null!=L&&(L[y]=R)}};function Hi(L){return Symbol.for(L)}var Et=new function L(y){var R=this;R._currentContext=y?new Map(y):new Map,R.getValue=function(B){return R._currentContext.get(B)},R.setValue=function(B,G){var ee=new L(R._currentContext);return ee._currentContext.set(B,G),ee},R.deleteValue=function(B){var G=new L(R._currentContext);return G._currentContext.delete(B),G}},Bo=function(L,y){for(var R=0,B=y.length,G=L.length;R<B;R++,G++)L[G]=y[R];return L},hr=function(){function L(){}return L.prototype.active=function(){return Et},L.prototype.with=function(y,R,B){for(var G=[],ee=3;ee<arguments.length;ee++)G[ee-3]=arguments[ee];return R.call.apply(R,Bo([B],G))},L.prototype.bind=function(y,R){return R},L.prototype.enable=function(){return this},L.prototype.disable=function(){return this},L}(),jo=function(L,y){for(var R=0,B=y.length,G=L.length;R<B;R++,G++)L[G]=y[R];return L},Kr="context",$n=new hr,qi=function(){function L(){}return L.getInstance=function(){return this._instance||(this._instance=new L),this._instance},L.prototype.setGlobalContextManager=function(y){return Vo(Kr,y,Sr.instance())},L.prototype.active=function(){return this._getContextManager().active()},L.prototype.with=function(y,R,B){for(var G,ee=[],fe=3;fe<arguments.length;fe++)ee[fe-3]=arguments[fe];return(G=this._getContextManager()).with.apply(G,jo([y,R,B],ee))},L.prototype.bind=function(y,R){return this._getContextManager().bind(y,R)},L.prototype._getContextManager=function(){return hi(Kr)||$n},L.prototype.disable=function(){this._getContextManager().disable(),Ln(Kr,Sr.instance())},L}(),Br=(()=>{return(L=Br||(Br={}))[L.NONE=0]="NONE",L[L.SAMPLED=1]="SAMPLED",Br;var L})(),Fn="0000000000000000",Yt="00000000000000000000000000000000",ia={traceId:Yt,spanId:Fn,traceFlags:Br.NONE},Gi=function(){function L(y){void 0===y&&(y=ia),this._spanContext=y}return L.prototype.spanContext=function(){return this._spanContext},L.prototype.setAttribute=function(y,R){return this},L.prototype.setAttributes=function(y){return this},L.prototype.addEvent=function(y,R){return this},L.prototype.setStatus=function(y){return this},L.prototype.updateName=function(y){return this},L.prototype.end=function(y){},L.prototype.isRecording=function(){return!1},L.prototype.recordException=function(y,R){},L}(),$i=Hi("OpenTelemetry Context Key SPAN");function Wi(L){return L.getValue($i)||void 0}function gi(L,y){return L.setValue($i,y)}function go(L){return L.deleteValue($i)}function mi(L,y){return gi(L,new Gi(y))}function Dn(L){var y;return null===(y=Wi(L))||void 0===y?void 0:y.spanContext()}var _u=/^([0-9a-f]{32})$/i,pr=/^[0-9a-f]{16}$/i;function mo(L){return function(L){return _u.test(L)&&L!==Yt}(L.traceId)&&function(L){return pr.test(L)&&L!==Fn}(L.spanId)}function yo(L){return new Gi(L)}var ar=qi.getInstance(),oa=function(){function L(){}return L.prototype.startSpan=function(y,R,B){if(Boolean(null==R?void 0:R.root))return new Gi;var ee=B&&Dn(B);return function(L){return"object"==typeof L&&"string"==typeof L.spanId&&"string"==typeof L.traceId&&"number"==typeof L.traceFlags}(ee)&&mo(ee)?new Gi(ee):new Gi},L.prototype.startActiveSpan=function(y,R,B,G){var ee,fe,Te;if(!(arguments.length<2)){2===arguments.length?Te=R:3===arguments.length?(ee=R,Te=B):(ee=R,fe=B,Te=G);var De=null!=fe?fe:ar.active(),Pe=this.startSpan(y,ee,De),Me=gi(De,Pe);return ar.with(Me,Te,void 0,Pe)}},L}(),sa=new oa,Es=function(){function L(y,R,B){this._provider=y,this.name=R,this.version=B}return L.prototype.startSpan=function(y,R,B){return this._getTracer().startSpan(y,R,B)},L.prototype.startActiveSpan=function(y,R,B,G){var ee=this._getTracer();return Reflect.apply(ee.startActiveSpan,ee,arguments)},L.prototype._getTracer=function(){if(this._delegate)return this._delegate;var y=this._provider.getDelegateTracer(this.name,this.version);return y?(this._delegate=y,this._delegate):sa},L}(),wu=new(function(){function L(){}return L.prototype.getTracer=function(y,R){return new oa},L}()),Rr=function(){function L(){}return L.prototype.getTracer=function(y,R){var B;return null!==(B=this.getDelegateTracer(y,R))&&void 0!==B?B:new Es(this,y,R)},L.prototype.getDelegate=function(){var y;return null!==(y=this._delegate)&&void 0!==y?y:wu},L.prototype.setDelegate=function(y){this._delegate=y},L.prototype.getDelegateTracer=function(y,R){var B;return null===(B=this._delegate)||void 0===B?void 0:B.getTracer(y,R)},L}(),Ho="trace",Qc=function(){function L(){this._proxyTracerProvider=new Rr,this.wrapSpanContext=yo,this.isSpanContextValid=mo,this.deleteSpan=go,this.getSpan=Wi,this.getSpanContext=Dn,this.setSpan=gi,this.setSpanContext=mi}return L.getInstance=function(){return this._instance||(this._instance=new L),this._instance},L.prototype.setGlobalTracerProvider=function(y){var R=Vo(Ho,this._proxyTracerProvider,Sr.instance());return R&&this._proxyTracerProvider.setDelegate(y),R},L.prototype.getTracerProvider=function(){return hi(Ho)||this._proxyTracerProvider},L.prototype.getTracer=function(y,R){return this.getTracerProvider().getTracer(y,R)},L.prototype.disable=function(){Ln(Ho,Sr.instance()),this._proxyTracerProvider=new Rr},L}(),aa=function(){function L(){}return L.prototype.inject=function(y,R){},L.prototype.extract=function(y,R){return y},L.prototype.fields=function(){return[]},L}(),Su=Hi("OpenTelemetry Baggage Key");function Jc(L){return L.getValue(Su)||void 0}function ua(L,y){return L.setValue(Su,y)}function Yc(L){return L.deleteValue(Su)}var _s="propagation",Xc=new aa,Iu=function(){function L(){this.createBaggage=Wt,this.getBaggage=Jc,this.setBaggage=ua,this.deleteBaggage=Yc}return L.getInstance=function(){return this._instance||(this._instance=new L),this._instance},L.prototype.setGlobalPropagator=function(y){return Vo(_s,y,Sr.instance())},L.prototype.inject=function(y,R,B){return void 0===B&&(B=fn),this._getGlobalPropagator().inject(y,R,B)},L.prototype.extract=function(y,R,B){return void 0===B&&(B=Dr),this._getGlobalPropagator().extract(y,R,B)},L.prototype.fields=function(){return this._getGlobalPropagator().fields()},L.prototype.disable=function(){Ln(_s,Sr.instance())},L.prototype._getGlobalPropagator=function(){return hi(_s)||Xc},L}(),ca=qi.getInstance(),zi=Qc.getInstance();Iu.getInstance(),Sr.instance();var Ki=(()=>{return(L=Ki||(Ki={}))[L.INTERNAL=0]="INTERNAL",L[L.SERVER=1]="SERVER",L[L.CLIENT=2]="CLIENT",L[L.PRODUCER=3]="PRODUCER",L[L.CONSUMER=4]="CONSUMER",Ki;var L})();function vi(L,y){return zi.setSpan(L,y)}const Au=ca;var un=(()=>{return(L=un||(un={}))[L.UNSET=0]="UNSET",L[L.OK=1]="OK",L[L.ERROR=2]="ERROR",un;var L})();function Qr(L){return function(y,R){const B=zi.getTracer("azure/core-tracing",void 0),G=(null==R?void 0:R.tracingOptions)||{},ee=Object.assign({kind:Ki.INTERNAL},G.spanOptions),fe=L.packagePrefix?`${L.packagePrefix}.${y}`:y;let Te;Te=function(){var L;if("undefined"==typeof process)return!1;const y=null===(L=process.env.AZURE_TRACING_DISABLED)||void 0===L?void 0:L.toLowerCase();return"false"!==y&&"0"!==y&&Boolean(y)}()?zi.wrapSpanContext(ia):B.startSpan(fe,ee,G.tracingContext),L.namespace&&Te.setAttribute("az.namespace",L.namespace);let De=G.spanOptions||{};Te.isRecording()&&L.namespace&&(De=Object.assign(Object.assign({},G.spanOptions),{attributes:Object.assign(Object.assign({},ee.attributes),{"az.namespace":L.namespace})}));const Pe=Object.assign(Object.assign({},G),{spanOptions:De,tracingContext:vi(G.tracingContext||Au.active(),Te)});return{span:Te,updatedOptions:Object.assign(Object.assign({},R),{tracingOptions:Pe})}}}const Mu=Qr({packagePrefix:"",namespace:""});class vo extends g.U{constructor(y,R,B){super(y,R),this.userAgent=B.userAgent}sendRequest(y){var R=this;return(0,_.Z)(function*(){if(!y.tracingContext)return R._nextPolicy.sendRequest(y);const B=R.tryCreateSpan(y);if(!B)return R._nextPolicy.sendRequest(y);try{const G=yield R._nextPolicy.sendRequest(y);return R.tryProcessResponse(B,G),G}catch(G){throw R.tryProcessError(B,G),G}})()}tryCreateSpan(y){var R;try{const B=b.UK.parse(y.url).getPath()||"/",{span:G}=Mu(B,{tracingOptions:{spanOptions:Object.assign(Object.assign({},y.spanOptions),{kind:Ki.CLIENT}),tracingContext:y.tracingContext}});if(!G.isRecording())return void G.end();const ee=null===(R=y.tracingContext)||void 0===R?void 0:R.getValue(Symbol.for("az.namespace"));"string"==typeof ee&&G.setAttribute("az.namespace",ee),G.setAttributes({"http.method":y.method,"http.url":y.url,requestId:y.requestId}),this.userAgent&&G.setAttribute("http.user_agent",this.userAgent);const fe=G.spanContext(),Te=function(L){const y=[];if(L.traceId||y.push("traceId"),L.spanId||y.push("spanId"),y.length)return;const B=(L.traceFlags||0).toString(16);return`00-${L.traceId}-${L.spanId}-${1===B.length?`0${B}`:B}`}(fe);if(Te&&zi.isSpanContextValid(fe)){y.headers.set("traceparent",Te);const De=fe.traceState&&fe.traceState.serialize();De&&y.headers.set("tracestate",De)}return G}catch(B){return void E.warning(`Skipping creating a tracing span due to an error: ${B.message}`)}}tryProcessError(y,R){try{y.setStatus({code:un.ERROR,message:R.message}),R.statusCode&&y.setAttribute("http.status_code",R.statusCode),y.end()}catch(B){E.warning(`Skipping tracing span processing due to an error: ${B.message}`)}}tryProcessResponse(y,R){try{y.setAttribute("http.status_code",R.status);const B=R.headers.get("x-ms-request-id");B&&y.setAttribute("serviceRequestId",B),y.setStatus({code:un.OK}),y.end()}catch(B){E.warning(`Skipping tracing span processing due to an error: ${B.message}`)}}}const Qi=new Error("DisableResponseDecompressionPolicy is not supported in browser environment");class da extends g.U{constructor(y,R){super(y,R)}sendRequest(y){var R=this;return(0,_.Z)(function*(){if("string"==typeof y.body&&y.body.startsWith("[")){const B=JSON.parse(y.body);Array.isArray(B)&&(y.body=B.map(G=>JSON.stringify(G)+"\n").join(""))}return R._nextPolicy.sendRequest(y)})()}}const Ds=URL;class yn{sendRequest(y){var R;const B=new XMLHttpRequest;if(y.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");const G=y.abortSignal;if(G){if(G.aborted)return Promise.reject(new Dt._("The operation was aborted."));const ee=()=>{B.abort()};G.addEventListener("abort",ee),B.addEventListener("readystatechange",()=>{B.readyState===XMLHttpRequest.DONE&&G.removeEventListener("abort",ee)})}if(fa(B.upload,y.onUploadProgress),fa(B,y.onDownloadProgress),y.formData){const ee=y.formData,fe=new FormData,Te=(Pe,Me)=>{Me&&Object.prototype.hasOwnProperty.call(Me,"value")&&Object.prototype.hasOwnProperty.call(Me,"options")?fe.append(Pe,Me.value,Me.options):fe.append(Pe,Me)};for(const Pe of Object.keys(ee)){const Me=ee[Pe];if(Array.isArray(Me))for(let et=0;et<Me.length;et++)Te(Pe,Me[et]);else Te(Pe,Me)}y.body=fe,y.formData=void 0;const De=y.headers.get("Content-Type");De&&-1!==De.indexOf("multipart/form-data")&&y.headers.remove("Content-Type")}B.open(y.method,y.url),B.timeout=y.timeout,B.withCredentials=y.withCredentials;for(const ee of y.headers.headersArray())B.setRequestHeader(ee.name,ee.value);return B.responseType=(null===(R=y.streamResponseStatusCodes)||void 0===R?void 0:R.size)||y.streamResponseBody?"blob":"text",B.send(void 0===y.body?null:y.body),new Promise("blob"===B.responseType?(ee,fe)=>{(function(L,y,R,B){L.addEventListener("readystatechange",()=>{var G;if(L.readyState===XMLHttpRequest.HEADERS_RECEIVED)if(y.streamResponseBody||(null===(G=y.streamResponseStatusCodes)||void 0===G?void 0:G.has(L.status))){const ee=new Promise((fe,Te)=>{L.addEventListener("load",()=>{fe(L.response)}),Wn(y,L,Te)});R({request:y,status:L.status,headers:Ji(L),blobBody:ee})}else L.addEventListener("load",()=>{if(L.response){const ee=new FileReader;ee.onload=function(fe){var Te;const De=null===(Te=fe.target)||void 0===Te?void 0:Te.result;R({request:y,status:L.status,headers:Ji(L),bodyAsText:De})},ee.onerror=function(fe){B(ee.error)},ee.readAsText(L.response,"UTF-8")}else R({request:y,status:L.status,headers:Ji(L)})})})})(B,y,ee,fe),Wn(y,B,fe)}:function(ee,fe){B.addEventListener("load",()=>ee({request:y,status:B.status,headers:Ji(B),bodyAsText:B.responseText})),Wn(y,B,fe)})}}function fa(L,y){y&&L.addEventListener("progress",R=>y({loadedBytes:R.loaded}))}function Ji(L){const y=new ho,R=L.getAllResponseHeaders().trim().split(/[\r\n]+/);for(const B of R){const G=B.indexOf(":"),ee=B.slice(0,G),fe=B.slice(G+2);y.set(ee,fe)}return y}function Wn(L,y,R){y.addEventListener("error",()=>R(new Tn(`Failed to send request to ${L.url}`,Tn.REQUEST_SEND_ERROR,void 0,L)));const B=new Dt._("The operation was aborted.");y.addEventListener("abort",()=>R(B)),y.addEventListener("timeout",()=>R(B))}let As;function $o(L,y){let R;return"string"==typeof L?R=L:(R=y(),"function"==typeof L&&(R=L(R))),R}function Ar(L,y){const R=[];let B;if(L.sendStreamingJson&&R.push({create:(L,y)=>new da(L,y)}),L.userAgentOptions&&L.userAgentOptions.userAgentPrefix){const Pe=[];Pe.push(L.userAgentOptions.userAgentPrefix);const Me=ko();-1===Pe.indexOf(Me)&&Pe.push(Me),B=Pe.join(" ")}const G=Object.assign(Object.assign({},Ts),L.keepAliveOptions),ee=Object.assign(Object.assign({},Li),L.retryOptions),fe=Object.assign(Object.assign({},$c),L.redirectOptions);m.UG&&R.push(Lo());const Te=Object.assign(Object.assign({},Ht),L.deserializationOptions),De=Object.assign({},L.loggingOptions);return R.push(function(L={}){return{create:(y,R)=>new vo(y,R,L)}}({userAgent:B}),function(L){return{create:(y,R)=>new Ur(y,R,L||Ts)}}(G),ta({value:B}),pu(),Js(Te.expectedContentTypes),Fr(),Ui(),ai(ee.maxRetries,ee.retryDelayInMs,ee.maxRetryDelayInMs)),fe.handleRedirects&&R.push(Wr(fe.maxRetries)),y&&R.push(y),R.push(U(De)),m.UG&&!1===L.decompressResponse&&R.push({create:(L,y)=>{throw Qi}}),{httpClient:L.httpClient,requestPolicyFactories:R}}function Ci(L,y,R,B){return Ct(L,y,R.parameterPath,R.mapper,B)}function Ct(L,y,R,B,G){var ee;let fe;"string"==typeof R&&(R=[R]);const Te=null===(ee=y.options)||void 0===ee?void 0:ee.serializerOptions;if(Array.isArray(R)){if(R.length>0){if(B.isConstant)fe=B.defaultValue;else{let Pe=Co(y,R);Pe.propertyFound||(Pe=Co(L,R));let Me=!1;Pe.propertyFound||(Me=B.required||"options"===R[0]&&2===R.length),fe=Me?B.defaultValue:Pe.propertyValue}const De=M(R,B);G.serialize(B,fe,De,Te)}}else{B.required&&(fe={});for(const De in R){const Pe=B.type.modelProperties[De],Me=R[De],et=Ct(L,y,Me,Pe,G),st=M(Me,Pe);G.serialize(Pe,et,st,Te),null!=et&&(fe||(fe={}),fe[De]=et)}}return fe}function Co(L,y){const R={propertyFound:!1};let B=0;for(;B<y.length;++B){const G=y[B];if(null==L||!(G in L))break;L=L[G]}return B===y.length&&(R.propertyValue=L,R.propertyFound=!0),R}function Ps(L,y){const R=L.parsedHeaders,B=y&&y.bodyMapper,G=ee=>Object.defineProperty(ee,"_response",{value:L});if(B){const ee=B.type.name;if("Stream"===ee)return G(Object.assign(Object.assign({},R),{blobBody:L.blobBody,readableStreamBody:L.readableStreamBody}));const fe="Composite"===ee&&B.type.modelProperties||{},Te=Object.keys(fe).some(De=>""===fe[De].serializedName);if("Sequence"===ee||Te){const De=[...L.parsedBody||[]];for(const Pe of Object.keys(fe))fe[Pe].serializedName&&(De[Pe]=L.parsedBody[Pe]);if(R)for(const Pe of Object.keys(R))De[Pe]=R[Pe];return G(De),De}if("Composite"===ee||"Dictionary"===ee)return G(Object.assign(Object.assign({},R),L.parsedBody))}return B||"HEAD"===L.request.method||m.ty(L.parsedBody)?G(Object.assign(Object.assign({},R),{body:L.parsedBody})):G(Object.assign(Object.assign({},R),L.parsedBody))}function At(L){var y;const{requestOptions:R,tracingOptions:B}=L;let ee=(0,d._T)(L,["requestOptions","tracingOptions"]);return R&&(ee=Object.assign(Object.assign({},ee),R)),B&&(ee.tracingContext=B.tracingContext,ee.spanOptions=null===(y=B)||void 0===y?void 0:y.spanOptions),ee}c(3369);const gt=Qr({packagePrefix:"Azure.Communication",namespace:"Microsoft.Communication"});var jr=c(8199);const Os=L=>{const{id:y}=L,R=(0,d._T)(L,["id"]);return Object.assign(Object.assign({},R),{communicationIdentifier:(0,jr.J)(y)})},ur=L=>{const{communicationIdentifier:y}=L,R=(0,d._T)(L,["communicationIdentifier"]);return Object.assign(Object.assign({},R),{id:(0,jr.H)(y)})},ga=L=>{const{participants:y,initiatorCommunicationIdentifier:R}=L,B=(0,d._T)(L,["participants","initiatorCommunicationIdentifier"]);let G=Object.assign({},B);if(R){const ee=(0,jr.H)(R);G=Object.assign(Object.assign({},G),{initiator:ee})}return y&&(G=Object.assign(Object.assign({},G),{participants:null==y?void 0:y.map(ee=>ur(ee))})),G},w=L=>{const{content:y,senderCommunicationIdentifier:R}=L,B=(0,d._T)(L,["content","senderCommunicationIdentifier"]);let G=Object.assign({},B);if(y&&(G=Object.assign(Object.assign({},G),{content:ga(y)})),R){const ee=(0,jr.H)(R);G=Object.assign(Object.assign({},G),{sender:ee})}return G},O=L=>{const{createdByCommunicationIdentifier:y}=L,R=(0,d._T)(L,["createdByCommunicationIdentifier"]);return y?Object.assign(Object.assign({},R),{createdBy:(0,jr.H)(y)}):Object.assign({},R)},z=L=>{const{senderCommunicationIdentifier:y}=L,R=(0,d._T)(L,["senderCommunicationIdentifier"]);return Object.assign(Object.assign({},R),{sender:(0,jr.H)(y)})},X={type:{name:"Composite",className:"ChatMessageReadReceiptsCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatMessageReadReceipt"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},le={type:{name:"Composite",className:"ChatMessageReadReceipt",modelProperties:{senderCommunicationIdentifier:{serializedName:"senderCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},chatMessageId:{serializedName:"chatMessageId",required:!0,type:{name:"String"}},readOn:{serializedName:"readOn",required:!0,type:{name:"DateTime"}}}}},me={type:{name:"Composite",className:"CommunicationIdentifierModel",modelProperties:{rawId:{serializedName:"rawId",type:{name:"String"}},communicationUser:{serializedName:"communicationUser",type:{name:"Composite",className:"CommunicationUserIdentifierModel"}},phoneNumber:{serializedName:"phoneNumber",type:{name:"Composite",className:"PhoneNumberIdentifierModel"}},microsoftTeamsUser:{serializedName:"microsoftTeamsUser",type:{name:"Composite",className:"MicrosoftTeamsUserIdentifierModel"}}}}},Re={type:{name:"Composite",className:"CommunicationUserIdentifierModel",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},we={type:{name:"Composite",className:"PhoneNumberIdentifierModel",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"String"}}}}},Oe={type:{name:"Composite",className:"MicrosoftTeamsUserIdentifierModel",modelProperties:{userId:{serializedName:"userId",required:!0,type:{name:"String"}},isAnonymous:{serializedName:"isAnonymous",type:{name:"Boolean"}},cloud:{serializedName:"cloud",type:{name:"String"}}}}},_e={type:{name:"Composite",className:"CommunicationErrorResponse",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ChatError"}}}}},He={type:{name:"Composite",className:"ChatError",modelProperties:{code:{serializedName:"code",required:!0,type:{name:"String"}},message:{serializedName:"message",required:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}},innerError:{serializedName:"innererror",type:{name:"Composite",className:"ChatError"}}}}},Je={type:{name:"Composite",className:"SendReadReceiptRequest",modelProperties:{chatMessageId:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}}}},nt={type:{name:"Composite",className:"SendChatMessageRequest",modelProperties:{content:{serializedName:"content",required:!0,type:{name:"String"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["text","html","topicUpdated","participantAdded","participantRemoved"]}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},ct={type:{name:"Composite",className:"SendChatMessageResult",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},pt={type:{name:"Composite",className:"ChatMessagesCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatMessage"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},it={type:{name:"Composite",className:"ChatMessage",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},type:{serializedName:"type",required:!0,type:{name:"Enum",allowedValues:["text","html","topicUpdated","participantAdded","participantRemoved"]}},sequenceId:{serializedName:"sequenceId",required:!0,type:{name:"String"}},version:{serializedName:"version",required:!0,type:{name:"String"}},content:{serializedName:"content",type:{name:"Composite",className:"ChatMessageContent"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}},createdOn:{serializedName:"createdOn",required:!0,type:{name:"DateTime"}},senderCommunicationIdentifier:{serializedName:"senderCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}},editedOn:{serializedName:"editedOn",type:{name:"DateTime"}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},yt={type:{name:"Composite",className:"ChatMessageContent",modelProperties:{message:{serializedName:"message",type:{name:"String"}},topic:{serializedName:"topic",type:{name:"String"}},participants:{serializedName:"participants",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}},initiatorCommunicationIdentifier:{serializedName:"initiatorCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}}}}},qt={type:{name:"Composite",className:"ChatParticipant",modelProperties:{communicationIdentifier:{serializedName:"communicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},displayName:{serializedName:"displayName",type:{name:"String"}},shareHistoryTime:{serializedName:"shareHistoryTime",type:{name:"DateTime"}}}}},cn={type:{name:"Composite",className:"UpdateChatMessageRequest",modelProperties:{content:{serializedName:"content",type:{name:"String"}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},wn={type:{name:"Composite",className:"ChatParticipantsCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Rn={type:{name:"Composite",className:"AddChatParticipantsRequest",modelProperties:{participants:{serializedName:"participants",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}}}}},Sn={type:{name:"Composite",className:"AddChatParticipantsResult",modelProperties:{invalidParticipants:{serializedName:"invalidParticipants",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}}}}},Cn={type:{name:"Composite",className:"CreateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",required:!0,type:{name:"String"}},participants:{serializedName:"participants",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}}}}},An={type:{name:"Composite",className:"CreateChatThreadResult",modelProperties:{chatThread:{serializedName:"chatThread",type:{name:"Composite",className:"ChatThreadProperties"}},invalidParticipants:{serializedName:"invalidParticipants",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}}}}},Xn={type:{name:"Composite",className:"ChatThreadProperties",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},topic:{serializedName:"topic",required:!0,type:{name:"String"}},createdOn:{serializedName:"createdOn",required:!0,type:{name:"DateTime"}},createdByCommunicationIdentifier:{serializedName:"createdByCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}}}}},ln={type:{name:"Composite",className:"ChatThreadsItemCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadItem"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Zt={type:{name:"Composite",className:"ChatThreadItem",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},topic:{serializedName:"topic",required:!0,type:{name:"String"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}},lastMessageReceivedOn:{serializedName:"lastMessageReceivedOn",readOnly:!0,type:{name:"DateTime"}}}}},kt={type:{name:"Composite",className:"UpdateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",type:{name:"String"}}}}},Bt={type:{name:"Composite",className:"SendTypingNotificationRequest",modelProperties:{senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}}}}},zt={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},jt={parameterPath:"endpoint",mapper:{serializedName:"endpoint",required:!0,type:{name:"String"}},skipEncoding:!0},on={parameterPath:"chatThreadId",mapper:{serializedName:"chatThreadId",required:!0,type:{name:"String"}}},Zn={parameterPath:["options","maxPageSize"],mapper:{serializedName:"maxPageSize",type:{name:"Number"}}},yr={parameterPath:["options","skip"],mapper:{serializedName:"skip",type:{name:"Number"}}},Kt={parameterPath:"apiVersion",mapper:{defaultValue:"2021-04-05-preview6",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},Nn={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},To={parameterPath:"sendReadReceiptRequest",mapper:Je},Wo={parameterPath:"sendChatMessageRequest",mapper:nt},Ti={parameterPath:["options","startTime"],mapper:{serializedName:"startTime",type:{name:"DateTime"}}},zo={parameterPath:"chatMessageId",mapper:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}},bo={parameterPath:["options","contentType"],mapper:{defaultValue:"application/merge-patch+json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},Pr={parameterPath:"updateChatMessageRequest",mapper:cn},Xi={parameterPath:"participantCommunicationIdentifier",mapper:me},Uu={parameterPath:"addChatParticipantsRequest",mapper:Rn},Vu={parameterPath:"updateChatThreadRequest",mapper:kt},Eo={parameterPath:["options","sendTypingNotificationRequest"],mapper:Bt},Ko={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0},Md={parameterPath:"createChatThreadRequest",mapper:Cn};class kp{constructor(y){this.client=y}listChatReadReceipts(y,R){const B={chatThreadId:y,options:At(R||{})};return this.client.sendOperationRequest(B,ma)}sendChatReadReceipt(y,R,B){const G={chatThreadId:y,sendReadReceiptRequest:R,options:At(B||{})};return this.client.sendOperationRequest(G,nl)}sendChatMessage(y,R,B){const G={chatThreadId:y,sendChatMessageRequest:R,options:At(B||{})};return this.client.sendOperationRequest(G,Bu)}listChatMessages(y,R){const B={chatThreadId:y,options:At(R||{})};return this.client.sendOperationRequest(B,ya)}getChatMessage(y,R,B){const G={chatThreadId:y,chatMessageId:R,options:At(B||{})};return this.client.sendOperationRequest(G,rl)}updateChatMessage(y,R,B,G){const ee={chatThreadId:y,chatMessageId:R,updateChatMessageRequest:B,options:At(G||{})};return this.client.sendOperationRequest(ee,il)}deleteChatMessage(y,R,B){const G={chatThreadId:y,chatMessageId:R,options:At(B||{})};return this.client.sendOperationRequest(G,Qo)}listChatParticipants(y,R){const B={chatThreadId:y,options:At(R||{})};return this.client.sendOperationRequest(B,kd)}removeChatParticipant(y,R,B){const G={chatThreadId:y,participantCommunicationIdentifier:R,options:At(B||{})};return this.client.sendOperationRequest(G,Jo)}addChatParticipants(y,R,B){const G={chatThreadId:y,addChatParticipantsRequest:R,options:At(B||{})};return this.client.sendOperationRequest(G,ju)}updateChatThreadProperties(y,R,B){const G={chatThreadId:y,updateChatThreadRequest:R,options:At(B||{})};return this.client.sendOperationRequest(G,va)}getChatThreadProperties(y,R){const B={chatThreadId:y,options:At(R||{})};return this.client.sendOperationRequest(B,xp)}sendTypingNotification(y,R){const B={chatThreadId:y,options:At(R||{})};return this.client.sendOperationRequest(B,ol)}listChatReadReceiptsNext(y,R,B){const G={chatThreadId:y,nextLink:R,options:At(B||{})};return this.client.sendOperationRequest(G,sl)}listChatMessagesNext(y,R,B){const G={chatThreadId:y,nextLink:R,options:At(B||{})};return this.client.sendOperationRequest(G,xd)}listChatParticipantsNext(y,R,B){const G={chatThreadId:y,nextLink:R,options:At(B||{})};return this.client.sendOperationRequest(G,Ld)}}const er=new oe(s,!1),ma={path:"/chat/threads/{chatThreadId}/readReceipts",httpMethod:"GET",responses:{200:{bodyMapper:X},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,yr,Kt],urlParameters:[jt,on],headerParameters:[zt],serializer:er},nl={path:"/chat/threads/{chatThreadId}/readReceipts",httpMethod:"POST",responses:{200:{},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:To,queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt,Nn],mediaType:"json",serializer:er},Bu={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"POST",responses:{201:{bodyMapper:ct},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:Wo,queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt,Nn],mediaType:"json",serializer:er},ya={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"GET",responses:{200:{bodyMapper:pt},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,Kt,Ti],urlParameters:[jt,on],headerParameters:[zt],serializer:er},rl={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"GET",responses:{200:{bodyMapper:it},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Kt],urlParameters:[jt,on,zo],headerParameters:[zt],serializer:er},il={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"PATCH",responses:{204:{},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:Pr,queryParameters:[Kt],urlParameters:[jt,on,zo],headerParameters:[zt,bo],mediaType:"json",serializer:er},Qo={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Kt],urlParameters:[jt,on,zo],headerParameters:[zt],serializer:er},kd={path:"/chat/threads/{chatThreadId}/participants",httpMethod:"GET",responses:{200:{bodyMapper:wn},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,yr,Kt],urlParameters:[jt,on],headerParameters:[zt],serializer:er},Jo={path:"/chat/threads/{chatThreadId}/participants/:remove",httpMethod:"POST",responses:{204:{},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:Xi,queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt,Nn],mediaType:"json",serializer:er},ju={path:"/chat/threads/{chatThreadId}/participants/:add",httpMethod:"POST",responses:{201:{bodyMapper:Sn},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:Uu,queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt,Nn],mediaType:"json",serializer:er},va={path:"/chat/threads/{chatThreadId}",httpMethod:"PATCH",responses:{204:{},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:Vu,queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt,bo],mediaType:"json",serializer:er},xp={path:"/chat/threads/{chatThreadId}",httpMethod:"GET",responses:{200:{bodyMapper:Xn},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt],serializer:er},ol={path:"/chat/threads/{chatThreadId}/typing",httpMethod:"POST",responses:{200:{},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:Eo,queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt,Nn],mediaType:"json",serializer:er},sl={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:X},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,yr,Kt],urlParameters:[jt,on,Ko],headerParameters:[zt],serializer:er},xd={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:pt},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,Kt,Ti],urlParameters:[jt,on,Ko],headerParameters:[zt],serializer:er},Ld={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:wn},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,yr,Kt],urlParameters:[jt,on,Ko],headerParameters:[zt],serializer:er};class Ms{constructor(y){this.client=y}createChatThread(y,R){const B={createChatThreadRequest:y,options:At(R||{})};return this.client.sendOperationRequest(B,Hu)}listChatThreads(y){const R={options:At(y||{})};return this.client.sendOperationRequest(R,Ca)}deleteChatThread(y,R){const B={chatThreadId:y,options:At(R||{})};return this.client.sendOperationRequest(B,Ta)}listChatThreadsNext(y,R){const B={nextLink:y,options:At(R||{})};return this.client.sendOperationRequest(B,Fd)}}const Yo=new oe(s,!1),Hu={path:"/chat/threads",httpMethod:"POST",responses:{201:{bodyMapper:An},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},requestBody:Md,queryParameters:[Kt],urlParameters:[jt],headerParameters:[zt,Nn,{parameterPath:["options","repeatabilityRequestId"],mapper:{serializedName:"repeatability-request-id",type:{name:"String"}}}],mediaType:"json",serializer:Yo},Ca={path:"/chat/threads",httpMethod:"GET",responses:{200:{bodyMapper:ln},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,Kt,Ti],urlParameters:[jt],headerParameters:[zt],serializer:Yo},Ta={path:"/chat/threads/{chatThreadId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Kt],urlParameters:[jt,on],headerParameters:[zt],serializer:Yo},Fd={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:ln},401:{bodyMapper:_e,isError:!0},403:{bodyMapper:_e,isError:!0},429:{bodyMapper:_e,isError:!0},503:{bodyMapper:_e,isError:!0}},queryParameters:[Zn,Kt,Ti],urlParameters:[jt,Ko],headerParameters:[zt],serializer:Yo};class qu extends class extends class{constructor(y,R){let B;if(R||(R={}),this._withCredentials=R.withCredentials||!1,this._httpClient=R.httpClient||(As||(As=new yn),As),this._requestPolicyOptions=new g._(R.httpPipelineLogger),Array.isArray(R.requestPolicyFactories))E.info("ServiceClient: using custom request policies"),B=R.requestPolicyFactories;else{let G;if((0,f.c)(y))E.info("ServiceClient: creating bearer token authentication policy from provided credentials"),G=(()=>{let fe;const Te=this,De=R;return{create(Pe,Me){const et=function(L,y){if(null==L?void 0:L.credentialScopes){const R=L.credentialScopes;return Array.isArray(R)?R.map(B=>new Ds(B).toString()):new Ds(R).toString()}if(y)return`${y}/.default`}(De,Te.baseUri);if(!et)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return null==fe&&(fe=(0,_r.v)(y,et)),fe.create(Pe,Me)}}})();else if(y&&"function"==typeof y.signRequest)E.info("ServiceClient: creating signing policy from provided credentials"),L=y,G={create:(y,R)=>new Cs(y,R,L)};else if(null!=y)throw new Error("The credentials argument must implement the TokenCredential interface");if(E.info("ServiceClient: using default request policies"),B=function(L,y){const R=[];y.generateClientRequestIdHeader&&R.push(pu(y.clientRequestIdHeaderName)),L&&R.push(L);const B=$o(y.userAgentHeaderName,Xt),G=$o(y.userAgent,ko);return B&&G&&R.push(ta({key:B,value:G})),R.push(Wr()),R.push(function(L=30){return{create:(y,R)=>new vu(y,R,L)}}(y.rpRegistrationRetryTimeout)),y.noRetryPolicy||(R.push(ai()),R.push(Ui()),R.push(Fr())),R.push(Js(y.deserializationContentTypes)),m.UG&&R.push(Lo()),R.push(U({logger:E.info})),R}(G,R),R.requestPolicyFactories){const ee=R.requestPolicyFactories(B);ee&&(B=ee)}}var L;this._requestPolicyFactories=B}sendRequest(y){if(null==y||"object"!=typeof y)throw new Error("options cannot be null or undefined and it must be of type object.");let R;try{!function(L){if(L&&"object"==typeof L){const y=L;if("string"==typeof y.url&&"string"==typeof y.method&&"object"==typeof y.headers&&kr(y.headers)&&"function"==typeof y.validateRequestProperties&&"function"==typeof y.prepare&&"function"==typeof y.clone)return!0}return!1}(y)?(R=new rn,R=R.prepare(y)):(y.validateRequestProperties(),R=y)}catch(G){return Promise.reject(G)}let B=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(let G=this._requestPolicyFactories.length-1;G>=0;--G)B=this._requestPolicyFactories[G].create(B,this._requestPolicyOptions);return B.sendRequest(R)}sendOperationRequest(y,R,B){var G=this;return(0,_.Z)(function*(){var ee;"function"==typeof y.options&&(B=y.options,y.options=void 0);const fe=null===(ee=y.options)||void 0===ee?void 0:ee.serializerOptions,Te=new rn;let De;try{const Me=R.baseUrl||G.baseUri;if(!Me)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");Te.method=R.httpMethod,Te.operationSpec=R;const et=b.UK.parse(Me);if(R.path&&et.appendPath(R.path),R.urlParameters&&R.urlParameters.length>0)for(const ft of R.urlParameters){let dt=Ci(G,y,ft,R.serializer);dt=R.serializer.serialize(ft.mapper,dt,D(ft),fe),ft.skipEncoding||(dt=encodeURIComponent(dt)),et.replaceAll(`{${ft.mapper.serializedName||D(ft)}}`,dt)}if(R.queryParameters&&R.queryParameters.length>0)for(const ft of R.queryParameters){let dt=Ci(G,y,ft,R.serializer);if(null!=dt){if(dt=R.serializer.serialize(ft.mapper,dt,D(ft),fe),null!=ft.collectionFormat)if(ft.collectionFormat===Lr.Multi){if(0===dt.length)continue;for(const ut in dt){const nn=dt[ut];dt[ut]=null==nn?"":nn.toString()}}else(ft.collectionFormat===Lr.Ssv||ft.collectionFormat===Lr.Tsv)&&(dt=dt.join(ft.collectionFormat));if(!ft.skipEncoding)if(Array.isArray(dt))for(const ut in dt)null!=dt[ut]&&(dt[ut]=encodeURIComponent(dt[ut]));else dt=encodeURIComponent(dt);null!=ft.collectionFormat&&ft.collectionFormat!==Lr.Multi&&ft.collectionFormat!==Lr.Ssv&&ft.collectionFormat!==Lr.Tsv&&(dt=dt.join(ft.collectionFormat)),et.setQueryParameter(ft.mapper.serializedName||D(ft),dt)}}Te.url=et.toString();const st=R.contentType||G.requestContentType;if(st&&R.requestBody&&Te.headers.set("Content-Type",st),R.headerParameters)for(const ft of R.headerParameters){let dt=Ci(G,y,ft,R.serializer);if(null!=dt){dt=R.serializer.serialize(ft.mapper,dt,D(ft),fe);const ut=ft.mapper.headerCollectionPrefix;if(ut)for(const nn of Object.keys(dt))Te.headers.set(ut+nn,dt[nn]);else Te.headers.set(ft.mapper.serializedName||D(ft),dt)}}const lt=y.options;if(lt){if(lt.customHeaders)for(const ft in lt.customHeaders)Te.headers.set(ft,lt.customHeaders[ft]);lt.abortSignal&&(Te.abortSignal=lt.abortSignal),lt.timeout&&(Te.timeout=lt.timeout),lt.onUploadProgress&&(Te.onUploadProgress=lt.onUploadProgress),lt.onDownloadProgress&&(Te.onDownloadProgress=lt.onDownloadProgress),lt.spanOptions&&(Te.spanOptions=lt.spanOptions),lt.tracingContext&&(Te.tracingContext=lt.tracingContext),null!=lt.shouldDeserialize&&(Te.shouldDeserialize=lt.shouldDeserialize)}let Qt,Jt;Te.withCredentials=G._withCredentials,function(L,y,R,B){var G,ee,fe,Te,De,Pe;const Me=null!==(ee=null===(G=R.options)||void 0===G?void 0:G.serializerOptions)&&void 0!==ee?ee:{},et={rootName:null!==(fe=Me.rootName)&&void 0!==fe?fe:"",includeRoot:null!==(Te=Me.includeRoot)&&void 0!==Te&&Te,xmlCharKey:null!==(De=Me.xmlCharKey)&&void 0!==De?De:ce.I},st=Me.xmlCharKey;if(B.requestBody&&B.requestBody.mapper){y.body=Ci(L,R,B.requestBody,B.serializer);const lt=B.requestBody.mapper,{required:Qt,xmlName:Jt,xmlElementName:ft,serializedName:dt,xmlNamespace:ut,xmlNamespacePrefix:nn}=lt,Or=lt.type.name;try{if(null!=y.body||Qt){const xs=D(B.requestBody);y.body=B.serializer.serialize(lt,y.body,xs,et);const _o=Or===Qe.Stream;if(B.isXML){const ba=nn?`xmlns:${nn}`:"xmlns",Gu=function(L,y,R,B,G){if(L&&!["Composite","Sequence","Dictionary"].includes(R)){const ee={};return ee[G.xmlCharKey]=B,ee[ce.c]={[y]:L},ee}return B}(ut,ba,Or,y.body,et);Or===Qe.Sequence?y.body=du(m.WQ(Gu,ft||Jt||dt,ba,ut),{rootName:Jt||dt,xmlCharKey:st}):_o||(y.body=du(Gu,{rootName:Jt||dt,xmlCharKey:st}))}else{if(Or===Qe.String&&((null===(Pe=B.contentType)||void 0===Pe?void 0:Pe.match("text/plain"))||"text"===B.mediaType))return;_o||(y.body=JSON.stringify(y.body))}}}catch(xs){throw new Error(`Error "${xs.message}" occurred in serializing the payload - ${JSON.stringify(dt,void 0,"  ")}.`)}}else if(B.formDataParameters&&B.formDataParameters.length>0){y.formData={};for(const lt of B.formDataParameters){const Qt=Ci(L,R,lt,B.serializer);if(null!=Qt){const Jt=lt.mapper.serializedName||D(lt);y.formData[Jt]=B.serializer.serialize(lt.mapper,Qt,D(lt),et)}}}}(G,Te,y,R),void 0===Te.streamResponseStatusCodes&&(Te.streamResponseStatusCodes=function(L){const y=new Set;for(const R in L.responses){const B=L.responses[R];B.bodyMapper&&B.bodyMapper.type.name===Qe.Stream&&y.add(Number(R))}return y}(R));try{Qt=yield G.sendRequest(Te)}catch(ft){Jt=ft}Jt?(Jt.response&&(Jt.details=Ps(Jt.response,R.responses[Jt.statusCode]||R.responses.default)),De=Promise.reject(Jt)):De=Promise.resolve(Ps(Qt,R.responses[Qt.status]))}catch(Me){De=Promise.reject(Me)}const Pe=B;return Pe&&De.then(Me=>Pe(null,Me._response.parsedBody,Me._response.request,Me._response)).catch(Me=>Pe(Me)),De})()}}{constructor(y,R){if(void 0===y)throw new Error("'endpoint' cannot be null");if(R||(R={}),!R.userAgent){const B=ko();R.userAgent=`azure-communication-chat/1.1.0-beta.2 ${B}`}super(void 0,R),this.requestContentType="application/json; charset=utf-8",this.baseUri=R.endpoint||"{endpoint}",this.endpoint=y,this.apiVersion=R.apiVersion||"2021-04-05-preview6"}}{constructor(y,R){super(y,R),this.chatThread=new kp(this),this.chat=new Ms(this)}}const ll=L=>(0,_r.v)({getToken:(y,R)=>L.getToken({abortSignal:null==R?void 0:R.abortSignal})},[]);class Ns{constructor(y,R,B,G={}){this.endpoint=y,this.timeOfLastTypingRequest=void 0,this.threadId=R,this.tokenCredential=B;const ee=`azsdk-js-communication-chat/${C}`;G.userAgentOptions||(G.userAgentOptions={});const fe=Object.assign({},G.userAgentOptions);fe.userAgentPrefix=G.userAgentOptions.userAgentPrefix?`${G.userAgentOptions.userAgentPrefix} ${ee}`:ee;const Pe=Ar(Object.assign(Object.assign({},Object.assign(Object.assign({},G),{userAgentOptions:fe})),{loggingOptions:{logger:T.info}}),ll(this.tokenCredential));this.client=new qu(this.endpoint,Pe)}getProperties(y={}){var R=this;return(0,_.Z)(function*(){const{span:B,updatedOptions:G}=gt("ChatClient-GetProperties",y);try{const ee=yield R.client.chatThread.getChatThreadProperties(R.threadId,At(G)),Te=(0,d._T)(ee,["_response"]);return O(Te)}catch(ee){throw B.setStatus({code:un.ERROR,message:ee.message}),ee}finally{B.end()}})()}updateTopic(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-UpdateTopic",R);try{yield B.client.chatThread.updateChatThreadProperties(B.threadId,{topic:y},At(ee))}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}sendMessage(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-SendMessage",R);try{B.timeOfLastTypingRequest=void 0;const fe=yield B.client.chatThread.sendChatMessage(B.threadId,Object.assign(Object.assign({},y),R),At(ee));return(0,d._T)(fe,["_response"])}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}getMessage(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-GetMessage",R);try{const fe=yield B.client.chatThread.getChatMessage(B.threadId,y,At(ee)),De=(0,d._T)(fe,["_response"]);return w(De)}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}listMessagesPage(y,R={}){return(0,d.FC)(this,arguments,function*(){const G=At(R);if(!y.continuationToken){const ee=yield(0,d.qq)(this.client.chatThread.listChatMessages(this.threadId,G));y.continuationToken=ee.nextLink,ee.value&&(yield yield(0,d.qq)(ee.value.map(w,this)))}for(;y.continuationToken;){const ee=yield(0,d.qq)(this.client.chatThread.listChatMessagesNext(this.threadId,y.continuationToken,G));if(y.continuationToken=ee.nextLink,!ee.value)break;yield yield(0,d.qq)(ee.value.map(w,this))}})}listMessagesAll(y){return(0,d.FC)(this,arguments,function*(){var B,G;try{for(var fe,ee=(0,d.KL)(this.listMessagesPage({},y));!(fe=yield(0,d.qq)(ee.next())).done;){const Te=fe.value;yield(0,d.qq)(yield*(0,d.V2)((0,d.KL)(Te)))}}catch(Te){B={error:Te}}finally{try{fe&&!fe.done&&(G=ee.return)&&(yield(0,d.qq)(G.call(ee)))}finally{if(B)throw B.error}}})}listMessages(y={}){const{span:R,updatedOptions:B}=gt("ChatThreadClient-ListMessages",y);try{const G=this.listMessagesAll(B);return{next:()=>G.next(),[Symbol.asyncIterator](){return this},byPage:(ee={})=>this.listMessagesPage(ee,B)}}catch(G){throw R.setStatus({code:un.ERROR,message:G.message}),G}finally{R.end()}}deleteMessage(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-DeleteMessage",R);try{yield B.client.chatThread.deleteChatMessage(B.threadId,y,At(ee))}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}updateMessage(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-UpdateMessage",R);try{yield B.client.chatThread.updateChatMessage(B.threadId,y,R,At(ee))}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}addParticipants(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-AddParticipants",R);try{const fe=yield B.client.chatThread.addChatParticipants(B.threadId,(L=>{var y;return{participants:null===(y=L.participants)||void 0===y?void 0:y.map(R=>Os(R))}})(y),At(ee));return(0,d._T)(fe,["_response"])}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}listParticipantsPage(y,R={}){return(0,d.FC)(this,arguments,function*(){const G=At(R);if(!y.continuationToken){const ee=yield(0,d.qq)(this.client.chatThread.listChatParticipants(this.threadId,G));y.continuationToken=ee.nextLink,ee.value&&(yield yield(0,d.qq)(ee.value.map(ur,this)))}for(;y.continuationToken;){const ee=yield(0,d.qq)(this.client.chatThread.listChatParticipantsNext(this.threadId,y.continuationToken,G));if(y.continuationToken=ee.nextLink,!ee.value)break;yield yield(0,d.qq)(ee.value.map(ur,this))}})}listParticipantsAll(y){return(0,d.FC)(this,arguments,function*(){var B,G;try{for(var fe,ee=(0,d.KL)(this.listParticipantsPage({},y));!(fe=yield(0,d.qq)(ee.next())).done;){const Te=fe.value;yield(0,d.qq)(yield*(0,d.V2)((0,d.KL)(Te)))}}catch(Te){B={error:Te}}finally{try{fe&&!fe.done&&(G=ee.return)&&(yield(0,d.qq)(G.call(ee)))}finally{if(B)throw B.error}}})}listParticipants(y={}){const{span:R,updatedOptions:B}=gt("ChatThreadClient-ListParticipants",y);try{const G=this.listParticipantsAll(B);return{next:()=>G.next(),[Symbol.asyncIterator](){return this},byPage:(ee={})=>this.listParticipantsPage(ee,B)}}catch(G){throw R.setStatus({code:un.ERROR,message:G.message}),G}finally{R.end()}}removeParticipant(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-RemoveParticipant",R);try{yield B.client.chatThread.removeChatParticipant(B.threadId,(0,jr.J)(y),At(ee))}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}sendTypingNotification(y={}){var R=this;return(0,_.Z)(function*(){const{span:B,updatedOptions:G}=gt("ChatThreadClient-SendTypingNotification",y);try{const ee=new Date,fe=At(G),{senderDisplayName:Te}=fe,De=(0,d._T)(fe,["senderDisplayName"]);return R.canPostTypingNotification(ee)?(yield R.client.chatThread.sendTypingNotification(R.threadId,Object.assign({sendTypingNotificationRequest:{senderDisplayName:Te}},De)),R.timeOfLastTypingRequest=ee,!0):(T.info(`Typing Notification NOT Send. [thread_id=${R.threadId}]`),!1)}catch(ee){throw B.setStatus({code:un.ERROR,message:ee.message}),ee}finally{B.end()}})()}sendReadReceipt(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatThreadClient-SendReadReceipt",R);try{yield B.client.chatThread.sendChatReadReceipt(B.threadId,y,At(ee))}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}listReadReceiptsPage(y,R={}){return(0,d.FC)(this,arguments,function*(){const G=At(R);if(!y.continuationToken){const ee=yield(0,d.qq)(this.client.chatThread.listChatReadReceipts(this.threadId,G));y.continuationToken=ee.nextLink,ee.value&&(yield yield(0,d.qq)(ee.value.map(z,this)))}for(;y.continuationToken;){const ee=yield(0,d.qq)(this.client.chatThread.listChatReadReceiptsNext(this.threadId,y.continuationToken,G));if(y.continuationToken=ee.nextLink,!ee.value)break;yield yield(0,d.qq)(ee.value.map(z,this))}})}listReadReceiptsAll(y){return(0,d.FC)(this,arguments,function*(){var B,G;try{for(var fe,ee=(0,d.KL)(this.listReadReceiptsPage({},y));!(fe=yield(0,d.qq)(ee.next())).done;){const Te=fe.value;yield(0,d.qq)(yield*(0,d.V2)((0,d.KL)(Te)))}}catch(Te){B={error:Te}}finally{try{fe&&!fe.done&&(G=ee.return)&&(yield(0,d.qq)(G.call(ee)))}finally{if(B)throw B.error}}})}listReadReceipts(y={}){const{span:R,updatedOptions:B}=gt("ChatThreadClient-ListChatReadReceipts",y);try{const G=this.listReadReceiptsAll(B);return{next:()=>G.next(),[Symbol.asyncIterator](){return this},byPage:(ee={})=>this.listReadReceiptsPage(ee,B)}}catch(G){throw R.setStatus({code:un.ERROR,message:G.message}),G}finally{R.end()}}canPostTypingNotification(y){return!(this.timeOfLastTypingRequest&&y.getTime()-this.timeOfLastTypingRequest.getTime()<8e3&&(T.info(`Typing interval check failed. [last_request=${this.timeOfLastTypingRequest}]`),1))}}class ks{constructor(y,R,B={}){this.endpoint=y,this.signalingClient=void 0,this.emitter=new l.EventEmitter,this.isRealtimeNotificationsStarted=!1,this.tokenCredential=R,this.clientOptions=Object.assign({},B);const G=`azsdk-js-communication-chat/${C}`;B.userAgentOptions||(B.userAgentOptions={});const ee=Object.assign({},B.userAgentOptions);ee.userAgentPrefix=B.userAgentOptions.userAgentPrefix?`${B.userAgentOptions.userAgentPrefix} ${G}`:G;const De=Ar(Object.assign(Object.assign({},Object.assign(Object.assign({},B),{userAgentOptions:ee})),{loggingOptions:{logger:T.info}}),ll(this.tokenCredential));this.client=new qu(this.endpoint,De),this.signalingClient=((L,y)=>new P.CommunicationSignalingClient(L,y))(R,T)}getChatThreadClient(y){return new Ns(this.endpoint,y,this.tokenCredential,this.clientOptions)}createChatThread(y,R={}){var B=this;return(0,_.Z)(function*(){var G,ee;const{span:fe,updatedOptions:Te}=gt("ChatClient-CreateChatThread",R);try{Te.idempotencyToken=null!==(G=Te.idempotencyToken)&&void 0!==G?G:(0,m.Rl)();const De=(L=>{const{idempotencyToken:R}=L,B=(0,d._T)(L,["participants","idempotencyToken"]);return Object.assign({repeatabilityRequestId:R},B)})(Te),Pe=yield B.client.chat.createChatThread({topic:y.topic,participants:null===(ee=R.participants)||void 0===ee?void 0:ee.map(st=>Os(st))},At(De));return(L=>{const{chatThread:y}=L,R=(0,d._T)(L,["chatThread"]);return y?Object.assign(Object.assign({},R),{chatThread:O(y)}):Object.assign({},R)})((0,d._T)(Pe,["_response"]))}catch(De){throw fe.setStatus({code:un.ERROR,message:De.message}),De}finally{fe.end()}})()}listChatThreadsPage(y,R={}){return(0,d.FC)(this,arguments,function*(){const G=At(R);if(!y.continuationToken){const ee=yield(0,d.qq)(this.client.chat.listChatThreads(G));y.continuationToken=ee.nextLink,ee.value&&(yield yield(0,d.qq)(ee.value))}for(;y.continuationToken;){const ee=yield(0,d.qq)(this.client.chat.listChatThreadsNext(y.continuationToken,G));if(y.continuationToken=ee.nextLink,!ee.value)break;yield yield(0,d.qq)(ee.value)}})}listChatThreadsAll(y){return(0,d.FC)(this,arguments,function*(){var B,G;try{for(var fe,ee=(0,d.KL)(this.listChatThreadsPage({},y));!(fe=yield(0,d.qq)(ee.next())).done;){const Te=fe.value;yield(0,d.qq)(yield*(0,d.V2)((0,d.KL)(Te)))}}catch(Te){B={error:Te}}finally{try{fe&&!fe.done&&(G=ee.return)&&(yield(0,d.qq)(G.call(ee)))}finally{if(B)throw B.error}}})}listChatThreads(y={}){const{span:R,updatedOptions:B}=gt("ChatClient-ListChatThreads",y);try{const G=this.listChatThreadsAll(B);return{next:()=>G.next(),[Symbol.asyncIterator](){return this},byPage:(ee={})=>this.listChatThreadsPage(ee,B)}}catch(G){throw R.setStatus({code:un.ERROR,message:G.message}),G}finally{R.end()}}deleteChatThread(y,R={}){var B=this;return(0,_.Z)(function*(){const{span:G,updatedOptions:ee}=gt("ChatClient-DeleteChatThread",R);try{yield B.client.chat.deleteChatThread(y,At(ee))}catch(fe){throw G.setStatus({code:un.ERROR,message:fe.message}),fe}finally{G.end()}})()}startRealtimeNotifications(){var y=this;return(0,_.Z)(function*(){if(void 0===y.signalingClient)throw new Error("Realtime notifications are not supported in node js.");y.isRealtimeNotificationsStarted||(y.isRealtimeNotificationsStarted=!0,y.signalingClient.start(),y.subscribeToSignalingEvents())})()}stopRealtimeNotifications(){var y=this;return(0,_.Z)(function*(){if(void 0===y.signalingClient)throw new Error("Realtime notifications are not supported in node js.");y.isRealtimeNotificationsStarted=!1,y.signalingClient.stop(),y.emitter.removeAllListeners()})()}on(y,R){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");if(!this.isRealtimeNotificationsStarted)throw new Error("You must call startRealtimeNotifications before you can subscribe to events.");this.emitter.on(y,R)}off(y,R){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.emitter.removeListener(y,R)}subscribeToSignalingEvents(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.signalingClient.on("chatMessageReceived",y=>{this.emitter.emit("chatMessageReceived",y)}),this.signalingClient.on("chatMessageEdited",y=>{this.emitter.emit("chatMessageEdited",y)}),this.signalingClient.on("chatMessageDeleted",y=>{this.emitter.emit("chatMessageDeleted",y)}),this.signalingClient.on("typingIndicatorReceived",y=>{this.emitter.emit("typingIndicatorReceived",y)}),this.signalingClient.on("readReceiptReceived",y=>{this.emitter.emit("readReceiptReceived",y)}),this.signalingClient.on("chatThreadCreated",y=>{this.emitter.emit("chatThreadCreated",y)}),this.signalingClient.on("chatThreadDeleted",y=>{this.emitter.emit("chatThreadDeleted",y)}),this.signalingClient.on("chatThreadPropertiesUpdated",y=>{this.emitter.emit("chatThreadPropertiesUpdated",y)}),this.signalingClient.on("participantsAdded",y=>{this.emitter.emit("participantsAdded",y)}),this.signalingClient.on("participantsRemoved",y=>{this.emitter.emit("participantsRemoved",y)})}}},8199:(Q,u,c)=>{"use strict";c.d(u,{J:()=>l,H:()=>C});var s=c(4762),_=c(6361);const d=(P,S)=>void 0===S?P:Object.assign(Object.assign({},P),{rawId:S}),p=(P,S)=>{const f=Object.keys(P)[0],g=P[f];if(S in g)return g[S];throw new Error(`Property ${S} is required for identifier of type ${f}.`)},l=P=>{var S,f;const g=(0,_.n9)(P);switch(g.kind){case"communicationUser":return{communicationUser:{id:g.communicationUserId}};case"phoneNumber":return d({phoneNumber:{value:g.phoneNumber}},g.rawId);case"microsoftTeamsUser":return d({microsoftTeamsUser:{userId:g.microsoftTeamsUserId,isAnonymous:null!==(S=g.isAnonymous)&&void 0!==S&&S,cloud:null!==(f=g.cloud)&&void 0!==f?f:"public"}},g.rawId);case"unknown":return{rawId:g.id};default:throw new Error(`Can't serialize an identifier with kind ${g.kind}`)}},C=P=>{(P=>{const f=(0,s._T)(P,["rawId"]),g=Object.keys(f);if(g.length>1)throw new Error(`Only one of the properties in ${JSON.stringify(g)} should be present.`)})(P);const{communicationUser:S,microsoftTeamsUser:f,phoneNumber:g}=P;return S?{kind:"communicationUser",communicationUserId:p({communicationUser:S},"id")}:g?{kind:"phoneNumber",phoneNumber:p({phoneNumber:g},"value"),rawId:p({phoneNumber:P},"rawId")}:f?{kind:"microsoftTeamsUser",microsoftTeamsUserId:p({microsoftTeamsUser:f},"userId"),isAnonymous:p({microsoftTeamsUser:f},"isAnonymous"),cloud:p({microsoftTeamsUser:f},"cloud"),rawId:p({microsoftTeamsUser:P},"rawId")}:{kind:"unknown",id:p({unknown:P},"rawId")}}},6361:(Q,u,c)=>{"use strict";c.d(u,{sE:()=>s,Nc:()=>_,OU:()=>d,vJ:()=>p,n9:()=>T});const s=l=>"string"==typeof l.communicationUserId,_=l=>"string"==typeof l.phoneNumber,d=l=>"string"==typeof l.microsoftTeamsUserId,p=l=>"string"==typeof l.id,T=l=>s(l)?Object.assign(Object.assign({},l),{kind:"communicationUser"}):_(l)?Object.assign(Object.assign({},l),{kind:"phoneNumber"}):d(l)?Object.assign(Object.assign({},l),{kind:"microsoftTeamsUser"}):Object.assign(Object.assign({},l),{kind:"unknown"})},9116:(Q,u,c)=>{"use strict";c.r(u),c.d(u,{AzureCommunicationTokenCredential:()=>f,createCommunicationAccessKeyCredentialPolicy:()=>D,createCommunicationAuthPolicy:()=>$,deserializeCommunicationIdentifier:()=>re.H,getIdentifierKind:()=>pe.n9,isCommunicationUserIdentifier:()=>pe.sE,isKeyCredential:()=>se,isMicrosoftTeamsUserIdentifier:()=>pe.OU,isPhoneNumberIdentifier:()=>pe.Nc,isUnknownIdentifier:()=>pe.vJ,parseClientArguments:()=>K,parseConnectionString:()=>ue,serializeCommunicationIdentifier:()=>re.J});var s=c(8239),_=c(4934),d=c.n(_);const p=J=>{const{exp:ne}=d()(J);return{token:J,expiresOnTimestamp:1e3*ne}};class T{constructor(ne){this.token=ne}getToken(){var ne=this;return(0,s.Z)(function*(){return ne.token})()}dispose(){}}const l={token:"",expiresOnTimestamp:-10};class S{constructor(ne){this.refreshingIntervalInMs=6e5,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.disposed=!1;const{tokenRefresher:te,token:ae,refreshProactively:ve}=ne;this.refresh=te,this.currentToken=ae?p(ae):l,this.refreshProactively=null!=ve&&ve,this.refreshProactively&&this.scheduleRefresh()}getToken(ne){var te=this;return(0,s.Z)(function*(){if(!te.isCurrentTokenExpiringSoon)return te.currentToken;const ae=te.updateTokenAndReschedule(null==ne?void 0:ne.abortSignal);return te.isCurrentTokenValid||(yield ae),te.currentToken})()}dispose(){this.disposed=!0,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.currentToken=l,this.activeTimeout&&clearTimeout(this.activeTimeout)}updateTokenAndReschedule(ne){var te=this;return(0,s.Z)(function*(){if(te.activeTokenUpdating)return te.activeTokenUpdating;te.activeTokenUpdating=te.refreshTokenAndReschedule(ne);try{yield te.activeTokenUpdating}finally{te.activeTokenUpdating=null}})()}refreshTokenAndReschedule(ne){var te=this;return(0,s.Z)(function*(){te.currentToken=yield te.refreshToken(ne),te.refreshProactively&&te.scheduleRefresh()})()}refreshToken(ne){var te=this;return(0,s.Z)(function*(){try{return te.activeTokenFetching||(te.activeTokenFetching=te.refresh(ne)),p(yield te.activeTokenFetching)}finally{te.activeTokenFetching=null}})()}scheduleRefresh(){if(this.disposed)return;this.activeTimeout&&clearTimeout(this.activeTimeout);const ne=this.currentToken.expiresOnTimestamp-Date.now()-this.refreshingIntervalInMs;this.activeTimeout=setTimeout(()=>this.updateTokenAndReschedule(),ne)}get isCurrentTokenValid(){return this.currentToken&&Date.now()<this.currentToken.expiresOnTimestamp}get isCurrentTokenExpiringSoon(){return!this.currentToken||Date.now()>=this.currentToken.expiresOnTimestamp-this.refreshingIntervalInMs}}class f{constructor(ne){this.disposed=!1,this.tokenCredential="string"==typeof ne?new T(p(ne)):new S(ne)}getToken(ne){var te=this;return(0,s.Z)(function*(){te.throwIfDisposed();const ae=yield te.tokenCredential.getToken(ne);return te.throwIfDisposed(),ae})()}dispose(){this.disposed=!0,this.tokenCredential.dispose()}throwIfDisposed(){if(this.disposed)throw new Error("User credential is disposed")}}var g=c(1126),E=c(369),b=c(7694);const m=J=>(new TextEncoder).encode(J);function x(J){if("function"!=typeof btoa)throw new Error("Your browser environment is missing the global `btoa` function");const ne=new Uint8Array(J);let te="";for(const ae of ne)te+=String.fromCharCode(ae);return btoa(te)}const N=globalThis,F=()=>{if(!N)throw new Error("Could not find global");if(!N.crypto||!N.crypto.subtle)throw new Error("Browser does not support cryptography functions");return N.crypto.subtle},U=function(){var J=(0,s.Z)(function*(ne){const te=m(ne);return x(yield F().digest("SHA-256",te))});return function(te){return J.apply(this,arguments)}}(),k=function(){var J=(0,s.Z)(function*(ne,te){const ae={name:"HMAC",hash:{name:"SHA-256"}},ve=m(te),ye=function(J){if("function"!=typeof atob)throw new Error("Your browser environment is missing the global `atob` function");const ne=atob(J),te=new Uint8Array(ne.length);for(let ae=0;ae<ne.length;ae++)te[ae]=ne.charCodeAt(ae);return te}(ne),ge=F(),be=yield ge.importKey("raw",ye,ae,!1,["sign"]);return x(yield ge.sign(ae,be,ve))});return function(te,ae){return J.apply(this,arguments)}}(),D=J=>({create:(ne,te)=>new M(J,ne,te)});class M extends g.U{constructor(ne,te,ae){super(te,ae),this.accessKey=ne}signRequest(ne){var te=this;return(0,s.Z)(function*(){const ae=ne.method.toUpperCase(),ve=(new Date).toUTCString(),ye=yield U(ne.body||""),ge="x-ms-date",be=`${ge};host;x-ms-content-sha256`,Ae=E.UK.parse(ne.url),xe=Ae.getQuery(),Ie=xe?`${Ae.getPath()}?${xe}`:Ae.getPath(),Le=Ae.getPort(),We=Le?`${Ae.getHost()}:${Le}`:Ae.getHost(),Ve=`${ae}\n${Ie}\n${ve};${We};${ye}`,Be=yield k(te.accessKey.key,Ve);return b.UG&&ne.headers.set("Host",We||""),ne.headers.set(ge,ve),ne.headers.set("x-ms-content-sha256",ye),ne.headers.set("Authorization",`HMAC-SHA256 SignedHeaders=${be}&Signature=${Be}`),ne})()}sendRequest(ne){var te=this;return(0,s.Z)(function*(){if(!ne)throw new Error("webResource cannot be null or undefined");return te._nextPolicy.sendRequest(yield te.signRequest(ne))})()}}var j=c(434),W=c(6354);const $=J=>(0,j.c)(J)?(0,W.v)(J,"https://communication.azure.com//.default"):D(J);class ce{constructor(ne){if(!ne)throw new Error("key must be a non-empty string");this._key=ne}get key(){return this._key}update(ne){this._key=ne}}const oe=/endpoint=(.*);accesskey=(.*)/i,ue=J=>{const ne=(J=>{const ne=J.match(oe);if((null==ne?void 0:ne[1])&&ne[2])return{endpoint:ne[1],credential:new ce(ne[2])}})(J);if(ne)return ne;throw new Error(`Invalid connection string ${J}`)},Ee=J=>{if(!(J=>{var ne;const te=E.UK.parse(J);return!!(null===(ne=te.getScheme())||void 0===ne?void 0:ne.match(/^http[s]?/))&&void 0!==te.getHost()&&""!==te.getHost()&&(void 0===te.getPath()||""===te.getPath()||"/"===te.getPath())})(J))throw new Error(`Invalid endpoint url ${J}`)},se=J=>J&&"string"==typeof J.key&&void 0===J.getToken,K=(J,ne)=>{if(se(ne)||(0,j.c)(ne))return Ee(J),{url:J,credential:ne};{const{endpoint:te,credential:ae}=ue(J);return Ee(te),{url:te,credential:ae}}};var pe=c(6361),re=c(8199)},2305:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";function _interopDefault(Q){return Q&&"object"==typeof Q&&"default"in Q?Q.default:Q}var coreHttp=_interopDefault(__webpack_require__(3700)),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(Q){return Q&&Q.__esModule&&Object.prototype.hasOwnProperty.call(Q,"default")?Q.default:Q}function createCommonjsModule(Q,u){return Q(u={exports:{}},u.exports),u.exports}var tsregistrar=createCommonjsModule(function(Q,u){Q.exports=function(c){function s(d){if(_[d])return _[d].exports;var p=_[d]={i:d,l:!1,exports:{}};return c[d].call(p.exports,p,p.exports,s),p.l=!0,p.exports}var _={};return s.m=c,s.c=_,s.i=function(d){return d},s.d=function(d,p,T){s.o(d,p)||Object.defineProperty(d,p,{configurable:!1,enumerable:!0,get:T})},s.n=function(d){var p=d&&d.__esModule?function(){return d.default}:function(){return d};return s.d(p,"a",p),p},s.o=function(d,p){return Object.prototype.hasOwnProperty.call(d,p)},s.p="",s(s.s=1)}([function(c,s,_){Object.defineProperty(s,"__esModule",{value:!0}),s.toJson=function(T){try{return JSON.stringify(T)}catch(l){return"Unable to serialize object of type "+typeof T}};var p=function(){function T(){this.start=Date.now()}return Object.defineProperty(T.prototype,"duration",{get:function(){return Date.now()-this.start},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"startTime",{get:function(){return this.start},enumerable:!0,configurable:!0}),T.prototype.reset=function(){this.start=Date.now()},T}();s.Timespan=p},function(c,s,_){var g,p=this&&this.__extends||(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,b){E.__proto__=b}||function(E,b){for(var m in b)b.hasOwnProperty(m)&&(E[m]=b[m])},function(E,b){function m(){this.constructor=E}g(E,b),E.prototype=null===b?Object.create(b):(m.prototype=b.prototype,new m)}),T=this&&this.__awaiter||function(g,E,b,m){return new(b||(b=Promise))(function(I,x){function N(k){try{U(m.next(k))}catch(D){x(D)}}function F(k){try{U(m.throw(k))}catch(D){x(D)}}function U(k){k.done?I(k.value):new b(function(D){D(k.value)}).then(N,F)}U((m=m.apply(g,E||[])).next())})},l=this&&this.__generator||function(g,E){function b(k){return function(D){return function(k){if(I)throw new TypeError("Generator is already executing.");for(;U;)try{if(I=1,x&&(N=2&k[0]?x.return:k[0]?x.throw||((N=x.return)&&N.call(x),0):x.next)&&!(N=N.call(x,k[1])).done)return N;switch(x=0,N&&(k=[2&k[0],N.value]),k[0]){case 0:case 1:N=k;break;case 4:return U.label++,{value:k[1],done:!1};case 5:U.label++,x=k[1],k=[0];continue;case 7:k=U.ops.pop(),U.trys.pop();continue;default:if(!(N=(N=U.trys).length>0&&N[N.length-1])&&(6===k[0]||2===k[0])){U=0;continue}if(3===k[0]&&(!N||k[1]>N[0]&&k[1]<N[3])){U.label=k[1];break}if(6===k[0]&&U.label<N[1]){U.label=N[1],N=k;break}if(N&&U.label<N[2]){U.label=N[2],U.ops.push(k);break}N[2]&&U.ops.pop(),U.trys.pop();continue}k=E.call(g,U)}catch(D){k=[6,D],x=0}finally{I=N=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}([k,D])}}var I,x,N,F,U={label:0,sent:function(){if(1&N[0])throw N[1];return N[1]},trys:[],ops:[]};return F={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(F[Symbol.iterator]=function(){return this}),F};Object.defineProperty(s,"__esModule",{value:!0});var C=_(0),P=function(g){function E(b){var m=g.call(this,b)||this;return m.name="CancelationError",m}return p(E,g),E}(Error),S=function(){function g(E,b,m){this.logger=E,this.maxBackoffInMs=b,this.initialDelay=m,this.backoffCount=0,this.id=++g.idCounter}return g.prototype.delay=function(E){var b=this;if(void 0!==this.timerHandle)throw new Error("Retry sequence logical failure");if(-1===this.backoffCount)return new Promise(function(I,x){x(new P("Cancelled"))});var m=this.calculateNextBackoffMs();return this.backoffCount++,this.logger.info("[RegistrarClient] Backing off "+E+" for "+m+" milliseconds with ID "+this.id),new Promise(function(I,x){b.cancelFunc=x,b.timerHandle=setTimeout(function(){b.logger.info("[RegistrarClient] Back off for "+E+" with ID "+b.id+" complete"),b.timerHandle=void 0,I()},m)})},g.prototype.cancel=function(){void 0!==this.timerHandle&&(this.logger.debug("Resetting back off"),clearTimeout(this.timerHandle),void 0!==this.cancelFunc&&this.cancelFunc(new P("Cancelled"))),this.backoffCount=-1},g.prototype.calculateNextBackoffMs=function(){var E=1+.4*(Math.random()-.5),b=this.initialDelay*Math.pow(2,this.backoffCount)*E;return b=Math.round(b),Math.min(this.maxBackoffInMs,b)},g.idCounter=0,g}(),f=function(){function g(E,b,m){this.logger=E,this.skypeTokenProvider=b,this.options=m,this.backoffs={}}return g.prototype.setTelemetryLogger=function(E){this.eventLogger=E},g.prototype.register=function(E,b){return T(this,void 0,void 0,function(){return l(this,function(m){switch(m.label){case 0:return[4,this.performRegistration(E,b,"pr_set_registration")];case 1:return m.sent(),this.cachedRegistrationParams=[E,b],[2]}})})},g.prototype.unregister=function(){return T(this,void 0,void 0,function(){var E;return l(this,function(b){switch(b.label){case 0:return this.logger.info("[RegistrarClient] sending unregister request"),E=new Request(this.options.registrarUrl+"/"+this.options.registrationId,{method:"DELETE",mode:"cors",headers:new Headers({accept:"application/json, text/javascript"})}),[4,this.callRegistrar(E,"pr_delete_registration")];case 1:return b.sent(),[2]}})})},g.prototype.cancelPendingRequests=function(){var E=this;Object.keys(this.backoffs).forEach(function(b){E.backoffs[b].cancel()}),this.backoffs={}},g.prototype.resendRegistration=function(){return T(this,void 0,void 0,function(){return l(this,function(E){switch(E.label){case 0:if(!this.cachedRegistrationParams)throw new Error("Re-registration failed because there is no registration parameters cached");return[4,this.performRegistration(this.cachedRegistrationParams[0],this.cachedRegistrationParams[1],"pr_resend_registration")];case 1:return E.sent(),[2]}})})},g.prototype.performRegistration=function(E,b,m){return T(this,void 0,void 0,function(){var I,x;return l(this,function(N){switch(N.label){case 0:return this.logger.info("[RegistrarClient] Sending register request"),I={clientDescription:E,registrationId:this.options.registrationId,nodeId:"",transports:b},x=new Request(this.options.registrarUrl,{method:"POST",mode:"cors",headers:new Headers({"content-type":"application/json",accept:"application/json, text/javascript"}),body:C.toJson(I)}),[4,this.callRegistrar(x,m)];case 1:return N.sent(),[2]}})})},g.prototype.startBackoff=function(){var E=new S(this.logger,this.options.maxRetryDelayMs,this.options.initialRetryDelayMs);return this.backoffs[E.id]=E,E},g.prototype.stopBackoff=function(E){E.cancel(),delete this.backoffs[E.id]},g.prototype.getSkypeToken=function(){return T(this,void 0,void 0,function(){var E,b,I;return l(this,function(x){switch(x.label){case 0:E=this.startBackoff(),x.label=1;case 1:return x.trys.push([1,3,,8]),this.logger.info("[RegistrarClient] Asking for a new skypetoken"),[4,this.skypeTokenProvider(!0)];case 2:return b=x.sent(),this.stopBackoff(E),[2,b];case 3:x.sent(),x.label=4;case 4:return x.trys.push([4,6,,7]),[4,E.delay("Fetching a new skypetoken")];case 5:return x.sent(),[3,8];case 6:throw I=x.sent(),this.stopBackoff(E),I;case 7:return[3,8];case 8:return[3,1];case 9:return[2]}})})},g.prototype.callRegistrar=function(E,b){return T(this,void 0,void 0,function(){var m,I,x,N,F,U,k,D,M,j,W,$,oe;return l(this,function(Z){switch(Z.label){case 0:return m=this.startBackoff(),[4,this.skypeTokenProvider(!1)];case 1:I=Z.sent(),this.setSkypeTokenHeader(E,I),x=new C.Timespan,Z.label=2;case 2:N=void 0,Z.label=3;case 3:return Z.trys.push([3,8,13,14]),F=E.clone(),[4,this.fetchWithTimeout(F)];case 4:return 401!==(N=Z.sent()).status?[3,6]:(U=this.setSkypeTokenHeader,k=[E],[4,this.getSkypeToken()]);case 5:return U.apply(this,k.concat([Z.sent()])),[3,20];case 6:if(N.status>=500&&N.status<600)throw new Error("Fetch for '"+E.url+"' failed with "+N.status+" "+N.statusText);Z.label=7;case 7:return[3,14];case 8:D=Z.sent(),this.logger.error("[RegistrarClient] Request failed with "+D),Z.label=9;case 9:return Z.trys.push([9,11,,12]),[4,m.delay("Registrar call retry")];case 10:return Z.sent(),[3,20];case 11:throw M=Z.sent(),this.logger.error("[RegistrarClient] Request cancelled"),this.stopBackoff(m),M;case 12:return[3,14];case 13:return this.sendTelemetryEvent(b,E,N,x),[7];case 14:return this.stopBackoff(m),N.ok?[2,N]:[3,15];case 15:j=void 0,Z.label=16;case 16:return Z.trys.push([16,18,,19]),$=(W=JSON).stringify,[4,N.json()];case 17:return j=$.apply(W,[Z.sent()]),[3,19];case 18:return Z.sent(),j="no details",[3,19];case 19:throw oe="Fetch for '"+E.url+"' failed with "+N.status+" "+N.statusText+" ("+j+", MS-CV: "+N.headers.get("MS-CV")+")",this.logger.error("[RegistrarClient] "+oe),new Error(oe);case 20:return[3,2];case 21:return[2]}})})},g.prototype.setSkypeTokenHeader=function(E,b){E.headers.set("X-Skypetoken",b)},g.prototype.fetchWithTimeout=function(E){var b=this;return new Promise(function(m,I){fetch(E).then(m).catch(I),0!==b.options.requestTimeoutMs&&setTimeout(I,b.options.requestTimeoutMs,new Error("Fetch for '"+E.url+"' timed out"))})},g.prototype.sendTelemetryEvent=function(E,b,m,I){void 0!==this.eventLogger&&this.eventLogger.logEvent({name:E,properties:{url:{value:b.url},result_code:{value:void 0!==m?m.status:0},begin_timestamp:{value:I.startTime},elapsed:{value:I.duration}}})},g}();s.RegistrarClient=f,s.createRegistrarClient=function(g,E,b){return new f(g,E,b)}}])});unwrapExports(tsregistrar);var tstrouter=createCommonjsModule(function(module,exports){var u;u=function(__WEBPACK_EXTERNAL_MODULE_20__){return function(Q){function u(s){if(c[s])return c[s].exports;var _=c[s]={i:s,l:!1,exports:{}};return Q[s].call(_.exports,_,_.exports,u),_.l=!0,_.exports}var c={};return u.m=Q,u.c=c,u.i=function(s){return s},u.d=function(s,_,d){u.o(s,_)||Object.defineProperty(s,_,{configurable:!1,enumerable:!0,get:d})},u.n=function(s){var _=s&&s.__esModule?function(){return s.default}:function(){return s};return u.d(_,"a",_),_},u.o=function(s,_){return Object.prototype.hasOwnProperty.call(s,_)},u.p="",u(u.s=19)}([function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var s=function(){function _(d,p){this.name=d,this.logger=p}return _.prototype.debug=function(d){this.logger.debug("["+this.name+"] "+d)},_.prototype.info=function(d){this.logger.info("["+this.name+"] "+d)},_.prototype.warn=function(d){this.logger.warn("["+this.name+"] "+d)},_.prototype.error=function(d){this.logger.error("["+this.name+"] "+d)},_}();u.Logger=s},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.constants={TROUTER_INIT:"trouterinit",TROUTER_READY_EVENT:"trouterReadyEvent",TROUTER_READY_TIMEOUT:"trouterReadyTimeout",TROUTER_TOKEN_REQUEST:"trouterTokenRequest",TROUTER_TOKEN_GET_SUCCEEDED:"trouterTokenGetSucceeded",TROUTER_TOKEN_GET_FAILED:"trouterTokenGetFailed",TROUTER_RECONNECTING:"trouterReconnecting",RENEWAL:"renewal",NEW_CONNECTION:"newConnection",ENDPOINT_REGISTRATION_FAILED:"endpointRegistrationFailed"},u.CLIENT_VERSION="2021.32.00.1",u.HANDLED_MESSAGE_ACK=200,u.UNHANDLED_MESSAGE_ACK=404,u.FAILED_MESSAGE_ACK=500},function(Q,u,c){var _;Object.defineProperty(u,"__esModule",{value:!0}),(_=u.UserActivityState||(u.UserActivityState={}))[_.Unknown=0]="Unknown",_[_.Active=1]="Active",_[_.Inactive=2]="Inactive",u.HttpHeaders=function(){},function(_){_[_.Unknown=0]="Unknown",_[_.Connected=2]="Connected",_[_.Disconnected=3]="Disconnected",_[_.Switching=9]="Switching"}(u.TrouterState||(u.TrouterState={}))},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0}),u.toJson=function(l){try{return JSON.stringify(l)}catch(C){return"Unable to serialize object of type "+typeof l}},u.calculateTtlInSec=function(l){var C=Math.round((new Date).getTime()/1e3);return void 0!==l&&l>C?l-C:0},u.calculateExpireTsInSec=function(l){return Math.round((new Date).getTime()/1e3)+l};var p=function(){function l(C){this.base=void 0!==C?C:this.createCorrelationVectorBase(),this.extension=0}return l.extend=function(C){return new l(C)},l.prototype.increase=function(){this.extension++},l.prototype.value=function(){return this.base+"."+this.extension},l.prototype.createCorrelationVectorBase=function(){for(var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0987654321/+",P="AQgw",S="",f=0;f<21;f++)S+=C.charAt(Math.floor(Math.random()*C.length));return S+P.charAt(Math.floor(Math.random()*P.length))},l}();u.CorrelationVector=p;var T=function(){function l(){this.start=Date.now()}return Object.defineProperty(l.prototype,"duration",{get:function(){return Date.now()-this.start},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"startTime",{get:function(){return this.start},enumerable:!0,configurable:!0}),l.prototype.reset=function(){this.start=Date.now()},l}();u.Timespan=T},function(Q,u){var c;c=function(){return this}();try{c=c||Function("return this")()||(0,eval)("this")}catch(s){"object"==typeof window&&(c=window)}Q.exports=c},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var d,s=c(3),_=function(){function d(p,T,l,C,P,S,f){this.connectionId=p,this.connectedClientId=T,this.domId=l,this.unsecureUrl=C,this.url=P,this.c2cUrlBase=S,this.expirationTsSec=f}return d.prototype.getRemainingTtlInSec=function(){return s.calculateTtlInSec(this.expirationTsSec)},d}();u.ServerState=_,(d=u.UserActivityEventReason||(u.UserActivityEventReason={}))[d.Unknown=0]="Unknown",d[d.Modified=1]="Modified",d[d.Snapshot=2]="Snapshot",d[d.Connected=3]="Connected"},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var s=c(1),_=function(){function d(p){this.logger=p,this.messageHandlers=[]}return d.prototype.register=function(p){if(this.messageHandlers.some(function(T){return T===p}))throw new Error("Registering the same handler twice is not allowed");this.messageHandlers.push(p)},d.prototype.clear=function(){this.logger.debug("Clearing message handlers"),this.messageHandlers=[]},d.prototype.active=function(){return this.messageHandlers.length>0},d.prototype.handleMessage=function(p){for(var T={resultCode:s.UNHANDLED_MESSAGE_ACK,isHandled:!1},l=0,C=this.messageHandlers;l<C.length;l++){var S=this.safeExecuteHandle(C[l],p);if(void 0!==S&&(void 0===S.isHandled||S.isHandled))return void 0===S.resultCode&&(S.resultCode=s.HANDLED_MESSAGE_ACK),S}return T},d.prototype.safeExecuteHandle=function(p,T){try{return p.handleMessage(T)}catch(l){return void this.logger.warn("A trouter message handler is throwing exceptions. exception: "+l)}},d}();u.MessageHandlerRegistry=_},function(Q,u,c){var _=this&&this.__awaiter||function(p,T,l,C){return new(l||(l=Promise))(function(P,S){function f(b){try{E(C.next(b))}catch(m){S(m)}}function g(b){try{E(C.throw(b))}catch(m){S(m)}}function E(b){b.done?P(b.value):new l(function(m){m(b.value)}).then(f,g)}E((C=C.apply(p,T||[])).next())})},d=this&&this.__generator||function(p,T){function l(b){return function(m){return function(b){if(P)throw new TypeError("Generator is already executing.");for(;E;)try{if(P=1,S&&(f=2&b[0]?S.return:b[0]?S.throw||((f=S.return)&&f.call(S),0):S.next)&&!(f=f.call(S,b[1])).done)return f;switch(S=0,f&&(b=[2&b[0],f.value]),b[0]){case 0:case 1:f=b;break;case 4:return E.label++,{value:b[1],done:!1};case 5:E.label++,S=b[1],b=[0];continue;case 7:b=E.ops.pop(),E.trys.pop();continue;default:if(!(f=(f=E.trys).length>0&&f[f.length-1])&&(6===b[0]||2===b[0])){E=0;continue}if(3===b[0]&&(!f||b[1]>f[0]&&b[1]<f[3])){E.label=b[1];break}if(6===b[0]&&E.label<f[1]){E.label=f[1],f=b;break}if(f&&E.label<f[2]){E.label=f[2],E.ops.push(b);break}f[2]&&E.ops.pop(),E.trys.pop();continue}b=T.call(p,E)}catch(m){b=[6,m],S=0}finally{P=f=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,m])}}var P,S,f,g,E={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(u,"__esModule",{value:!0}),u.addCacheAsBackupTo=function(p){var T,l=this;return function(C){return _(l,void 0,void 0,function(){return d(this,function(P){return C&&(T=void 0),[2,new Promise(function(S,f){p(C).then(function(g){T=g,S(g)}).catch(function(g){void 0!==T&&T.length>0&&S(T),f(g)})})]})})}}},function(Q,u,c){var s=this&&this.__awaiter||function(f,g,E,b){return new(E||(E=Promise))(function(m,I){function x(U){try{F(b.next(U))}catch(k){I(k)}}function N(U){try{F(b.throw(U))}catch(k){I(k)}}function F(U){U.done?m(U.value):new E(function(k){k(U.value)}).then(x,N)}F((b=b.apply(f,g||[])).next())})},_=this&&this.__generator||function(f,g){function E(U){return function(k){return function(U){if(m)throw new TypeError("Generator is already executing.");for(;F;)try{if(m=1,I&&(x=2&U[0]?I.return:U[0]?I.throw||((x=I.return)&&x.call(I),0):I.next)&&!(x=x.call(I,U[1])).done)return x;switch(I=0,x&&(U=[2&U[0],x.value]),U[0]){case 0:case 1:x=U;break;case 4:return F.label++,{value:U[1],done:!1};case 5:F.label++,I=U[1],U=[0];continue;case 7:U=F.ops.pop(),F.trys.pop();continue;default:if(!(x=(x=F.trys).length>0&&x[x.length-1])&&(6===U[0]||2===U[0])){F=0;continue}if(3===U[0]&&(!x||U[1]>x[0]&&U[1]<x[3])){F.label=U[1];break}if(6===U[0]&&F.label<x[1]){F.label=x[1],x=U;break}if(x&&F.label<x[2]){F.label=x[2],F.ops.push(U);break}x[2]&&F.ops.pop(),F.trys.pop();continue}U=g.call(f,F)}catch(k){U=[6,k],I=0}finally{m=x=0}if(5&U[0])throw U[1];return{value:U[0]?U[1]:void 0,done:!0}}([U,k])}}var m,I,x,N,F={label:0,sent:function(){if(1&x[0])throw x[1];return x[1]},trys:[],ops:[]};return N={next:E(0),throw:E(1),return:E(2)},"function"==typeof Symbol&&(N[Symbol.iterator]=function(){return this}),N};Object.defineProperty(u,"__esModule",{value:!0});var d=c(3),p=c(2),T=c(0),l=c(16),C=c(18),P=function(){function f(g,E){this.state=g,this.correlationVector=void 0!==E?E:d.CorrelationVector.extend()}return f.prototype.getStateString=function(){switch(this.state){case p.UserActivityState.Active:return"active";case p.UserActivityState.Inactive:return"inactive";case p.UserActivityState.Unknown:return"unknown";default:return"undefined"}},f.prototype.toEventObject=function(){return{state:this.getStateString(),cv:this.correlationVector.value()}},f.prototype.toEventJSON=function(){return d.toJson(this.toEventObject())},f}();u.UserActivityObject=P;var S=function(){function f(g,E,b,m){this.logFunc=g,this.options=E,this.tokenProvider=b,this.listener=m,this.logger=new T.Logger("Manager",g),this.logger.info("Created TrouterManager with options "+d.toJson(this.options)),this.fsm=new C.TrouterManagerFsm(g,this),this.baseEndpointUrl="",this.processedMessageLoss={},this.userActivityObject=new P(p.UserActivityState.Unknown)}return f.prototype.start=function(){this.fsm.start()},f.prototype.stop=function(g){this.fsm.stop(g)},f.prototype.configure=function(g){this.options=g,void 0!==this.firstConnection&&this.firstConnection.configure(g),void 0!==this.secondConnection&&this.secondConnection.configure(g),this.logger.info("Reconfigured TrouterManager with options "+d.toJson(this.options))},f.prototype.checkConnection=function(g){void 0!==this.firstConnection&&this.firstConnection.checkConnection(g),void 0!==this.secondConnection&&this.secondConnection.checkConnection(g)},f.prototype.resendRegistration=function(){return s(this,void 0,void 0,function(){return _(this,function(g){return void 0!==this.secondConnection?(this.logger.info("Resending registration on the second/new connection"),[2,this.secondConnection.resendRegistration()]):void 0!==this.firstConnection?(this.logger.info("Resending registration on the first/current connection"),[2,this.firstConnection.resendRegistration()]):(this.logger.info("No connection to resend registration on, will be done upon (re)connect"),[2])})})},f.prototype.getServerState=function(){if(void 0!==this.firstConnection)return this.firstConnection.getServerState()},f.prototype.getState=function(){return this.fsm.getState()},f.prototype.startFirstConnection=function(){var g=new l.TrouterConnection(this.logFunc,this.options,this,this.tokenProvider,this.userActivityObject);this.firstConnection=g,this.getConnectionCache().then(function(E){g.start(E)}).catch()},f.prototype.startSecondConnection=function(){this.secondConnection=new l.TrouterConnection(this.logFunc,this.options,this,this.tokenProvider,this.userActivityObject),this.secondConnection.start()},f.prototype.stopFirstConnection=function(g){void 0!==this.firstConnection&&(this.firstConnection.stop(g),this.storedFirstConnection=this.firstConnection,this.firstConnection=void 0)},f.prototype.stopSecondConnection=function(g){void 0!==this.secondConnection&&(this.secondConnection.stop(g),this.secondConnection=void 0)},f.prototype.stopSecondConnectionDelayed=function(){if(void 0!==this.secondConnection){var g=this.secondConnection;this.secondConnection=void 0,this.logger.info("Closing an inactive connection in "+Math.round(this.options.lingeringConnectionDelayMs/1e3)+"s"),setTimeout(function(){g.stop(!0)},this.options.lingeringConnectionDelayMs)}},f.prototype.forceStopLingeringConnection=function(){this.storedFirstConnection&&(this.storedFirstConnection.stop(!1),this.storedFirstConnection=void 0)},f.prototype.switchConnections=function(){var g=this.firstConnection;this.firstConnection=this.secondConnection,this.secondConnection=g},f.prototype.doesSecondConnectionExist=function(){return void 0!==this.secondConnection},f.prototype.dispatchConnected=function(){if(void 0!==this.firstConnection){var g=this.firstConnection.getServerState(),E="/"===g.url.slice(-1)?g.url.slice(0,-1):g.url,b={baseEndpointUrl:E,newEndpointUrl:E!==this.baseEndpointUrl,c2cUrlBase:g.c2cUrlBase,clientId:g.connectedClientId,connectionId:g.connectionId,connectionTtlSec:g.getRemainingTtlInSec()};this.baseEndpointUrl=E,this.listener.onTrouterConnected(g.url,b)}},f.prototype.dispatchReconnecting=function(){this.listener.onTrouterDisconnected&&this.listener.onTrouterDisconnected()},f.prototype.dispatchStopped=function(){this.listener.onTrouterDisconnected&&this.listener.onTrouterDisconnected()},f.prototype.dispatchRegistrationState=function(g){this.options.registrationStateCallback&&this.options.registrationStateCallback(g)},f.prototype.onDownstreamRequest=function(g,E,b){var I={id:E.id,status:0,headers:{},body:"",send:function(){return I.status<=100||I.status>=999?3:(b.writeHead(I.status,I.headers),b.end(I.body))}};this.listener.onTrouterRequest({id:E.id,method:E.method,path:"/"+E.shortUrl,body:E.body,headers:E.headers},I)},f.prototype.onConnected=function(g){this.fsm.onConnected(g===this.firstConnection)},f.prototype.onRegistered=function(g){this.fsm.onRegistered(g===this.firstConnection)},f.prototype.onUnregistered=function(g){this.fsm.onUnregistered(g===this.firstConnection||g===this.storedFirstConnection)},f.prototype.onReconnecting=function(g){this.fsm.onReconnecting(g===this.firstConnection)},f.prototype.onReconnectIsRequired=function(g){this.fsm.onReconnectionRequired(g===this.firstConnection)},f.prototype.onDisconnected=function(g){this.fsm.onDisconnected(g===this.storedFirstConnection),this.storedFirstConnection=void 0},f.prototype.onUserActivityStateAccepted=function(g){this.listener.onTrouterUserActivityStateAccepted&&this.listener.onTrouterUserActivityStateAccepted(g)},f.prototype.onConnectionParametersUpdated=function(g){this.setConnectionCache(g)},f.prototype.setUserActivityState=function(g,E){return this.userActivityObject=new P(g,d.CorrelationVector.extend(E)),void 0!==this.secondConnection?(this.logger.info("Setting user activity "+this.userActivityObject.toEventJSON()+" on the second/new connection"),void this.secondConnection.setUserActivityState(this.userActivityObject)):void 0!==this.firstConnection?(this.logger.info("Setting user activity "+this.userActivityObject.toEventJSON()+" on the first/current connection"),void this.firstConnection.setUserActivityState(this.userActivityObject)):void 0},f.prototype.onTrouterMessageLost=function(g){var E=this;if(this.listener.onTrouterMessageLoss)if(g&&g.length){var b=g.filter(function(I){return void 0!==E.processedMessageLoss[I.tag+"-"+I.etag]});if(b.length&&(this.logger.warn("onTrouterMessageLoss - removing duplicates and sending event to server"),this.sendProcessedDroppedIndicators(b),!(g=g.filter(function(I){return void 0===E.processedMessageLoss[I.tag+"-"+I.etag]})).length))return void this.logger.warn("onTrouterMessageLoss - All the data are duplicated");if(!this.listener.onTrouterMessageLoss(g.map(function(I){return I.tag})))return void this.logger.warn("onTrouterMessageLoss - flow tags have not been processed by listeners");g.forEach(function(I){E.processedMessageLoss[I.tag+"-"+I.etag]=""}),this.sendProcessedDroppedIndicators(g)}else this.logger.warn("onTrouterMessageLoss - no flow tags have been provided")},f.prototype.getConnectionCache=function(){var g=this;return this.options.connectionCache?(this.logger.debug("Querying host's connection cache"),this.options.connectionCache.onGetTrouterConnectionCache().then(function(E){return E?JSON.parse(E):void 0}).catch(function(E){return g.logger.warn("Invalid connection cache content provided: "+E),g.connectionCache})):Promise.resolve(this.connectionCache)},f.prototype.setConnectionCache=function(g){if(this.connectionCache=g,this.options.connectionCache)try{this.options.connectionCache.onSetTrouterConnectionCache(JSON.stringify(g))}catch(E){this.logger.warn("Error setting external connection cache: "+E)}},f.prototype.sendProcessedDroppedIndicators=function(g){return void 0!==this.firstConnection?void this.firstConnection.sendProcessedDroppedIndicators(g):void 0!==this.secondConnection?void this.secondConnection.sendProcessedDroppedIndicators(g):void 0},f}();u.TrouterManager=S},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var s=function(){function _(d){this.logger=d}return _.prototype.getPromise=function(){var d=this;return void 0!==this.url?(this.logger.debug("[TrouterUrlPromise] returning previously resolved url: "+this.url),Promise.resolve(this.url)):(void 0===this.pendingPromise?(this.logger.debug("[TrouterUrlPromise] creating and returning promise"),this.pendingPromise=new Promise(function(p,T){d.pendingPromiseResolveRef=p,d.pendingPromiseRejectRef=T})):this.logger.debug("[TrouterUrlPromise] returning existing promise"),this.pendingPromise)},_.prototype.resolveUrl=function(d){this.url=d,this.logger.debug("[TrouterUrlPromise] got url: "+this.url);var p=this.pendingPromiseResolveRef;this.pendingPromise=void 0,this.pendingPromiseResolveRef=void 0,this.pendingPromiseRejectRef=void 0,void 0!==p&&(this.logger.debug("[TrouterUrlPromise] resolving promise"),p(d))},_.prototype.rejectUrl=function(d){this.logger.debug("[TrouterUrlPromise] aborting");var p=this.pendingPromiseRejectRef;this.url=void 0,this.pendingPromise=void 0,this.pendingPromiseResolveRef=void 0,this.pendingPromiseRejectRef=void 0,void 0!==p&&(this.logger.debug("[TrouterUrlPromise] rejecting promise"),p(d))},_.prototype.resetUrl=function(){this.logger.debug("[TrouterUrlPromise] resetting url"),this.url=void 0},_}();u.TrouterUrlPromise=s},function(module,exports,__nested_webpack_require_43418__){(function(global,module){var Q,u,c;Q=module.exports,u=void 0===global?window:global,c=Q,c.version="0.9.6",c.protocol=1,c.transports=[],c.j=[],c.sockets={},c.connect=function(s,_){var d,p,T=c.util.parseUri(s);u&&u.location&&(T.protocol=T.protocol||u.location.protocol.slice(0,-1),T.host=T.host||(u.document?u.document.domain:u.location.hostname),T.port=T.port||u.location.port),d=c.util.uniqueUri(T);var l={host:T.host,secure:"https"==T.protocol,port:T.port||("https"==T.protocol?443:80),query:T.query||""};return c.util.merge(l,_),!l["force new connection"]&&c.sockets[d]||(p=new c.Socket(l)),!l["force new connection"]&&p&&(c.sockets[d]=p),(p=p||c.sockets[d]).of(T.path.length>1?T.path:"")};var io=module.exports;(function(Q,u){var c=Q.util={},s=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];c.parseUri=function(p){for(var T=s.exec(p||""),l={},C=14;C--;)l[_[C]]=T[C]||"";return l},c.uniqueUri=function(p){var T=p.protocol,l=p.host,C=p.port;return"document"in u?(l=l||document.domain,C=C||("https"==T&&"https:"!==document.location.protocol?443:document.location.port)):(l=l||"localhost",C||"https"!=T||(C=443)),(T||"http")+"://"+l+":"+(C||80)},c.query=function(p,T){var l=c.chunkQuery(p||""),C=[];for(var P in c.merge(l,c.chunkQuery(T||"")),l)l.hasOwnProperty(P)&&C.push(P+"="+l[P]);return C.length?"?"+C.join("&"):""},c.chunkQuery=function(p){for(var T,l={},C=p.split("&"),P=0,S=C.length;P<S;++P)(T=C[P].split("="))[0]&&(l[T[0]]=T[1]);return l};var d=!1;c.load=function(p){if("document"in u&&"complete"===document.readyState||d)return p();c.on(u,"load",p,!1)},c.on=function(p,T,l,C){p.attachEvent?p.attachEvent("on"+T,l):p.addEventListener&&p.addEventListener(T,l,C)},c.request=function(p){if(p&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!p||c.ua.hasCORS))return new XMLHttpRequest;if(!p)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(T){}return null},"undefined"!=typeof window&&c.load(function(){d=!0}),c.defer=function(p){if(!c.ua.webkit||"undefined"!=typeof importScripts)return p();c.load(function(){setTimeout(p,100)})},c.merge=function(p,T,l,C){var P,S=C||[],f=void 0===l?2:l;for(P in T)T.hasOwnProperty(P)&&c.indexOf(S,P)<0&&("object"==typeof p[P]&&f?c.merge(p[P],T[P],f-1,S):(p[P]=T[P],S.push(T[P])));return p},c.mixin=function(p,T){c.merge(p.prototype,T.prototype)},c.inherit=function(p,T){function l(){}l.prototype=T.prototype,p.prototype=new l},c.isArray=Array.isArray||function(p){return"[object Array]"===Object.prototype.toString.call(p)},c.intersect=function(p,T){for(var l=[],C=p.length>T.length?p:T,P=p.length>T.length?T:p,S=0,f=P.length;S<f;S++)~c.indexOf(C,P[S])&&l.push(P[S]);return l},c.indexOf=function(p,T,l){var C=p.length;for(l=l<0?l+C<0?0:l+C:l||0;l<C&&p[l]!==T;l++);return C<=l?-1:l},c.toArray=function(p){for(var T=[],l=0,C=p.length;l<C;l++)T.push(p[l]);return T},c.ua={},c.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var p=new XMLHttpRequest}catch(T){return!1}return null!=p.withCredentials}(),c.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)})(void 0!==io?io:module.exports,void 0===global?window:global),function(Q,u){function c(){}Q.EventEmitter=c,c.prototype.addListener=c.prototype.on=function(s,_){return this.$events||(this.$events={}),this.$events[s]?u.util.isArray(this.$events[s])?this.$events[s].push(_):this.$events[s]=[this.$events[s],_]:this.$events[s]=_,this},c.prototype.once=function(s,_){function d(){p.removeListener(s,d),_.apply(this,arguments)}var p=this;return d.listener=_,this.on(s,d),this},c.prototype.removeListener=function(s,_){if(this.$events&&this.$events[s]){var d=this.$events[s];if(u.util.isArray(d)){for(var p=-1,T=0,l=d.length;T<l;T++)if(d[T]===_||d[T].listener&&d[T].listener===_){p=T;break}if(p<0)return this;d.splice(p,1),d.length||delete this.$events[s]}else(d===_||d.listener&&d.listener===_)&&delete this.$events[s]}return this},c.prototype.removeAllListeners=function(s){return this.$events&&this.$events[s]&&(this.$events[s]=null),this},c.prototype.listeners=function(s){return this.$events||(this.$events={}),this.$events[s]||(this.$events[s]=[]),u.util.isArray(this.$events[s])||(this.$events[s]=[this.$events[s]]),this.$events[s]},c.prototype.emit=function(s){if(!this.$events)return!1;var _=this.$events[s];if(!_)return!1;var d=Array.prototype.slice.call(arguments,1);if("function"==typeof _)_.apply(this,d);else{if(!u.util.isArray(_))return!1;for(var p=_.slice(),T=0,l=p.length;T<l;T++)p[T].apply(this,d)}return!0}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(exports,nativeJSON){function f(Q){return Q<10?"0"+Q:Q}function date(Q,u){return isFinite(Q.valueOf())?Q.getUTCFullYear()+"-"+f(Q.getUTCMonth()+1)+"-"+f(Q.getUTCDate())+"T"+f(Q.getUTCHours())+":"+f(Q.getUTCMinutes())+":"+f(Q.getUTCSeconds())+"Z":null}function quote(Q){return escapable.lastIndex=0,escapable.test(Q)?'"'+Q.replace(escapable,function(u){var c=meta[u];return"string"==typeof c?c:"\\u"+("0000"+u.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+Q+'"'}function str(Q,u){var c,s,_,d,p,T=gap,l=u[Q];switch(l instanceof Date&&(l=date(Q)),"function"==typeof rep&&(l=rep.call(u,Q,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,p=[],"[object Array]"===Object.prototype.toString.apply(l)){for(d=l.length,c=0;c<d;c+=1)p[c]=str(c,l)||"null";return _=0===p.length?"[]":gap?"[\n"+gap+p.join(",\n"+gap)+"\n"+T+"]":"["+p.join(",")+"]",gap=T,_}if(rep&&"object"==typeof rep)for(d=rep.length,c=0;c<d;c+=1)"string"==typeof rep[c]&&(_=str(s=rep[c],l))&&p.push(quote(s)+(gap?": ":":")+_);else for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(_=str(s,l))&&p.push(quote(s)+(gap?": ":":")+_);return _=0===p.length?"{}":gap?"{\n"+gap+p.join(",\n"+gap)+"\n"+T+"}":"{"+p.join(",")+"}",gap=T,_}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(Q,u,c){var s;if(gap="",indent="","number"==typeof c)for(s=0;s<c;s+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return str("",{"":Q})},JSON.parse=function(text,reviver){function walk(Q,u){var c,s,_=Q[u];if(_&&"object"==typeof _)for(c in _)Object.prototype.hasOwnProperty.call(_,c)&&(void 0!==(s=walk(_,c))?_[c]=s:delete _[c]);return reviver.call(Q,u,_)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(Q){return"\\u"+("0000"+Q.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}(void 0!==io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(Q,u){var c=Q.parser={},s=c.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],_=c.reasons=["transport not supported","client not handshaken","unauthorized"],d=c.advice=["reconnect"],p=u.JSON,T=u.util.indexOf;c.encodePacket=function(C){var P=T(s,C.type),S=C.id||"",f=C.endpoint||"",g=C.ack,E=null;switch(C.type){case"error":var b=C.reason?T(_,C.reason):"",m=C.advice?T(d,C.advice):"";""===b&&""===m||(E=b+(""!==m?"+"+m:""));break;case"message":""!==C.data&&(E=C.data);break;case"event":var I={name:C.name};C.args&&C.args.length&&(I.args=C.args),E=p.stringify(I);break;case"json":E=p.stringify(C.data);break;case"connect":C.qs&&(E=C.qs);break;case"ack":E=C.ackId+(C.args&&C.args.length?"+"+p.stringify(C.args):"")}var x=[P,S+("data"==g?"+":""),f];return null!=E&&x.push(E),x.join(":")},c.encodePayload=function(C){var P="";if(1==C.length)return C[0];for(var S=0,f=C.length;S<f;S++)P+="\ufffd"+C[S].length+"\ufffd"+C[S];return P};var l=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;c.decodePacket=function(C){if(!(P=C.match(l)))return{};var S=P[2]||"",f=(C=P[5]||"",{type:s[P[1]],endpoint:P[4]||""});switch(S&&(f.id=S,f.ack=!P[3]||"data"),f.type){case"error":var P=C.split("+");f.reason=_[P[0]]||"",f.advice=d[P[1]]||"";break;case"message":f.data=C||"";break;case"event":try{var g=p.parse(C);f.name=g.name,f.args=g.args}catch(b){}f.args=f.args||[];break;case"json":try{f.data=p.parse(C)}catch(b){}break;case"connect":f.qs=C||"";break;case"ack":if((P=C.match(/^([0-9]+)(\+)?(.*)/))&&(f.ackId=P[1],f.args=[],P[3]))try{f.args=P[3]?p.parse(P[3]):[]}catch(b){}break;case"disconnect":f.reason=C}return f},c.decodePayload=function(C){if("\ufffd"==C.charAt(0)){for(var P=[],S=1,f="";S<C.length;S++)"\ufffd"==C.charAt(S)?(P.push(c.decodePacket(C.substr(S+1).substr(0,f))),S+=Number(f)+1,f=""):f+=C.charAt(S);return P}return[c.decodePacket(C)]}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(Q,u){function c(s,_){this.socket=s,this.sessid=_,this.connectErrorCallback=void 0,this.isOpened=!1}Q.Transport=c,u.util.mixin(c,u.EventEmitter),c.prototype.onData=function(s){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==s){var _=u.parser.decodePayload(s);if(_&&_.length)for(var d=0,p=_.length;d<p;d++)this.onPacket(_[d])}return this},c.prototype.onPacket=function(s){return this.socket.setHeartbeatTimeout(),"heartbeat"==s.type?this.onHeartbeat():("connect"==s.type&&""==s.endpoint&&this.onConnect(),"error"==s.type&&"reconnect"==s.advice&&(this.isOpened=!1),this.socket.onPacket(s),this)},c.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var s=this;this.closeTimeout=setTimeout(function(){s.onDisconnect()},this.socket.closeTimeout)}},c.prototype.onDisconnect=function(){return this.close&&this.isOpened&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},c.prototype.onConnect=function(){return this.socket.onConnect(),this.connectErrorCallback=void 0,this},c.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},c.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},c.prototype.packet=function(s){this.send(u.parser.encodePacket(s))},c.prototype.onHeartbeat=function(s){this.packet({type:"heartbeat"})},c.prototype.onOpen=function(){this.isOpened=!0,this.clearCloseTimeout(),this.socket.onOpen()},c.prototype.onClose=function(){this.isOpened=!1,this.socket.onClose(),this.onDisconnect()},c.prototype.prepareUrl=function(){var s=this.socket.options;return this.scheme()+"://"+s.host+":"+s.port+"/"+s.resource+"/"+u.protocol+"/"+this.name+"/"+this.sessid},c.prototype.ready=function(s,_){_.call(this)},c.prototype.clearEventHandlers=function(){return this}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(Q,u,c){function s(d){if(this.options={port:80,secure:!1,document:"document"in c&&document,resource:"socket.io",transports:u.transports.slice(),"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},u.util.merge(this.options,d),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.disconnected=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||u.util.ua.hasCORS)){var p=this;u.util.on(c,"unload",function(){p.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function _(){}Q.Socket=s,u.util.mixin(s,u.EventEmitter),s.prototype.of=function(d){return this.namespaces[d]||(this.namespaces[d]=new u.SocketNamespace(this,d),""!==d&&this.namespaces[d].packet({type:"connect"})),this.namespaces[d]},s.prototype.publish=function(){var d;for(var p in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(p)&&(d=this.of(p)).$emit.apply(d,arguments)},s.prototype.handshake=function(d){function p(g){g instanceof Error?T.onError(g.message):d.apply(null,g.split(":"))}var T=this,l=this.options;if(!T.disconnected){var C=["http"+(l.secure?"s":"")+":/",l.host+":"+l.port,l.resource,u.protocol,u.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!u.util.ua.hasCORS){var P=document.getElementsByTagName("script")[0],S=document.createElement("script");S.src=C+"&jsonp="+u.j.length,P.parentNode.insertBefore(S,P),u.j.push(function(g){p(g),S.parentNode.removeChild(S)})}else{var f=u.util.request();f.open("GET",C,!0),f.withCredentials=!0,f.onreadystatechange=function(){4==f.readyState&&(f.onreadystatechange=_,200==f.status?p(f.responseText):!T.reconnecting&&T.onError(f.responseText))},f.send(null)}}},s.prototype.getTransport=function(d){for(var p,T=d||this.transports,l=0;p=T[l];l++)if(u.Transport[p]&&u.Transport[p].check(this)&&(!this.isXDomain()||u.Transport[p].xdomainCheck()))return new u.Transport[p](this,this.sessionid);return null},s.prototype.connect=function(d){if(this.connecting||this.disconnected)return this;var p=this;return this.handshake(function(T,l,C,P){function S(){if(!p.connected&&!p.disconnected)if(p.connecting=!1,clearTimeout(p.connectTimeoutTimer),p.options["try multiple transports"]){for(;p.remainingTransports.length>0&&p.remainingTransports.splice(0,1)[0]!=p.transport.name;);p.remainingTransports.length?f(p.remainingTransports):p.publish("connect_failed")}else p.publish("connect_failed")}function f(g){if(p.transport&&(p.transport.clearTimeouts(),p.transport.clearEventHandlers()),p.transport=p.getTransport(g),!p.transport||p.disconnected)return p.publish("connect_failed");p.transport.ready(p,function(){p.connecting=!0,p.publish("connecting",p.transport.name),p.transport.open(S),p.options["connect timeout"]&&(p.connectTimeoutTimer=setTimeout(function(){S()},p.options["connect timeout"]))})}p.sessionid=T,p.closeTimeout=1e3*C+2e3,p.heartbeatTimeout=1e3*l+2e3,p.transports=P?u.util.intersect(P.split(","),p.options.transports):p.options.transports,p.setHeartbeatTimeout(),p.remainingTransports=p.transports.slice(0),f(p.transports),p.once("connect",function(){clearTimeout(p.connectTimeoutTimer),d&&"function"==typeof d&&d()})}),this},s.prototype.setHeartbeatTimeout=function(){clearTimeout(this.heartbeatTimeoutTimer);var d=this;this.heartbeatTimeoutTimer=setTimeout(function(){d.transport.onClose()},this.heartbeatTimeout)},s.prototype.packet=function(d){return this.connected&&!this.doBuffer?this.transport.packet(d):this.buffer.push(d),this},s.prototype.setBuffer=function(d){this.doBuffer=d,!d&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},s.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this.disconnected=!0,this},s.prototype.disconnectSync=function(){u.util.request().open("GET",this.resource+"/"+u.protocol+"/"+this.sessionid,!0),this.onDisconnect("booted")},s.prototype.isXDomain=function(){return this.options.host!==c.location.hostname||this.options.port!=(c.location.port||("https:"==c.location.protocol?443:80))},s.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},s.prototype.onOpen=function(){this.open=!0},s.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},s.prototype.onPacket=function(d){this.of(d.endpoint).onPacket(d)},s.prototype.onError=function(d){d&&d.advice&&"reconnect"===d.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",d&&d.reason?d.reason:d)},s.prototype.onDisconnect=function(d){var p=this.connected,T=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(p||T)&&(this.transport.close(),this.transport.clearTimeouts(),p&&(this.publish("disconnect",d),"booted"!=d&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},s.prototype.reconnect=function(){function d(){if(T.connected){for(var S in T.namespaces)T.namespaces.hasOwnProperty(S)&&""!==S&&T.namespaces[S].packet({type:"connect"});T.publish("reconnect",T.transport.name,T.reconnectionAttempts)}clearTimeout(T.reconnectionTimer),T.removeListener("connect_failed",p),T.removeListener("connect",p),T.reconnecting=!1,delete T.reconnectionAttempts,delete T.reconnectionDelay,delete T.reconnectionTimer,delete T.redoTransports,T.options["try multiple transports"]=C}function p(){if(T.reconnecting)return T.connected?d():T.connecting&&T.reconnecting?T.reconnectionTimer=setTimeout(p,1e3):void(T.reconnectionAttempts++>=l?T.redoTransports?(T.publish("reconnect_failed"),d()):(T.on("connect_failed",p),T.options["try multiple transports"]=!0,T.transport=T.getTransport(),T.redoTransports=!0,T.connect()):(T.reconnectionDelay<P&&(T.reconnectionDelay*=2),T.connect(),T.publish("reconnecting",T.reconnectionDelay,T.reconnectionAttempts),T.reconnectionTimer=setTimeout(p,T.reconnectionDelay)))}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var T=this,l=this.options["max reconnection attempts"],C=this.options["try multiple transports"],P=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(p,this.reconnectionDelay),this.on("connect",p)}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(Q,u){function c(_,d){this.socket=_,this.name=d||"",this.flags={},this.json=new s(this,"json"),this.ackPackets=0,this.acks={}}function s(_,d){this.namespace=_,this.name=d}Q.SocketNamespace=c,u.util.mixin(c,u.EventEmitter),c.prototype.$emit=u.EventEmitter.prototype.emit,c.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},c.prototype.packet=function(_){return _.endpoint=this.name,this.socket.packet(_),this.flags={},this},c.prototype.send=function(_,d){var p={type:this.flags.json?"json":"message",data:_};return"function"==typeof d&&(p.id=++this.ackPackets,p.ack=!0,this.acks[p.id]=d),this.packet(p)},c.prototype.emit=function(_){var d=Array.prototype.slice.call(arguments,1),p=d[d.length-1],T={type:"event",name:_};return"function"==typeof p&&(T.id=++this.ackPackets,T.ack="data",this.acks[T.id]=p,d=d.slice(0,d.length-1)),T.args=d,this.packet(T)},c.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},c.prototype.onPacket=function(_){function d(){p.packet({type:"ack",args:u.util.toArray(arguments),ackId:_.id})}var p=this;switch(_.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(_.reason||"booted"):this.$emit("disconnect",_.reason||"");break;case"message":case"json":var T=["message",_.data];"data"==_.ack?T.push(d):_.ack&&this.packet({type:"ack",ackId:_.id}),this.$emit.apply(this,T);break;case"event":T=[_.name].concat(_.args),"data"==_.ack&&T.push(d),this.$emit.apply(this,T);break;case"ack":this.acks[_.ackId]&&(this.acks[_.ackId].apply(this,_.args),delete this.acks[_.ackId]);break;case"error":_.advice?this.socket.onError(_):this.$emit("unauthorized"==_.reason?"connect_failed":"error",_.reason)}},s.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},s.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(Q,u,c){function s(d){u.Transport.apply(this,arguments)}function _(){}Q.websocket=s,u.util.inherit(s,u.Transport),s.prototype.name="websocket",s.prototype.open=function(d){var p,T=u.util.query(this.socket.options.query),l=this;return this.connectErrorCallback=d,p||(p=c.MozWebSocket||c.WebSocket),this.websocket=new p(this.prepareUrl()+T),this.websocket.onopen=function(){l.onOpen(),l.socket.setBuffer(!1)},this.websocket.onmessage=function(C){l.onData(C.data)},this.websocket.onclose=function(){l.onClose(),l.socket.setBuffer(!0)},this.websocket.onerror=function(C){l.onError(C)},this},s.prototype.send=function(d){return this.websocket.send(d),this},s.prototype.payload=function(d){for(var p=0,T=d.length;p<T;p++)this.packet(d[p]);return this},s.prototype.close=function(){return this.websocket.close(),this},s.prototype.onError=function(d){void 0!==this.connectErrorCallback&&(this.connectErrorCallback(),this.connectErrorCallback=void 0),this.socket.onError(d)},s.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},s.check=function(){return"WebSocket"in c&&!("__addTask"in WebSocket)||"MozWebSocket"in c},s.xdomainCheck=function(){return!0},s.prototype.clearEventHandlers=function(){return this.websocket&&(this.websocket.onopen=this.websocket.onmessage=this.websocket.onclose=this.websocket.onerror=_),this},u.transports.push("websocket")}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(Q,u,c){function s(d){d&&(u.Transport.apply(this,arguments),this.sendBuffer=[])}function _(){}Q.XHR=s,u.util.inherit(s,u.Transport),s.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},s.prototype.payload=function(d){for(var p=[],T=0,l=d.length;T<l;T++)p.push(u.parser.encodePacket(d[T]));this.send(u.parser.encodePayload(p))},s.prototype.send=function(d){return this.post(d),this},s.prototype.post=function(d){var l=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),c.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=_,l.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=_,l.posting=!1,200==this.status?(l.socket.setBuffer(!1),clearTimeout(l.sendXHR.ackTimeoutTimer)):l.onClose())},this.sendXHR.send(d),l.sendXHR.ackTimeoutTimer=setTimeout(function(){l.onClose()},l.socket.options.ackTimeoutMs)},s.prototype.close=function(){return this.onClose(),this},s.prototype.request=function(d){var p=u.util.request(this.socket.isXDomain()),T=u.util.query(this.socket.options.query,"t="+ +new Date);if(p.open(d||"GET",this.prepareUrl()+T,!0),"POST"==d)try{p.setRequestHeader?p.setRequestHeader("Content-type","text/plain;charset=UTF-8"):p.contentType="text/plain"}catch(l){}return p},s.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},s.check=function(d,p){try{var T=u.util.request(p),l=c.XDomainRequest&&T instanceof XDomainRequest;if(T&&(!l||(d&&d.options&&d.options.secure?"https:":"http:")==c.location.protocol))return!0}catch(S){}return!1},s.xdomainCheck=function(){return s.check(null,!0)},s.prototype.clearEventHandlers=function(){return this.sendXHR&&(this.sendXHR.onreadystatechange=this.sendXHR.onload=_),this}}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(Q,u,c){function s(){u.Transport.XHR.apply(this,arguments)}function _(){}Q["xhr-polling"]=s,u.util.inherit(s,u.Transport.XHR),u.util.merge(s,u.Transport.XHR),s.prototype.name="xhr-polling",s.prototype.open=function(d){return this.connectErrorCallback=d,u.Transport.XHR.prototype.open.call(this),!1},s.prototype.get=function(){if(this.isOpened){var l=this;this.xhr=this.request(),c.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){l.connectErrorCallback=void 0,this.onload=_,this.onerror=_,l.onData(this.responseText),l.get()},this.xhr.onerror=function(){l.onClose(),void 0!==l.connectErrorCallback&&(l.connectErrorCallback(),l.connectErrorCallback=void 0)}):this.xhr.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=_,200==this.status?(l.connectErrorCallback=void 0,l.onData(this.responseText),l.get()):(l.onClose(),void 0!==l.connectErrorCallback&&(l.connectErrorCallback(),l.connectErrorCallback=void 0)))},this.xhr.send(null)}},s.prototype.onClose=function(){if(u.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=_;try{this.xhr.abort()}catch(d){}this.xhr=null}},s.prototype.ready=function(d,p){var T=this;u.util.defer(function(){p.call(T)})},s.prototype.clearEventHandlers=function(){return u.Transport.XHR.prototype.clearEventHandlers.call(this),this.xhr&&(this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=_),this},u.transports.push("xhr-polling")}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),exports.io=io}).call(exports,__nested_webpack_require_43418__(4),__nested_webpack_require_43418__(13)(module))},function(Q,u,c){(function(s,_){Q.exports=function(){function p(ke){return"function"==typeof ke}function P(){var ke=setTimeout;return function(){return ke(S,1)}}function S(){for(var ke=0;ke<be;ke+=2)(0,Ye[ke])(Ye[ke+1]),Ye[ke]=void 0,Ye[ke+1]=void 0;be=0}function f(ke,ze){var Xe=arguments,bt=this,Nt=new this.constructor(E);void 0===Nt[qe]&&Ee(Nt);var an,Pt=bt._state;return Pt?(an=Xe[Pt-1],Ie(function(){return Z(Pt,Nt,an,bt._result)})):W(bt,Nt,ke,ze),Nt}function g(ke){if(ke&&"object"==typeof ke&&ke.constructor===this)return ke;var Xe=new this(E);return k(Xe,ke),Xe}function E(){}function I(ke){try{return ke.then}catch(ze){return rr.error=ze,rr}}function U(ke,ze,Xe){ze.constructor===ke.constructor&&Xe===f&&ze.constructor.resolve===g?function(ke,ze){ze._state===Ue?M(ke,ze._result):ze._state===Gt?j(ke,ze._result):W(ze,void 0,function(Xe){return k(ke,Xe)},function(Xe){return j(ke,Xe)})}(ke,ze):Xe===rr?j(ke,rr.error):void 0===Xe?M(ke,ze):p(Xe)?function(ke,ze,Xe){Ie(function(bt){var Nt=!1,Pt=function(ke,ze,Xe,bt){try{ke.call(ze,Xe,bt)}catch(Nt){return Nt}}(Xe,ze,function(an){Nt||(Nt=!0,ze!==an?k(bt,an):M(bt,an))},function(an){Nt||(Nt=!0,j(bt,an))});!Nt&&Pt&&(Nt=!0,j(bt,Pt))},ke)}(ke,ze,Xe):M(ke,ze)}function k(ke,ze){ke===ze?j(ke,new TypeError("You cannot resolve a promise with itself")):function(ke){return"function"==typeof ke||"object"==typeof ke&&null!==ke}(ze)?U(ke,ze,I(ze)):M(ke,ze)}function D(ke){ke._onerror&&ke._onerror(ke._result),$(ke)}function M(ke,ze){ke._state===Qe&&(ke._result=ze,ke._state=Ue,0!==ke._subscribers.length&&Ie($,ke))}function j(ke,ze){ke._state===Qe&&(ke._state=Gt,ke._result=ze,Ie(D,ke))}function W(ke,ze,Xe,bt){var Nt=ke._subscribers,Pt=Nt.length;ke._onerror=null,Nt[Pt]=ze,Nt[Pt+Ue]=Xe,Nt[Pt+Gt]=bt,0===Pt&&ke._state&&Ie($,ke)}function $(ke){var ze=ke._subscribers,Xe=ke._state;if(0!==ze.length){for(var bt=void 0,Nt=void 0,Pt=ke._result,an=0;an<ze.length;an+=3)Nt=ze[an+Xe],(bt=ze[an])?Z(Xe,bt,Nt,Pt):Nt(Pt);ke._subscribers.length=0}}function ce(){this.error=null}function Z(ke,ze,Xe,bt){var Nt=p(Xe),Pt=void 0,an=void 0,Ot=void 0,si=void 0;if(Nt){if((Pt=function(ke,ze){try{return ke(ze)}catch(Xe){return Tn.error=Xe,Tn}}(Xe,bt))===Tn?(si=!0,an=Pt.error,Pt=null):Ot=!0,ze===Pt)return void j(ze,new TypeError("A promises callback cannot return that same promise."))}else Pt=bt,Ot=!0;ze._state!==Qe||(Nt&&Ot?k(ze,Pt):si?j(ze,an):ke===Ue?M(ze,Pt):ke===Gt&&j(ze,Pt))}function Ee(ke){ke[qe]=Nr++,ke._state=void 0,ke._result=void 0,ke._subscribers=[]}function se(ke,ze){this._instanceConstructor=ke,this.promise=new ke(E),this.promise[qe]||Ee(this.promise),ge(ze)?(this._input=ze,this.length=ze.length,this._remaining=ze.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&M(this.promise,this._result))):j(this.promise,new Error("Array Methods must be provided an Array"))}function ae(ke){this[qe]=Nr++,this._result=this._state=void 0,this._subscribers=[],E!==ke&&("function"!=typeof ke&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof ae?function(ke,ze){try{ze(function(Xe){k(ke,Xe)},function(Xe){j(ke,Xe)})}catch(Xe){j(ke,Xe)}}(this,ke):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var ke,ze,Xe,ge=Array.isArray?Array.isArray:function(ke){return"[object Array]"===Object.prototype.toString.call(ke)},be=0,Ae=void 0,xe=void 0,Ie=function(ke,ze){Ye[be]=ke,Ye[be+1]=ze,2===(be+=2)&&(xe?xe(S):Ke())},Le="undefined"!=typeof window?window:void 0,We=Le||{},Ve=We.MutationObserver||We.WebKitMutationObserver,Be="undefined"==typeof self&&void 0!==s&&"[object process]"==={}.toString.call(s),$e="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Ye=new Array(1e3),Ke=void 0;Ke=Be?function(){return s.nextTick(S)}:Ve?(ke=0,ze=new Ve(S),Xe=document.createTextNode(""),ze.observe(Xe,{characterData:!0}),function(){Xe.data=ke=++ke%2}):$e?function(){var ke=new MessageChannel;return ke.port1.onmessage=S,function(){return ke.port2.postMessage(0)}}():void 0===Le?function(){try{var ke=c(21);return void 0!==(Ae=ke.runOnLoop||ke.runOnContext)?function(){Ae(S)}:P()}catch(ze){return P()}}():P();var qe=Math.random().toString(36).substring(16),Qe=void 0,Ue=1,Gt=2,rr=new ce,Tn=new ce,Nr=0;return se.prototype._enumerate=function(){for(var ke=this.length,ze=this._input,Xe=0;this._state===Qe&&Xe<ke;Xe++)this._eachEntry(ze[Xe],Xe)},se.prototype._eachEntry=function(ke,ze){var Xe=this._instanceConstructor,bt=Xe.resolve;if(bt===g){var Nt=I(ke);if(Nt===f&&ke._state!==Qe)this._settledAt(ke._state,ze,ke._result);else if("function"!=typeof Nt)this._remaining--,this._result[ze]=ke;else if(Xe===ae){var Pt=new Xe(E);U(Pt,ke,Nt),this._willSettleAt(Pt,ze)}else this._willSettleAt(new Xe(function(an){return an(ke)}),ze)}else this._willSettleAt(bt(ke),ze)},se.prototype._settledAt=function(ke,ze,Xe){var bt=this.promise;bt._state===Qe&&(this._remaining--,ke===Gt?j(bt,Xe):this._result[ze]=Xe),0===this._remaining&&M(bt,this._result)},se.prototype._willSettleAt=function(ke,ze){var Xe=this;W(ke,void 0,function(bt){return Xe._settledAt(Ue,ze,bt)},function(bt){return Xe._settledAt(Gt,ze,bt)})},ae.all=function(ke){return new se(this,ke).promise},ae.race=function(ke){var ze=this;return new ze(ge(ke)?function(Xe,bt){for(var Nt=ke.length,Pt=0;Pt<Nt;Pt++)ze.resolve(ke[Pt]).then(Xe,bt)}:function(Xe,bt){return bt(new TypeError("You must pass an array to race."))})},ae.resolve=g,ae.reject=function(ke){var Xe=new this(E);return j(Xe,ke),Xe},ae._setScheduler=function(ke){xe=ke},ae._setAsap=function(ke){Ie=ke},ae._asap=Ie,ae.prototype={constructor:ae,then:f,catch:function(ke){return this.then(null,ke)}},ae.polyfill=function(){var ke=void 0;if(void 0!==_)ke=_;else if("undefined"!=typeof self)ke=self;else try{ke=Function("return this")()}catch(bt){throw new Error("polyfill failed because global object is unavailable in this environment")}var ze=ke.Promise;if(ze){var Xe=null;try{Xe=Object.prototype.toString.call(ze.resolve())}catch(bt){}if("[object Promise]"===Xe&&!ze.cast)return}ke.Promise=ae},ae.Promise=ae,ae}()}).call(u,c(12),c(4))},function(Q,u){function c(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function _(I){if(P===setTimeout)return setTimeout(I,0);if((P===c||!P)&&setTimeout)return P=setTimeout,setTimeout(I,0);try{return P(I,0)}catch(x){try{return P.call(null,I,0)}catch(N){return P.call(this,I,0)}}}function p(){b&&g&&(b=!1,g.length?E=g.concat(E):m=-1,E.length&&T())}function T(){if(!b){var I=_(p);b=!0;for(var x=E.length;x;){for(g=E,E=[];++m<x;)g&&g[m].run();m=-1,x=E.length}g=null,b=!1,function(I){if(S===clearTimeout)return clearTimeout(I);if((S===s||!S)&&clearTimeout)return S=clearTimeout,clearTimeout(I);try{S(I)}catch(x){try{return S.call(null,I)}catch(N){return S.call(this,I)}}}(I)}}function l(I,x){this.fun=I,this.array=x}function C(){}var P,S,f=Q.exports={};!function(){try{P="function"==typeof setTimeout?setTimeout:c}catch(I){P=c}try{S="function"==typeof clearTimeout?clearTimeout:s}catch(I){S=s}}();var g,E=[],b=!1,m=-1;f.nextTick=function(I){var x=new Array(arguments.length-1);if(arguments.length>1)for(var N=1;N<arguments.length;N++)x[N-1]=arguments[N];E.push(new l(I,x)),1!==E.length||b||_(T)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=C,f.addListener=C,f.once=C,f.off=C,f.removeListener=C,f.removeAllListeners=C,f.emit=C,f.prependListener=C,f.prependOnceListener=C,f.listeners=function(I){return[]},f.binding=function(I){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(I){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(Q,u){Q.exports=function(c){return c.webpackPolyfill||(c.deprecate=function(){},c.paths=[],c.children||(c.children=[]),Object.defineProperty(c,"loaded",{enumerable:!0,get:function(){return c.l}}),Object.defineProperty(c,"id",{enumerable:!0,get:function(){return c.i}}),c.webpackPolyfill=1),c}},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var T,g,s=c(3),_=c(1),d=c(0);u.ResponseData=function(E){this.id=E,this.status=200,this.headers={},this.body=""},(g=T=u.ClientEventName||(u.ClientEventName={})).Connected="trouter_js_client_connected",g.Disconnected="trouter_js_client_disconnected",g.Error="trouter_js_client_error",g.Progress="trouter_js_client_progress",g.Response="trouter_js_client_response",g.Request="trouter_js_client_request",g.CheckConnection="trouter_js_client_check_connection",g.Registration="trouter_js_client_registration",g.Unregistration="trouter_js_client_unregistration";var l=function(E,b,m,I,x){this.stepName=E,this.operation=b,this.delta=m,this.ts=I,this.error=x};u.TrackerStep=l,u.Properties=function(){};var P=function(){this.numberOfPingReplies=0,this.connectedTimestamp=0,this.isNewUrl=!1,this.transportType="",this.connectionNumber=0},S=function(){this.enabled=!1,this.numberOfStepsToMaintain=40,this.logHealthCheckError=!1,this.sendProgressTimeoutSecs=55,this.logSendPingError=!1,this.maxBackoffInMs=12e4,this.trouter_js_client_connected=!1,this.trouter_js_client_disconnected=!1,this.trouter_js_client_error=!1,this.trouter_js_client_progress=!1,this.trouter_js_client_response=!1,this.trouter_js_client_request=!1,this.trouter_js_client_registration=!1,this.trouter_js_client_unregistration=!1,this.trouter_js_client_check_connection=!0},f=function(){function g(E,b,m,I,x,N,F){this.clientId=b,this.clientInfo=m,this.getServerState=I,this.endpointId=x,this.clientCorrelationID=N,this.environment=F,this.logger=new d.Logger("ConnectionTracker",E),this.clientCorrelationID=void 0!==N?N:"",this.steps=[],this.connectionAttempt=0,this.totalStepCount=0,this.beginTimestamp=new s.Timespan,this.eventLogSettings=new S,this.connectedInfo=new P}return g.prototype.enable=function(E){this.eventLogSettings.enabled=!0,this.eventLogger=E},g.prototype.disable=function(){this.eventLogSettings.enabled=!1},g.prototype.sendProgress=function(E){this.steps.length>0&&this.sendTelemetry(T.Progress,E,this.steps)},g.prototype.cancelProgressTimer=function(){void 0!==this.progressTimeout&&(clearTimeout(this.progressTimeout),this.progressTimeout=void 0)},g.prototype.resetProgressSendTimer=function(){var E=this;this.cancelProgressTimer(),void 0!==this.eventLogSettings.sendProgressTimeoutSecs&&this.eventLogSettings.sendProgressTimeoutSecs>0&&(this.progressTimeout=setTimeout(function(){E.sendProgress({reason:"timeout",timeoutSecs:E.eventLogSettings.sendProgressTimeoutSecs})},1e3*this.eventLogSettings.sendProgressTimeoutSecs))},g.prototype.setConnectedInfo=function(E,b){this.connectedInfo.numberOfPingReplies=0,this.connectedInfo.connectedTimestamp=Date.now(),this.connectedInfo.isNewUrl=E,this.connectedInfo.transportType=b,++this.connectedInfo.connectionNumber},g.prototype.clearConnectedInfo=function(){this.connectedInfo.numberOfPingReplies=0,this.connectedInfo.connectedTimestamp=0,this.connectedInfo.isNewUrl=!0,this.connectedInfo.transportType=""},g.prototype.copyProperties=function(E,b){for(var m=0,I=Object.keys(b);m<I.length;m++){var x=I[m];b.hasOwnProperty(x)&&void 0!==b[x]&&(E[x.replace(/-/g,"_")]={value:b[x]})}},g.prototype.increasePingResponseCount=function(){++this.connectedInfo.numberOfPingReplies},g.prototype.sendTelemetry=function(E,b,m){try{if(!0===this.eventLogSettings.enabled&&!0===this.eventLogSettings[E]&&void 0!==this.eventLogger){var I=this.getServerState(),x={name:E,properties:{connectionAttempt:{value:this.connectionAttempt},epid:{value:this.endpointId},clientCorrelationID:{value:this.clientCorrelationID},steps:{value:s.toJson(m)},clientID:{value:this.clientId},eventVersion:{value:3},environment:{value:this.environment},cv:{value:_.CLIENT_VERSION},ua:{value:this.clientInfo.ua},connectionId:{value:I.connectionId},connectedClientId:{value:I.connectedClientId},domId:{value:I.domId},url:{value:I.unsecureUrl},surl:{value:I.url},ttlInSecs:{value:I.getRemainingTtlInSec()},numberOfPingReplies:{value:this.connectedInfo.numberOfPingReplies},connectedTimestamp:{value:this.connectedInfo.connectedTimestamp},isNewUrl:{value:this.connectedInfo.isNewUrl},transportType:{value:this.connectedInfo.transportType},connectionNumber:{value:this.connectedInfo.connectionNumber}}};this.copyProperties(x.properties,b),this.eventLogger.logEvent(x)}}catch(N){this.logger.warn("error in sending event "+E+": "+s.toJson(N))}},g.prototype.createStep=function(E,b,m){return new l(E,b,this.beginTimestamp.duration,Date.now(),m)},g.prototype.addStep=function(E,b,m){if(!1!==this.eventLogSettings.enabled&&(0===this.steps.length&&this.beginTimestamp.reset(),this.steps.push(this.createStep(E,b,m)),++this.totalStepCount,void 0!==this.eventLogSettings.numberOfStepsToMaintain&&this.steps.length>this.eventLogSettings.numberOfStepsToMaintain)){var I=this.steps.slice(0);this.steps.length=0,this.sendTelemetry(T.Progress,{reason:"flush"},I)}},g.prototype.trackStart=function(E){this.addStep(E,"start")},g.prototype.trackEnd=function(E){this.addStep(E,"end")},g.prototype.trackError=function(E,b,m,I){void 0===m&&(m=!0),"health"===E&&!0!==this.eventLogSettings.logHealthCheckError||"ping"===E&&!1===this.eventLogSettings.logSendPingError||(void 0===I&&(I="error"),!0===m&&this.addStep(E,I,b),this.sendTelemetry(T.Error,{},[this.createStep(E,I,b)]))},g.prototype.trackProgress=function(E,b){this.addStep(E,b)},g.prototype.trackConnected=function(E,b){this.setConnectedInfo(E,b);var m=this.steps.slice(0),I=this.totalStepCount,x=this.beginTimestamp.duration;this.steps.length=0,this.totalStepCount=0,this.sendTelemetry(T.Connected,{stepCount:m.length,totalStepCount:I,connectionEstablishmentMs_Total:x},m),this.cancelProgressTimer()},g.prototype.trackDisconnected=function(E){E.sessionLengthMS=Date.now()-this.connectedInfo.connectedTimestamp,this.sendTelemetry(T.Disconnected,E,[]),this.resetProgressSendTimer()},g.prototype.trackNewConnection=function(){++this.connectionAttempt},g.prototype.trackRequest=function(E,b){var m={};void 0!==b&&(m.hasError=!0,m.error=b);try{if(E){m.requestID=E.id,m.httpMethod=E.method,m.url=E.url,m.bodyLength=E.body.length,m.shortUrl=E.shortUrl,m.requestTimeStamp=E.startTS,m.correlationVector=E.correlationVector;for(var I=E.headers,x=0,N=Object.keys(I);x<N.length;x++){var F=N[x];I.hasOwnProperty(F)&&(m[F]=I[F])}}}catch(U){m.hasError=!0,m.error=m.error+" error creating request context "+s.toJson(U)}this.sendTelemetry(T.Request,m,[])},g.prototype.trackResponse=function(E,b,m,I){var x={};void 0!==I&&(x.hasError=!0,x.error=I);try{if(x.responseTimestamp=void 0!==m?m.sentTS:Date.now(),E){x.requestID=E.id,x.httpMethod=E.method,x.shortUrl=E.shortUrl,x.correlationVector=E.correlationVector;for(var N=E.headers,F=0,U=Object.keys(N);F<U.length;F++){var k=U[F];N.hasOwnProperty(k)&&(x[k]=N[k])}}m&&(x.latencyMS=b,x.responseCode=m.status,x.responseLength=m.body.length)}catch(D){x.hasError=!0,x.error=x.error+" error creating response context "+s.toJson(D)}this.sendTelemetry(T.Response,x,[])},g.prototype.sendResponseError=function(E,b,m){this.trackResponse(b,void 0,m,E)},g.prototype.close=function(){this.sendProgress({reason:"closed"}),this.steps.length=0,this.cancelProgressTimer()},g.prototype.mergeSettings=function(E){if(E){this.eventLogSettings.numberOfStepsToMaintain=Math.min(40,Math.max(10,void 0!==E.numberOfStepsToMaintain?E.numberOfStepsToMaintain:0));var b=Math.min(3600,Math.max(55,void 0!==E.sendProgressTimeoutSecs?E.sendProgressTimeoutSecs:0));this.eventLogSettings.logHealthCheckError=E.logHealthCheckError,this.eventLogSettings.logSendPingError=E.logSendPingError;for(var m=0,I=Object.keys(T).map(function(N){return T[N]});m<I.length;m++){var x=I[m];E.hasOwnProperty(x)&&void 0!==E[x]&&(this.eventLogSettings[x]=E[x])}this.eventLogSettings.sendProgressTimeoutSecs!==b&&(this.eventLogSettings.sendProgressTimeoutSecs=b,this.resetProgressSendTimer())}},g}();u.ConnectionTracker=f},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var s=function(){function _(d,p){this.logger=d,this.maxBackoffInMs=p,this.backoffId=0,this.backoffCount=0}return _.calculateNextBackoffMs=function(d,p){var T=1+.4*(Math.random()-.5),l=1e3*Math.pow(2,d)*T;return l=Math.round(l),Math.min(p,l)},_.prototype.setMaxBackoffMs=function(d){this.maxBackoffInMs=d},_.prototype.backoff=function(d,p){var T=this;void 0!==this.timerHandle&&(this.logger.debug("Clearing current back off"),clearTimeout(this.timerHandle),this.timerHandle=void 0);var l=_.calculateNextBackoffMs(this.backoffCount,this.maxBackoffInMs);this.backoffId++,this.backoffCount++,this.logger.info("Backing off "+d+" for "+l+" milliseconds with ID "+this.backoffId),this.timerHandle=setTimeout(function(){T.logger.info("Back off for "+d+" with ID "+T.backoffId+" complete, invoking handler"),T.timerHandle=void 0,p()},l)},_.prototype.reset=function(){void 0!==this.timerHandle&&(this.logger.debug("Resetting back off"),clearTimeout(this.timerHandle),this.timerHandle=void 0),this.backoffCount=0},_}();u.ExponentialBackoff=s},function(Q,u,c){var s=this&&this.__assign||Object.assign||function(k){for(var D,M=1,j=arguments.length;M<j;M++)for(var W in D=arguments[M])Object.prototype.hasOwnProperty.call(D,W)&&(k[W]=D[W]);return k};Object.defineProperty(u,"__esModule",{value:!0});var _=c(20),d=c(11),p=c(3),T=c(14),l=c(1),C=c(15),P=c(2),S=c(5),f=c(0),g=c(17),E=c(10),b=function(){this.cv=l.CLIENT_VERSION,this.ua="",this.hr="",this.v=""},m=function(){this["force new connection"]=!0,this.reconnect=!1,this.query="",this.ackTimeoutMs=5e3},I="MS-CV",x=function(){function k(D){this.cvCounter=0;var M=JSON.parse(D);this.startTS=M.hasOwnProperty("startTS")?M.startTS:0,this.url=M.hasOwnProperty("url")?M.url:"",this.shortUrl=M.hasOwnProperty("shortUrl")?M.shortUrl:"",this.body=M.hasOwnProperty("body")?M.body:"",this.headers=M.hasOwnProperty("headers")?M.headers:{},this.id=M.hasOwnProperty("id")&&"number"==typeof M.id?M.id:-1,this.method=M.hasOwnProperty("method")?M.method:"",this.replied=!1,this.timedout=!1,this.timeoutTimerId=0,this.receivedCv=this.headers[I],this.updateCvHeader()}return Object.defineProperty(k.prototype,"correlationVector",{get:function(){return this.receivedCv?this.receivedCv+"."+this.cvCounter:""},enumerable:!0,configurable:!0}),k.prototype.on=function(D,M){"data"===D?this.dataCallback=M:"end"===D&&("function"==typeof this.dataCallback&&this.dataCallback(this.body),M())},k.prototype.incrementCorrelationVector=function(){++this.cvCounter,this.updateCvHeader()},k.prototype.updateCvHeader=function(){var D=this.correlationVector;D&&(this.headers[I]=D)},k}(),N=function(){function k(D,M,j){this.request=D,this.responseData=M,this.sendResponse=j}return k.prototype.writeHead=function(D,M){this.responseData.status=D,this.responseData.headers=M},k.prototype.write=function(D){this.responseData.body+=D},k.prototype.end=function(D){return D&&(this.responseData.body+=D),this.sendResponse(this.request,this.responseData)},k}(),F=function(D){this.name=D,this.args={},this.timeoutTimerId=0},U=function(){function k(D,M,j,W,$){var ce=this;this.options=M,this.manager=j,this.tokenProvider=W,this.connectionId="",this.inIncallMode=!1,this.connectionAttempt=0,this.connectedClientId="",this.c2cUrlBase="",this.pendingTimers={},this.lastDisconnectReason="",this.UNKNOWN_TRANSPORT="unknown_transport",this.logger=new f.Logger("Connection",D),this.timeoutOptions=this.options.timeoutOptions,this.healthBackoff=new C.ExponentialBackoff(this.logger,this.timeoutOptions.maxBackoffMs),this.tokenBackoff=new C.ExponentialBackoff(this.logger,this.timeoutOptions.maxBackoffMs),this.clientID=Date.now(),"undefined"!=typeof window&&window.location&&(this.domId=window.location.hostname),this.clientInfo=new b,this.clientInfo.cv=l.CLIENT_VERSION,this.clientInfo.ua="",this.options&&this.options.clientInfo&&(this.clientInfo.ua=this.safeString(this.options.clientInfo.ua),this.clientInfo.v=this.safeString(this.options.clientInfo.v)),this.connectionTracker=new T.ConnectionTracker(D,this.clientID,this.clientInfo,function(){return ce.getServerState()},this.options.endpointId,this.options.clientCorrelationID,this.options.environment),this.applyConnectionTrackerOptions(M),this.fsm=new g.TrouterFsm(D,this,this.options.incallModeTimeoutMs>0),M.registration&&(this.registrarClient=_.createRegistrarClient(D,this.tokenProvider,{registrarUrl:M.registration.registrarUrl,registrationId:M.registration.registrationId,requestTimeoutMs:M.timeoutOptions.fetchTimeoutMs,initialRetryDelayMs:1e3,maxRetryDelayMs:M.timeoutOptions.maxBackoffMs})),this.userActivityState=$}return k.prototype.start=function(D){this.logger.info("Starting"),this.externalConnectParams=D,this.fsm.start()},k.prototype.stop=function(D){this.logger.info("Stopping"),this.connectionTracker.close(),this.fsm.stop(D)},k.prototype.configure=function(D){var M=this.options.trouterUrl!==D.trouterUrl;this.options=D,this.applyConnectionTrackerOptions(D),M&&this.onTrouterReconnect()},k.prototype.checkConnection=function(D){this.logger.info("checkConnection called with "+D),this.fsm.checkConnection(D),D&&this.connectionTracker.sendTelemetry(T.ClientEventName.CheckConnection,{disconnectDetected:D},[])},k.prototype.getServerState=function(){return new S.ServerState(this.connectionId,this.connectedClientId,this.domId?this.domId:"",this.allocateResult?this.allocateResult.url:"",this.allocateResult?this.allocateResult.surl:"",this.c2cUrlBase,this.connectionExpireTimestampInSecs)},k.prototype.getToken=function(D,M){var j=this;this.logger.info("Getting token "+(M?"with backoff":"without backoff"));var W=function(){j.connectionTracker.trackStart("token"),j.tokenProvider(!D).then(function($){j.logger.debug("token is received"),j.connectionTracker.trackEnd("token"),j.fsm.onTokenReceived($)}).catch(function($){var ce=p.toJson($.stack);j.logger.error("Getting token failed, will retry after timeout. Error: "+ce),j.connectionTracker.trackError("token",ce),j.getToken(D,!0)})};M?this.tokenBackoff.backoff("getting token",W):(this.tokenBackoff.reset(),W())},k.prototype.startConnectionTimer=function(){var D=this;this.stopConnectionTimer(),this.logger.debug("Starting connection timeout for "+this.timeoutOptions.connectionTimeoutMs+" ms"),this.connectionTimeoutId=setTimeout(function(){D.logger.info("Connection timeout is fired"),D.fsm.onConnectingTimeout()},this.timeoutOptions.connectionTimeoutMs)},k.prototype.stopConnectionTimer=function(){this.connectionTimeoutId&&(this.logger.debug("Stopping connection timeout"),clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0)},k.prototype.startPingTimer=function(){var D=this;"websocket"===this.transportTypeName?(this.logger.debug("Starting ping timeout for "+this.timeoutOptions.pingTimeoutMs+" ms"),this.pingTimerId=setInterval(function(){D.logger.info("Ping interval fired"),D.fsm.onPingInterval()},this.timeoutOptions.pingTimeoutMs)):this.logger.debug("Not starting ping for transport "+this.transportTypeName)},k.prototype.stopPingTimer=function(){this.pingTimerId&&(this.logger.debug("Stopping ping timeout"),this.clearPingResponseTimer(),clearInterval(this.pingTimerId),this.pingTimerId=void 0)},k.prototype.shouldSkipRegistration=function(){return void 0===this.options.registration},k.prototype.hasCustomRegisterTtl=function(){return this.options.registration&&this.options.registration.registrarTtlSec},k.prototype.startRegisterTimer=function(){var D=this;void 0!==this.registrationTimerId&&this.stopRegisterTimer();var M=this.getRegistrationTtl()-30;this.logger.debug("Starting registration timeout for "+M+" sec"),this.registrationTimerId=setTimeout(function(){D.logger.info("Registration timeout is fired"),D.registrationTimerId=setTimeout(function(){D.registrationTimerId=void 0,D.logger.debug("Re-registration did not happen in time"),D.dispatchUnregistered()},3e4),D.fsm.onRegistrationTimeout()},1e3*M)},k.prototype.stopRegisterTimer=function(){this.registrationTimerId&&(this.logger.debug("Stopping registration timeout"),clearTimeout(this.registrationTimerId),this.registrationTimerId=void 0)},k.prototype.resendRegistration=function(){if(!this.registrarClient)throw new Error("Trouter Client not configured to handle registrations");return this.registrarClient.resendRegistration()},k.prototype.buildSocketIoUrlParams=function(){if(!this.allocateResult)throw new Error("Allocate result is undefined in buildSocketIoUrlParams()");var D={};if(this.allocateResult.connectparams)for(var M=this.allocateResult.connectparams,j=0,W=Object.keys(M);j<W.length;j++){var $=W[j];M.hasOwnProperty($)&&void 0!==M[$]&&(D[$]=M[$])}return D.v="v4",D.tc=encodeURI(p.toJson(this.clientInfo)),D.timeout=this.timeoutOptions.pingTimeoutMs/1e3,D.auth="true",this.options.endpointId&&(D.epid=this.options.endpointId),this.userActivityState.state!==P.UserActivityState.Unknown&&(D.userActivity=encodeURI(p.toJson(this.userActivityState.toEventObject()))),this.appendConnectedClientIds(this.buildQuery(D),!0)},k.prototype.startSocketIo=function(){var D=this;if(this.logger.info("Starting socket io"),this.connectionTracker.trackStart("connectSocket"),!this.allocateResult)throw new Error("Allocate result is undefined in startSocketIo()");var M=this.options.ioOptions||new m;if(M["force new connection"]=!0,M.reconnect=!1,M.query=this.buildSocketIoUrlParams(),this.logger.info("connecting to "+this.allocateResult.socketio+"?"+M.query),this.stopSocketIo(),this.socket=(this.options.io||E).connect(this.allocateResult.socketio,M),void 0===this.socket)throw new Error("Can't create Socket.io object");this.socket.on("connecting",function(j){D.onSocketConnecting(j)}),this.socket.on("connect",function(){D.onSocketConnect()}),this.socket.on("connect_failed",function(j){D.onSocketConnectFailed(j)}),this.socket.on("disconnect",function(j){D.onSocketDisconnect(j)}),this.socket.on("reconnect",function(){D.onSocketReconnect()}),this.socket.on("reconnect_failed",function(j){D.onSocketReconnectFailed(j)}),this.socket.on("reconnecting",function(){D.onSocketReconnecting()}),this.socket.on("error",function(j){D.onSocketError(j)}),this.socket.on("message",function(j){D.onSocketMessage(j)}),this.socket.on("trouter.connected",function(j){D.onTrouterConnected(j)}),this.socket.on("trouter.reconnect",function(){D.onTrouterReconnect()}),this.socket.on("trouter.message_loss",function(j){D.onTrouterMessageLoss(j)})},k.prototype.stopSocketIo=function(){if(this.socket){this.logger.info("clearing socket.io");try{for(var D=0,M=["connecting","connect","connect_failed","disconnect","reconnect","reconnect_failed","reconnecting","error","message","trouter.connected","trouter.reconnect","trouter.message_loss"];D<M.length;D++)this.socket.removeAllListeners(M[D]);this.socket.disconnect(),this.logger.debug("cleared socket"),this.socket=void 0}catch(W){this.logger.error("exception in disconnecting previous socket. Error: "+p.toJson(W.stack))}}},k.prototype.dispatchConnected=function(){this.logger.info("dispatching connected"),this.manager.onConnected(this)},k.prototype.dispatchRegistered=function(){this.logger.info("dispatching registered"),this.manager.onRegistered(this)},k.prototype.dispatchUnregistered=function(){this.logger.info("dispatching unregistered"),this.manager.onUnregistered(this)},k.prototype.dispatchDownstreamRequest=function(D){var M=this;this.logger.info("dispatching downstream request");try{var j=new N(D,new T.ResponseData(D.id),function(W,$){return M.logger.info("sending response to downstream"),M.sendResponse(W,$)});this.manager.onDownstreamRequest(this,D,j)}catch(W){this.logger.error("exception in socket.on message. Error : "+p.toJson(W.stack))}},k.prototype.dispatchReconnecting=function(){this.logger.info("dispatching reconnecting"),this.manager.onReconnecting(this)},k.prototype.dispatchReconnectIsRequired=function(){this.logger.info("dispatching reconnect is required by server"),this.manager.onReconnectIsRequired(this)},k.prototype.dispatchDisconnected=function(){this.logger.info("dispatching disconnected"),this.manager.onDisconnected(this)},k.prototype.dispatchTrouterMessageLost=function(D){this.logger.info("dispatching trouter lost message"),this.manager.onTrouterMessageLost(D)},k.prototype.sendProcessedDroppedIndicators=function(D){var M=this;try{this.logger.info("emitting processed flow tags to the server");var j=new F("trouter.processed_message_loss");j.args={droppedIndicators:D},this.sendDownstreamEvent(j,function(){M.logger.info("emitted processed flow tags to the server")})}catch($){var W=p.toJson($.stack);this.logger.error("unable to send processed message loss event. Error: "+W),this.connectionTracker.trackError("trouter.processed_message_loss",W,!1)}},k.prototype.resetAllocationConnectionParams=function(){this.allocateResult&&(this.logger.info("Resetting allocation connection parameters"),this.allocateResult.connectparams=void 0)},k.prototype.sendAllocateRequest=function(D){var M=this;this.connectionAttempt++,this.connectionTracker.trackNewConnection();var j=this.options.trouterUrl,W=j,$=this.allocateResult&&this.allocateResult.connectparams;if(!$){var ce=this.externalConnectParams;ce&&ce.se&&parseInt(ce.se,10)<=Date.now()+36e5&&(this.logger.warn("Dropping expired cached connection parameters: "+new Date(parseInt(ce.se,10))),this.externalConnectParams=ce=void 0),ce&&ce.serviceUrl!==W&&(this.logger.warn("Dropping cached connection parameters for a different environment ("+ce.serviceUrl+", now "+W+")"),this.externalConnectParams=ce=void 0),ce&&ce.reconnectUrl?(W=ce.reconnectUrl,$=s({},ce,{reconnectUrl:void 0})):$=ce}W=this.appendCorrelationIds(W,!1),W=this.appendEndpointId(W,!1),$&&(W+="&"+this.buildQuery($),$.v||(W+="&v=v4"));var oe=new Request(W,{method:"POST",mode:"cors",headers:new Headers({"X-Skypetoken":D,"Content-Type":"text/plain"})});this.logger.info("sendAllocateRequest: POST "+W),this.connectionTracker.trackStart("allocation");var Z=-1;this.fetchWithTimeout(oe,this.timeoutOptions.fetchTimeoutMs).then(function(ue){if(Z=ue.status,!ue.ok)throw new Error(ue.statusText);var he=ue.headers.get("content-type");if(!he||"application/json"!==he&&"application/json;"!==he.substring(0,17))throw new Error("Content-type '"+he+"' is unexpected");return M.connectionTracker.trackEnd("allocation"),ue.json()}).then(function(ue){M.onAllocationResponse(ue,j)}).catch(function(ue){var he=ue+", status code "+Z;M.logger.error("Allocation request failed. Error: "+he),M.connectionTracker.trackError("allocation",he),M.externalConnectParams&&M.connectionAttempt>2&&(Z>=400&&Z<=599?(M.logger.warn(M.connectionAttempt+" connection attempts, server-side failure: erasing external connection parameters"),M.externalConnectParams=void 0):M.externalConnectParams.reconnectUrl&&(M.logger.warn(M.connectionAttempt+" connection attempts, erasing reconnect URL"),delete M.externalConnectParams.reconnectUrl)),M.fsm.onAllocationFailed(401===Z)})},k.prototype.sendPingRequest=function(){var D=this;if(this.socket&&void 0===this.pingResponseTimerId)try{this.logger.info("emitting ping event"),this.socket.emit("ping",function(){D.onPingResponse()}),this.pingResponseTimerId=setTimeout(function(){D.logger.error("Ping response timeout is fired"),D.clearPingResponseTimer(),D.fsm.onPingResponseTimeout()},this.timeoutOptions.pongTimeoutMs)}catch(j){var M=p.toJson(j.stack);this.logger.error("unable to send ping. Error: "+M),this.connectionTracker.trackError("ping",M,!1)}},k.prototype.setUserActivityState=function(D){var M=D.state!==this.userActivityState.state;this.userActivityState=D,this.fsm.onSetUserActivityState(D,M)},k.prototype.sendUserActivityState=function(D,M){this.userActivityState.state!==P.UserActivityState.Unknown&&("websocket"===this.transportTypeName&&M?this.sendUserActivityStateMultiple(D===S.UserActivityEventReason.Connected?2:1):"xhr-polling"===this.transportTypeName&&D===S.UserActivityEventReason.Modified&&this.fsm.forceReconnect())},k.prototype.sendRegisterRequest=function(){var D=this;if(!this.options.registration||!this.registrarClient)throw new Error("Internal error - options.registration is undefined");if(!this.allocateResult)throw new Error("Allocate result is undefined in sendRegisterRequest()");this.logger.info("sending register request");var M=new p.Timespan;this.connectionTracker.trackStart("registration"),this.registrarClient.register({appId:this.options.registration.pnhAppId,aesKey:"",languageId:"en-US",platform:this.options.registration.platform,templateKey:this.options.registration.pnhTemplateKey,platformUIVersion:this.options.registration.platformUIVersion,productContext:this.options.registration.productContext},{TROUTER:[{context:this.options.registration.context,path:this.allocateResult.surl,ttl:this.getRegistrationTtl()}]}).then(function(){D.logger.info("Register request successful"),D.connectionTracker.trackEnd("registration"),D.fsm.onRegistrationSucceed(),D.connectionTracker.sendTelemetry(T.ClientEventName.Registration,{duration:M.duration},[])}).catch(function(j){D.logger.error("Register request failed. Error: "+j),D.connectionTracker.trackError("registration",j.message),D.fsm.onRegistrationFailed(!1),D.connectionTracker.sendTelemetry(T.ClientEventName.Registration,{duration:M.duration},[])})},k.prototype.sendUnregisterRequest=function(){var D=this;this.logger.info("sending unregister request");var M=new p.Timespan;if(!this.options.registration||!this.registrarClient)throw new Error("Internal error - options.registration is undefined");this.connectionTracker.trackStart("unregistration"),this.registrarClient.unregister().then(function(){D.logger.info("Unregister request successful"),D.connectionTracker.trackEnd("unregistration"),D.fsm.onUnregistrationSucceed(),D.connectionTracker.sendTelemetry(T.ClientEventName.Unregistration,{duration:M.duration},[])}).catch(function(j){D.logger.error("Unregister request failed. Error: "+j),D.connectionTracker.trackError("unregistration",j.message),D.fsm.onUnregistrationFailed(!1),D.connectionTracker.sendTelemetry(T.ClientEventName.Unregistration,{duration:M.duration},[])})},k.prototype.fetchWithTimeout=function(D,M){return new d.Promise(function(j,W){fetch(D).then(j).catch(W),0!==M&&setTimeout(W,M,new Error("Fetch for '"+D.url+"' timed out"))})},k.prototype.resetTokenBackoff=function(){this.tokenBackoff.reset()},k.prototype.resetRegisterBackoff=function(){this.registrarClient&&this.registrarClient.cancelPendingRequests()},k.prototype.clearTimers=function(){this.logger.debug("Clearing all pending downstream events related timers");for(var D=0,M=Object.keys(this.pendingTimers);D<M.length;D++)this.clearTimer(Number(M[D]))},k.prototype.restartIncallModeTimer=function(){var D=this;this.clearIncallModeTimerId(),this.logger.debug("Restarting incall mode timer"),this.incallModeTimerId=setTimeout(function(){D.logger.info("Call mode timer fired"),D.fsm.onIncallModeTimer()},this.options.incallModeTimeoutMs)},k.prototype.enterIncallMode=function(){this.logger.info("Entering incall mode"),this.timeoutOptions=this.options.incallTimeoutOptions,this.healthBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.tokenBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.inIncallMode=!0},k.prototype.exitIncallMode=function(){this.logger.info("Exiting incall mode"),this.clearIncallModeTimerId(),this.timeoutOptions=this.options.timeoutOptions,this.healthBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.tokenBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.inIncallMode=!1},k.prototype.isIncallMode=function(){return this.inIncallMode},k.prototype.onSocketConnecting=function(D){this.logger.info("onSocketConnecting("+D+")"),this.transportTypeName=D,this.connectionTracker.trackProgress("connecting",this.transportTypeName),this.fsm.onConnecting()},k.prototype.onSocketConnect=function(){this.logger.info("onSocketConnect")},k.prototype.onSocketConnectFailed=function(D){this.logger.error("onSocketConnectFailed"),this.connectionTracker.trackError("connect_failed",D,!0,this.transportTypeName?this.transportTypeName:this.UNKNOWN_TRANSPORT),this.fsm.onConnectingFailed()},k.prototype.onSocketDisconnect=function(D){this.logger.error("onSocketDisconnect, reason: "+D);var M={reason:D,serverClosed:!this.fsm.isActive()};this.connectionTracker.trackDisconnected(M),this.connectionTracker.clearConnectedInfo();var j=M.sessionLengthMS||0;"dup"===D&&"dup"===this.lastDisconnectReason&&j<this.options.duplicateDisconnectThresholdMs&&(this.logger.warn("Socket was closed by server as Duplicate for the second time in a row after "+j+" ms which is below the threshold of "+this.options.duplicateDisconnectThresholdMs+" ms. Resetting cached connection parameters and making a new allocation."),this.resetAllocationConnectionParams()),this.lastDisconnectReason=D,this.fsm.onSocketError(void 0),this.connectionExpireTimestampInSecs=void 0},k.prototype.onSocketReconnect=function(){this.logger.error("onSocketReconnect"),this.fsm.onTrouterConnected()},k.prototype.onSocketReconnectFailed=function(D){this.logger.error("onSocketReconnectFailed with '"+D+"'"),this.fsm.onSocketError("string"==typeof D?D:void 0)},k.prototype.onSocketReconnecting=function(){this.logger.error("onSocketReconnecting")},k.prototype.onSocketError=function(D){this.logger.error("onSocketError with '"+p.toJson(D)+"'"),this.connectionTracker.trackError("connectSocket",D),this.fsm.onSocketError("string"==typeof D?D:void 0)},k.prototype.onSocketMessage=function(D){var j,M=this;this.logger.info("onSocketMessage");try{var W=(j=new x(D)).headers&&j.headers["X-Microsoft-Skype-Chain-ID"];this.logger.info("Received request N "+j.id+(W?" Chain-Id "+W:"")+" CV "+j.correlationVector+" to '"+j.url+"'"),j.startTS=Date.now(),j.url&&this.urlPath&&0===j.url.indexOf(this.urlPath)&&(j.shortUrl=j.url.substring(this.urlPath.length))}catch(oe){var ce=p.toJson(oe.stack);return this.logger.error("unable to parse request. Error: "+ce),this.connectionTracker.trackRequest(void 0,ce),void this.connectionTracker.sendResponseError("unable to parse request, error: "+oe)}j.timeoutTimerId=setTimeout(function(){if(!j.replied){M.logger.error("Request "+j.id+" timed out");var oe=new T.ResponseData(j.id);oe.status=504,oe.headers={"Trouter-Responder":"ClientLib"},M.sendResponse(j,oe),j.timedout=!0}},this.timeoutOptions.requestTimeoutMs);try{this.connectionTracker.trackRequest(j),this.fsm.onDownstreamRequest(j)}catch(oe){this.logger.error("exception in socket.on message. Error: "+p.toJson(oe.stack)),this.connectionTracker.sendResponseError(oe.message,j,void 0)}},k.prototype.onTrouterConnected=function(D){if(this.allocateResult){this.logger.info("onTrouterConnected: "+this.allocateResult.url),this.socket&&this.socket.socket&&this.socket.socket.options&&this.socket.socket.options.query&&(this.socket.socket.options.query+="&connected=true"),this.urlPath=this.allocateResult.url.replace(/https?:\/\/([A-z0-9\:\$\-\_\.\+\!\*\"\(\)\,]*)\//,"/");var M=this.connectedUrl!==this.allocateResult.url;this.connectedUrl=this.allocateResult.url,this.connectionExpireTimestampInSecs=p.calculateExpireTsInSec(D.ttl),this.connectionTracker.trackEnd("connectSocket"),this.connectionTracker.trackConnected(M,this.transportTypeName?this.transportTypeName:this.UNKNOWN_TRANSPORT),this.fsm.onTrouterConnected()}else this.logger.error("Invalid internal state - received onTrouterConnected while allocateResult is not set")},k.prototype.onTrouterReconnect=function(){this.logger.info("onTrouterReconnect"),this.fsm.onReconnectRequired()},k.prototype.onTrouterMessageLoss=function(D){this.logger.info("onTrouterMessageLoss"),this.fsm.onTrouterMessageLost(D.droppedIndicators)},k.prototype.onAllocationResponse=function(D,M){if(this.logger.info("Received allocation response "+JSON.stringify(D)),this.allocateResult=D,this.externalConnectParams=void 0,this.connectionExpireTimestampInSecs=p.calculateExpireTsInSec(+D.ttl),this.connectionId=this.allocateResult.id||"",this.connectedClientId=this.allocateResult.ccid,this.logger.info("connected client id set {connectedClientId:"+this.connectedClientId+"}"),this.c2cUrlBase=D.curlb||"",""===this.c2cUrlBase){var W=D.surl.indexOf("://");W>=0&&(W=D.surl.indexOf("/",W+3))>=5&&":3443"===D.surl.substr(W-5,5)&&(this.c2cUrlBase=D.surl.substr(0,W-5))}var $=s({serviceUrl:M,reconnectUrl:D.socketio+"v4/a"},D.connectparams);this.manager.onConnectionParametersUpdated($),this.fsm.onAllocationSucceed()},k.prototype.onPingResponse=function(){this.logger.info("onPingResponse"),this.connectionTracker.increasePingResponseCount(),this.clearPingResponseTimer(),this.fsm.onPingResponse()},k.prototype.clearPingResponseTimer=function(){void 0!==this.pingResponseTimerId&&(clearTimeout(this.pingResponseTimerId),this.pingResponseTimerId=void 0)},k.prototype.buildQuery=function(D){for(var M=[],j=0,W=Object.keys(D);j<W.length;j++){var $=W[j];D.hasOwnProperty($)&&void 0!==D[$]&&M.push($+"="+D[$])}return M.join("&")},k.prototype.appendConnectedClientIds=function(D,M){var j="";D.indexOf("ccid=")<0&&(j="ccid="+this.connectedClientId+"&"),this.domId&&(j+="dom="+this.domId+"&"),j.length>0&&(j=j.slice(0,-1));var W=M||-1!==D.indexOf("?")?"&":"?";return this.appendCorrelationIds(D+W+j,M)},k.prototype.appendEndpointId=function(D,M){var j=M||-1!==D.indexOf("?")?"&":"?";return D.indexOf("epid")<0&&this.options.endpointId?""+D+j+"epid="+this.options.endpointId:D},k.prototype.appendCorrelationIds=function(D,M){var j=M||-1!==D.indexOf("?")?"&":"?";return D.indexOf("cor_id")<0?""+D+j+"cor_id="+this.options.clientCorrelationID+"&con_num="+this.clientID+"_"+this.connectionAttempt:D},k.prototype.getHealthUrl=function(D){return D.substring(0,D.lastIndexOf("/a"))+"/h"},k.prototype.safeString=function(D){return"string"==typeof D?D:""},k.prototype.sendResponse=function(D,M){if(D.timedout)return this.logger.error("Request "+D.id+" already timed out"),1;if(D.replied)return this.logger.error("Response for request "+D.id+" already sent"),2;clearTimeout(D.timeoutTimerId),D.timeoutTimerId=0,D.replied=!0,M.headers=M.headers||{};var j=D.correlationVector;this.logger.info("Sending response for request N "+D.id+" CV "+j+" with status "+M.status),j&&(M.headers[I]=j),D.headers&&D.headers["trouter-request"]&&!M.headers["trouter-request"]&&(M.headers["trouter-request"]=D.headers["trouter-request"]);var W=Date.now()-D.startTS;if(M.headers["trouter-client"]=p.toJson({cd:W}),this.logger.debug("response: "+p.toJson(M)),!this.socket)return this.connectionTracker.sendResponseError("no socket",D,M),4;try{return this.socket.send(p.toJson(M)),M.sentTS=Date.now(),D.incrementCorrelationVector(),this.connectionTracker.trackResponse(D,W,M),"websocket"===this.transportTypeName&&this.sendPingRequest(),0}catch(ce){var $="unable to send data on response.end. Error: "+p.toJson(ce.stack);return this.logger.error($),this.connectionTracker.sendResponseError($,D,M),4}},k.prototype.sendUserActivityStateMultiple=function(D){var M=this,j=new F("user.activity"),W=this.userActivityState.toEventObject();j.args=W,this.userActivityState.correlationVector.increase(),this.logger.debug("Sending user activity '"+this.userActivityState.toEventJSON()+"', remaining "+(D-1)),this.sendDownstreamEvent(j,function(){if(M.logger.info("User activity state: "+W.state+", cv: "+W.cv+" accepted"),M.manager.onUserActivityStateAccepted&&M.manager.onUserActivityStateAccepted(W.cv),M.clearTimer(j.timeoutTimerId),D>1){var $=setTimeout(function(){M.clearTimer($),M.sendUserActivityStateMultiple(D-1)},M.options.userActivitySecondResendDelayMs);M.registerTimer($,"user.activity/resend")}}),j.timeoutTimerId=setTimeout(function(){M.logger.error("Activity state response timeout is fired"),M.fsm.onActivityStateResponseTimeout(),M.clearTimer(j.timeoutTimerId)},this.timeoutOptions.userActivityResponseTimeoutMs),this.registerTimer(j.timeoutTimerId,"user.activity/response")},k.prototype.sendDownstreamEvent=function(D,M){this.logger.info("Sending downstream event "+D.name),this.socket&&this.socket.emit(D.name,D.args,M)},k.prototype.registerTimer=function(D,M){this.logger.debug("registering timer "+D+" -> "+M),this.pendingTimers[D]=M},k.prototype.clearTimer=function(D){this.logger.debug("clearing timer "+D+" -> "+this.pendingTimers[D]),delete this.pendingTimers[D],clearTimeout(D)},k.prototype.getRegistrationTtl=function(){var D=p.calculateTtlInSec(this.connectionExpireTimestampInSecs);return this.logger.debug("Current connectionID will expire in "+D+" seconds"),this.options.registration&&this.options.registration.registrarTtlSec&&D>0?Math.min(this.options.registration.registrarTtlSec,D):this.options.registration&&this.options.registration.registrarTtlSec?this.options.registration.registrarTtlSec:D>0?D:3600},k.prototype.clearIncallModeTimerId=function(){void 0!==this.incallModeTimerId&&(this.logger.debug("Clearing in-call mode timer"),clearTimeout(this.incallModeTimerId),this.incallModeTimerId=void 0)},k.prototype.applyConnectionTrackerOptions=function(D){try{D.eventLogger&&"function"==typeof D.eventLogger.logEvent?(this.connectionTracker.mergeSettings(D.telemetrySettings),this.connectionTracker.enable(D.eventLogger)):this.logger.warn("Trouter client event logging disabled due to invalid configuration.")}catch(M){this.logger.warn("Trouter client event logging disabled. Error: "+p.toJson(M.stack)),this.connectionTracker.disable()}},k}();u.TrouterConnection=U},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var s,l,p,_=c(5),d=c(0);(l=s=u.State||(u.State={}))[l.Initial=0]="Initial",l[l.RetrievingToken=1]="RetrievingToken",l[l.Allocating=2]="Allocating",l[l.Handshaking=3]="Handshaking",l[l.Connecting=4]="Connecting",l[l.Connected=5]="Connected",l[l.UnregisteringRetrievingToken=6]="UnregisteringRetrievingToken",l[l.Unregistering=7]="Unregistering",function(l){l[l.Initial=0]="Initial",l[l.RetrievingToken=1]="RetrievingToken",l[l.Registering=2]="Registering",l[l.Registered=3]="Registered",l[l.NotRegistered=4]="NotRegistered"}(p||(p={}));var T=function(){function l(C,P,S){this.worker=P,this.incallModeEnabled=S,this.state=s.Initial,this.connectionErrors=0,this.logger=new d.Logger("ConnectionFsm",C),this.connectedSubstate=p.Initial}return l.prototype.getState=function(){return this.state},l.prototype.isActive=function(){return this.state===s.Allocating||this.state===s.Connected||this.state===s.Handshaking||this.state===s.Connecting||this.state===s.RetrievingToken},l.prototype.start=function(){return this.state===s.Initial?(this.setState(s.RetrievingToken),this.worker.getToken(!0,!1),!0):(this.showIgnored("start"),!1)},l.prototype.stop=function(C){C&&(this.connectedSubstate=p.Initial),this.worker.isIncallMode()&&this.worker.exitIncallMode(),this.worker.resetTokenBackoff(),this.worker.resetRegisterBackoff(),this.worker.stopConnectionTimer(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.state!==s.Connecting&&this.state!==s.Handshaking&&this.state!==s.Connected||this.worker.stopSocketIo(),this.isRegistered()&&this.state!==s.UnregisteringRetrievingToken&&this.state!==s.Unregistering?(this.setState(s.UnregisteringRetrievingToken),this.worker.stopRegisterTimer(),this.worker.getToken(!0,!1)):(this.setState(s.Initial),this.worker.dispatchDisconnected())},l.prototype.onTokenReceived=function(C){this.state===s.RetrievingToken?(this.setState(s.Allocating),this.worker.startConnectionTimer(),this.worker.sendAllocateRequest(C)):this.state===s.Connected&&this.connectedSubstate===p.RetrievingToken?(this.connectedSubstate=p.Registering,this.worker.sendRegisterRequest()):this.state===s.UnregisteringRetrievingToken?(this.setState(s.Unregistering),this.worker.sendUnregisterRequest()):this.showIgnored("onTokenReceived")},l.prototype.checkConnection=function(C){C&&this.onPingInterval()},l.prototype.onAllocationSucceed=function(){return this.state===s.Allocating?(this.setState(s.Handshaking),this.connectedSubstate===p.Registered&&this.worker.dispatchUnregistered(),this.connectedSubstate=p.Initial,this.worker.startSocketIo(),!0):(this.showIgnored("onAllocationSucceed"),!1)},l.prototype.onAllocationFailed=function(C){this.state===s.Allocating?(this.setState(s.RetrievingToken),this.worker.stopConnectionTimer(),this.worker.getToken(!C,!0)):this.showIgnored("onAllocationFailed")},l.prototype.onConnectingTimeout=function(){this.state===s.Allocating||this.state===s.Connecting||this.state===s.Handshaking?(this.setState(s.RetrievingToken),this.resetAllocationIfNecessary(void 0),this.worker.stopSocketIo(),this.worker.getToken(!0,!1)):this.showIgnored("onConnectingTimeout")},l.prototype.onConnecting=function(){this.state===s.Handshaking?this.setState(s.Connecting):this.showIgnored("onConnecting")},l.prototype.onConnectingFailed=function(){this.state===s.Connecting?this.onConnectingTimeout():this.state===s.Handshaking?(this.logger.error("Unexpected error in Socket.io - no valid transports"),this.onConnectingTimeout()):this.showIgnored("onConnectingFailed")},l.prototype.onSocketError=function(C){this.state===s.Handshaking||this.state===s.Connected?(this.worker.stopSocketIo(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopConnectionTimer(),this.state!==s.Connected&&this.worker.resetAllocationConnectionParams(),this.setState(s.RetrievingToken),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)):this.showIgnored("onSocketError")},l.prototype.onTrouterConnected=function(){this.state===s.Connecting?(this.setState(s.Connected),this.worker.resetTokenBackoff(),this.worker.stopConnectionTimer(),this.worker.sendUserActivityState(_.UserActivityEventReason.Connected,!0),this.worker.startPingTimer(),this.worker.dispatchConnected(),this.connectionErrors=0,this.worker.shouldSkipRegistration()?(this.connectedSubstate=p.NotRegistered,this.worker.dispatchRegistered()):(this.connectedSubstate=p.RetrievingToken,this.worker.getToken(!0,!1))):this.showIgnored("onTrouterConnected")},l.prototype.onReconnectRequired=function(){this.worker.dispatchReconnectIsRequired()},l.prototype.onDownstreamRequest=function(C){this.state===s.Connected?(this.switchToIncallModeIfEnabled(),this.worker.dispatchDownstreamRequest(C)):this.showIgnored("onDownstreamRequest")},l.prototype.onTrouterMessageLost=function(C){this.state===s.Connected?this.worker.dispatchTrouterMessageLost(C):this.showIgnored("onTrouterMessageLost")},l.prototype.onPingInterval=function(){this.state===s.Connected?this.worker.sendPingRequest():this.showIgnored("onPingInterval")},l.prototype.onPingResponseTimeout=function(){this.onMissedResponse("onPingResponseTimeout")},l.prototype.onPingResponse=function(){this.state===s.Connected||this.showIgnored("onPingResponse")},l.prototype.onRegistrationFailed=function(C){this.state===s.Connected&&this.connectedSubstate===p.Registering?(this.connectedSubstate=p.RetrievingToken,this.worker.getToken(!C,!0)):this.showIgnored("onRegistrationFailed")},l.prototype.onRegistrationSucceed=function(){this.state===s.Connected?(this.connectedSubstate===p.Registering&&(this.connectedSubstate=p.Registered,this.worker.dispatchRegistered()),this.worker.hasCustomRegisterTtl()&&this.worker.startRegisterTimer()):this.showIgnored("onRegistrationSucceed")},l.prototype.onRegistrationTimeout=function(){this.state===s.Connected&&this.connectedSubstate!==p.NotRegistered?(this.connectedSubstate=p.RetrievingToken,this.worker.getToken(!0,!1)):this.showIgnored("onRegistrationTimeout")},l.prototype.onUnregistrationFailed=function(C){this.state===s.Unregistering?(this.setState(s.UnregisteringRetrievingToken),this.worker.getToken(!C,!C)):this.showIgnored("onUnregistrationFailed")},l.prototype.onUnregistrationSucceed=function(){this.state===s.Unregistering?(this.setState(s.Initial),this.worker.dispatchUnregistered(),this.worker.dispatchDisconnected()):this.showIgnored("onUnregistrationSucceed")},l.prototype.onIncallModeTimer=function(){this.worker.exitIncallMode(),this.state===s.Connected?(this.worker.stopPingTimer(),this.worker.startPingTimer()):this.showIgnored("onIncallModeTimer")},l.prototype.onSetUserActivityState=function(C,P){P?(this.logger.info("Changing user activity state to '"+C.toEventJSON()+"'"),this.worker.sendUserActivityState(_.UserActivityEventReason.Modified,this.state===s.Connected)):this.logger.debug("Not changing the same user activity state '"+C.toEventJSON()+"'")},l.prototype.onActivityStateResponseTimeout=function(){this.onMissedResponse("onActivityStateResponseTimeout")},l.prototype.forceReconnect=function(){this.setState(s.RetrievingToken),this.worker.resetTokenBackoff(),this.worker.stopConnectionTimer(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopSocketIo(),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)},l.prototype.onMissedResponse=function(C){this.state===s.Connected?(this.setState(s.RetrievingToken),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopSocketIo(),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)):this.showIgnored(C)},l.prototype.showIgnored=function(C){this.logger.debug("Ignoring event '"+C+"' in state '"+s[this.state]+"'")},l.prototype.setState=function(C){this.logger.info("Switching from state '"+s[this.state]+"' to state '"+s[C]+"'"),this.state!==C?this.state=C:this.logger.error("Attempt to switching into the current state '"+s[C]+"'")},l.prototype.resetAllocationIfNecessary=function(C){this.connectionErrors++,this.connectionErrors>=2||void 0!==C&&/^4\d\d /.test(C)?(this.logger.error("Connection error count is "+this.connectionErrors+" - will reset allocation"),this.connectionErrors=0):this.logger.info("Connection error count is "+this.connectionErrors+" - will NOT reset allocation")},l.prototype.isRegistered=function(){return this.connectedSubstate===p.Registered||this.connectedSubstate===p.Registering},l.prototype.switchToIncallModeIfEnabled=function(){this.incallModeEnabled&&(this.worker.isIncallMode()||(this.worker.enterIncallMode(),this.worker.stopPingTimer(),this.worker.startPingTimer()),this.worker.restartIncallModeTimer())},l}();u.TrouterFsm=T},function(Q,u,c){Object.defineProperty(u,"__esModule",{value:!0});var s=c(2),_=c(0),d=function(){function p(T,l){this.worker=l,this.state=s.TrouterState.Unknown,this.logger=new _.Logger("ManagerFsm",T)}return p.prototype.start=function(){this.state===s.TrouterState.Unknown?(this.setState(s.TrouterState.Disconnected),this.worker.forceStopLingeringConnection(),this.worker.startFirstConnection()):this.showIgnored("start")},p.prototype.stop=function(T){this.state!==s.TrouterState.Unknown?(this.setState(s.TrouterState.Unknown),this.worker.stopFirstConnection(!0===T),this.worker.stopSecondConnection(!0===T)):this.showIgnored("stop")},p.prototype.getState=function(){return this.state},p.prototype.onConnected=function(T){this.state===s.TrouterState.Disconnected&&T?this.worker.doesSecondConnectionExist()?this.setState(s.TrouterState.Switching):(this.setState(s.TrouterState.Connected),this.worker.dispatchConnected()):this.showIgnored("onConnected("+T+")")},p.prototype.onRegistered=function(T){this.state!==s.TrouterState.Disconnected||T?this.state!==s.TrouterState.Switching||T||(this.setState(s.TrouterState.Connected),this.worker.switchConnections(),this.worker.stopSecondConnectionDelayed(),this.worker.dispatchConnected()):(this.setState(s.TrouterState.Connected),this.worker.switchConnections(),this.worker.stopSecondConnection(!0),this.worker.dispatchConnected()),this.worker.dispatchRegistrationState(!0)},p.prototype.onUnregistered=function(T){T&&this.worker.dispatchRegistrationState(!1)},p.prototype.onReconnecting=function(T){this.state===s.TrouterState.Connected&&T||this.state===s.TrouterState.Switching&&T?(this.setState(s.TrouterState.Disconnected),this.worker.dispatchReconnecting()):this.showIgnored("onReconnecting("+T+")")},p.prototype.onReconnectionRequired=function(T){this.state===s.TrouterState.Connected&&T?(this.setState(s.TrouterState.Switching),this.worker.startSecondConnection()):this.state===s.TrouterState.Disconnected&&T?this.worker.startSecondConnection():this.showIgnored("onReconnectionRequired("+T+")")},p.prototype.onDisconnected=function(T){this.state===s.TrouterState.Unknown&&T?this.worker.dispatchStopped():this.showIgnored("onDisconnected("+T+")")},p.prototype.showIgnored=function(T){this.logger.info("Ignoring event '"+T+"' in state '"+s.TrouterState[this.state]+"'")},p.prototype.setState=function(T){this.logger.info("Switching from state '"+s.TrouterState[this.state]+"' to state '"+s.TrouterState[T]+"'"),this.state!==T?this.state=T:this.logger.error("Attempt to switching into the current state '"+s.TrouterState[T]+"'")},p}();u.TrouterManagerFsm=d},function(Q,u,c){function s(N,F){if(!F)return N;var U=l({},N,{enabled:F.TelemetryEnabled});return void 0!==F.ClientTelemetryEventEnabled&&(U=l({},U,F.ClientTelemetryEventEnabled)),U}function _(N,F){return{clientInfo:{ua:N.trouterSettings.productName,v:N.trouterSettings.version},ioOptions:{ackTimeoutMs:5e3},clientCorrelationID:N.trouterSettings.sessionId,environment:N.trouterSettings.environment,telemetrySettings:s(N.telemetryConfig.settings,F),eventLogger:N.telemetryConfig.eventLogger,endpointId:N.trouterSettings.registrationId,trouterUrl:F&&F.TrouterConnectionUrl||N.trouterSettings.trouterServiceUrl,registration:N.trouterSettings.registrarServiceUrl?{registrarUrl:N.trouterSettings.registrarServiceUrl,registrationId:N.trouterSettings.registrationId||"",pnhAppId:N.trouterSettings.pnhAppId||"",platform:N.trouterSettings.platform||"",pnhTemplateKey:N.trouterSettings.pnhTemplate||"",platformUIVersion:N.trouterSettings.platformUIVersion||"",productContext:N.trouterSettings.pnhProductContext||void 0,context:N.trouterSettings.pnhContext||"",registrarTtlSec:(N.trouterSettings.maxRegistrationTimeInMs||0)/1e3}:void 0,timeoutOptions:l({connectionTimeoutMs:N.trouterSettings.trouterConnectTimeoutInMs||3e4,fetchTimeoutMs:1e4,pingTimeoutMs:4e4,pongTimeoutMs:5e3,maxBackoffMs:3e4,requestTimeoutMs:5e3,userActivityResponseTimeoutMs:1e4},N.trouterSettings.timeoutOptions),incallTimeoutOptions:l({connectionTimeoutMs:1e4,fetchTimeoutMs:5e3,pingTimeoutMs:5e3,pongTimeoutMs:2e3,maxBackoffMs:1e4,requestTimeoutMs:5e3,userActivityResponseTimeoutMs:1e4},N.trouterSettings.incallTimeoutOptions),incallModeTimeoutMs:N.trouterSettings.incallModeTimeoutMs||0,lingeringConnectionDelayMs:6e4,userActivitySecondResendDelayMs:N.trouterSettings.userActivitySecondResendDelayMs||1e4,duplicateDisconnectThresholdMs:1e4,connectionCache:N.connectionCache,registrationStateCallback:N.registrationStateCallbackForAcsDoNotUse}}var l=this&&this.__assign||Object.assign||function(N){for(var F,U=1,k=arguments.length;U<k;U++)for(var D in F=arguments[U])Object.prototype.hasOwnProperty.call(F,D)&&(N[D]=F[D]);return N},C=this&&this.__awaiter||function(N,F,U,k){return new(U||(U=Promise))(function(D,M){function j(ce){try{$(k.next(ce))}catch(oe){M(oe)}}function W(ce){try{$(k.throw(ce))}catch(oe){M(oe)}}function $(ce){ce.done?D(ce.value):new U(function(oe){oe(ce.value)}).then(j,W)}$((k=k.apply(N,F||[])).next())})},P=this&&this.__generator||function(N,F){function U(ce){return function(oe){return function(ce){if(D)throw new TypeError("Generator is already executing.");for(;$;)try{if(D=1,M&&(j=2&ce[0]?M.return:ce[0]?M.throw||((j=M.return)&&j.call(M),0):M.next)&&!(j=j.call(M,ce[1])).done)return j;switch(M=0,j&&(ce=[2&ce[0],j.value]),ce[0]){case 0:case 1:j=ce;break;case 4:return $.label++,{value:ce[1],done:!1};case 5:$.label++,M=ce[1],ce=[0];continue;case 7:ce=$.ops.pop(),$.trys.pop();continue;default:if(!(j=(j=$.trys).length>0&&j[j.length-1])&&(6===ce[0]||2===ce[0])){$=0;continue}if(3===ce[0]&&(!j||ce[1]>j[0]&&ce[1]<j[3])){$.label=ce[1];break}if(6===ce[0]&&$.label<j[1]){$.label=j[1],j=ce;break}if(j&&$.label<j[2]){$.label=j[2],$.ops.push(ce);break}j[2]&&$.ops.pop(),$.trys.pop();continue}ce=F.call(N,$)}catch(oe){ce=[6,oe],M=0}finally{D=j=0}if(5&ce[0])throw ce[1];return{value:ce[0]?ce[1]:void 0,done:!0}}([ce,oe])}}var D,M,j,W,$={label:0,sent:function(){if(1&j[0])throw j[1];return j[1]},trys:[],ops:[]};return W={next:U(0),throw:U(1),return:U(2)},"function"==typeof Symbol&&(W[Symbol.iterator]=function(){return this}),W};Object.defineProperty(u,"__esModule",{value:!0});var S=c(1),f=c(2);u.TrouterState=f.TrouterState,u.UserActivityState=f.UserActivityState;var g=c(0),E=c(6),b=c(7),m=c(8),I=c(9),x=function(){function N(F){this.logProvider=F,this.stateChangedListeners=[],this.logger=new g.Logger("Trouter",F),this.trouterUrlPromise=new I.TrouterUrlPromise(F),this.messageHandlers=new E.MessageHandlerRegistry(F),this.listeners={},this.connectionInfo=null,this.logger.info("Created TrouterService version "+S.CLIENT_VERSION)}return N.prototype.start=function(F){this.logger.info("Start"),F.trouterSettings.disableInternalSkypeTokenCache||(F.skypeTokenProvider=b.addCacheAsBackupTo(F.skypeTokenProvider)),this.trouterCfg=F;var k=_(F,this.ecsCfg);void 0===this.trouterServer&&(this.trouterServer=new m.TrouterManager(this.logProvider,k,F.skypeTokenProvider,this)),this.trouterServer.start()},N.prototype.stop=function(F){this.logger.info("close connection"),this.trouterUrlPromise.rejectUrl(new Error("TrouterService is stopped")),void 0!==this.trouterServer&&this.trouterServer.stop(F)},N.prototype.setEcsConfig=function(F){return C(this,void 0,void 0,function(){var U=this;return P(this,function(k){return[2,new Promise(function(D,M){if(U.ecsCfg=F.TrouterJScriptClient,U.logger.info("Setting ECS configuration to "+JSON.stringify(U.ecsCfg)),void 0!==U.trouterServer&&void 0!==U.trouterCfg){var j=_(U.trouterCfg,U.ecsCfg);U.trouterServer.configure(j)}D()})]})})},N.prototype.checkConnection=function(F){void 0!==this.trouterServer&&this.trouterServer.checkConnection(F||!1)},N.prototype.resendRegistration=function(){return C(this,void 0,void 0,function(){return P(this,function(F){if(!this.trouterServer)throw new Error("resendRegistration called too early");return[2,this.trouterServer.resendRegistration()]})})},N.prototype.registerListener=function(F,U){return""===U||"/"!==U[0]||U.indexOf("?")>=0||U.indexOf("#")>=0?(this.logger.error("Listener path '"+U+"' is not valid"),!1):this.listeners[U]?(this.logger.error("Another listener is already registered for path '"+U+"'"),!1):(this.listeners[U]=F,this.logger.debug("Listener for path '"+U+"' registered"),this.connectionInfo&&F.onTrouterConnected(this.connectionInfo.baseEndpointUrl+U,this.connectionInfo),!0)},N.prototype.unregisterListener=function(F){for(var U=[],k=0,D=Object.keys(this.listeners);k<D.length;k++)this.listeners[M=D[k]]===F&&U.push(M);if(0===U.length)return!1;for(var j=0,W=U;j<W.length;j++){var M;delete this.listeners[M=W[j]]}return this.logger.debug("Listener for path(s) '"+U.join("', '")+"' unregistered"),!0},N.prototype.onTrouterConnected=function(F,U){this.logger.debug("Trouter is now connected");for(var k=0,D=Object.keys(this.listeners);k<D.length;k++){var M=D[k];try{this.listeners[M].onTrouterConnected(U.baseEndpointUrl+M,U)}catch(j){this.logger.error("Listener '"+M+"' threw an exception from onTrouterConnected(): "+j)}}this.connectionInfo=U,this.trouterUrlPromise.resolveUrl(F),this.notifyStateChanged(f.TrouterState.Connected,{url:F,getRemainingTtlInSec:function(){return U.connectionTtlSec}})},N.prototype.onTrouterDisconnected=function(){this.logger.debug("Trouter is now disconnected"),this.connectionInfo=null;for(var F=0,U=Object.keys(this.listeners);F<U.length;F++){var k=U[F],D=this.listeners[k];if(D.onTrouterDisconnected)try{D.onTrouterDisconnected()}catch(M){this.logger.error("Listener '"+k+"' threw an exception from onTrouterDisconnected(): "+M)}}this.notifyStateChanged(f.TrouterState.Disconnected)},N.prototype.onTrouterRequest=function(F,U){for(var k="",D=0,M=Object.keys(this.listeners);D<M.length;D++){var j=M[D];F.path.substring(0,j.length)===j&&j.length>k.length&&(k=j)}if(""===k)this.tryMessageHandlers(F,U)||(U.status=404,U.headers={"Trouter-Responder":"ClientLib"},U.send());else try{this.listeners[k].onTrouterRequest(F,U)}catch(W){this.logger.error("Listener '"+k+"' threw an exception from onTrouterRequest(): "+W),U.status=500,U.headers={"Trouter-Responder":"ClientLib"},U.send()}},N.prototype.onTrouterMessageLoss=function(F){this.logger.info("onTrouterMessageLoss called with value "+F);for(var U=!0,k=0,D=Object.keys(this.listeners);k<D.length;k++){var M=D[k],j=this.listeners[M];if(j.onTrouterMessageLoss)try{void 0===(U=j.onTrouterMessageLoss(F)&&U)&&(this.logger.error("Listener '"+M+"' did not response with boolean value onTrouterMessageLoss()"),U=!1)}catch(W){this.logger.error("Listener '"+M+"' threw an exception from onTrouterMessageLoss(): "+W),U=!1}}return U},N.prototype.onTrouterUserActivityStateAccepted=function(F){this.logger.debug("onTrouterUserActivityStateAccepted cv: "+F);for(var U=0,k=Object.keys(this.listeners);U<k.length;U++){var D=k[U],M=this.listeners[D];if(M.onTrouterUserActivityStateAccepted)try{M.onTrouterUserActivityStateAccepted(F)}catch(j){this.logger.error("Listener '"+D+"' threw an exception from onTrouterUserActivityStateAccepted(): "+j)}}},N.prototype.setUserActivityState=function(F,U){if(F!==f.UserActivityState.Active&&F!==f.UserActivityState.Inactive)throw new Error("setUserActivityState called with unsupported value "+F);if(this.logger.info("setUserActivityState called with value "+f.UserActivityState[F]),!this.trouterServer||this.state()===f.TrouterState.Unknown)throw new Error("setUserActivityState called too early");this.trouterServer.setUserActivityState(F,U)},N.prototype.state=function(){return void 0!==this.trouterServer?this.trouterServer.getState():f.TrouterState.Unknown},N.prototype.getServerState=function(){if(void 0!==this.trouterServer)return this.trouterServer.getServerState()},N.prototype.getTrouterUrlAsync=function(){return void 0!==this.trouterServer?this.trouterUrlPromise.getPromise():Promise.reject(new Error("TrouterService has not been started"))},N.prototype.onStateChanged=function(F){if(this.logger.info("onStateChanged called"),void 0===F)this.stateChangedListeners=this.stateChangedListeners.filter(function(k){return void 0===k.wrappedCallback});else{this.offStateChanged(F);var U=function(k,D){F(k,D?D.url:"")};U.wrappedCallback=F,this.stateChangedListeners.push(U)}},N.prototype.offStateChanged=function(F){this.logger.info("offStateChanged called");var U=this.stateChangedListeners.length;return this.stateChangedListeners=this.stateChangedListeners.filter(function(k){return k.wrappedCallback!==F}),U>this.stateChangedListeners.length},N.prototype.addCallback=function(F){this.logger.info("addListener called"),-1===this.stateChangedListeners.indexOf(F,0)&&void 0!==F&&this.stateChangedListeners.push(F)},N.prototype.removeCallback=function(F){this.logger.info("removeListener called");var U=this.stateChangedListeners.indexOf(F,0);return U>-1&&(this.stateChangedListeners.splice(U,1),!0)},N.prototype.registerMessageHandler=function(F){this.logger.info("registerMessageHandler is called"),this.messageHandlers.register(F)},N.prototype.clearMessageHandlers=function(){this.logger.info("clearMessageHandlers is called"),this.messageHandlers.clear()},N.prototype.notifyStateChanged=function(F,U){var k=this;this.logger.info("notifyStateChanged called, will forward to "+this.stateChangedListeners.length+" listeners"),this.stateChangedListeners.forEach(function(D){try{D(F,U)}catch(M){k.logger.error("Error in callback "+M)}})},N.prototype.tryMessageHandlers=function(F,U){if(!this.messageHandlers.active())return!1;var k,D=null;try{D=(k=JSON.parse(F.body))&&(k.evt||k.eventId)||null}catch(W){}var j=this.messageHandlers.handleMessage({eventId:D,url:(this.connectionInfo?this.connectionInfo.baseEndpointUrl:"")+F.path,body:k,rawBody:F.body,headers:F.headers});return!!j.isHandled&&(U.status=j.resultCode,j.responseHeaders&&(U.headers=j.responseHeaders),j.responseBody&&(U.body=j.responseBody),U.send(),!0)},N}();u.TrouterService=x,u.createTrouterService=function(N){return new x(N)},u.getTrouterServiceVersion=function(){return S.CLIENT_VERSION},u.replaceTrouterUrlBase=function(N,F){var U=N.indexOf("://");if(U>=0){var k=N.indexOf("/",U+3);if(k>=0)return F+N.substr(k)}return""}},function(Q,u){Q.exports=__WEBPACK_EXTERNAL_MODULE_20__},function(Q,u){}])},module.exports=u(tsregistrar)});unwrapExports(tstrouter);var TrouterUtils=createCommonjsModule(function(Q,u){u.__esModule=!0;var c=new Map([["chatMessageReceived",200],["typingIndicatorReceived",245],["readReceiptReceived",246],["chatMessageEdited",247],["chatMessageDeleted",248],["chatThreadCreated",257],["chatThreadPropertiesUpdated",258],["chatThreadDeleted",259],["participantsAdded",260],["participantsRemoved",261]]),s="8:orgid:",_="8:dod:",d="8:gcch:",p="8:teamsvisitor:";u.toMessageHandler=function(g,E){var b=c.get(g);return{handleMessage:function(m){var I=null;if((null==m?void 0:m.rawBody)&&(I=JSON.parse(m.rawBody)),null!==I&&I.eventId===b){var x=P(g,I);if(null!==x)return E(x),{isHandled:!0,resultCode:200}}}}};var P=function(g,E){if("chatMessageReceived"===g)return{threadId:(b=E).groupId,sender:S(b.senderId),senderDisplayName:b.senderDisplayName,recipient:S(b.recipientMri),id:b.messageId,createdOn:new Date(b.originalArrivalTime),version:b.version,type:b.messageType,message:b.messageBody,metadata:f(b.acsChatMessageMetadata)};if("chatMessageEdited"===g)return{threadId:(b=E).groupId,sender:S(b.senderId),senderDisplayName:b.senderDisplayName,recipient:S(b.recipientMri),id:b.messageId,createdOn:new Date(b.originalArrivalTime),version:b.version,message:b.messageBody,editedOn:new Date(b.edittime),type:b.messageType,metadata:f(b.acsChatMessageMetadata)};if("chatMessageDeleted"===g)return{threadId:(b=E).groupId,sender:S(b.senderId),senderDisplayName:b.senderDisplayName,recipient:S(b.recipientMri),id:b.messageId,createdOn:new Date(b.originalArrivalTime),version:b.version,deletedOn:new Date(b.deletetime),type:b.messageType};if("typingIndicatorReceived"===g)return{threadId:(b=E).groupId,sender:S(b.senderId),senderDisplayName:b.senderDisplayName,recipient:S(b.recipientMri),version:b.version,receivedOn:new Date(b.originalArrivalTime)};if("readReceiptReceived"===g){var b=E,x=JSON.parse(b.messageBody).consumptionhorizon.split(";");return{threadId:b.groupId,sender:S(b.senderId),senderDisplayName:"",recipient:S(b.recipientMri),chatMessageId:b.messageId,readOn:new Date(+x[1])}}if("chatThreadCreated"===g){b=E;var N=JSON.parse(unescape(b.createdBy)),F=JSON.parse(unescape(b.members)),U=JSON.parse(unescape(b.properties)),k={id:S(N.participantId),displayName:N.displayName},D=F.map(function(pe){return{id:S(pe.participantId),displayName:pe.displayName}});return{threadId:b.threadId,createdOn:new Date(b.createTime),createdBy:k,version:b.version,participants:D,properties:U}}if("chatThreadPropertiesUpdated"===g){b=E;var M=JSON.parse(unescape(b.editedBy)),j=(U=JSON.parse(unescape(b.properties)),{id:S(M.participantId),displayName:M.displayName});return{threadId:b.threadId,updatedOn:new Date(b.editTime),updatedBy:j,version:b.version,properties:U}}if("chatThreadDeleted"===g){b=E;var W=JSON.parse(unescape(b.deletedBy)),$={id:S(W.participantId),displayName:W.displayName};return{threadId:b.threadId,deletedOn:new Date(b.deleteTime),deletedBy:$,version:b.version}}if("participantsAdded"===g){b=E;var ce=JSON.parse(unescape(b.addedBy)),oe=JSON.parse(unescape(b.participantsAdded)),Z={id:S(ce.participantId),displayName:ce.displayName};return D=oe.map(function(re){return{id:S(re.participantId),displayName:re.displayName,shareHistoryTime:new Date(re.shareHistoryTime)}}),{threadId:b.threadId,addedOn:new Date(b.time),addedBy:Z,version:b.version,participantsAdded:D}}if("participantsRemoved"===g){b=E;var ue=JSON.parse(unescape(b.removedBy)),he=JSON.parse(unescape(b.participantsRemoved)),Ee={id:S(ue.participantId),displayName:ue.displayName};return D=he.map(function(re){return{id:S(re.participantId),displayName:re.displayName,shareHistoryTime:new Date(re.shareHistoryTime)}}),{threadId:b.threadId,removedOn:new Date(b.time),removedBy:Ee,version:b.version,participantsRemoved:D}}return null};u.toLogProvider=function(g){return{log:function(){for(var E=[],b=0;b<arguments.length;b++)E[b]=arguments[b];return g.info(E)},warn:function(){for(var E=[],b=0;b<arguments.length;b++)E[b]=arguments[b];return g.warning(E)},error:function(){for(var E=[],b=0;b<arguments.length;b++)E[b]=arguments[b];return g.error(E)},debug:function(){for(var E=[],b=0;b<arguments.length;b++)E[b]=arguments[b];return g.verbose(E)},info:function(){for(var E=[],b=0;b<arguments.length;b++)E[b]=arguments[b];return g.verbose(E)}}},u.toTelemetrySender=function(g){return{logEvent:function(E){return g.info(E)}}};var S=function(g){return g.startsWith(s)?{kind:"microsoftTeamsUser",rawId:g,microsoftTeamsUserId:g.substring(s.length),isAnonymous:!1,cloud:"public"}:g.startsWith(_)?{kind:"microsoftTeamsUser",rawId:g,microsoftTeamsUserId:g.substring(_.length),isAnonymous:!1,cloud:"dod"}:g.startsWith(d)?{kind:"microsoftTeamsUser",rawId:g,microsoftTeamsUserId:g.substring(d.length),isAnonymous:!1,cloud:"gcch"}:g.startsWith(p)?{kind:"microsoftTeamsUser",rawId:g,microsoftTeamsUserId:g.substring(p.length),isAnonymous:!0}:g.startsWith("4:")?{kind:"phoneNumber",rawId:g,phoneNumber:g.substring("4:".length)}:g.startsWith("8:acs:")||g.startsWith("8:spool:")?{kind:"communicationUser",communicationUserId:g}:{kind:"unknown",id:g}},f=function(g){return null==g||""===g||"null"===g?{}:JSON.parse(g)}});unwrapExports(TrouterUtils);var TrouterUtils_1=TrouterUtils.toMessageHandler,TrouterUtils_2=TrouterUtils.toLogProvider,TrouterUtils_3=TrouterUtils.toTelemetrySender,TrouterSettings=createCommonjsModule(function(Q,u){u.__esModule=!0;var c={version:"1.0.0",registrationId:"",sessionId:"",pnhAppId:"AcsWeb",pnhTemplate:"AcsWeb_Chat_1.2",platform:"SPOOL",platformUIVersion:"0.0.0",environment:"",productName:"acs-chat-web",trouterServiceUrl:"https://go.trouter.skype.com/v4/a",registrarServiceUrl:"https://edge.skype.com/registrar/prod/v3/registrations",registrarRefreshTimeoutInMs:35e4,timeoutOptions:{connectionTimeoutMs:2e4,fetchTimeoutMs:1e4,pingTimeoutMs:4e4,pongTimeoutMs:5e3,maxBackoffMs:5e4,requestTimeoutMs:5e3},maxRegistrationTimeInMs:72e5};u.createSettings=function(s){var _,d=c;return d.registrationId=coreHttp.generateUuid(),d.sessionId=coreHttp.generateUuid(),d.maxRegistrationTimeInMs=null!==(_=null==s?void 0:s.registrationTimeInMs)&&void 0!==_?_:c.maxRegistrationTimeInMs,d},u.defaultTelemetrySettings={enabled:!1}});unwrapExports(TrouterSettings);var TrouterSettings_1=TrouterSettings.createSettings,TrouterSettings_2=TrouterSettings.defaultTelemetrySettings,constants=createCommonjsModule(function(Q,u){u.__esModule=!0,u.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES=3});unwrapExports(constants);var constants_1=constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES,SignalingClient=createCommonjsModule(function(Q,u){var p,c=commonjsGlobal&&commonjsGlobal.__awaiter||function(p,T,l,C){return new(l||(l=Promise))(function(S,f){function g(m){try{b(C.next(m))}catch(I){f(I)}}function E(m){try{b(C.throw(m))}catch(I){f(I)}}function b(m){m.done?S(m.value):function(S){return S instanceof l?S:new l(function(f){f(S)})}(m.value).then(g,E)}b((C=C.apply(p,T||[])).next())})},s=commonjsGlobal&&commonjsGlobal.__generator||function(p,T){var C,P,S,f,l={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return f={next:g(0),throw:g(1),return:g(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function g(b){return function(m){return function(b){if(C)throw new TypeError("Generator is already executing.");for(;l;)try{if(C=1,P&&(S=2&b[0]?P.return:b[0]?P.throw||((S=P.return)&&S.call(P),0):P.next)&&!(S=S.call(P,b[1])).done)return S;switch(P=0,S&&(b=[2&b[0],S.value]),b[0]){case 0:case 1:S=b;break;case 4:return l.label++,{value:b[1],done:!1};case 5:l.label++,P=b[1],b=[0];continue;case 7:b=l.ops.pop(),l.trys.pop();continue;default:if(!(S=(S=l.trys).length>0&&S[S.length-1])&&(6===b[0]||2===b[0])){l=0;continue}if(3===b[0]&&(!S||b[1]>S[0]&&b[1]<S[3])){l.label=b[1];break}if(6===b[0]&&l.label<S[1]){l.label=S[1],S=b;break}if(S&&l.label<S[2]){l.label=S[2],l.ops.push(b);break}S[2]&&l.ops.pop(),l.trys.pop();continue}b=T.call(p,l)}catch(m){b=[6,m],P=0}finally{C=S=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,m])}}};u.__esModule=!0,(p=u.ConnectionState||(u.ConnectionState={}))[p.Unknown=0]="Unknown",p[p.Connected=2]="Connected",p[p.Disconnected=3]="Disconnected",p[p.Switching=9]="Switching";var d=function(){function p(T,l,C){var P=this;this.logger=l,this.stateChangedListener=null,this.tokenFetchRetries=0,this.trouter=tstrouter.createTrouterService(TrouterUtils.toLogProvider(l)),this.config={trouterSettings:TrouterSettings.createSettings(C),skypeTokenProvider:function(S){return c(P,void 0,void 0,function(){var f,g;return s(this,function(E){switch(E.label){case 0:if(S){if(this.tokenFetchRetries+=1,this.tokenFetchRetries>constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES)throw this.stop(!0),new Error("Access token is expired and failed to fetch a valid one after "+constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES+" retries")}else this.tokenFetchRetries=0;return g=(f=Promise).resolve,[4,T.getToken()];case 1:return[2,g.apply(f,[E.sent().token])]}})})},telemetryConfig:{eventLogger:TrouterUtils.toTelemetrySender(l),settings:TrouterSettings.defaultTelemetrySettings}}}return p.prototype.start=function(){this.trouter.start(this.config),this.trouter.setUserActivityState(tstrouter.UserActivityState.Active)},p.prototype.stop=function(T){this.trouter.offStateChanged(this.stateChangedListener),this.trouter.clearMessageHandlers(),this.trouter.stop(null!=T?T:this.tokenFetchRetries>constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES)},p.prototype.on=function(T,l){if("connectionChanged"===T)return this.trouter.offStateChanged(this.stateChangedListener),this.stateChangedListener=function(C,P){return l(C)},void this.trouter.onStateChanged(this.stateChangedListener);this.trouter.registerMessageHandler(TrouterUtils.toMessageHandler(T,l))},p}();u.CommunicationSignalingClient=d});unwrapExports(SignalingClient);var SignalingClient_1=SignalingClient.ConnectionState,SignalingClient_2=SignalingClient.CommunicationSignalingClient,src=createCommonjsModule(function(Q,u){u.__esModule=!0,function(s){for(var _ in s)u.hasOwnProperty(_)||(u[_]=s[_])}(SignalingClient)}),index=unwrapExports(src);module.exports=index},3700:(Q,u,c)=>{"use strict";function s(w){return w.toLowerCase()}function _(w){return!(!w||"object"!=typeof w||"function"!=typeof w.rawHeaders||"function"!=typeof w.clone||"function"!=typeof w.get||"function"!=typeof w.set||"function"!=typeof w.contains||"function"!=typeof w.remove||"function"!=typeof w.headersArray||"function"!=typeof w.headerValues||"function"!=typeof w.headerNames||"function"!=typeof w.toJson)}c.r(u),c.d(u,{AccessTokenRefresher:()=>gt,ApiKeyCredentials:()=>Yi,BaseRequestPolicy:()=>Mn,BasicAuthenticationCredentials:()=>Os,Constants:()=>hr,DefaultHttpClient:()=>po,ExpiringAccessTokenCache:()=>je,HttpHeaders:()=>d,HttpPipelineLogLevel:()=>Qn,MapperType:()=>Li,QueryCollectionFormat:()=>Rr,RequestPolicyOptions:()=>rn,RestError:()=>rt,RetryMode:()=>Dr,Serializer:()=>an,ServiceClient:()=>ha,TopicCredentials:()=>ur,URLBuilder:()=>ui,URLQuery:()=>No,WebResource:()=>fo,XML_ATTRKEY:()=>xe,XML_CHARKEY:()=>Ie,applyMixins:()=>Nr,bearerTokenAuthenticationPolicy:()=>sa,createPipelineFromOptions:()=>Ci,createSpanFunction:()=>tl,delay:()=>Ue,deserializationPolicy:()=>Uo,deserializeResponseBody:()=>pn,disableResponseDecompressionPolicy:()=>fa,encodeUri:()=>Be,executePromisesSequentially:()=>Qe,exponentialRetryPolicy:()=>bn,flattenResponse:()=>At,generateClientRequestIdPolicy:()=>Et,generateUuid:()=>qe,getDefaultProxySettings:()=>Qc,getDefaultUserAgentValue:()=>Fn,isDuration:()=>ze,isNode:()=>We,isTokenCredential:()=>Lr.c,isValidUuid:()=>Ke,keepAlivePolicy:()=>ca,logPolicy:()=>Lo,operationOptionsToRequestOptionsBase:()=>Hn,parseXML:()=>zr,promiseToCallback:()=>Gt,promiseToServiceCallback:()=>rr,proxyPolicy:()=>aa,redirectPolicy:()=>Wi,serializeObject:()=>ai,signingPolicy:()=>_s,stringifyXML:()=>ji,stripRequest:()=>Ye,stripResponse:()=>$e,systemErrorRetryPolicy:()=>Es,throttlingRetryPolicy:()=>ua,tracingPolicy:()=>Ds,userAgentPolicy:()=>Yt});var d=function(){function w(v){if(this._headersMap={},v)for(var O in v)this.set(O,v[O])}return w.prototype.set=function(v,O){this._headersMap[s(v)]={name:v,value:O.toString()}},w.prototype.get=function(v){var O=this._headersMap[s(v)];return O?O.value:void 0},w.prototype.contains=function(v){return!!this._headersMap[s(v)]},w.prototype.remove=function(v){var O=this.contains(v);return delete this._headersMap[s(v)],O},w.prototype.rawHeaders=function(){var v={};for(var O in this._headersMap){var H=this._headersMap[O];v[H.name.toLowerCase()]=H.value}return v},w.prototype.headersArray=function(){var v=[];for(var O in this._headersMap)v.push(this._headersMap[O]);return v},w.prototype.headerNames=function(){for(var v=[],O=this.headersArray(),H=0;H<O.length;++H)v.push(O[H].name);return v},w.prototype.headerValues=function(){for(var v=[],O=this.headersArray(),H=0;H<O.length;++H)v.push(O[H].value);return v},w.prototype.toJson=function(){return this.rawHeaders()},w.prototype.toString=function(){return JSON.stringify(this.toJson())},w.prototype.clone=function(){return new w(this.rawHeaders())},w}(),p=function(w,v){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,H){O.__proto__=H}||function(O,H){for(var z in H)Object.prototype.hasOwnProperty.call(H,z)&&(O[z]=H[z])})(w,v)};function T(w,v){if("function"!=typeof v&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function O(){this.constructor=w}p(w,v),w.prototype=null===v?Object.create(v):(O.prototype=v.prototype,new O)}var l=function(){return(l=Object.assign||function(v){for(var O,H=1,z=arguments.length;H<z;H++)for(var X in O=arguments[H])Object.prototype.hasOwnProperty.call(O,X)&&(v[X]=O[X]);return v}).apply(this,arguments)};function g(w,v,O,H){return new(O||(O=Promise))(function(X,le){function me(Oe){try{we(H.next(Oe))}catch(_e){le(_e)}}function Re(Oe){try{we(H.throw(Oe))}catch(_e){le(_e)}}function we(Oe){Oe.done?X(Oe.value):function(X){return X instanceof O?X:new O(function(le){le(X)})}(Oe.value).then(me,Re)}we((H=H.apply(w,v||[])).next())})}function E(w,v){var H,z,X,le,O={label:0,sent:function(){if(1&X[0])throw X[1];return X[1]},trys:[],ops:[]};return le={next:me(0),throw:me(1),return:me(2)},"function"==typeof Symbol&&(le[Symbol.iterator]=function(){return this}),le;function me(we){return function(Oe){return function(we){if(H)throw new TypeError("Generator is already executing.");for(;O;)try{if(H=1,z&&(X=2&we[0]?z.return:we[0]?z.throw||((X=z.return)&&X.call(z),0):z.next)&&!(X=X.call(z,we[1])).done)return X;switch(z=0,X&&(we=[2&we[0],X.value]),we[0]){case 0:case 1:X=we;break;case 4:return O.label++,{value:we[1],done:!1};case 5:O.label++,z=we[1],we=[0];continue;case 7:we=O.ops.pop(),O.trys.pop();continue;default:if(!(X=(X=O.trys).length>0&&X[X.length-1])&&(6===we[0]||2===we[0])){O=0;continue}if(3===we[0]&&(!X||we[1]>X[0]&&we[1]<X[3])){O.label=we[1];break}if(6===we[0]&&O.label<X[1]){O.label=X[1],X=we;break}if(X&&O.label<X[2]){O.label=X[2],O.ops.push(we);break}X[2]&&O.ops.pop(),O.trys.pop();continue}we=v.call(w,O)}catch(Oe){we=[6,Oe],z=0}finally{H=X=0}if(5&we[0])throw we[1];return{value:we[0]?we[1]:void 0,done:!0}}([we,Oe])}}}function Ee(w){for(var v="",O=0;O<w.length;O++)v+=String.fromCharCode(w[O]);return btoa(v)}function se(w){for(var v=atob(w),O=new Uint8Array(v.length),H=0;H<v.length;H++)O[H]=v.charCodeAt(H);return O}var K,pe=new Uint8Array(16);function re(){if(!K&&!(K="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return K(pe)}const J=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,te=function(w){return"string"==typeof w&&J.test(w)};for(var ae=[],ve=0;ve<256;++ve)ae.push((ve+256).toString(16).substr(1));const Ae=function(w,v,O){var H=(w=w||{}).random||(w.rng||re)();if(H[6]=15&H[6]|64,H[8]=63&H[8]|128,v){O=O||0;for(var z=0;z<16;++z)v[O+z]=H[z];return v}return function(w){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,O=(ae[w[v+0]]+ae[w[v+1]]+ae[w[v+2]]+ae[w[v+3]]+"-"+ae[w[v+4]]+ae[w[v+5]]+"-"+ae[w[v+6]]+ae[w[v+7]]+"-"+ae[w[v+8]]+ae[w[v+9]]+"-"+ae[w[v+10]]+ae[w[v+11]]+ae[w[v+12]]+ae[w[v+13]]+ae[w[v+14]]+ae[w[v+15]]).toLowerCase();if(!te(O))throw TypeError("Stringified UUID is invalid");return O}(H)};var xe="$",Ie="_",Le=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,We="undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node;function Be(w){return encodeURIComponent(w).replace(/!/g,"%21").replace(/"/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function $e(w){var v={};return v.body=w.bodyAsText,v.headers=w.headers,v.status=w.status,v}function Ye(w){var v=w.clone();return v.headers&&v.headers.remove("authorization"),v}function Ke(w){return Le.test(w)}function qe(){return Ae()}function Qe(w,v){var O=Promise.resolve(v);return w.forEach(function(H){O=O.then(H)}),O}function Ue(w,v){return new Promise(function(O){return setTimeout(function(){return O(v)},w)})}function Gt(w){if("function"!=typeof w.then)throw new Error("The provided input is not a Promise.");return function(v){w.then(function(O){return v(void 0,O)}).catch(function(O){v(O)})}}function rr(w){if("function"!=typeof w.then)throw new Error("The provided input is not a Promise.");return function(v){w.then(function(O){return process.nextTick(v,void 0,O.parsedBody,O.request,O)}).catch(function(O){process.nextTick(v,O)})}}function Nr(w,v){var O=w;v.forEach(function(H){Object.getOwnPropertyNames(H.prototype).forEach(function(z){O.prototype[z]=H.prototype[z]})})}var ke=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ze(w){return ke.test(w)}function Xe(w,v,O){return w&&v?w.split(v).join(O||""):w}var an=function(){function w(v,O){void 0===v&&(v={}),this.modelMappers=v,this.isXML=O}return w.prototype.validateConstraints=function(v,O,H){var z=function(cn,wn){throw new Error('"'+H+'" with value "'+O+'" should satisfy the constraint "'+cn+'": '+wn+".")};if(v.constraints&&null!=O){var X=O,le=v.constraints,me=le.ExclusiveMaximum,Re=le.ExclusiveMinimum,we=le.InclusiveMaximum,Oe=le.InclusiveMinimum,_e=le.MaxItems,He=le.MaxLength,Je=le.MinItems,nt=le.MinLength,ct=le.MultipleOf,pt=le.Pattern,it=le.UniqueItems;null!=me&&X>=me&&z("ExclusiveMaximum",me),null!=Re&&X<=Re&&z("ExclusiveMinimum",Re),null!=we&&X>we&&z("InclusiveMaximum",we),null!=Oe&&X<Oe&&z("InclusiveMinimum",Oe);var yt=O;if(null!=_e&&yt.length>_e&&z("MaxItems",_e),null!=He&&yt.length>He&&z("MaxLength",He),null!=Je&&yt.length<Je&&z("MinItems",Je),null!=nt&&yt.length<nt&&z("MinLength",nt),null!=ct&&X%ct!=0&&z("MultipleOf",ct),pt){var qt="string"==typeof pt?new RegExp(pt):pt;("string"!=typeof O||null===O.match(qt))&&z("Pattern",pt)}it&&yt.some(function(cn,wn,Rn){return Rn.indexOf(cn)!==wn})&&z("UniqueItems",it)}},w.prototype.serialize=function(v,O,H,z){var X,le,me;void 0===z&&(z={});var Re={rootName:null!==(X=z.rootName)&&void 0!==X?X:"",includeRoot:null!==(le=z.includeRoot)&&void 0!==le&&le,xmlCharKey:null!==(me=z.xmlCharKey)&&void 0!==me?me:Ie},we={},Oe=v.type.name;H||(H=v.serializedName),null!==Oe.match(/^Sequence$/i)&&(we=[]),v.isConstant&&(O=v.defaultValue);var _e=v.required,He=v.nullable;if(_e&&He&&void 0===O)throw new Error(H+" cannot be undefined.");if(_e&&!He&&null==O)throw new Error(H+" cannot be null or undefined.");if(!_e&&!1===He&&null===O)throw new Error(H+" cannot be null.");return null==O?we=O:(this.validateConstraints(v,O,H),null!==Oe.match(/^any$/i)?we=O:null!==Oe.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?we=function(w,v,O){if(null!=O)if(null!==w.match(/^Number$/i)){if("number"!=typeof O)throw new Error(v+" with value "+O+" must be of type number.")}else if(null!==w.match(/^String$/i)){if("string"!=typeof O.valueOf())throw new Error(v+' with value "'+O+'" must be of type string.')}else if(null!==w.match(/^Uuid$/i)){if("string"!=typeof O.valueOf()||!Ke(O))throw new Error(v+' with value "'+O+'" must be of type string and a valid uuid.')}else if(null!==w.match(/^Boolean$/i)){if("boolean"!=typeof O)throw new Error(v+" with value "+O+" must be of type boolean.")}else if(null!==w.match(/^Stream$/i)){var H=typeof O;if(!("string"===H||"function"===H||O instanceof ArrayBuffer||ArrayBuffer.isView(O)||("function"==typeof Blob||"object"==typeof Blob)&&O instanceof Blob))throw new Error(v+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return O}(Oe,H,O):null!==Oe.match(/^Enum$/i)?we=function(w,v,O){if(!v)throw new Error("Please provide a set of allowedValues to validate "+w+" as an Enum Type.");if(!v.some(function(z){return"string"==typeof z.valueOf()?z.toLowerCase()===O.toLowerCase():z===O}))throw new Error(O+" is not a valid value for "+w+". The valid values are: "+JSON.stringify(v)+".");return O}(H,v.type.allowedValues,O):null!==Oe.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?we=function(w,v,O){if(null!=v)if(null!==w.match(/^Date$/i)){if(!(v instanceof Date||"string"==typeof v.valueOf()&&!isNaN(Date.parse(v))))throw new Error(O+" must be an instanceof Date or a string in ISO8601 format.");v=v instanceof Date?v.toISOString().substring(0,10):new Date(v).toISOString().substring(0,10)}else if(null!==w.match(/^DateTime$/i)){if(!(v instanceof Date||"string"==typeof v.valueOf()&&!isNaN(Date.parse(v))))throw new Error(O+" must be an instanceof Date or a string in ISO8601 format.");v=v instanceof Date?v.toISOString():new Date(v).toISOString()}else if(null!==w.match(/^DateTimeRfc1123$/i)){if(!(v instanceof Date||"string"==typeof v.valueOf()&&!isNaN(Date.parse(v))))throw new Error(O+" must be an instanceof Date or a string in RFC-1123 format.");v=v instanceof Date?v.toUTCString():new Date(v).toUTCString()}else if(null!==w.match(/^UnixTime$/i)){if(!(v instanceof Date||"string"==typeof v.valueOf()&&!isNaN(Date.parse(v))))throw new Error(O+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");v=function(w){if(w)return"string"==typeof w.valueOf()&&(w=new Date(w)),Math.floor(w.getTime()/1e3)}(v)}else if(null!==w.match(/^TimeSpan$/i)&&!ze(v))throw new Error(O+' must be a string in ISO 8601 format. Instead was "'+v+'".');return v}(Oe,O,H):null!==Oe.match(/^ByteArray$/i)?we=function(w,v){var O="";if(null!=v){if(!(v instanceof Uint8Array))throw new Error(w+" must be of type Uint8Array.");O=Ee(v)}return O}(H,O):null!==Oe.match(/^Base64Url$/i)?we=function(w,v){var O="";if(null!=v){if(!(v instanceof Uint8Array))throw new Error(w+" must be of type Uint8Array.");O=function(w){if(w){if(!(w instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(w,v){for(var O=w.length;O-1>=0&&"="===w[O-1];)--O;return w.substr(0,O)}(Ee(w)).replace(/\+/g,"-").replace(/\//g,"_")}}(v)||""}return O}(H,O):null!==Oe.match(/^Sequence$/i)?we=function(w,v,O,H,z,X){var le,me;if(!Array.isArray(O))throw new Error(H+" must be of type Array.");var Re=v.type.element;if(!Re||"object"!=typeof Re)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+H+".");for(var we=[],Oe=0;Oe<O.length;Oe++){var _e=w.serialize(Re,O[Oe],H,X);if(z&&Re.xmlNamespace){var He=Re.xmlNamespacePrefix?"xmlns:"+Re.xmlNamespacePrefix:"xmlns";"Composite"===Re.type.name?(we[Oe]=l({},_e),we[Oe][xe]=((le={})[He]=Re.xmlNamespace,le)):(we[Oe]={},we[Oe][X.xmlCharKey]=_e,we[Oe][xe]=((me={})[He]=Re.xmlNamespace,me))}else we[Oe]=_e}return we}(this,v,O,H,Boolean(this.isXML),Re):null!==Oe.match(/^Dictionary$/i)?we=function(w,v,O,H,z,X){var le;if("object"!=typeof O)throw new Error(H+" must be of type object.");var me=v.type.value;if(!me||"object"!=typeof me)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+H+".");for(var Re={},we=0,Oe=Object.keys(O);we<Oe.length;we++){var _e=Oe[we],He=w.serialize(me,O[_e],H,X);Re[_e]=Er(me,He,z,X)}if(z&&v.xmlNamespace){var nt=Re;return nt[xe]=((le={})[v.xmlNamespacePrefix?"xmlns:"+v.xmlNamespacePrefix:"xmlns"]=v.xmlNamespace,le),nt}return Re}(this,v,O,H,Boolean(this.isXML),Re):null!==Oe.match(/^Composite$/i)&&(we=function(w,v,O,H,z,X){var le,me;if(xi(w,v)&&(v=hs(w,v,O,"clientName")),null!=O){for(var Re={},we=ds(w,v,H),Oe=0,_e=Object.keys(we);Oe<_e.length;Oe++){var He=_e[Oe],Je=we[He];if(!Je.readOnly){var nt=void 0,ct=Re;if(w.isXML)nt=Je.xmlIsWrapped?Je.xmlName:Je.xmlElementName||Je.xmlName;else{var pt=ss(Je.serializedName);nt=pt.pop();for(var it=0,yt=pt;it<yt.length;it++){var qt=yt[it];null==ct[qt]&&(null!=O[He]||void 0!==Je.defaultValue)&&(ct[qt]={}),ct=ct[qt]}}if(null!=ct){if(z&&v.xmlNamespace){var wn=v.xmlNamespacePrefix?"xmlns:"+v.xmlNamespacePrefix:"xmlns";ct[xe]=l(l({},ct[xe]),((le={})[wn]=v.xmlNamespace,le))}var Rn=""!==Je.serializedName?H+"."+Je.serializedName:H,Sn=O[He],Cn=xi(w,v);Cn&&Cn.clientName===He&&null==Sn&&(Sn=v.serializedName);var An=w.serialize(Je,Sn,Rn,X);if(void 0!==An&&null!=nt){var Xn=Er(Je,An,z,X);z&&Je.xmlIsAttribute?(ct[xe]=ct[xe]||{},ct[xe][nt]=An):ct[nt]=z&&Je.xmlIsWrapped?((me={})[Je.xmlElementName]=Xn,me):Xn}}}}var ln=function(w,v,O){var H=v.type.additionalProperties;if(!H&&v.type.className){var z=at(w,v,O);return null==z?void 0:z.type.additionalProperties}return H}(w,v,H);if(ln){var Zt=Object.keys(we),kt=function(zt){Zt.every(function(on){return on!==zt})&&(Re[zt]=w.serialize(ln,O[zt],H+'["'+zt+'"]',X))};for(var Bt in O)kt(Bt)}return Re}return O}(this,v,O,H,Boolean(this.isXML),Re))),we},w.prototype.deserialize=function(v,O,H,z){var X,le,me;void 0===z&&(z={});var Re={rootName:null!==(X=z.rootName)&&void 0!==X?X:"",includeRoot:null!==(le=z.includeRoot)&&void 0!==le&&le,xmlCharKey:null!==(me=z.xmlCharKey)&&void 0!==me?me:Ie};if(null==O)return this.isXML&&"Sequence"===v.type.name&&!v.xmlIsWrapped&&(O=[]),void 0!==v.defaultValue&&(O=v.defaultValue),O;var we,Oe=v.type.name;if(H||(H=v.serializedName),null!==Oe.match(/^Composite$/i))we=function(w,v,O,H,z){var X;xi(w,v)&&(v=hs(w,v,O,"serializedName"));for(var le=ds(w,v,H),me={},Re=[],we=0,Oe=Object.keys(le);we<Oe.length;we++){var He=le[_e=Oe[we]],Je=ss(le[_e].serializedName);Re.push(Je[0]);var nt=He.serializedName,ct=He.xmlName,pt=He.xmlElementName,it=H;""!==nt&&void 0!==nt&&(it=H+"."+nt);var yt=He.headerCollectionPrefix;if(yt){for(var qt={},cn=0,wn=Object.keys(O);cn<wn.length;cn++){var Rn=wn[cn];Rn.startsWith(yt)&&(qt[Rn.substring(yt.length)]=w.deserialize(He.type.value,O[Rn],it,z)),Re.push(Rn)}me[_e]=qt}else if(w.isXML)if(He.xmlIsAttribute&&O[xe])me[_e]=w.deserialize(He,O[xe][ct],it,z);else{var Sn=pt||ct||nt;if(He.xmlIsWrapped){var Cn=O[ct],An=null!==(X=null==Cn?void 0:Cn[pt])&&void 0!==X?X:[];me[_e]=w.deserialize(He,An,it,z)}else me[_e]=w.deserialize(He,O[Sn],it,z)}else{for(var ln=void 0,Zt=O,kt=0,Bt=Je;kt<Bt.length;kt++){var zt=Bt[kt];if(!Zt)break;Zt=Zt[zt]}ln=Zt;var jt=v.type.polymorphicDiscriminator;jt&&_e===jt.clientName&&null==ln&&(ln=v.serializedName);var on=void 0;if(Array.isArray(O[_e])&&""===le[_e].serializedName){for(var Zn=w.deserialize(He,ln=O[_e],it,z),yr=0,Kt=Object.entries(me);yr<Kt.length;yr++){var Nn=Kt[yr],To=Nn[0],Wo=Nn[1];Object.prototype.hasOwnProperty.call(Zn,To)||(Zn[To]=Wo)}me=Zn}else(void 0!==ln||void 0!==He.defaultValue)&&(on=w.deserialize(He,ln,it,z),me[_e]=on)}}var Ti=v.type.additionalProperties;if(Ti){var zo=function(Uu){for(var Vu in le)if(ss(le[Vu].serializedName)[0]===Uu)return!1;return!0};for(var bo in O)zo(bo)&&(me[bo]=w.deserialize(Ti,O[bo],H+'["'+bo+'"]',z))}else if(O)for(var Pr=0,Xi=Object.keys(O);Pr<Xi.length;Pr++){var _e;void 0===me[_e=Xi[Pr]]&&!Re.includes(_e)&&!ea(_e,z)&&(me[_e]=O[_e])}return me}(this,v,O,H,Re);else{if(this.isXML){var _e=Re.xmlCharKey;null!=O[xe]&&null!=O[_e]&&(O=O[_e])}null!==Oe.match(/^Number$/i)?(we=parseFloat(O),isNaN(we)&&(we=O)):null!==Oe.match(/^Boolean$/i)?we="true"===O||"false"!==O&&O:null!==Oe.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?we=O:null!==Oe.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?we=new Date(O):null!==Oe.match(/^UnixTime$/i)?we=function(w){if(w)return new Date(1e3*w)}(O):null!==Oe.match(/^ByteArray$/i)?we=se(O):null!==Oe.match(/^Base64Url$/i)?we=function(w){if(w){if(w&&"string"!=typeof w.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return se(w=w.replace(/-/g,"+").replace(/_/g,"/"))}}(O):null!==Oe.match(/^Sequence$/i)?we=function(w,v,O,H,z){var X=v.type.element;if(!X||"object"!=typeof X)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+H);if(O){Array.isArray(O)||(O=[O]);for(var le=[],me=0;me<O.length;me++)le[me]=w.deserialize(X,O[me],H+"["+me+"]",z);return le}return O}(this,v,O,H,Re):null!==Oe.match(/^Dictionary$/i)&&(we=function(w,v,O,H,z){var X=v.type.value;if(!X||"object"!=typeof X)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+H);if(O){for(var le={},me=0,Re=Object.keys(O);me<Re.length;me++){var we=Re[me];le[we]=w.deserialize(X,O[we],H,z)}return le}return O}(this,v,O,H,Re))}return v.isConstant&&(we=v.defaultValue),we},w}();function ss(w){var v=[],O="";if(w)for(var z=0,X=w.split(".");z<X.length;z++){var le=X[z];"\\"===le.charAt(le.length-1)?O+=le.substr(0,le.length-1)+".":(v.push(O+=le),O="")}return v}function at(w,v,O){var H=v.type.className;if(!H)throw new Error('Class name for model "'+O+'" is not provided in the mapper "'+JSON.stringify(v,void 0,2)+'".');return w.modelMappers[H]}function ds(w,v,O){var H=v.type.modelProperties;if(!H){var z=at(w,v,O);if(!z)throw new Error('mapper() cannot be null or undefined for model "'+v.type.className+'".');if(!(H=null==z?void 0:z.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(z)+'" of type "'+v.type.className+'" for object "'+O+'".')}return H}function Er(w,v,O,H){var z;if(!O||!w.xmlNamespace)return v;var le=((z={})[w.xmlNamespacePrefix?"xmlns:"+w.xmlNamespacePrefix:"xmlns"]=w.xmlNamespace,z);if(["Composite"].includes(w.type.name)){if(v[xe])return v;var me=l({},v);return me[xe]=le,me}var Re={};return Re[H.xmlCharKey]=v,Re[xe]=le,Re}function ea(w,v){return[xe,v.xmlCharKey].includes(w)}function hs(w,v,O,H){var z=xi(w,v);if(z){var X=z[H];if(null!=X){var le=O[X];if(null!=le){var me=v.type.uberParent||v.type.className,we=w.modelMappers.discriminators[le===me?le:me+"."+le];we&&(v=we)}}}return v}function xi(w,v){return v.type.polymorphicDiscriminator||Mo(w,v.type.uberParent)||Mo(w,v.type.className)}function Mo(w,v){return v&&w.modelMappers[v]&&w.modelMappers[v].type.polymorphicDiscriminator}function ai(w){var v=w;if(null!=w){if(w instanceof Uint8Array)return Ee(w);if(w instanceof Date)return w.toISOString();if(Array.isArray(w)){for(var O=[],H=0;H<w.length;H++)O.push(ai(w[H]));return O}if("object"==typeof w){var z={};for(var X in w)z[X]=ai(v[X]);return z}return w}}var Li=function(w){for(var v={},O=0,H=["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"];O<H.length;O++){var z=H[O];v[z]=z}return v}(),fo=function(){function w(v,O,H,z,X,le,me,Re,we,Oe,_e,He,Je,nt,ct){this.streamResponseBody=le,this.streamResponseStatusCodes=ct,this.url=v||"",this.method=O||"GET",this.headers=_(X)?X:new d(X),this.body=H,this.query=z,this.formData=void 0,this.withCredentials=me||!1,this.abortSignal=Re,this.timeout=we||0,this.onUploadProgress=Oe,this.onDownloadProgress=_e,this.proxySettings=He,this.keepAlive=Je,this.decompressResponse=nt,this.requestId=this.headers.get("x-ms-client-request-id")||qe()}return w.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},w.prototype.prepare=function(v){if(!v)throw new Error("options object is required");if(null==v.method||"string"!=typeof v.method.valueOf())throw new Error("options.method must be a string.");if(v.url&&v.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=v.pathTemplate&&"string"==typeof v.pathTemplate.valueOf()||null!=v.url&&"string"==typeof v.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(v.url){if("string"!=typeof v.url)throw new Error('options.url must be of type "string".');this.url=v.url}if(v.method){var O=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===O.indexOf(v.method.toUpperCase()))throw new Error('The provided method "'+v.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(O))}if(this.method=v.method.toUpperCase(),v.pathTemplate){var H=v.pathTemplate,z=v.pathParameters;if("string"!=typeof H)throw new Error('options.pathTemplate must be of type "string".');v.baseUrl||(v.baseUrl="https://management.azure.com");var X=v.baseUrl,le=X+(X.endsWith("/")?"":"/")+(H.startsWith("/")?H.slice(1):H),me=le.match(/({[\w-]*\s*[\w-]*})/gi);if(me&&me.length){if(!z)throw new Error("pathTemplate: "+H+" has been provided. Hence, options.pathParameters must also be provided.");me.forEach(function(pt){var it=pt.slice(1,-1),yt=z[it];if(null==yt||"string"!=typeof yt&&"object"!=typeof yt){var qt=JSON.stringify(z,void 0,2);throw new Error("pathTemplate: "+H+" contains the path parameter "+it+" however, it is not present in parameters: "+qt+'.The value of the path parameter can either be a "string" of the form { '+it+': "some sample value" } or it can be an "object" of the form { "'+it+'": { value: "some sample value", skipUrlEncoding: true } }.')}if("string"==typeof yt.valueOf()&&(le=le.replace(pt,encodeURIComponent(yt))),"object"==typeof yt.valueOf()){if(!yt.value)throw new Error("options.pathParameters["+it+'] is of type "object" but it does not contain a "value" property.');le=le.replace(pt,yt.skipUrlEncoding?yt.value:encodeURIComponent(yt.value))}})}this.url=le}if(v.queryParameters){var Re=v.queryParameters;if("object"!=typeof Re)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var we=[];for(var Oe in this.query={},Re){var _e=Re[Oe];if(_e)if("string"==typeof _e)we.push(Oe+"="+encodeURIComponent(_e)),this.query[Oe]=encodeURIComponent(_e);else if("object"==typeof _e){if(!_e.value)throw new Error("options.queryParameters["+Oe+'] is of type "object" but it does not contain a "value" property.');_e.skipUrlEncoding?(we.push(Oe+"="+_e.value),this.query[Oe]=_e.value):(we.push(Oe+"="+encodeURIComponent(_e.value)),this.query[Oe]=encodeURIComponent(_e.value))}}this.url+=we.join("&")}if(v.headers)for(var He=v.headers,Je=0,nt=Object.keys(v.headers);Je<nt.length;Je++){var ct=nt[Je];this.headers.set(ct,He[ct])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),!this.headers.get("x-ms-client-request-id")&&!v.disableClientRequestId&&this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=v.body,null!=v.body&&(v.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(v.serializationMapper&&(this.body=new an(v.mappers).serialize(v.serializationMapper,v.body,"requestBody")),v.disableJsonStringifyOnBody||(this.body=JSON.stringify(v.body)))),v.spanOptions&&(this.spanOptions=v.spanOptions),v.tracingContext&&(this.tracingContext=v.tracingContext),this.abortSignal=v.abortSignal,this.onDownloadProgress=v.onDownloadProgress,this.onUploadProgress=v.onUploadProgress,this},w.prototype.clone=function(){var v=new w(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse,this.streamResponseStatusCodes);return this.formData&&(v.formData=this.formData),this.operationSpec&&(v.operationSpec=this.operationSpec),this.shouldDeserialize&&(v.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(v.operationResponseGetter=this.operationResponseGetter),v},w}(),or=c(4637),pu={},No=function(){function w(){this._rawQuery={}}return w.prototype.any=function(){return Object.keys(this._rawQuery).length>0},w.prototype.keys=function(){return Object.keys(this._rawQuery)},w.prototype.set=function(v,O){var H=O;if(v)if(null!=H){var z=Array.isArray(H)?H:H.toString();this._rawQuery[v]=z}else delete this._rawQuery[v]},w.prototype.get=function(v){return v?this._rawQuery[v]:void 0},w.prototype.toString=function(){var v="";for(var O in this._rawQuery){v&&(v+="&");var H=this._rawQuery[O];if(Array.isArray(H)){for(var z=[],X=0,le=H;X<le.length;X++)z.push(O+"="+le[X]);v+=z.join("&")}else v+=O+"="+H}return v},w.parse=function(v){var O=new w;if(v){v.startsWith("?")&&(v=v.substring(1));for(var H="ParameterName",z="",X="",le=0;le<v.length;++le){var me=v[le];switch(H){case"ParameterName":switch(me){case"=":H="ParameterValue";break;case"&":z="",X="";break;default:z+=me}break;case"ParameterValue":switch(me){case"&":O.set(z,X),z="",X="",H="ParameterName";break;default:X+=me}break;default:throw new Error("Unrecognized URLQuery parse state: "+H)}}"ParameterValue"===H&&O.set(z,X)}return O},w}(),ui=function(){function w(){}return w.prototype.setScheme=function(v){v?this.set(v,"SCHEME"):this._scheme=void 0},w.prototype.getScheme=function(){return this._scheme},w.prototype.setHost=function(v){v?this.set(v,"SCHEME_OR_HOST"):this._host=void 0},w.prototype.getHost=function(){return this._host},w.prototype.setPort=function(v){null==v||""===v?this._port=void 0:this.set(v.toString(),"PORT")},w.prototype.getPort=function(){return this._port},w.prototype.setPath=function(v){if(v){var O=v.indexOf("://");if(-1!==O){var H=v.lastIndexOf("/",O);this.set(-1===H?v:v.substr(H+1),"SCHEME")}else this.set(v,"PATH")}else this._path=void 0},w.prototype.appendPath=function(v){if(v){var O=this.getPath();O&&(O.endsWith("/")||(O+="/"),v.startsWith("/")&&(v=v.substring(1)),v=O+v),this.set(v,"PATH")}},w.prototype.getPath=function(){return this._path},w.prototype.setQuery=function(v){this._query=v?No.parse(v):void 0},w.prototype.setQueryParameter=function(v,O){v&&(this._query||(this._query=new No),this._query.set(v,O))},w.prototype.getQueryParameterValue=function(v){return this._query?this._query.get(v):void 0},w.prototype.getQuery=function(){return this._query?this._query.toString():void 0},w.prototype.set=function(v,O){for(var H=new gu(v,O);H.next();){var z=H.current(),X=void 0;if(z)switch(z.type){case"SCHEME":this._scheme=z.text||void 0;break;case"HOST":this._host=z.text||void 0;break;case"PORT":this._port=z.text||void 0;break;case"PATH":X=z.text||void 0,(!this._path||"/"===this._path||"/"!==X)&&(this._path=X);break;case"QUERY":this._query=No.parse(z.text);break;default:throw new Error("Unrecognized URLTokenType: "+z.type)}}},w.prototype.toString=function(){var v="";return this._scheme&&(v+=this._scheme+"://"),this._host&&(v+=this._host),this._port&&(v+=":"+this._port),this._path&&(this._path.startsWith("/")||(v+="/"),v+=this._path),this._query&&this._query.any()&&(v+="?"+this._query.toString()),v},w.prototype.replaceAll=function(v,O){v&&(this.setScheme(Xe(this.getScheme(),v,O)),this.setHost(Xe(this.getHost(),v,O)),this.setPort(Xe(this.getPort(),v,O)),this.setPath(Xe(this.getPath(),v,O)),this.setQuery(Xe(this.getQuery(),v,O)))},w.parse=function(v){var O=new w;return O.set(v,"SCHEME_OR_HOST"),O},w}(),kr=function(){function w(v,O){this.text=v,this.type=O}return w.scheme=function(v){return new w(v,"SCHEME")},w.host=function(v){return new w(v,"HOST")},w.port=function(v){return new w(v,"PORT")},w.path=function(v){return new w(v,"PATH")},w.query=function(v){return new w(v,"QUERY")},w}(),gu=function(){function w(v,O){this._text=v,this._textLength=v?v.length:0,this._currentState=null!=O?O:"SCHEME_OR_HOST",this._currentIndex=0}return w.prototype.current=function(){return this._currentToken},w.prototype.next=function(){if(ci(this))switch(this._currentState){case"SCHEME":!function(w){var v=function(w){return ta(w,function(v){return function(w){var v=w.charCodeAt(0);return 48<=v&&v<=57||65<=v&&v<=90||97<=v&&v<=122}(v)})}(w);w._currentToken=kr.scheme(v),w._currentState=ci(w)?"HOST":"DONE"}(this);break;case"SCHEME_OR_HOST":!function(w){var v=Ft(w,":","/","?");ci(w)?":"===hn(w)?"://"===ko(w,3)?(w._currentToken=kr.scheme(v),w._currentState="HOST"):(w._currentToken=kr.host(v),w._currentState="PORT"):(w._currentToken=kr.host(v),w._currentState="/"===hn(w)?"PATH":"QUERY"):(w._currentToken=kr.host(v),w._currentState="DONE")}(this);break;case"HOST":!function(w){"://"===ko(w,3)&&Xt(w,3);var v=Ft(w,":","/","?");w._currentToken=kr.host(v),w._currentState=ci(w)?":"===hn(w)?"PORT":"/"===hn(w)?"PATH":"QUERY":"DONE"}(this);break;case"PORT":!function(w){":"===hn(w)&&Xt(w);var v=Ft(w,"/","?");w._currentToken=kr.port(v),w._currentState=ci(w)?"/"===hn(w)?"PATH":"QUERY":"DONE"}(this);break;case"PATH":!function(w){var v=Ft(w,"?");w._currentToken=kr.path(v),w._currentState=ci(w)?"QUERY":"DONE"}(this);break;case"QUERY":!function(w){"?"===hn(w)&&Xt(w);var v=function(w){var v="";return w._currentIndex<w._textLength&&(v=w._text.substring(w._currentIndex),w._currentIndex=w._textLength),v}(w);w._currentToken=kr.query(v),w._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;return!!this._currentToken},w}();function ci(w){return w._currentIndex<w._textLength}function hn(w){return w._text[w._currentIndex]}function Xt(w,v){ci(w)&&(v||(v=1),w._currentIndex+=v)}function ko(w,v){var O=w._currentIndex+v;return w._textLength<O&&(O=w._textLength),w._text.substring(w._currentIndex,O)}function ta(w,v){for(var O="";ci(w);){var H=hn(w);if(!v(H))break;O+=H,Xt(w)}return O}function Ft(w){for(var v=[],O=1;O<arguments.length;O++)v[O-1]=arguments[O];return ta(w,function(H){return-1===v.indexOf(H)})}var gs="REDACTED",Fi=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent"],xo=["api-version"],ms=function(){function w(v){var O=void 0===v?{}:v,H=O.allowedHeaderNames,z=void 0===H?[]:H,X=O.allowedQueryParameters,le=void 0===X?[]:X;z=Array.isArray(z)?Fi.concat(z):Fi,le=Array.isArray(le)?xo.concat(le):xo,this.allowedHeaderNames=new Set(z.map(function(me){return me.toLowerCase()})),this.allowedQueryParameters=new Set(le.map(function(me){return me.toLowerCase()}))}return w.prototype.sanitize=function(v){var O=this,H=new Set;return JSON.stringify(v,function(z,X){if(X instanceof Error)return l(l({},X),{name:X.name,message:X.message});if("_headersMap"===z)return O.sanitizeHeaders(X);if("url"===z)return O.sanitizeUrl(X);if("query"===z)return O.sanitizeQuery(X);if("body"!==z&&"response"!==z&&"operationSpec"!==z){if(Array.isArray(X)||function(w){return!("object"!=typeof w||null===w||Array.isArray(w)||w instanceof RegExp||w instanceof Date)}(X)){if(H.has(X))return"[Circular]";H.add(X)}return X}},2)},w.prototype.sanitizeHeaders=function(v){return this.sanitizeObject(v,this.allowedHeaderNames,function(O,H){return O[H].value})},w.prototype.sanitizeQuery=function(v){return this.sanitizeObject(v,this.allowedQueryParameters,function(O,H){return O[H]})},w.prototype.sanitizeObject=function(v,O,H){if("object"!=typeof v||null===v)return v;for(var z={},X=0,le=Object.keys(v);X<le.length;X++){var me=le[X];z[me]=O.has(me.toLowerCase())?H(v,me):gs}return z},w.prototype.sanitizeUrl=function(v){if("string"!=typeof v||null===v)return v;var O=ui.parse(v),H=O.getQuery();if(!H)return v;for(var z=No.parse(H),X=0,le=z.keys();X<le.length;X++){var me=le[X];this.allowedQueryParameters.has(me.toLowerCase())||z.set(me,gs)}return O.setQuery(z.toString()),O.toString()},w}(),Cu=new ms,rt=function(w){function v(O,H,z,X,le){var me=w.call(this,O)||this;return me.name="RestError",me.code=H,me.statusCode=z,me.request=X,me.response=le,Object.setPrototypeOf(me,v.prototype),me}return T(v,w),v.prototype[pu]=function(){return"RestError: "+this.message+" \n "+Cu.sanitize(this)},v.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",v.PARSE_ERROR="PARSE_ERROR",v}(Error),po=function(){function w(){}return w.prototype.sendRequest=function(v){var O,H=new XMLHttpRequest;if(v.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var z=v.abortSignal;if(z){if(z.aborted)return Promise.reject(new or._("The operation was aborted."));var X=function(){H.abort()};z.addEventListener("abort",X),H.addEventListener("readystatechange",function(){H.readyState===XMLHttpRequest.DONE&&z.removeEventListener("abort",X)})}if(_r(H.upload,v.onUploadProgress),_r(H,v.onDownloadProgress),v.formData){for(var le=v.formData,me=new FormData,Re=function(yt,qt){qt&&Object.prototype.hasOwnProperty.call(qt,"value")&&Object.prototype.hasOwnProperty.call(qt,"options")?me.append(yt,qt.value,qt.options):me.append(yt,qt)},we=0,Oe=Object.keys(le);we<Oe.length;we++){var _e=Oe[we],He=le[_e];if(Array.isArray(He))for(var Je=0;Je<He.length;Je++)Re(_e,He[Je]);else Re(_e,He)}v.body=me,v.formData=void 0;var nt=v.headers.get("Content-Type");nt&&-1!==nt.indexOf("multipart/form-data")&&v.headers.remove("Content-Type")}H.open(v.method,v.url),H.timeout=v.timeout,H.withCredentials=v.withCredentials;for(var ct=0,pt=v.headers.headersArray();ct<pt.length;ct++){var it=pt[ct];H.setRequestHeader(it.name,it.value)}return H.responseType=(null===(O=v.streamResponseStatusCodes)||void 0===O?void 0:O.size)||v.streamResponseBody?"blob":"text",H.send(void 0===v.body?null:v.body),new Promise("blob"===H.responseType?function(yt,qt){(function(w,v,O,H){w.addEventListener("readystatechange",function(){var z;if(w.readyState===XMLHttpRequest.HEADERS_RECEIVED)if(v.streamResponseBody||(null===(z=v.streamResponseStatusCodes)||void 0===z?void 0:z.has(w.status))){var X=new Promise(function(le,me){w.addEventListener("load",function(){le(w.response)}),na(v,w,me)});O({request:v,status:w.status,headers:Ui(w),blobBody:X})}else w.addEventListener("load",function(){if(w.response){var le=new FileReader;le.onload=function(me){var Re,we=null===(Re=me.target)||void 0===Re?void 0:Re.result;O({request:v,status:w.status,headers:Ui(w),bodyAsText:we})},le.onerror=function(me){H(le.error)},le.readAsText(w.response,"UTF-8")}else O({request:v,status:w.status,headers:Ui(w)})})})})(H,v,yt,qt),na(v,H,qt)}:function(yt,qt){H.addEventListener("load",function(){return yt({request:v,status:H.status,headers:Ui(H),bodyAsText:H.responseText})}),na(v,H,qt)})},w}();function _r(w,v){v&&w.addEventListener("progress",function(O){return v({loadedBytes:O.loaded})})}function Ui(w){for(var v=new d,H=0,z=w.getAllResponseHeaders().trim().split(/[\r\n]+/);H<z.length;H++){var X=z[H],le=X.indexOf(":"),me=X.slice(0,le),Re=X.slice(le+2);v.set(me,Re)}return v}function na(w,v,O){v.addEventListener("error",function(){return O(new rt("Failed to send request to "+w.url,rt.REQUEST_SEND_ERROR,void 0,w))});var H=new or._("The operation was aborted.");v.addEventListener("abort",function(){return O(H)}),v.addEventListener("timeout",function(){return O(H)})}var Qn=(()=>{return(w=Qn||(Qn={}))[w.OFF=0]="OFF",w[w.ERROR=1]="ERROR",w[w.WARNING=2]="WARNING",w[w.INFO=3]="INFO",Qn;var w})();function Hn(w){var v=w.requestOptions,O=w.tracingOptions,z=function(w,v){var O={};for(var H in w)Object.prototype.hasOwnProperty.call(w,H)&&v.indexOf(H)<0&&(O[H]=w[H]);if(null!=w&&"function"==typeof Object.getOwnPropertySymbols){var z=0;for(H=Object.getOwnPropertySymbols(w);z<H.length;z++)v.indexOf(H[z])<0&&Object.prototype.propertyIsEnumerable.call(w,H[z])&&(O[H[z]]=w[H[z]])}return O}(w,["requestOptions","tracingOptions"]);return v&&(z=l(l({},z),v)),O&&(z.spanOptions=O.spanOptions,z.tracingContext=O.tracingContext),z}var Lr=c(434),Mn=function(){function w(v,O){this._nextPolicy=v,this._options=O}return w.prototype.shouldLog=function(v){return this._options.shouldLog(v)},w.prototype.log=function(v,O){this._options.log(v,O)},w}(),rn=function(){function w(v){this._logger=v}return w.prototype.shouldLog=function(v){return!!this._logger&&v!==Qn.OFF&&v<=this._logger.minimumLogLevel},w.prototype.log=function(v,O){this._logger&&this.shouldLog(v)&&this._logger.log(v,O)},w}(),Vi=(0,c(1326).YR)("core-http");function Lo(w){return void 0===w&&(w={}),{create:function(v,O){return new Wc(v,O,w)}}}var Wc=function(w){function v(O,H,z){var X=void 0===z?{}:z,le=X.logger,me=void 0===le?Vi.info:le,Re=X.allowedHeaderNames,we=void 0===Re?[]:Re,Oe=X.allowedQueryParameters,_e=void 0===Oe?[]:Oe,He=w.call(this,O,H)||this;return He.logger=me,He.sanitizer=new ms({allowedHeaderNames:we,allowedQueryParameters:_e}),He}return T(v,w),Object.defineProperty(v.prototype,"allowedHeaderNames",{get:function(){return this.sanitizer.allowedHeaderNames},set:function(O){this.sanitizer.allowedHeaderNames=O},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"allowedQueryParameters",{get:function(){return this.sanitizer.allowedQueryParameters},set:function(O){this.sanitizer.allowedQueryParameters=O},enumerable:!1,configurable:!0}),v.prototype.sendRequest=function(O){var H=this;return this.logger.enabled?(this.logRequest(O),this._nextPolicy.sendRequest(O).then(function(z){return H.logResponse(z)})):this._nextPolicy.sendRequest(O)},v.prototype.logRequest=function(O){this.logger("Request: "+this.sanitizer.sanitize(O))},v.prototype.logResponse=function(O){return this.logger("Response status code: "+O.status),this.logger("Headers: "+this.sanitizer.sanitize(O.headers)),O},v}(Mn);function Dt(w){return ra(w.parameterPath,w.mapper)}function ra(w,v){return"string"==typeof w?w:Array.isArray(w)?w.join("."):v.serializedName}if(!(self.document&&self.DOMParser&&self.Node&&self.XMLSerializer))throw new Error('This library depends on the following DOM objects: ["document", "DOMParser", "Node", "XMLSerializer"] to parse XML, but some of these are undefined. You may provide a polyfill to make these globally available in order to support your environment. For more information, please refer to https://aka.ms/azsdk/js/web-workers. ');var li,Fr=document.implementation.createDocument(null,null,null),$t=new DOMParser;function zr(w,v){var O,H,z;void 0===v&&(v={});try{var X={rootName:null!==(O=v.rootName)&&void 0!==O?O:"",includeRoot:null!==(H=v.includeRoot)&&void 0!==H&&H,xmlCharKey:null!==(z=v.xmlCharKey)&&void 0!==z?z:Ie},le=$t.parseFromString(w,"application/xml");!function(w){var v=w.getElementsByTagName("parsererror");if(v.length>0&&function(){var w;if(void 0===li)try{li=null!==(w=$t.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==w?w:""}catch(v){li=""}return li}())for(var O=0;O<v.length;O++)if(v[O].namespaceURI===li)throw new Error(v[O].innerHTML)}(le);var me;return me=di(X.includeRoot?le:le.childNodes[0],X),Promise.resolve(me)}catch(Re){return Promise.reject(Re)}}function di(w,v){var O={},H=w.childNodes.length,z=w.childNodes[0],X=z&&1===H&&z.nodeType===Node.TEXT_NODE&&z.nodeValue||void 0,le=function(w){return function(w){return!!w.attributes}(w)&&w.hasAttributes()?w:void 0}(w);if(le){O[xe]={};for(var me=0;me<le.attributes.length;me++){var Re=le.attributes[me];O[xe][Re.nodeName]=Re.nodeValue}X&&(O[v.xmlCharKey]=X)}else 0===H?O="":X&&(O=X);if(!X)for(me=0;me<H;me++){var we=w.childNodes[me];if(we.nodeType!==Node.TEXT_NODE){var Oe=di(we,v);O[we.nodeName]?Array.isArray(O[we.nodeName])?O[we.nodeName].push(Oe):O[we.nodeName]=[O[we.nodeName],Oe]:O[we.nodeName]=Oe}}return O}var Bi=new XMLSerializer;function ji(w,v){var O,H,z;void 0===v&&(v={});var X={rootName:null!==(O=v.rootName)&&void 0!==O?O:"root",includeRoot:null!==(H=v.includeRoot)&&void 0!==H&&H,xmlCharKey:null!==(z=v.xmlCharKey)&&void 0!==z?z:Ie},le=Fo(w,X.rootName,X)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+Bi.serializeToString(le)}function Eu(w){for(var v=[],O=0,H=Object.keys(w);O<H.length;O++){var z=H[O],X=Fr.createAttribute(z);X.value=w[z].toString(),v.push(X)}return v}function Fo(w,v,O){if(null==w||"string"==typeof w||"number"==typeof w||"boolean"==typeof w)return(H=Fr.createElement(v)).textContent=null==w?"":w.toString(),[H];if(Array.isArray(w)){for(var z=[],X=0,le=w;X<le.length;X++)for(var Re=0,we=Fo(le[X],v,O);Re<we.length;Re++)z.push(we[Re]);return z}if("object"==typeof w){for(var H=Fr.createElement(v),_e=0,He=Object.keys(w);_e<He.length;_e++){var Je=He[_e];if(Je===xe)for(var nt=0,ct=Eu(w[Je]);nt<ct.length;nt++)H.attributes.setNamedItem(ct[nt]);else if(Je===O.xmlCharKey)H.textContent=w[Je].toString();else for(var it=0,yt=Fo(w[Je],Je,O);it<yt.length;it++)H.appendChild(yt[it])}return[H]}throw new Error("Illegal value passed to buildObject: "+w)}function Uo(w,v){return{create:function(O,H){return new hi(O,H,w,v)}}}var fi=["application/json","text/json"],wr=["application/xml","application/atom+xml"],Vo={expectedContentTypes:{json:fi,xml:wr}},hi=function(w){function v(O,H,z,X){void 0===X&&(X={});var le,me=w.call(this,O,H)||this;return me.jsonContentTypes=z&&z.json||fi,me.xmlContentTypes=z&&z.xml||wr,me.xmlCharKey=null!==(le=X.xmlCharKey)&&void 0!==le?le:Ie,me}return T(v,w),v.prototype.sendRequest=function(O){return g(this,void 0,void 0,function(){var H=this;return E(this,function(z){return[2,this._nextPolicy.sendRequest(O).then(function(X){return pn(H.jsonContentTypes,H.xmlContentTypes,X,{xmlCharKey:H.xmlCharKey})})]})})},v}(Mn);function pn(w,v,O,H){var z,X,le;void 0===H&&(H={});var me={rootName:null!==(z=H.rootName)&&void 0!==z?z:"",includeRoot:null!==(X=H.includeRoot)&&void 0!==X&&X,xmlCharKey:null!==(le=H.xmlCharKey)&&void 0!==le?le:Ie};return function(w,v,O,H){var z,X=function(Oe){var Je=new rt('Error "'+Oe+'" occurred while parsing the response body - '+O.bodyAsText+".",Oe.code||rt.PARSE_ERROR,O.status,O.request,O);return Promise.reject(Je)};if(!(null===(z=O.request.streamResponseStatusCodes)||void 0===z?void 0:z.has(O.status))&&!O.request.streamResponseBody&&O.bodyAsText){var me=O.bodyAsText,Re=O.headers.get("Content-Type")||"",we=Re?Re.split(";").map(function(Oe){return Oe.toLowerCase()}):[];if(0===we.length||we.some(function(Oe){return-1!==w.indexOf(Oe)}))return new Promise(function(Oe){O.parsedBody=JSON.parse(me),Oe(O)}).catch(X);if(we.some(function(Oe){return-1!==v.indexOf(Oe)}))return zr(me,H).then(function(Oe){return O.parsedBody=Oe,O}).catch(X)}return Promise.resolve(O)}(w,v,O,me).then(function(Re){if(!function(w){var v=w.request.shouldDeserialize;return void 0===v||("boolean"==typeof v?v:v(w))}(Re))return Re;var we=Re.request.operationSpec;if(!we||!we.responses)return Re;var Oe=function(w){var v,O=w.request,H=O.operationSpec;if(H){var z=O.operationResponseGetter;v=z?z(H,w):H.responses[w.status]}return v}(Re),_e=function(w,v,O){var H,z=200<=w.status&&w.status<300;if(function(w){var v=Object.keys(w.responses);return 0===v.length||1===v.length&&"default"===v[0]}(v)?z:O){if(!O)return{error:null,shouldReturnResponse:!1};if(!O.isError)return{error:null,shouldReturnResponse:!1}}var le=null!=O?O:v.responses.default,me=(null===(H=w.request.streamResponseStatusCodes)||void 0===H?void 0:H.has(w.status))||w.request.streamResponseBody,we=new rt(me?"Unexpected status code: "+w.status:w.bodyAsText,void 0,w.status,w.request,w);if(!le)throw we;var Oe=le.bodyMapper,_e=le.headersMapper;try{if(w.parsedBody){var He=w.parsedBody,Je=void 0;if(Oe){var nt=He;v.isXML&&Oe.type.name===Li.Sequence&&(nt="object"==typeof He?He[Oe.xmlElementName]:[]),Je=v.serializer.deserialize(Oe,nt,"error.response.parsedBody")}var ct=He.error||Je||He;we.code=ct.code,ct.message&&(we.message=ct.message),Oe&&(we.response.parsedBody=Je)}w.headers&&_e&&(we.response.parsedHeaders=v.serializer.deserialize(_e,w.headers.rawHeaders(),"operationRes.parsedHeaders"))}catch(pt){we.message='Error "'+pt.message+'" occurred in deserializing the responseBody - "'+w.bodyAsText+'" for the default response.'}return{error:we,shouldReturnResponse:!1}}(Re,we,Oe),He=_e.error;if(He)throw He;if(_e.shouldReturnResponse)return Re;if(Oe){if(Oe.bodyMapper){var nt=Re.parsedBody;we.isXML&&Oe.bodyMapper.type.name===Li.Sequence&&(nt="object"==typeof nt?nt[Oe.bodyMapper.xmlElementName]:[]);try{Re.parsedBody=we.serializer.deserialize(Oe.bodyMapper,nt,"operationRes.parsedBody",H)}catch(pt){throw new rt("Error "+pt+" occurred in deserializing the responseBody - "+Re.bodyAsText,void 0,Re.status,Re.request,Re)}}else"HEAD"===we.httpMethod&&(Re.parsedBody=O.status>=200&&O.status<300);Oe.headersMapper&&(Re.parsedHeaders=we.serializer.deserialize(Oe.headersMapper,Re.headers.rawHeaders(),"operationRes.parsedHeaders",H))}return Re})}function Wt(w){return"number"==typeof w}function Jn(w,v,O,H,z){return!!v(H,z)&&O.retryCount<w}function Ir(w,v,O){void 0===v&&(v={retryCount:0,retryInterval:0}),O&&(v.error&&(O.innerError=v.error),v.error=O),v.retryCount++;var H=Math.pow(2,v.retryCount-1)-1,z=.8*w.retryInterval+Math.floor(Math.random()*(.4*w.retryInterval));return v.retryInterval=Math.min(w.minRetryInterval+(H*=z),w.maxRetryInterval),v}function bn(w,v,O){return{create:function(H,z){return new Hi(H,z,w,v,O)}}}var Dr=(()=>{return(w=Dr||(Dr={}))[w.Exponential=0]="Exponential",Dr;var w})(),fn={maxRetries:3,retryDelayInMs:3e4,maxRetryDelayInMs:9e4},Hi=function(w){function v(O,H,z,X,le){var me=w.call(this,O,H)||this;return me.retryCount=Wt(z)?z:3,me.retryInterval=Wt(X)?X:3e4,me.maxRetryInterval=Wt(le)?le:9e4,me}return T(v,w),v.prototype.sendRequest=function(O){var H=this;return this._nextPolicy.sendRequest(O.clone()).then(function(z){return Vr(H,O,z)}).catch(function(z){return Vr(H,O,z.response,void 0,z)})},v}(Mn);function Vr(w,v,O,H,z){return g(this,void 0,void 0,function(){function X(Oe){var _e=null==Oe?void 0:Oe.status;return!(void 0===_e||_e<500&&408!==_e||501===_e||505===_e)}var le,me,Re;return E(this,function(Oe){switch(Oe.label){case 0:if(H=Ir({retryInterval:w.retryInterval,minRetryInterval:0,maxRetryInterval:w.maxRetryInterval},H,z),(le=v.abortSignal&&v.abortSignal.aborted)||!Jn(w.retryCount,X,H,O))return[3,6];Vi.info("Retrying request in "+H.retryInterval),Oe.label=1;case 1:return Oe.trys.push([1,4,,5]),[4,Ue(H.retryInterval)];case 2:return Oe.sent(),[4,w._nextPolicy.sendRequest(v.clone())];case 3:return me=Oe.sent(),[2,Vr(w,v,me,H)];case 4:return Re=Oe.sent(),[2,Vr(w,v,O,H,Re)];case 5:return[3,7];case 6:if(le||z||!O)throw H.error||new rt("Failed to send the request.",rt.REQUEST_SEND_ERROR,O&&O.status,O&&O.request,O);return[2,O];case 7:return[2]}})})}function Et(w){return void 0===w&&(w="x-ms-client-request-id"),{create:function(v,O){return new Bo(v,O,w)}}}var Bo=function(w){function v(O,H,z){var X=w.call(this,O,H)||this;return X._requestIdHeaderName=z,X}return T(v,w),v.prototype.sendRequest=function(O){return O.headers.contains(this._requestIdHeaderName)||O.headers.set(this._requestIdHeaderName,O.requestId),this._nextPolicy.sendRequest(O)},v}(Mn),hr={coreHttpVersion:"1.2.6",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",NO_PROXY:"NO_PROXY",ALL_PROXY:"ALL_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}};var Br=function(){return"x-ms-useragent"};function Fn(){var w=[{key:"core-http",value:hr.coreHttpVersion}],v=function(){var w=self.navigator;return[{key:"OS",value:(w.oscpu||w.platform).replace(" ","")}]}();return function(w,v,O){return void 0===v&&(v=" "),void 0===O&&(O="/"),w.map(function(H){return H.key+(H.value?""+O+H.value:"")}).join(v)}(w.concat(v))}function Yt(w){var v=w&&null!=w.key?w.key:"x-ms-useragent",O=w&&null!=w.value?w.value:Fn();return{create:function(H,z){return new ia(H,z,v,O)}}}var ia=function(w){function v(O,H,z,X){var le=w.call(this,O,H)||this;return le._nextPolicy=O,le._options=H,le.headerKey=z,le.headerValue=X,le}return T(v,w),v.prototype.sendRequest=function(O){return this.addUserAgentHeader(O),this._nextPolicy.sendRequest(O)},v.prototype.addUserAgentHeader=function(O){O.headers||(O.headers=new d),!O.headers.get(this.headerKey)&&this.headerValue&&O.headers.set(this.headerKey,this.headerValue)},v}(Mn),Gi=["GET","HEAD"],$i={handleRedirects:!0,maxRetries:20};function Wi(w){return void 0===w&&(w=20),{create:function(v,O){return new gi(v,O,w)}}}var gi=function(w){function v(O,H,z){void 0===z&&(z=20);var X=w.call(this,O,H)||this;return X.maxRetries=z,X}return T(v,w),v.prototype.sendRequest=function(O){var H=this;return this._nextPolicy.sendRequest(O).then(function(z){return go(H,z,0)})},v}(Mn);function go(w,v,O){var H=v.request,z=v.status,X=v.headers.get("location");if(X&&(300===z||301===z&&Gi.includes(H.method)||302===z&&Gi.includes(H.method)||303===z&&"POST"===H.method||307===z)&&(!w.maxRetries||O<w.maxRetries)){var le=ui.parse(H.url);return le.setPath(X),H.url=le.toString(),303===z&&(H.method="GET",delete H.body),w._nextPolicy.sendRequest(H).then(function(me){return go(w,me,O+1)})}return Promise.resolve(v)}var Dn=function(w){function v(O,H,z){void 0===z&&(z=30);var X=w.call(this,O,H)||this;return X._retryTimeout=z,X}return T(v,w),v.prototype.sendRequest=function(O){var H=this;return this._nextPolicy.sendRequest(O.clone()).then(function(z){return function(w,v,O){if(409===O.status){var H=function(w){var v,O;if(w){try{O=JSON.parse(w)}catch(z){}if(O&&O.error&&O.error.message&&O.error.code&&"MissingSubscriptionRegistration"===O.error.code){var H=O.error.message.match(/.*'(.*)'/i);H&&(v=H.pop())}}return v}(O.bodyAsText);if(H){var z=function(w){var O=w.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!O||!O[0])throw new Error("Unable to extract subscriptionId from the given url - "+w+".");return O[0]}(v.url);return function(w,v,O,H){var z=v+"providers/"+O+"/register?api-version=2016-02-01",X=v+"providers/"+O+"?api-version=2016-02-01",le=pr(H);return le.method="POST",le.url=z,w._nextPolicy.sendRequest(le).then(function(me){if(200!==me.status)throw new Error("Autoregistration of "+O+" failed. Please try registering manually.");return yo(w,X,H)})}(w,z,H,v).catch(function(){return!1}).then(function(X){return X?(v.headers.set("x-ms-client-request-id",qe()),w._nextPolicy.sendRequest(v.clone())):O})}}return Promise.resolve(O)}(H,O,z)})},v}(Mn);function pr(w,v){void 0===v&&(v=!1);var O=w.clone();return v&&(O.url=w.url),O.headers.set("x-ms-client-request-id",qe()),O.headers.set("Content-Type","application/json; charset=utf-8"),O}function yo(w,v,O){var H=pr(O);return H.url=v,H.method="GET",w._nextPolicy.sendRequest(H).then(function(z){var X=z.parsedBody;return!(!z.parsedBody||!X.registrationState||"Registered"!==X.registrationState)||Ue(1e3*w._retryTimeout).then(function(){return yo(w,v,O)})})}var ar={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function sa(w,v){var O=function(w,v,O){var H=this,z=null,X=null,le=l(l({},ar),O),me={get isRefreshing(){return null!==z},get shouldRefresh(){var we;return!me.isRefreshing&&(null!==(we=null==X?void 0:X.expiresOnTimestamp)&&void 0!==we?we:0)-le.refreshWindowInMs<Date.now()},get mustRefresh(){return null===X||X.expiresOnTimestamp-le.forcedRefreshWindowInMs<Date.now()}};function Re(we){var Oe;return me.isRefreshing||(z=function(w,v,O){return g(this,void 0,void 0,function(){function H(){return g(this,void 0,void 0,function(){var le;return E(this,function(me){switch(me.label){case 0:if(!(Date.now()<O))return[3,5];me.label=1;case 1:return me.trys.push([1,3,,4]),[4,w()];case 2:return[2,me.sent()];case 3:return me.sent(),[2,null];case 4:return[3,7];case 5:return[4,w()];case 6:if(null===(le=me.sent()))throw new Error("Failed to refresh access token.");return[2,le];case 7:return[2]}})})}var z;return E(this,function(X){switch(X.label){case 0:return[4,H()];case 1:z=X.sent(),X.label=2;case 2:return null!==z?[3,5]:[4,Ue(v)];case 3:return X.sent(),[4,H()];case 4:return z=X.sent(),[3,2];case 5:return[2,z]}})})}(function(){return w.getToken(v,we)},le.retryIntervalInMs,null!==(Oe=null==X?void 0:X.expiresOnTimestamp)&&void 0!==Oe?Oe:Date.now()).then(function(He){return z=null,X=He}).catch(function(He){throw z=null,X=null,He})),z}return function(we){return g(H,void 0,void 0,function(){return E(this,function(Oe){return me.mustRefresh?[2,Re(we)]:(me.shouldRefresh&&Re(we),[2,X])})})}}(w,v),H=function(z){function X(le,me){return z.call(this,le,me)||this}return T(X,z),X.prototype.sendRequest=function(le){return g(this,void 0,void 0,function(){var me;return E(this,function(Re){switch(Re.label){case 0:return[4,O({abortSignal:le.abortSignal,tracingOptions:{spanOptions:le.spanOptions,tracingContext:le.tracingContext}})];case 1:return me=Re.sent().token,le.headers.set(hr.HeaderConstants.AUTHORIZATION,"Bearer "+me),[2,this._nextPolicy.sendRequest(le)]}})})},X}(Mn);return{create:function(z,X){return new H(z,X)}}}function Es(w,v,O,H){return{create:function(z,X){return new Kc(z,X,w,v,O,H)}}}var Kc=function(w){function v(O,H,z,X,le,me){var Re=w.call(this,O,H)||this;return Re.retryCount=Wt(z)?z:3,Re.retryInterval=Wt(X)?X:3e4,Re.minRetryInterval=Wt(le)?le:3e3,Re.maxRetryInterval=Wt(me)?me:9e4,Re}return T(v,w),v.prototype.sendRequest=function(O){var H=this;return this._nextPolicy.sendRequest(O.clone()).catch(function(z){return wu(H,O,z.response,z)})},v}(Mn);function wu(w,v,O,H,z){return g(this,void 0,void 0,function(){function X(me,Re){return!(!Re||!Re.code||"ETIMEDOUT"!==Re.code&&"ESOCKETTIMEDOUT"!==Re.code&&"ECONNREFUSED"!==Re.code&&"ECONNRESET"!==Re.code&&"ENOENT"!==Re.code)}var le;return E(this,function(me){switch(me.label){case 0:if(z=Ir(w,z,H),!Jn(w.retryCount,X,z,O,H))return[3,5];me.label=1;case 1:return me.trys.push([1,3,,4]),[4,Ue(z.retryInterval)];case 2:return me.sent(),[2,w._nextPolicy.sendRequest(v.clone())];case 3:return le=me.sent(),[2,wu(w,v,O,le,z)];case 4:return[3,6];case 5:return H?[2,Promise.reject(z.error)]:[2,O];case 6:return[2]}})})}var Rr=(()=>{return(w=Rr||(Rr={})).Csv=",",w.Ssv=" ",w.Tsv="\t",w.Pipes="|",w.Multi="Multi",Rr;var w})(),Ho=new Error("ProxyPolicy is not supported in browser environment");function Qc(w){}function aa(w){return{create:function(v,O){throw Ho}}}!function(w){function v(O,H){throw w.call(this,O,H),Ho}T(v,w),v.prototype.sendRequest=function(O){throw Ho}}(Mn);var Jc=hr.HttpConstants.StatusCodes;function ua(){return{create:function(w,v){return new Yc(w,v)}}}var Yc=function(w){function v(O,H,z){var X=w.call(this,O,H)||this;return X._handleResponse=z||X._defaultResponseHandler,X}return T(v,w),v.prototype.sendRequest=function(O){return g(this,void 0,void 0,function(){var H=this;return E(this,function(z){return[2,this._nextPolicy.sendRequest(O.clone()).then(function(X){return X.status!==Jc.TooManyRequests?X:H._handleResponse(O,X)})]})})},v.prototype._defaultResponseHandler=function(O,H){return g(this,void 0,void 0,function(){var z,X,le=this;return E(this,function(me){return(z=H.headers.get(hr.HeaderConstants.RETRY_AFTER))&&(X=v.parseRetryAfterHeader(z))?[2,Ue(X).then(function(Re){return le._nextPolicy.sendRequest(O)})]:[2,H]})})},v.parseRetryAfterHeader=function(O){var H=Number(O);return Number.isNaN(H)?v.parseDateRetryAfterHeader(O):1e3*H},v.parseDateRetryAfterHeader=function(O){try{var H=Date.now(),X=Date.parse(O)-H;return Number.isNaN(X)?void 0:X}catch(le){return}},v}(Mn);function _s(w){return{create:function(v,O){return new Xc(v,O,w)}}}var Xc=function(w){function v(O,H,z){var X=w.call(this,O,H)||this;return X.authenticationProvider=z,X}return T(v,w),v.prototype.signRequest=function(O){return this.authenticationProvider.signRequest(O)},v.prototype.sendRequest=function(O){var H=this;return this.signRequest(O).then(function(z){return H._nextPolicy.sendRequest(z)})},v}(Mn),Iu={enable:!0};function ca(w){return{create:function(v,O){return new zi(v,O,w||Iu)}}}var vi,Ss,zi=function(w){function v(O,H,z){var X=w.call(this,O,H)||this;return X.keepAliveOptions=z,X}return T(v,w),v.prototype.sendRequest=function(O){return g(this,void 0,void 0,function(){return E(this,function(H){return O.keepAlive=this.keepAliveOptions.enable,[2,this._nextPolicy.sendRequest(O)]})})},v}(Mn),qo=function(){function w(){}return w.prototype.context=function(){return{spanId:"",traceId:"",traceFlags:0}},w.prototype.end=function(v){},w.prototype.setAttribute=function(v,O){return this},w.prototype.setAttributes=function(v){return this},w.prototype.addEvent=function(v,O){return this},w.prototype.setStatus=function(v){return this},w.prototype.updateName=function(v){return this},w.prototype.isRecording=function(){return!1},w.prototype.recordException=function(v,O){},w}(),Zc=function(){function w(){}return w.prototype.startSpan=function(v,O){return new qo},w.prototype.getCurrentSpan=function(){return new qo},w.prototype.withSpan=function(v,O){return O()},w.prototype.bind=function(v,O){return v},w}(),yi=Symbol.for("@azure/core-tracing.tracerCache3");function un(){var w=(vi||function(){var w=self,v=w[yi],O=!0;if(v)if(4===v.version)vi=v;else if(O=!1,v.tracer)throw new Error("Two incompatible versions of @azure/core-tracing have been loaded.\n          This library is 4, existing is "+v.version+".");vi||(vi={tracer:void 0,version:4}),O&&(w[yi]=vi)}(),vi);return w.tracer?w.tracer:(Ss||(Ss=new Zc),Ss)}var la=c(9803),Qr=(()=>{return(w=Qr||(Qr={}))[w.INTERNAL=0]="INTERNAL",w[w.SERVER=1]="SERVER",w[w.CLIENT=2]="CLIENT",w[w.PRODUCER=3]="PRODUCER",w[w.CONSUMER=4]="CONSUMER",Qr;var w})();function mr(w,v){return(0,la.setSpan)(w,v)}var Is=la.context,vo=(()=>{return(w=vo||(vo={}))[w.UNSET=0]="UNSET",w[w.OK=1]="OK",w[w.ERROR=2]="ERROR",vo;var w})();function Qi(w){return function(v,O){var H=un(),z=(null==O?void 0:O.tracingOptions)||{},X=l({kind:Qr.INTERNAL},z.spanOptions),me=H.startSpan(w.packagePrefix?w.packagePrefix+"."+v:v,X,z.tracingContext);w.namespace&&me.setAttribute("az.namespace",w.namespace);var Re=z.spanOptions||{};me.isRecording()&&w.namespace&&(Re=l(l({},z.spanOptions),{attributes:l(l({},X.attributes),{"az.namespace":w.namespace})}));var we=l(l({},z),{spanOptions:Re,tracingContext:mr(z.tracingContext||Is.active(),me)});return{span:me,updatedOptions:l(l({},O),{tracingOptions:we})}}}var da=Qi({packagePrefix:"",namespace:""});function Ds(w){return void 0===w&&(w={}),{create:function(v,O){return new yn(v,O,w)}}}var yn=function(w){function v(O,H,z){var X=w.call(this,O,H)||this;return X.userAgent=z.userAgent,X}return T(v,w),v.prototype.sendRequest=function(O){return g(this,void 0,void 0,function(){var H,z,X,le,me,Re,we,Oe;return E(this,function(_e){switch(_e.label){case 0:if(!O.tracingContext)return[2,this._nextPolicy.sendRequest(O)];H=ui.parse(O.url).getPath()||"/",(z=da(H,{tracingOptions:{spanOptions:l(l({},O.spanOptions),{kind:Qr.CLIENT}),tracingContext:O.tracingContext}}).span).setAttributes({"http.method":O.method,"http.url":O.url,requestId:O.requestId}),this.userAgent&&z.setAttribute("http.user_agent",this.userAgent),_e.label=1;case 1:return _e.trys.push([1,3,4,5]),X=z.context(),(le=function(w){var v=[];if(w.traceId||v.push("traceId"),w.spanId||v.push("spanId"),!v.length){var H=(w.traceFlags||0).toString(16);return"00-"+w.traceId+"-"+w.spanId+"-"+(1===H.length?"0"+H:H)}}(X))&&(O.headers.set("traceparent",le),(me=X.traceState&&X.traceState.serialize())&&O.headers.set("tracestate",me)),[4,this._nextPolicy.sendRequest(O)];case 2:return Re=_e.sent(),z.setAttribute("http.status_code",Re.status),(we=Re.headers.get("x-ms-request-id"))&&z.setAttribute("serviceRequestId",we),z.setStatus({code:vo.OK}),[2,Re];case 3:throw Oe=_e.sent(),z.setStatus({code:vo.ERROR,message:Oe.message}),z.setAttribute("http.status_code",Oe.statusCode),Oe;case 4:return z.end(),[7];case 5:return[2]}})})},v}(Mn),Rs=new Error("DisableResponseDecompressionPolicy is not supported in browser environment");function fa(){return{create:function(w,v){throw Rs}}}!function(w){function v(O,H){throw w.call(this,O,H),Rs}T(v,w),v.prototype.sendRequest=function(O){return g(this,void 0,void 0,function(){return E(this,function(H){throw Rs})})}}(Mn);var Jr,As=function(w){function v(O,H){return w.call(this,O,H)||this}return T(v,w),v.prototype.sendRequest=function(O){return g(this,void 0,void 0,function(){var H;return E(this,function(z){return"string"==typeof O.body&&O.body.startsWith("[")&&(H=JSON.parse(O.body),Array.isArray(H)&&(O.body=H.map(function(X){return JSON.stringify(X)+"\n"}).join(""))),[2,this._nextPolicy.sendRequest(O)]})})},v}(Mn),Go=URL,ha=function(){function w(v,O){var z,Re,we,Oe;if(O||(O={}),this._withCredentials=O.withCredentials||!1,this._httpClient=O.httpClient||(Jr||(Jr=new po),Jr),this._requestPolicyOptions=new rn(O.httpPipelineLogger),Array.isArray(O.requestPolicyFactories))Vi.info("ServiceClient: using custom request policies"),z=O.requestPolicyFactories;else{var X=void 0;if((0,Lr.c)(v))Vi.info("ServiceClient: creating bearer token authentication policy from provided credentials"),Re=void 0,we=this,Oe=O,X={create:function(_e,He){var Je=function(w,v){if(null==w?void 0:w.credentialScopes){var O=w.credentialScopes;return Array.isArray(O)?O.map(function(H){return new Go(H).toString()}):new Go(O).toString()}if(v)return v+"/.default"}(Oe,we.baseUri);if(!Je)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return null==Re&&(Re=sa(v,Je)),Re.create(_e,He)}};else if(v&&"function"==typeof v.signRequest)Vi.info("ServiceClient: creating signing policy from provided credentials"),X=_s(v);else if(null!=v)throw new Error("The credentials argument must implement the TokenCredential interface");if(Vi.info("ServiceClient: using default request policies"),z=function(w,v){var O=[];v.generateClientRequestIdHeader&&O.push(Et(v.clientRequestIdHeaderName)),w&&O.push(w);var H=Ar(v.userAgentHeaderName,Br),z=Ar(v.userAgent,Fn);return H&&z&&O.push(Yt({key:H,value:z})),O.push(Wi()),O.push(function(w){return void 0===w&&(w=30),{create:function(v,O){return new Dn(v,O,w)}}}(v.rpRegistrationRetryTimeout)),v.noRetryPolicy||(O.push(bn()),O.push(Es()),O.push(ua())),O.push(Uo(v.deserializationContentTypes)),We&&O.push(aa()),O.push(Lo({logger:Vi.info})),O}(X,O),O.requestPolicyFactories){var me=O.requestPolicyFactories(z);me&&(z=me)}}this._requestPolicyFactories=z}return w.prototype.sendRequest=function(v){if(null==v||"object"!=typeof v)throw new Error("options cannot be null or undefined and it must be of type object.");var O;try{!function(w){if(w&&"object"==typeof w){var v=w;if("string"==typeof v.url&&"string"==typeof v.method&&"object"==typeof v.headers&&_(v.headers)&&"function"==typeof v.validateRequestProperties&&"function"==typeof v.prepare&&"function"==typeof v.clone)return!0}return!1}(v)?O=(O=new fo).prepare(v):(v.validateRequestProperties(),O=v)}catch(X){return Promise.reject(X)}var H=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var z=this._requestPolicyFactories.length-1;z>=0;--z)H=this._requestPolicyFactories[z].create(H,this._requestPolicyOptions);return H.sendRequest(O)},w.prototype.sendOperationRequest=function(v,O,H){var z;return g(this,void 0,void 0,function(){var X,le,me,Re,we,Oe,_e,He,Je,nt,ct,pt,it,qt,yt,cn,wn,Rn,Sn,Cn,An,Xn,ln,Zt,kt,Bt,zt,jt,on,Zn,yr;return E(this,function(Kt){switch(Kt.label){case 0:"function"==typeof v.options&&(H=v.options,v.options=void 0),X=null===(z=v.options)||void 0===z?void 0:z.serializerOptions,le=new fo,Kt.label=1;case 1:if(Kt.trys.push([1,6,,7]),!(Re=O.baseUrl||this.baseUri))throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");if(le.method=O.httpMethod,le.operationSpec=O,we=ui.parse(Re),O.path&&we.appendPath(O.path),O.urlParameters&&O.urlParameters.length>0)for(Oe=0,_e=O.urlParameters;Oe<_e.length;Oe++)Je=Co(this,v,He=_e[Oe],O.serializer),Je=O.serializer.serialize(He.mapper,Je,Dt(He),X),He.skipEncoding||(Je=encodeURIComponent(Je)),we.replaceAll("{"+(He.mapper.serializedName||Dt(He))+"}",Je);if(O.queryParameters&&O.queryParameters.length>0)for(nt=0,ct=O.queryParameters;nt<ct.length;nt++)if(null!=(it=Co(this,v,pt=ct[nt],O.serializer))){if(it=O.serializer.serialize(pt.mapper,it,Dt(pt),X),null!=pt.collectionFormat)if(pt.collectionFormat===Rr.Multi){if(0===it.length)continue;for(yt in it)it[yt]=null==(qt=it[yt])?"":qt.toString()}else(pt.collectionFormat===Rr.Ssv||pt.collectionFormat===Rr.Tsv)&&(it=it.join(pt.collectionFormat));if(!pt.skipEncoding)if(Array.isArray(it))for(yt in it)null!=it[yt]&&(it[yt]=encodeURIComponent(it[yt]));else it=encodeURIComponent(it);null!=pt.collectionFormat&&pt.collectionFormat!==Rr.Multi&&pt.collectionFormat!==Rr.Ssv&&pt.collectionFormat!==Rr.Tsv&&(it=it.join(pt.collectionFormat)),we.setQueryParameter(pt.mapper.serializedName||Dt(pt),it)}if(le.url=we.toString(),(cn=O.contentType||this.requestContentType)&&O.requestBody&&le.headers.set("Content-Type",cn),O.headerParameters)for(wn=0,Rn=O.headerParameters;wn<Rn.length;wn++)if(null!=(Cn=Co(this,v,Sn=Rn[wn],O.serializer)))if(Cn=O.serializer.serialize(Sn.mapper,Cn,Dt(Sn),X),An=Sn.mapper.headerCollectionPrefix)for(Xn=0,ln=Object.keys(Cn);Xn<ln.length;Xn++)le.headers.set(An+(Zt=ln[Xn]),Cn[Zt]);else le.headers.set(Sn.mapper.serializedName||Dt(Sn),Cn);if(kt=v.options){if(kt.customHeaders)for(Bt in kt.customHeaders)le.headers.set(Bt,kt.customHeaders[Bt]);kt.abortSignal&&(le.abortSignal=kt.abortSignal),kt.timeout&&(le.timeout=kt.timeout),kt.onUploadProgress&&(le.onUploadProgress=kt.onUploadProgress),kt.onDownloadProgress&&(le.onDownloadProgress=kt.onDownloadProgress),kt.spanOptions&&(le.spanOptions=kt.spanOptions),kt.tracingContext&&(le.tracingContext=kt.tracingContext),null!=kt.shouldDeserialize&&(le.shouldDeserialize=kt.shouldDeserialize)}le.withCredentials=this._withCredentials,function(w,v,O,H){var z,X,le,me,Re,we,Oe=null!==(X=null===(z=O.options)||void 0===z?void 0:z.serializerOptions)&&void 0!==X?X:{},_e={rootName:null!==(le=Oe.rootName)&&void 0!==le?le:"",includeRoot:null!==(me=Oe.includeRoot)&&void 0!==me&&me,xmlCharKey:null!==(Re=Oe.xmlCharKey)&&void 0!==Re?Re:Ie},He=Oe.xmlCharKey;if(H.requestBody&&H.requestBody.mapper){v.body=Co(w,O,H.requestBody,H.serializer);var Je=H.requestBody.mapper,nt=Je.required,ct=Je.xmlName,pt=Je.xmlElementName,it=Je.serializedName,yt=Je.xmlNamespace,qt=Je.xmlNamespacePrefix,cn=Je.type.name;try{if(null!=v.body||nt){var wn=Dt(H.requestBody);v.body=H.serializer.serialize(Je,v.body,wn,_e);var Rn=cn===Li.Stream;if(H.isXML){var Sn=qt?"xmlns:"+qt:"xmlns",Cn=function(w,v,O,H,z){var X;if(w&&!["Composite","Sequence","Dictionary"].includes(O)){var le={};return le[z.xmlCharKey]=H,le[xe]=((X={})[v]=w,X),le}return H}(yt,Sn,cn,v.body,_e);cn===Li.Sequence?v.body=ji(function(w,v,O,H){var z,X,le;if(Array.isArray(w)||(w=[w]),!O||!H)return(z={})[v]=w,z;var me=((X={})[v]=w,X);return me[xe]=((le={})[O]=H,le),me}(Cn,pt||ct||it,Sn,yt),{rootName:ct||it,xmlCharKey:He}):Rn||(v.body=ji(Cn,{rootName:ct||it,xmlCharKey:He}))}else{if(cn===Li.String&&((null===(we=H.contentType)||void 0===we?void 0:we.match("text/plain"))||"text"===H.mediaType))return;Rn||(v.body=JSON.stringify(v.body))}}}catch(Bt){throw new Error('Error "'+Bt.message+'" occurred in serializing the payload - '+JSON.stringify(it,void 0,"  ")+".")}}else if(H.formDataParameters&&H.formDataParameters.length>0){v.formData={};for(var An=0,Xn=H.formDataParameters;An<Xn.length;An++){var ln=Xn[An],Zt=Co(w,O,ln,H.serializer);if(null!=Zt){var kt=ln.mapper.serializedName||Dt(ln);v.formData[kt]=H.serializer.serialize(ln.mapper,Zt,Dt(ln),_e)}}}}(this,le,v,O),void 0===le.streamResponseStatusCodes&&(le.streamResponseStatusCodes=function(w){var v=new Set;for(var O in w.responses){var H=w.responses[O];H.bodyMapper&&H.bodyMapper.type.name===Li.Stream&&v.add(Number(O))}return v}(O)),zt=void 0,jt=void 0,Kt.label=2;case 2:return Kt.trys.push([2,4,,5]),[4,this.sendRequest(le)];case 3:return zt=Kt.sent(),[3,5];case 4:return on=Kt.sent(),jt=on,[3,5];case 5:return jt?(jt.response&&(jt.details=At(jt.response,O.responses[jt.statusCode]||O.responses.default)),me=Promise.reject(jt)):me=Promise.resolve(At(zt,O.responses[zt.status])),[3,7];case 6:return Zn=Kt.sent(),me=Promise.reject(Zn),[3,7];case 7:return(yr=H)&&me.then(function(Nn){return yr(null,Nn._response.parsedBody,Nn._response.request,Nn._response)}).catch(function(Nn){return yr(Nn)}),[2,me]}})})},w}();function Ar(w,v){var O;return"string"==typeof w?O=w:(O=v(),"function"==typeof w&&(O=w(O))),O}function Ci(w,v){var O=[];w.sendStreamingJson&&O.push({create:function(w,v){return new As(w,v)}});var H=void 0;if(w.userAgentOptions&&w.userAgentOptions.userAgentPrefix){var z=[];z.push(w.userAgentOptions.userAgentPrefix);var X=Fn();-1===z.indexOf(X)&&z.push(X),H=z.join(" ")}var le=l(l({},Iu),w.keepAliveOptions),me=l(l({},fn),w.retryOptions),Re=l(l({},$i),w.redirectOptions);We&&O.push(aa());var we=l(l({},Vo),w.deserializationOptions),Oe=l({},w.loggingOptions);return O.push(Ds({userAgent:H}),ca(le),Yt({value:H}),Et(),Uo(we.expectedContentTypes),ua(),Es(),bn(me.maxRetries,me.retryDelayInMs,me.maxRetryDelayInMs)),Re.handleRedirects&&O.push(Wi(Re.maxRetries)),v&&O.push(v),O.push(Lo(Oe)),We&&!1===w.decompressResponse&&O.push(fa()),{httpClient:w.httpClient,requestPolicyFactories:O}}function Co(w,v,O,H){return Ps(w,v,O.parameterPath,O.mapper,H)}function Ps(w,v,O,H,z){var X,le;"string"==typeof O&&(O=[O]);var me=null===(X=v.options)||void 0===X?void 0:X.serializerOptions;if(Array.isArray(O)){if(O.length>0){if(H.isConstant)le=H.defaultValue;else{var Re=pa(v,O);Re.propertyFound||(Re=pa(w,O));var we=!1;Re.propertyFound||(we=H.required||"options"===O[0]&&2===O.length),le=we?H.defaultValue:Re.propertyValue}var Oe=ra(O,H);z.serialize(H,le,Oe,me)}}else for(var _e in H.required&&(le={}),O){var He=H.type.modelProperties[_e],Je=O[_e],nt=Ps(w,v,Je,He,z),ct=ra(Je,He);z.serialize(He,nt,ct,me),null!=nt&&(le||(le={}),le[_e]=nt)}return le}function pa(w,v){for(var O={propertyFound:!1},H=0;H<v.length;++H){var z=v[H];if(null==w||!(z in w))break;w=w[z]}return H===v.length&&(O.propertyValue=w,O.propertyFound=!0),O}function At(w,v){var O=w.parsedHeaders,H=v&&v.bodyMapper,z=function(nt){return Object.defineProperty(nt,"_response",{value:w})};if(H){var X=H.type.name;if("Stream"===X)return z(l(l({},O),{blobBody:w.blobBody,readableStreamBody:w.readableStreamBody}));var le="Composite"===X&&H.type.modelProperties||{},me=Object.keys(le).some(function(nt){return""===le[nt].serializedName});if("Sequence"===X||me){for(var Re=function(w,v,O){if(O||2===arguments.length)for(var X,H=0,z=v.length;H<z;H++)(X||!(H in v))&&(X||(X=Array.prototype.slice.call(v,0,H)),X[H]=v[H]);return w.concat(X||Array.prototype.slice.call(v))}([],w.parsedBody||[]),we=0,Oe=Object.keys(le);we<Oe.length;we++)le[_e=Oe[we]].serializedName&&(Re[_e]=w.parsedBody[_e]);if(O)for(var He=0,Je=Object.keys(O);He<Je.length;He++){var _e;Re[_e=Je[He]]=O[_e]}return z(Re),Re}if("Composite"===X||"Dictionary"===X)return z(l(l({},O),w.parsedBody))}return H||"HEAD"===w.request.method||function(w){return"object"!=typeof w&&"function"!=typeof w||null===w}(w.parsedBody)?z(l(l({},O),{body:w.parsedBody})):z(l(l({},O),w.parsedBody))}function tl(w){return Qi(w)}var je=function(){function w(v){void 0===v&&(v=12e4),this.cachedToken=void 0,this.tokenRefreshBufferMs=v}return w.prototype.setCachedToken=function(v){this.cachedToken=v},w.prototype.getCachedToken=function(){return this.cachedToken&&Date.now()+this.tokenRefreshBufferMs>=this.cachedToken.expiresOnTimestamp&&(this.cachedToken=void 0),this.cachedToken},w}(),gt=function(){function w(v,O,H){void 0===H&&(H=3e4),this.credential=v,this.scopes=O,this.requiredMillisecondsBeforeNewRefresh=H,this.lastCalled=0}return w.prototype.isReady=function(){return!this.lastCalled||Date.now()-this.lastCalled>this.requiredMillisecondsBeforeNewRefresh},w.prototype.getToken=function(v){return g(this,void 0,void 0,function(){var O;return E(this,function(H){switch(H.label){case 0:return this.lastCalled=Date.now(),[4,this.credential.getToken(this.scopes,v)];case 1:return O=H.sent(),this.promise=void 0,[2,O||void 0]}})})},w.prototype.refresh=function(v){return this.promise||(this.promise=this.getToken(v)),this.promise},w}(),jr=hr.HeaderConstants,Os=function(){function w(v,O,H){if(void 0===H&&(H="Basic"),this.authorizationScheme="Basic",null==v||"string"!=typeof v.valueOf())throw new Error("userName cannot be null or undefined and must be of type string.");if(null==O||"string"!=typeof O.valueOf())throw new Error("password cannot be null or undefined and must be of type string.");this.userName=v,this.password=O,this.authorizationScheme=H}return w.prototype.signRequest=function(v){var H=this.authorizationScheme+" "+function(w){return btoa(w)}(this.userName+":"+this.password);return v.headers||(v.headers=new d),v.headers.set(jr.AUTHORIZATION,H),Promise.resolve(v)},w}(),Yi=function(){function w(v){if(!v||v&&!v.inHeader&&!v.inQuery)throw new Error('options cannot be null or undefined. Either "inHeader" or "inQuery" property of the options object needs to be provided.');this.inHeader=v.inHeader,this.inQuery=v.inQuery}return w.prototype.signRequest=function(v){if(!v)return Promise.reject(new Error('webResource cannot be null or undefined and must be of type "object".'));if(this.inHeader)for(var O in v.headers||(v.headers=new d),this.inHeader)v.headers.set(O,this.inHeader[O]);if(this.inQuery){if(!v.url)return Promise.reject(new Error("url cannot be null in the request object."));for(var H in v.url.indexOf("?")<0&&(v.url+="?"),this.inQuery)v.url.endsWith("?")||(v.url+="&"),v.url+=H+"="+this.inQuery[H]}return Promise.resolve(v)},w}(),ur=function(w){function v(O){if(!O||O&&"string"!=typeof O)throw new Error("topicKey cannot be null or undefined and must be of type string.");return w.call(this,{inHeader:{"aeg-sas-key":O}})||this}return T(v,w),v}(Yi);c(3369)},7933:function(Q,u,c){"use strict";var s=this&&this.__spreadArrays||function(){for(var C=0,P=0,S=arguments.length;P<S;P++)C+=arguments[P].length;var f=Array(C),g=0;for(P=0;P<S;P++)for(var E=arguments[P],b=0,m=E.length;b<m;b++,g++)f[g]=E[b];return f};Object.defineProperty(u,"__esModule",{value:!0}),u.ContextAPI=void 0;var _=c(6061),d=c(6315),p="context",T=new _.NoopContextManager,l=function(){function C(){}return C.getInstance=function(){return this._instance||(this._instance=new C),this._instance},C.prototype.setGlobalContextManager=function(P){return d.registerGlobal(p,P),P},C.prototype.active=function(){return this._getContextManager().active()},C.prototype.with=function(P,S,f){for(var g,E=[],b=3;b<arguments.length;b++)E[b-3]=arguments[b];return(g=this._getContextManager()).with.apply(g,s([P,S,f],E))},C.prototype.bind=function(P,S){return void 0===S&&(S=this.active()),this._getContextManager().bind(P,S)},C.prototype._getContextManager=function(){return d.getGlobal(p)||T},C.prototype.disable=function(){this._getContextManager().disable(),d.unregisterGlobal(p)},C}();u.ContextAPI=l},8866:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.DiagAPI=void 0;var s=c(6091),_=c(8645),d=c(6315),T=function(){function l(){function C(S){return function(){var f=d.getGlobal("diag");if(f)return f[S].apply(f,arguments)}}var P=this;P.setLogger=function(S,f){var g;if(void 0===f&&(f=_.DiagLogLevel.INFO),S!==P)d.registerGlobal("diag",s.createLogLevelDiagLogger(f,S),!0);else{var E=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");P.error(null!==(g=E.stack)&&void 0!==g?g:E.message)}},P.disable=function(){d.unregisterGlobal("diag")},P.verbose=C("verbose"),P.debug=C("debug"),P.info=C("info"),P.warn=C("warn"),P.error=C("error")}return l.instance=function(){return this._instance||(this._instance=new l),this._instance},l}();u.DiagAPI=T},3112:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.PropagationAPI=void 0;var s=c(8038),_=c(5486),d=c(6315),p="propagation",T=function(){function l(){}return l.getInstance=function(){return this._instance||(this._instance=new l),this._instance},l.prototype.setGlobalPropagator=function(C){return d.registerGlobal(p,C),C},l.prototype.inject=function(C,P,S){return void 0===S&&(S=_.defaultTextMapSetter),this._getGlobalPropagator().inject(C,P,S)},l.prototype.extract=function(C,P,S){return void 0===S&&(S=_.defaultTextMapGetter),this._getGlobalPropagator().extract(C,P,S)},l.prototype.fields=function(){return this._getGlobalPropagator().fields()},l.prototype.disable=function(){d.unregisterGlobal(p)},l.prototype._getGlobalPropagator=function(){return d.getGlobal(p)||s.NOOP_TEXT_MAP_PROPAGATOR},l}();u.PropagationAPI=T},2159:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.TraceAPI=void 0;var s=c(7619),_=c(3710),d=c(6315),p="trace",T=function(){function l(){this._proxyTracerProvider=new s.ProxyTracerProvider,this.isSpanContextValid=_.isSpanContextValid}return l.getInstance=function(){return this._instance||(this._instance=new l),this._instance},l.prototype.setGlobalTracerProvider=function(C){return this._proxyTracerProvider.setDelegate(C),d.registerGlobal(p,this._proxyTracerProvider),this._proxyTracerProvider},l.prototype.getTracerProvider=function(){return d.getGlobal(p)||this._proxyTracerProvider},l.prototype.getTracer=function(C,P){return this.getTracerProvider().getTracer(C,P)},l.prototype.disable=function(){d.unregisterGlobal(p),this._proxyTracerProvider=new s.ProxyTracerProvider},l}();u.TraceAPI=T},1511:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},5532:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},3523:function(Q,u,c){"use strict";var s=this&&this.__createBinding||(Object.create?function(C,P,S,f){void 0===f&&(f=S),Object.defineProperty(C,f,{enumerable:!0,get:function(){return P[S]}})}:function(C,P,S,f){void 0===f&&(f=S),C[f]=P[S]}),_=this&&this.__exportStar||function(C,P){for(var S in C)"default"!==S&&!Object.prototype.hasOwnProperty.call(P,S)&&s(P,C,S)};Object.defineProperty(u,"__esModule",{value:!0}),u.baggageEntryMetadataFromString=u.createBaggage=void 0;var d=c(284),p=c(7181);_(c(1511),u),_(c(5532),u),u.createBaggage=function(C){return void 0===C&&(C={}),new d.BaggageImpl(new Map(Object.entries(C)))},u.baggageEntryMetadataFromString=function(C){return"string"!=typeof C&&(C=""),{__TYPE__:p.baggageEntryMetadataSymbol,toString:function(){return C}}}},284:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.BaggageImpl=void 0;var c=function(){function s(_){this._entries=_?new Map(_):new Map}return s.prototype.getEntry=function(_){var d=this._entries.get(_);if(d)return Object.assign({},d)},s.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(_){return[_[0],_[1]]})},s.prototype.setEntry=function(_,d){var p=new s(this._entries);return p._entries.set(_,d),p},s.prototype.removeEntry=function(_){var d=new s(this._entries);return d._entries.delete(_),d},s.prototype.removeEntries=function(){for(var _=[],d=0;d<arguments.length;d++)_[d]=arguments[d];for(var p=new s(this._entries),T=0,l=_;T<l.length;T++){var C=l[T];p._entries.delete(C)}return p},s.prototype.clear=function(){return new s},s}();u.BaggageImpl=c},7181:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.baggageEntryMetadataSymbol=void 0,u.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},1070:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},4904:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},6061:function(Q,u,c){"use strict";var s=this&&this.__spreadArrays||function(){for(var p=0,T=0,l=arguments.length;T<l;T++)p+=arguments[T].length;var C=Array(p),P=0;for(T=0;T<l;T++)for(var S=arguments[T],f=0,g=S.length;f<g;f++,P++)C[P]=S[f];return C};Object.defineProperty(u,"__esModule",{value:!0}),u.NoopContextManager=void 0;var _=c(4874),d=function(){function p(){}return p.prototype.active=function(){return _.ROOT_CONTEXT},p.prototype.with=function(T,l,C){for(var P=[],S=3;S<arguments.length;S++)P[S-3]=arguments[S];return l.call.apply(l,s([C],P))},p.prototype.bind=function(T,l){return T},p.prototype.enable=function(){return this},p.prototype.disable=function(){return this},p}();u.NoopContextManager=d},4874:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.ROOT_CONTEXT=u.createContextKey=u.setBaggage=u.getBaggage=u.isInstrumentationSuppressed=u.unsuppressInstrumentation=u.suppressInstrumentation=u.getSpanContext=u.setSpanContext=u.setSpan=u.getSpan=void 0;var s=c(5575),_=m("OpenTelemetry Context Key SPAN"),d=m("OpenTelemetry Context Key SUPPRESS_INSTRUMENTATION"),p=m("OpenTelemetry Baggage Key");function T(x){return x.getValue(_)||void 0}function l(x,N){return x.setValue(_,N)}function m(x){return Symbol.for(x)}u.getSpan=T,u.setSpan=l,u.setSpanContext=function(x,N){return l(x,new s.NoopSpan(N))},u.getSpanContext=function(x){var N;return null===(N=T(x))||void 0===N?void 0:N.context()},u.suppressInstrumentation=function(x){return x.setValue(d,!0)},u.unsuppressInstrumentation=function(x){return x.setValue(d,!1)},u.isInstrumentationSuppressed=function(x){return Boolean(x.getValue(d))},u.getBaggage=function(x){return x.getValue(p)||void 0},u.setBaggage=function(x,N){return x.setValue(p,N)},u.createContextKey=m,u.ROOT_CONTEXT=new function x(N){var F=this;F._currentContext=N?new Map(N):new Map,F.getValue=function(U){return F._currentContext.get(U)},F.setValue=function(U,k){var D=new x(F._currentContext);return D._currentContext.set(U,k),D},F.deleteValue=function(U){var k=new x(F._currentContext);return k._currentContext.delete(U),k}}},9611:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},1866:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.DiagConsoleLogger=void 0;var c=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];u.DiagConsoleLogger=function(){function d(T){return function(){var l=arguments;if(console){var C=console[T];if("function"!=typeof C&&(C=console.log),"function"==typeof C)return C.apply(console,l)}}}for(var p=0;p<c.length;p++)this[c[p].n]=d(c[p].c)}},2663:function(Q,u,c){"use strict";var s=this&&this.__createBinding||(Object.create?function(d,p,T,l){void 0===l&&(l=T),Object.defineProperty(d,l,{enumerable:!0,get:function(){return p[T]}})}:function(d,p,T,l){void 0===l&&(l=T),d[l]=p[T]}),_=this&&this.__exportStar||function(d,p){for(var T in d)"default"!==T&&!Object.prototype.hasOwnProperty.call(p,T)&&s(p,d,T)};Object.defineProperty(u,"__esModule",{value:!0}),_(c(1866),u),_(c(8645),u)},6091:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.createLogLevelDiagLogger=void 0;var s=c(8645);u.createLogLevelDiagLogger=function(d,p){function T(l,C){var P=p[l];return"function"==typeof P&&d>=C?P.bind(p):function(){}}return d<s.DiagLogLevel.NONE?d=s.DiagLogLevel.NONE:d>s.DiagLogLevel.ALL&&(d=s.DiagLogLevel.ALL),p=p||{},{error:T("error",s.DiagLogLevel.ERROR),warn:T("warn",s.DiagLogLevel.WARN),info:T("info",s.DiagLogLevel.INFO),debug:T("debug",s.DiagLogLevel.DEBUG),verbose:T("verbose",s.DiagLogLevel.VERBOSE)}}},8645:(Q,u)=>{"use strict";var s;Object.defineProperty(u,"__esModule",{value:!0}),u.DiagLogLevel=void 0,(s=u.DiagLogLevel||(u.DiagLogLevel={}))[s.NONE=0]="NONE",s[s.ERROR=30]="ERROR",s[s.WARN=50]="WARN",s[s.INFO=60]="INFO",s[s.DEBUG=70]="DEBUG",s[s.VERBOSE=80]="VERBOSE",s[s.ALL=9999]="ALL"},9803:function(Q,u,c){"use strict";var s=this&&this.__createBinding||(Object.create?function(P,S,f,g){void 0===g&&(g=f),Object.defineProperty(P,g,{enumerable:!0,get:function(){return S[f]}})}:function(P,S,f,g){void 0===g&&(g=f),P[g]=S[f]}),_=this&&this.__exportStar||function(P,S){for(var f in P)"default"!==f&&!Object.prototype.hasOwnProperty.call(S,f)&&s(S,P,f)};Object.defineProperty(u,"__esModule",{value:!0}),u.diag=u.propagation=u.trace=u.context=u.isValidSpanId=u.isValidTraceId=u.isSpanContextValid=u.INVALID_SPAN_CONTEXT=u.INVALID_TRACEID=u.INVALID_SPANID=void 0,_(c(3523),u),_(c(1070),u),_(c(4904),u),_(c(2663),u),_(c(8038),u),_(c(5486),u),_(c(1595),u),_(c(608),u),_(c(1987),u),_(c(282),u),_(c(1391),u),_(c(7215),u),_(c(670),u),_(c(7619),u),_(c(9094),u),_(c(2415),u),_(c(5815),u),_(c(9293),u),_(c(997),u),_(c(8700),u),_(c(3788),u),_(c(1189),u),_(c(7034),u),_(c(8757),u),_(c(3606),u),_(c(3426),u);var d=c(3710);Object.defineProperty(u,"INVALID_SPANID",{enumerable:!0,get:function(){return d.INVALID_SPANID}}),Object.defineProperty(u,"INVALID_TRACEID",{enumerable:!0,get:function(){return d.INVALID_TRACEID}}),Object.defineProperty(u,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return d.INVALID_SPAN_CONTEXT}}),Object.defineProperty(u,"isSpanContextValid",{enumerable:!0,get:function(){return d.isSpanContextValid}}),Object.defineProperty(u,"isValidTraceId",{enumerable:!0,get:function(){return d.isValidTraceId}}),Object.defineProperty(u,"isValidSpanId",{enumerable:!0,get:function(){return d.isValidSpanId}}),_(c(4874),u),_(c(6061),u),_(c(9611),u);var p=c(7933);u.context=p.ContextAPI.getInstance();var T=c(2159);u.trace=T.TraceAPI.getInstance();var l=c(3112);u.propagation=l.PropagationAPI.getInstance();var C=c(8866);u.diag=C.DiagAPI.instance(),u.default={trace:u.trace,context:u.context,propagation:u.propagation,diag:u.diag}},6315:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.unregisterGlobal=u.getGlobal=u.registerGlobal=void 0;var s=c(9803),_=c(7426),d=c(4288),p=c(600),T=d.VERSION.split(".")[0],l=Symbol.for("io.opentelemetry.js.api."+T),C=_._globalThis;u.registerGlobal=function(g,E,b){var m;void 0===b&&(b=!1),C[l]=null!==(m=C[l])&&void 0!==m?m:{version:d.VERSION};var I=C[l];if(b||!I[g])I.version===d.VERSION?I[g]=E:(x=new Error("@opentelemetry/api: All API registration versions must match"),s.diag.error(x.stack||x.message));else{var x=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+g);s.diag.error(x.stack||x.message)}},u.getGlobal=function(g){var E,b,m=null===(E=C[l])||void 0===E?void 0:E.version;if(m&&p.isCompatible(m))return null===(b=C[l])||void 0===b?void 0:b[g]},u.unregisterGlobal=function(g){var E=C[l];E&&delete E[g]}},600:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.isCompatible=u._makeCompatibilityCheck=void 0;var s=c(4288),_=/^(\d+)\.(\d+)\.(\d+)(?:-(.*))?$/;function d(p){var T=new Set([p]),l=new Set,C=p.match(_);if(!C)return function(){return!1};var P_major=+C[1],P_minor=+C[2],P_patch=+C[3];function S(g){return l.add(g),!1}function f(g){return T.add(g),!0}return function(E){if(T.has(E))return!0;if(l.has(E))return!1;var b=E.match(_);if(!b)return S(E);var m_minor=+b[2],m_patch=+b[3];return P_major!==+b[1]?S(E):0===P_major?P_minor===m_minor&&P_patch<=m_patch?f(E):S(E):P_minor<=m_minor?f(E):S(E)}}u._makeCompatibilityCheck=d,u.isCompatible=d(s.VERSION)},1775:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u._globalThis=void 0,u._globalThis="object"==typeof globalThis?globalThis:window},7426:function(Q,u,c){"use strict";var s=this&&this.__createBinding||(Object.create?function(d,p,T,l){void 0===l&&(l=T),Object.defineProperty(d,l,{enumerable:!0,get:function(){return p[T]}})}:function(d,p,T,l){void 0===l&&(l=T),d[l]=p[T]}),_=this&&this.__exportStar||function(d,p){for(var T in d)"default"!==T&&!Object.prototype.hasOwnProperty.call(p,T)&&s(p,d,T)};Object.defineProperty(u,"__esModule",{value:!0}),_(c(1775),u)},8038:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.NOOP_TEXT_MAP_PROPAGATOR=u.NoopTextMapPropagator=void 0;var c=function(){function s(){}return s.prototype.inject=function(_,d){},s.prototype.extract=function(_,d){return _},s.prototype.fields=function(){return[]},s}();u.NoopTextMapPropagator=c,u.NOOP_TEXT_MAP_PROPAGATOR=new c},5486:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.defaultTextMapSetter=u.defaultTextMapGetter=void 0,u.defaultTextMapGetter={get:function(c,s){if(null!=c)return c[s]},keys:function(c){return null==c?[]:Object.keys(c)}},u.defaultTextMapSetter={set:function(c,s,_){null!=c&&(c[s]=_)}}},608:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},5575:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.NoopSpan=void 0;var s=c(3710),_=function(){function d(p){void 0===p&&(p=s.INVALID_SPAN_CONTEXT),this._spanContext=p}return d.prototype.context=function(){return this._spanContext},d.prototype.setAttribute=function(p,T){return this},d.prototype.setAttributes=function(p){return this},d.prototype.addEvent=function(p,T){return this},d.prototype.setStatus=function(p){return this},d.prototype.updateName=function(p){return this},d.prototype.end=function(p){},d.prototype.isRecording=function(){return!1},d.prototype.recordException=function(p,T){},d}();u.NoopSpan=_},1391:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.NOOP_TRACER=u.NoopTracer=void 0;var s=c(4874),_=c(5575),d=c(3710),p=function(){function l(){}return l.prototype.startSpan=function(C,P,S){if(Boolean(null==P?void 0:P.root))return new _.NoopSpan;var g=S&&s.getSpanContext(S);return function(l){return"object"==typeof l&&"string"==typeof l.spanId&&"string"==typeof l.traceId&&"number"==typeof l.traceFlags}(g)&&d.isSpanContextValid(g)?new _.NoopSpan(g):new _.NoopSpan},l}();u.NoopTracer=p,u.NOOP_TRACER=new p},7215:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.NOOP_TRACER_PROVIDER=u.NoopTracerProvider=void 0;var s=c(1391),_=function(){function d(){}return d.prototype.getTracer=function(p,T){return s.NOOP_TRACER},d}();u.NoopTracerProvider=_,u.NOOP_TRACER_PROVIDER=new _},670:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.ProxyTracer=void 0;var s=c(1391),_=function(){function d(p,T,l){this._provider=p,this.name=T,this.version=l}return d.prototype.startSpan=function(p,T,l){return this._getTracer().startSpan(p,T,l)},d.prototype._getTracer=function(){if(this._delegate)return this._delegate;var p=this._provider.getDelegateTracer(this.name,this.version);return p?(this._delegate=p,this._delegate):s.NOOP_TRACER},d}();u.ProxyTracer=_},7619:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.ProxyTracerProvider=void 0;var s=c(670),_=c(7215),d=function(){function p(){}return p.prototype.getTracer=function(T,l){var C;return null!==(C=this.getDelegateTracer(T,l))&&void 0!==C?C:new s.ProxyTracer(this,T,l)},p.prototype.getDelegate=function(){var T;return null!==(T=this._delegate)&&void 0!==T?T:_.NOOP_TRACER_PROVIDER},p.prototype.setDelegate=function(T){this._delegate=T},p.prototype.getDelegateTracer=function(T,l){var C;return null===(C=this._delegate)||void 0===C?void 0:C.getTracer(T,l)},p}();u.ProxyTracerProvider=d},9094:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},2415:(Q,u)=>{"use strict";var s;Object.defineProperty(u,"__esModule",{value:!0}),u.SamplingDecision=void 0,(s=u.SamplingDecision||(u.SamplingDecision={}))[s.NOT_RECORD=0]="NOT_RECORD",s[s.RECORD=1]="RECORD",s[s.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"},8700:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},1189:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},1595:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},282:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},1987:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},997:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},5815:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},9293:(Q,u)=>{"use strict";var s;Object.defineProperty(u,"__esModule",{value:!0}),u.SpanKind=void 0,(s=u.SpanKind||(u.SpanKind={}))[s.INTERNAL=0]="INTERNAL",s[s.SERVER=1]="SERVER",s[s.CLIENT=2]="CLIENT",s[s.PRODUCER=3]="PRODUCER",s[s.CONSUMER=4]="CONSUMER"},3710:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.isSpanContextValid=u.isValidSpanId=u.isValidTraceId=u.INVALID_SPAN_CONTEXT=u.INVALID_TRACEID=u.INVALID_SPANID=void 0;var s=c(7034),_=/^([0-9a-f]{32})$/i,d=/^[0-9a-f]{16}$/i;function p(C){return _.test(C)&&C!==u.INVALID_TRACEID}function T(C){return d.test(C)&&C!==u.INVALID_SPANID}u.INVALID_SPANID="0000000000000000",u.INVALID_TRACEID="00000000000000000000000000000000",u.INVALID_SPAN_CONTEXT={traceId:u.INVALID_TRACEID,spanId:u.INVALID_SPANID,traceFlags:s.TraceFlags.NONE},u.isValidTraceId=p,u.isValidSpanId=T,u.isSpanContextValid=function(C){return p(C.traceId)&&T(C.spanId)}},3788:(Q,u)=>{"use strict";var s;Object.defineProperty(u,"__esModule",{value:!0}),u.SpanStatusCode=void 0,(s=u.SpanStatusCode||(u.SpanStatusCode={}))[s.UNSET=0]="UNSET",s[s.OK=1]="OK",s[s.ERROR=2]="ERROR"},7034:(Q,u)=>{"use strict";var s;Object.defineProperty(u,"__esModule",{value:!0}),u.TraceFlags=void 0,(s=u.TraceFlags||(u.TraceFlags={}))[s.NONE=0]="NONE",s[s.SAMPLED=1]="SAMPLED"},8757:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},3426:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},3606:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0})},4288:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.VERSION=void 0,u.VERSION="1.0.0-rc.0"},3369:()=>{"use strict";(void 0===typeof Symbol||!Symbol.asyncIterator)&&(Symbol.asyncIterator=Symbol.for("Symbol.asyncIterator"))},434:(Q,u,c)=>{"use strict";function s(_){return _&&"function"==typeof _.getToken&&(void 0===_.signRequest||_.getToken.length>0)}c.d(u,{c:()=>s})},6354:(Q,u,c)=>{"use strict";c.d(u,{v:()=>S});var s=c(8239),_=c(1126),d=c(8006),p=c(969);const T={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function C(){return(C=(0,s.Z)(function*(f,g,E){function b(){return m.apply(this,arguments)}function m(){return(m=(0,s.Z)(function*(){if(!(Date.now()<E)){const x=yield f();if(null===x)throw new Error("Failed to refresh access token.");return x}try{return yield f()}catch(x){return null}})).apply(this,arguments)}let I=yield b();for(;null===I;)yield(0,p.g)(g),I=yield b();return I})).apply(this,arguments)}function S(f,g){const E=function(f,g,E){let b=null,m=null;const I=Object.assign(Object.assign({},T),E),x={get isRefreshing(){return null!==b},get shouldRefresh(){var F;return!x.isRefreshing&&(null!==(F=null==m?void 0:m.expiresOnTimestamp)&&void 0!==F?F:0)-I.refreshWindowInMs<Date.now()},get mustRefresh(){return null===m||m.expiresOnTimestamp-I.forcedRefreshWindowInMs<Date.now()}};function N(F){var U;return x.isRefreshing||(b=function(f,g,E){return C.apply(this,arguments)}(()=>f.getToken(g,F),I.retryIntervalInMs,null!==(U=null==m?void 0:m.expiresOnTimestamp)&&void 0!==U?U:Date.now()).then(D=>(b=null,m=D,m)).catch(D=>{throw b=null,m=null,D})),b}return function(){var F=(0,s.Z)(function*(U){return x.mustRefresh?N(U):(x.shouldRefresh&&N(U),m)});return function(U){return F.apply(this,arguments)}}()}(f,g);class b extends _.U{constructor(I,x){super(I,x)}sendRequest(I){var x=this;return(0,s.Z)(function*(){if(!I.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");const{token:N}=yield E({abortSignal:I.abortSignal,tracingOptions:{tracingContext:I.tracingContext}});return I.headers.set(d.g.HeaderConstants.AUTHORIZATION,`Bearer ${N}`),x._nextPolicy.sendRequest(I)})()}}return{create:(m,I)=>new b(m,I)}}},1126:(Q,u,c)=>{"use strict";c.d(u,{U:()=>_,_:()=>d});var s=(()=>{return(p=s||(s={}))[p.OFF=0]="OFF",p[p.ERROR=1]="ERROR",p[p.WARNING=2]="WARNING",p[p.INFO=3]="INFO",s;var p})();class _{constructor(T,l){this._nextPolicy=T,this._options=l}shouldLog(T){return this._options.shouldLog(T)}log(T,l){this._options.log(T,l)}}class d{constructor(T){this._logger=T}shouldLog(T){return!!this._logger&&T!==s.OFF&&T<=this._logger.minimumLogLevel}log(T,l){this._logger&&this.shouldLog(T)&&this._logger.log(T,l)}}},369:(Q,u,c)=>{"use strict";c.d(u,{$4:()=>_,UK:()=>d});var s=c(7694);class _{constructor(){this._rawQuery={}}any(){return Object.keys(this._rawQuery).length>0}keys(){return Object.keys(this._rawQuery)}set(M,j){const W=j;if(M)if(null!=W){const $=Array.isArray(W)?W:W.toString();this._rawQuery[M]=$}else delete this._rawQuery[M]}get(M){return M?this._rawQuery[M]:void 0}toString(){let M="";for(const j in this._rawQuery){M&&(M+="&");const W=this._rawQuery[j];if(Array.isArray(W)){const $=[];for(const ce of W)$.push(`${j}=${ce}`);M+=$.join("&")}else M+=`${j}=${W}`}return M}static parse(M){const j=new _;if(M){M.startsWith("?")&&(M=M.substring(1));let W="ParameterName",$="",ce="";for(let oe=0;oe<M.length;++oe){const Z=M[oe];switch(W){case"ParameterName":switch(Z){case"=":W="ParameterValue";break;case"&":$="",ce="";break;default:$+=Z}break;case"ParameterValue":switch(Z){case"&":j.set($,ce),$="",ce="",W="ParameterName";break;default:ce+=Z}break;default:throw new Error("Unrecognized URLQuery parse state: "+W)}}"ParameterValue"===W&&j.set($,ce)}return j}}class d{setScheme(M){M?this.set(M,"SCHEME"):this._scheme=void 0}getScheme(){return this._scheme}setHost(M){M?this.set(M,"SCHEME_OR_HOST"):this._host=void 0}getHost(){return this._host}setPort(M){null==M||""===M?this._port=void 0:this.set(M.toString(),"PORT")}getPort(){return this._port}setPath(M){if(M){const j=M.indexOf("://");if(-1!==j){const W=M.lastIndexOf("/",j);this.set(-1===W?M:M.substr(W+1),"SCHEME")}else this.set(M,"PATH")}else this._path=void 0}appendPath(M){if(M){let j=this.getPath();j&&(j.endsWith("/")||(j+="/"),M.startsWith("/")&&(M=M.substring(1)),M=j+M),this.set(M,"PATH")}}getPath(){return this._path}setQuery(M){this._query=M?_.parse(M):void 0}setQueryParameter(M,j){M&&(this._query||(this._query=new _),this._query.set(M,j))}getQueryParameterValue(M){return this._query?this._query.get(M):void 0}getQuery(){return this._query?this._query.toString():void 0}set(M,j){const W=new l(M,j);for(;W.next();){const $=W.current();let ce;if($)switch($.type){case"SCHEME":this._scheme=$.text||void 0;break;case"HOST":this._host=$.text||void 0;break;case"PORT":this._port=$.text||void 0;break;case"PATH":ce=$.text||void 0,(!this._path||"/"===this._path||"/"!==ce)&&(this._path=ce);break;case"QUERY":this._query=_.parse($.text);break;default:throw new Error(`Unrecognized URLTokenType: ${$.type}`)}}}toString(){let M="";return this._scheme&&(M+=`${this._scheme}://`),this._host&&(M+=this._host),this._port&&(M+=`:${this._port}`),this._path&&(this._path.startsWith("/")||(M+="/"),M+=this._path),this._query&&this._query.any()&&(M+=`?${this._query.toString()}`),M}replaceAll(M,j){M&&(this.setScheme((0,s.ko)(this.getScheme(),M,j)),this.setHost((0,s.ko)(this.getHost(),M,j)),this.setPort((0,s.ko)(this.getPort(),M,j)),this.setPath((0,s.ko)(this.getPath(),M,j)),this.setQuery((0,s.ko)(this.getQuery(),M,j)))}static parse(M){const j=new d;return j.set(M,"SCHEME_OR_HOST"),j}}class p{constructor(M,j){this.text=M,this.type=j}static scheme(M){return new p(M,"SCHEME")}static host(M){return new p(M,"HOST")}static port(M){return new p(M,"PORT")}static path(M){return new p(M,"PATH")}static query(M){return new p(M,"QUERY")}}class l{constructor(M,j){this._text=M,this._textLength=M?M.length:0,this._currentState=null!=j?j:"SCHEME_OR_HOST",this._currentIndex=0}current(){return this._currentToken}next(){if(P(this))switch(this._currentState){case"SCHEME":!function(D){const M=function(D){return E(D,M=>function(D){const M=D.charCodeAt(0);return 48<=M&&M<=57||65<=M&&M<=90||97<=M&&M<=122}(M))}(D);D._currentToken=p.scheme(M),D._currentState=P(D)?"HOST":"DONE"}(this);break;case"SCHEME_OR_HOST":!function(D){const M=m(D,":","/","?");P(D)?":"===S(D)?"://"===g(D,3)?(D._currentToken=p.scheme(M),D._currentState="HOST"):(D._currentToken=p.host(M),D._currentState="PORT"):(D._currentToken=p.host(M),D._currentState="/"===S(D)?"PATH":"QUERY"):(D._currentToken=p.host(M),D._currentState="DONE")}(this);break;case"HOST":!function(D){"://"===g(D,3)&&f(D,3);const M=m(D,":","/","?");D._currentToken=p.host(M),D._currentState=P(D)?":"===S(D)?"PORT":"/"===S(D)?"PATH":"QUERY":"DONE"}(this);break;case"PORT":!function(D){":"===S(D)&&f(D);const M=m(D,"/","?");D._currentToken=p.port(M),D._currentState=P(D)?"/"===S(D)?"PATH":"QUERY":"DONE"}(this);break;case"PATH":!function(D){const M=m(D,"?");D._currentToken=p.path(M),D._currentState=P(D)?"QUERY":"DONE"}(this);break;case"QUERY":!function(D){"?"===S(D)&&f(D);const M=function(D){let M="";return D._currentIndex<D._textLength&&(M=D._text.substring(D._currentIndex),D._currentIndex=D._textLength),M}(D);D._currentToken=p.query(M),D._currentState="DONE"}(this);break;default:throw new Error(`Unrecognized URLTokenizerState: ${this._currentState}`)}else this._currentToken=void 0;return!!this._currentToken}}function P(D){return D._currentIndex<D._textLength}function S(D){return D._text[D._currentIndex]}function f(D,M){P(D)&&(M||(M=1),D._currentIndex+=M)}function g(D,M){let j=D._currentIndex+M;return D._textLength<j&&(j=D._textLength),D._text.substring(D._currentIndex,j)}function E(D,M){let j="";for(;P(D);){const W=S(D);if(!M(W))break;j+=W,f(D)}return j}function m(D,...M){return E(D,j=>-1===M.indexOf(j))}},8006:(Q,u,c)=>{"use strict";c.d(u,{g:()=>s});const s={coreHttpVersion:"2.2.1",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",NO_PROXY:"NO_PROXY",ALL_PROXY:"ALL_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429,ServiceUnavailable:503}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}}},969:(Q,u,c)=>{"use strict";c.d(u,{g:()=>p});var _=c(4637);function p(T,l,C){return new Promise((P,S)=>{let f,g;const E=()=>S(new _._((null==C?void 0:C.abortErrorMsg)?null==C?void 0:C.abortErrorMsg:"The operation was aborted.")),b=()=>{(null==C?void 0:C.abortSignal)&&g&&C.abortSignal.removeEventListener("abort",g)};if(g=()=>(function(T){return null!=T}(f)&&clearTimeout(f),b(),E()),(null==C?void 0:C.abortSignal)&&C.abortSignal.aborted)return E();f=setTimeout(()=>{b(),P(l)},T),(null==C?void 0:C.abortSignal)&&C.abortSignal.addEventListener("abort",g)})}},4510:(Q,u,c)=>{"use strict";c.d(u,{c:()=>s,I:()=>_});const s="$",_="_"},7694:(Q,u,c)=>{"use strict";c.d(u,{Rl:()=>D,_9:()=>Z,UG:()=>I,Kn:()=>se,ty:()=>he,TP:()=>k,WQ:()=>$,ko:()=>ue});var s,_=new Uint8Array(16);function d(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(_)}const p=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function(K){return"string"==typeof K&&p.test(K)};for(var C=[],P=0;P<256;++P)C.push((P+256).toString(16).substr(1));const E=function(K,pe,re){var J=(K=K||{}).random||(K.rng||d)();if(J[6]=15&J[6]|64,J[8]=63&J[8]|128,pe){re=re||0;for(var ne=0;ne<16;++ne)pe[re+ne]=J[ne];return pe}return function(K){var pe=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,re=(C[K[pe+0]]+C[K[pe+1]]+C[K[pe+2]]+C[K[pe+3]]+"-"+C[K[pe+4]]+C[K[pe+5]]+"-"+C[K[pe+6]]+C[K[pe+7]]+"-"+C[K[pe+8]]+C[K[pe+9]]+"-"+C[K[pe+10]]+C[K[pe+11]]+C[K[pe+12]]+C[K[pe+13]]+C[K[pe+14]]+C[K[pe+15]]).toLowerCase();if(!l(re))throw TypeError("Stringified UUID is invalid");return re}(J)};var b=c(4510);const m=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,I="undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node;function k(K){return m.test(K)}function D(){return E()}function $(K,pe,re,J){if(Array.isArray(K)||(K=[K]),!re||!J)return{[pe]:K};const ne={[pe]:K};return ne[b.c]={[re]:J},ne}const oe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Z(K){return oe.test(K)}function ue(K,pe,re){return K&&pe?K.split(pe).join(re||""):K}function he(K){return"object"!=typeof K&&"function"!=typeof K||null===K}function se(K){return!("object"!=typeof K||null===K||Array.isArray(K)||K instanceof RegExp||K instanceof Date)}},1326:(Q,u,c)=>{"use strict";c.d(u,{YR:()=>j});const _="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let d,p=[],T=[];const l=[];_&&P(_);const C=Object.assign(Z=>g(Z),{enable:P,enabled:S,disable:function(){const Z=d||"";return P(""),Z},log:function(...Z){if(Z.length>0){const ue=String(Z[0]);ue.includes(":error")?console.error(...Z):ue.includes(":warning")?console.warn(...Z):ue.includes(":info")?console.info(...Z):(ue.includes(":verbose"),console.debug(...Z))}}});function P(Z){d=Z,p=[],T=[];const ue=/\*/g,he=Z.split(",").map(Ee=>Ee.trim().replace(ue,".*?"));for(const Ee of he)Ee.startsWith("-")?T.push(new RegExp(`^${Ee.substr(1)}$`)):p.push(new RegExp(`^${Ee}$`));for(const Ee of l)Ee.enabled=S(Ee.namespace)}function S(Z){if(Z.endsWith("*"))return!0;for(const ue of T)if(ue.test(Z))return!1;for(const ue of p)if(ue.test(Z))return!0;return!1}function g(Z){const ue=Object.assign(function(...Ee){!ue.enabled||(Ee.length>0&&(Ee[0]=`${Z} ${Ee[0]}`),ue.log(...Ee))},{enabled:S(Z),destroy:E,log:C.log,namespace:Z,extend:b});return l.push(ue),ue}function E(){const Z=l.indexOf(this);return Z>=0&&(l.splice(Z,1),!0)}function b(Z){const ue=g(`${this.namespace}:${Z}`);return ue.log=this.log,ue}const m=C,I=new Set,x="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let N;const F=m("azure");F.log=(...Z)=>{m.log(...Z)};const U=["verbose","info","warning","error"];x&&(oe(x)?function(Z){if(Z&&!oe(Z))throw new Error(`Unknown log level '${Z}'. Acceptable values: ${U.join(",")}`);N=Z;const ue=[];for(const he of I)ce(he)&&ue.push(he.namespace);m.enable(ue.join(","))}(x):console.error(`AZURE_LOG_LEVEL set to unknown log level '${x}'; logging is not enabled. Acceptable values: ${U.join(", ")}.`));const M={verbose:400,info:300,warning:200,error:100};function j(Z){const ue=F.extend(Z);return W(F,ue),{error:$(ue,"error"),warning:$(ue,"warning"),info:$(ue,"info"),verbose:$(ue,"verbose")}}function W(Z,ue){ue.log=(...he)=>{Z.log(...he)}}function $(Z,ue){const he=Object.assign(Z.extend(ue),{level:ue});if(W(Z,he),ce(he)){const Ee=m.disable();m.enable(Ee+","+he.namespace)}return I.add(he),he}function ce(Z){return!!(N&&M[Z.level]<=M[N])}function oe(Z){return U.includes(Z)}},5413:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(1819)),p=c(2e3),T=function l(){(0,_.default)(this,l)};u.default=T,(0,d.default)(T,"requiredOmnichannelConfigurationParameters",["orgUrl","orgId","widgetId"]),(0,d.default)(T,"defaultHeaders",{"Content-Type":"application/json"}),(0,d.default)(T,"bypassCacheHeaders",{"cache-control":"no-store, must-revalidate, no-cache"}),(0,d.default)(T,"defaultChannelId",p.ChannelId.LCW),(0,d.default)(T,"defaultLocale","en-us"),(0,d.default)(T,"noContentStatusCode",204),(0,d.default)(T,"sensitiveProperties",["AuthenticatedUserToken"]),(0,d.default)(T,"transactionid","transaction-id"),(0,d.default)(T,"customerDisplayName","customerDisplayName")},2e3:(Q,u)=>{"use strict";var c,C,s,_,d,p,T,l;Object.defineProperty(u,"__esModule",{value:!0}),u.LiveChatVersion=u.OCSDKTelemetryEvent=u.ChannelId=u.OperatingSystem=u.DeviceType=u.Browser=u.BrowserVendor=void 0,u.BrowserVendor=c,(C=c||(u.BrowserVendor=c={})).IE="IE",C.CHROME="Chrome",C.FIREFOX="Firefox",C.SAFARI="Safari",C.EDGE="Edge",C.EDGE_CHROMIUM="Edg",C.OPERA="Opera",C.UNKNOWN="Unknown",u.Browser=s,function(C){C[C.Chrome=0]="Chrome",C[C.Firefox=1]="Firefox",C[C.Ie=2]="Ie",C[C.Edge=3]="Edge",C[C.Safari=4]="Safari",C[C.None=5]="None"}(s||(u.Browser=s={})),u.DeviceType=_,function(C){C.Desktop="Desktop",C.Mobile="Mobile",C.Tablet="Tablet"}(_||(u.DeviceType=_={})),u.OperatingSystem=d,function(C){C.WINDOWS="Windows",C.MACOSX="Mac OS X",C.WINDOWS_PHONE="Windows Phone",C.WINDOWS_RT="Windows RT",C.IOS="iOS",C.ANDROID="Android",C.LINUX="Linux",C.UNKNOWN="Unknown"}(d||(u.OperatingSystem=d={})),u.ChannelId=p,function(C){C.LCW="lcw",C.SMS="sms",C.FACEBOOK="facebook",C.WECHAT="wechat"}(p||(u.ChannelId=p={})),u.OCSDKTelemetryEvent=T,function(C){C.GETCHATCONFIG="GetChatConfig",C.GETCHATCONFIGSUCCESS="GetChatConfigSucceeded",C.GETRECONNECTABLECHATS="GetReconnnectableChats",C.GETRECONNECTAVAILABILITY="GetReconnnectableAvailability",C.GETCHATTOKENSTARTED="GetChatTokenStarted",C.GETCHATTOKENSUCCEEDED="GetChatTokenSucceeded",C.GETCHATTOKENFAILED="GetChatTokenFailed",C.GETLWISTATUSSTARTED="GetLwiStatusStarted",C.GETLWISTATUSSUCCEEDED="GetLwiStatusSucceeded",C.GETLWISTATUSFAILED="GetLwiStatusFailed",C.SESSIONINITSTARTED="SessionInitStarted",C.SESSIONINITSUCCEEDED="SessionInitSucceeded",C.SESSIONINITFAILED="SessionInitFailed",C.SESSIONCLOSESTARTED="SessionCloseStarted",C.SESSIONCLOSESUCCEEDED="SessionCloseSucceeded",C.SESSIONCLOSEFAILED="SessionCloseFailed",C.SUBMITPOSTCHATSTARTED="SubmitPostChatStarted",C.SUBMITPOSTCHATSUCCEEDED="SubmitPostChatSucceeded",C.SUBMITPOSTCHATFAILED="SubmitPostChatFailed",C.GETCHATTRANSCRIPTSTARTED="GetChatTranscriptStarted",C.GETCHATTRANSCRIPTSUCCEEDED="GetChatTranscriptSucceeded",C.GETCHATTRANSCRIPTFAILED="GetChatTranscriptFailed",C.EMAILTRANSCRIPTSTARTED="EmailTranscriptStarted",C.EMAILTRANSCRIPTSUCCEEDED="EmailTranscriptSucceeded",C.EMAILTRANSCRIPTFAILED="EmailTranscriptFailed",C.FETCHDATAMASKINGSTARTED="FetchDataMaskingStarted",C.FETCHDATAMASKINGSUCCEEDED="FetchDataMaskingSucceeded",C.FETCHDATAMASKINGFAILED="FetchDataMaskingFailed",C.SECONDARYCHANNELEVENTREQUESTSTARTED="SecondaryChannelEventRequestStarted",C.SECONDARYCHANNELEVENTREQUESTSUCCEEDED="SecondaryChannelEventRequestSucceeded",C.SECONDARYCHANNELEVENTREQUESTFAILED="SecondaryChannelEventRequestFailed",C.GETSURVEYINVITELINKSTARTED="GetSurveyInviteLinkStarted",C.GETSURVEYINVITELINKSUCCEEDED="GetSurveyInviteLinkSucceeded",C.GETSURVEYINVITELINKFAILED="GetSurveyInviteLinkFailed",C.VALIDATEAUTHCHATRECORDSTARTED="ValidateAuthChatRecordStarted",C.VALIDATEAUTHCHATRECORDSUCCEEDED="ValidateAuthChatRecordSucceeded",C.VALIDATEAUTHCHATRECORDFAILED="ValidateAuthChatRecordFailed",C.GETQUEUEAVAILABILITYSTARTED="GetQueueAvailabilityStarted",C.GETQUEUEAVAILABILITYSUCCEEDED="GetQueueAvailabilitySucceeded",C.GETQUEUEAVAILABILITYFAILED="GetQueueAvailabilityFailed",C.SENDTYPINGINDICATORFAILED="SendTypingIndicatorFailed",C.SENDTYPINGINDICATORSUCCEEDED="SendTypingIndicatorSucceeded"}(T||(u.OCSDKTelemetryEvent=T={})),u.LiveChatVersion=l,function(C){C[C.V1=1]="V1",C[C.V2=2]="V2"}(l||(u.LiveChatVersion=l={}))},3096:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(2805));u.default=function(){function T(){(0,_.default)(this,T)}return(0,d.default)(T,null,[{key:"OCSDKLOAD",get:function(){return"oc:sdk:load"}}]),T}()},4950:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(1819)),p=function T(){(0,_.default)(this,T)};u.default=p,(0,d.default)(p,"supportedLocales",["ar-sa","bg-bg","ca-es","cs-cz","da-dk","de-de","el-gr","en-us","es-es","et-ee","eu-es","fi-fi","fr-fr","gl-es","he-il","hi-in","hr-hr","hu-hu","id-id","it-it","ja-jp","kk-kz","ko-kr","lt-lt","lv-lv","ms-my","nb-no","nl-nl","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sr-cyrl-cs","sr-latn-cs","sv-se","th-th","tr-tr","uk-ua","vi-vn","zh-cn","zh-hk","zh-tw"])},4162:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(2805)),p=s(c(1819)),T=s(c(7276));u.default=function(){function C(P){(0,_.default)(this,C),(0,p.default)(this,"logger",void 0),this.logger=P}return(0,d.default)(C,[{key:"log",value:function(S,f,g,E){if(this.isLoggingEnabled()){var b=T.default.GETTELEMETRYEVENTDATA(f,g,E);this.logEvent(S,b)}}},{key:"logEvent",value:function(S,f){this.isLoggingEnabled()&&setTimeout(this.logger.logClientSdkTelemetryEvent.bind(this.logger),0,S,f)}},{key:"isLoggingEnabled",value:function(){return!this.isNullOrUndefined(this.logger)}},{key:"isNullOrUndefined",value:function(S){return null==S}}]),C}()},2172:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(1819)),p=function T(){(0,_.default)(this,T)};u.default=p,(0,d.default)(p,"LiveChatConfigPath","livechatconnector/config"),(0,d.default)(p,"LiveChatSessionInitPath","livechatconnector/sessioninit"),(0,d.default)(p,"LiveChatAuthSessionInitPath","livechatconnector/auth/sessioninit"),(0,d.default)(p,"LiveChatGetChatTokenPath","livechatconnector/getchattoken"),(0,d.default)(p,"LiveChatv2GetChatTokenPath","livechatconnector/v2/getchattoken"),(0,d.default)(p,"LiveChatAuthGetChatTokenPath","livechatconnector/auth/getchattoken"),(0,d.default)(p,"LiveChatv2AuthGetChatTokenPath","livechatconnector/v2/auth/getchattoken"),(0,d.default)(p,"LiveChatSessionClosePath","livechatconnector/sessionclose"),(0,d.default)(p,"LiveChatAuthSessionClosePath","livechatconnector/auth/sessionclose"),(0,d.default)(p,"LiveChatSubmitPostChatPath","survey/submitpostchat"),(0,d.default)(p,"LiveChatAuthSubmitPostChatPath","survey/auth/submitpostchat"),(0,d.default)(p,"LiveChatGetSurveyInviteLinkPath","livechatconnector/getsurveyinvite"),(0,d.default)(p,"LiveChatAuthGetSurveyInviteLinkPath","livechatconnector/auth/getsurveyinvite"),(0,d.default)(p,"LiveChatGetChatTranscriptPath","livechatconnector/getchattranscripts"),(0,d.default)(p,"LiveChatv2GetChatTranscriptPath","livechatconnector/v2/getchattranscripts"),(0,d.default)(p,"LiveChatAuthGetChatTranscriptPath","livechatconnector/auth/getchattranscripts"),(0,d.default)(p,"LiveChatv2AuthGetChatTranscriptPath","livechatconnector/v2/auth/getchattranscripts"),(0,d.default)(p,"LiveChatTranscriptEmailRequestPath","livechatconnector/createemailrequest"),(0,d.default)(p,"LiveChatAuthTranscriptEmailRequestPath","livechatconnector/auth/createemailrequest"),(0,d.default)(p,"LiveChatFetchDataMaskingInfoPath","livechatconnector/fetchdatamaskinginfo"),(0,d.default)(p,"LiveChatSecondaryChannelEventPath","livechatconnector/secondarychannelevent"),(0,d.default)(p,"LiveChatAuthSecondaryChannelEventPath","livechatconnector/auth/secondarychannelevent"),(0,d.default)(p,"LiveChatLiveWorkItemDetailsPath","livechatconnector/getliveworkitemdetails"),(0,d.default)(p,"LiveChatAuthLiveWorkItemDetailsPath","livechatconnector/auth/getliveworkitemdetails"),(0,d.default)(p,"LiveChatGetReconnectableChatsPath","livechatconnector/auth/reconnectablechats"),(0,d.default)(p,"LiveChatReconnectAvailabilityPath","livechatconnector/reconnect"),(0,d.default)(p,"LiveChatValidateAuthChatMapRecordPath","livechatconnector/auth/validateauthchatmaprecord"),(0,d.default)(p,"GetQueueAvailabilityPath","livechatconnector/auth/getqueueavailability"),(0,d.default)(p,"SendTypingIndicatorPath","inbound/typingindicator/livechat/sendtypingindicator")},1858:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(1819)),p=function T(){(0,_.default)(this,T)};u.default=p,(0,d.default)(p,"authenticatedUserToken","AuthenticatedUserToken"),(0,d.default)(p,"authorization","Authorization"),(0,d.default)(p,"organizationId","OrganizationId"),(0,d.default)(p,"widgetAppId","widgetAppId"),(0,d.default)(p,"requestId","Request-Id")},6528:(Q,u)=>{"use strict";var c,s;Object.defineProperty(u,"__esModule",{value:!0}),u.LogLevel=void 0,u.LogLevel=c,(s=c||(u.LogLevel=c={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR"},8634:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(6533)),d=s(c(1907)),p=s(c(1298)),T=s(c(8884)),l=s(c(2805)),C=s(c(1819)),P=c(2e3),S=s(c(8686)),f=c(4717),g=s(c(5413)),E=c(6812),b=s(c(4950)),m=c(9569),I=c(6528),x=c(7169),N=s(c(2172)),F=s(c(1858)),U=c(3945),k=s(c(1729)),D=c(8566);function M(Z,ue){var he=Object.keys(Z);if(Object.getOwnPropertySymbols){var Ee=Object.getOwnPropertySymbols(Z);ue&&(Ee=Ee.filter(function(se){return Object.getOwnPropertyDescriptor(Z,se).enumerable})),he.push.apply(he,Ee)}return he}function j(Z){for(var ue=1;ue<arguments.length;ue++){var he=null!=arguments[ue]?arguments[ue]:{};ue%2?M(Object(he),!0).forEach(function(Ee){(0,C.default)(Z,Ee,he[Ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(he)):M(Object(he)).forEach(function(Ee){Object.defineProperty(Z,Ee,Object.getOwnPropertyDescriptor(he,Ee))})}return Z}function W(Z,ue){var he="undefined"!=typeof Symbol&&Z[Symbol.iterator]||Z["@@iterator"];if(!he){if(Array.isArray(Z)||(he=function(Z,ue){if(Z){if("string"==typeof Z)return ce(Z,undefined);var he=Object.prototype.toString.call(Z).slice(8,-1);if("Object"===he&&Z.constructor&&(he=Z.constructor.name),"Map"===he||"Set"===he)return Array.from(Z);if("Arguments"===he||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(he))return ce(Z,undefined)}}(Z))||ue&&Z&&"number"==typeof Z.length){he&&(Z=he);var Ee=0,se=function(){};return{s:se,n:function(){return Ee>=Z.length?{done:!0}:{done:!1,value:Z[Ee++]}},e:function(ne){throw ne},f:se}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var re,K=!0,pe=!1;return{s:function(){he=he.call(Z)},n:function(){var ne=he.next();return K=ne.done,ne},e:function(ne){pe=!0,re=ne},f:function(){try{!K&&null!=he.return&&he.return()}finally{if(pe)throw re}}}}function ce(Z,ue){(null==ue||ue>Z.length)&&(ue=Z.length);for(var he=0,Ee=new Array(ue);he<ue;he++)Ee[he]=Z[he];return Ee}var oe=function(){function Z(ue){var he=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.defaultConfiguration,Ee=arguments.length>2?arguments[2]:void 0;(0,T.default)(this,Z),this.omnichannelConfiguration=ue,this.configuration=he,this.logger=Ee,(0,C.default)(this,"liveChatVersion",void 0),(!Object.keys(this.configuration).length||"object"!==(0,p.default)(he))&&(this.configuration=Z.defaultConfiguration);for(var se=0,K=Object.keys(Z.defaultConfiguration);se<K.length;se++){var pe=K[se];if(!this.configuration.hasOwnProperty(pe))throw new Error("Missing '".concat(pe,"' in SDKConfiguration"))}var re=ue.channelId;if(!Object.values(P.ChannelId).includes(re))throw new Error("Invalid channelId");var te,J=Object.keys(ue),ne=W(g.default.requiredOmnichannelConfigurationParameters);try{for(ne.s();!(te=ne.n()).done;){var ae=te.value;if(!J.includes(ae))throw new Error("Missing '".concat(ae,"' in OmnichannelConfiguration"))}}catch(ve){ne.e(ve)}finally{ne.f()}this.liveChatVersion=P.LiveChatVersion.V1}return(0,l.default)(Z,[{key:"getChatConfig",value:(ue=(0,d.default)(_.default.mark(function Ee(se){var K,pe,re,J,ne,te,ae,ve,ye=arguments;return _.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return K=ye.length>1&&void 0!==ye[1]&&ye[1],pe=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETCHATCONFIG,{RequestId:se},"Get Chat Config Started"),se||(se=(0,D.uuidv4)()),re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatConfigPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"?requestId=").concat(se,"&channelId=").concat(this.omnichannelConfiguration.channelId),J=S.default.create(),(0,k.default)(J,{retries:this.configuration.maxRequestRetriesOnFailure}),ne={},K&&(ne=j(j({},g.default.bypassCacheHeaders),ne)),be.next=11,J.get(re,{headers:ne});case 11:return ae=pe.milliSecondsElapsed,(ve=(te=be.sent).data).LiveChatVersion&&ve.LiveChatVersion===P.LiveChatVersion.V2&&(this.liveChatVersion=ve.LiveChatVersion),ve.headers={},te.headers&&te.headers.date&&(ve.headers.date=te.headers.date),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETCHATCONFIGSUCCESS,{RequestId:se,Region:te.data.Region,ElapsedTimeInMilliseconds:ae,TransactionId:te.headers["transaction-id"]},"Get Chat config succeeded"),be.abrupt("return",ve);case 19:case"end":return be.stop()}},Ee,this)})),function(Ee){return ue.apply(this,arguments)})},{key:"getLWIDetails",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,J,ne,te,ae,ve,ye,K=this,ge=arguments;return _.default.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return pe=ge.length>1&&void 0!==ge[1]?ge[1]:{},re=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETLWISTATUSSTARTED,{RequestId:se},"Get LWI Details Started"),se||(se=(0,D.uuidv4)()),J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatLiveWorkItemDetailsPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),ne=S.default.create(),(0,k.default)(ne,{retries:this.configuration.maxRequestRetriesOnFailure}),ae=pe.reconnectId,ve=g.default.defaultHeaders,(te=pe.authenticatedUserToken)&&(J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthLiveWorkItemDetailsPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),ve[F.default.authenticatedUserToken]=te),ae&&(J+="/".concat(ae)),J+="?channelId=".concat(this.omnichannelConfiguration.channelId),ye={headers:ve,method:"GET",url:J},Ae.abrupt("return",new Promise(function(){var xe=(0,d.default)(_.default.mark(function Ie(Le,We){var Ve,Be,$e,Ye;return _.default.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.prev=0,qe.next=3,ne(ye);case 3:Be=re.milliSecondsElapsed,$e=(Ve=qe.sent).data,K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETLWISTATUSSUCCEEDED,{RequestId:se,Region:Ve.data.Region,ElapsedTimeInMilliseconds:Be,TransactionId:Ve.headers["transaction-id"]},"Get LWI Details succeeded"),Le($e),qe.next=18;break;case 10:if(qe.prev=10,qe.t0=qe.catch(0),Ye=re.milliSecondsElapsed,!K.logger){qe.next=17;break}return qe.next=16,m.LoggingSanitizer.stripErrorSensitiveProperties(qe.t0);case 16:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.GETLWISTATUSFAILED,{RequestId:se,ExceptionDetails:qe.t0,ElapsedTimeInMilliseconds:Ye},"Get LWI Details failed");case 17:We();case 18:case"end":return qe.stop()}},Ie,null,[[0,10]])}));return function(Ie,Le){return xe.apply(this,arguments)}}()));case 14:case"end":return Ae.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"getChatToken",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,J,ne,te,ae,ve,ye,ge,be,K=this,Ae=arguments;return _.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:if(pe=Ae.length>1&&void 0!==Ae[1]?Ae[1]:{},re=Ae.length>2&&void 0!==Ae[2]?Ae[2]:0,J=U.Timer.TIMER(),ne=pe.reconnectId,te=pe.authenticatedUserToken,ae=pe.currentLiveChatVersion,this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETCHATTOKENSTARTED,{RequestId:se},"Get Chat Token Started"),!(re<0)){Ie.next=7;break}throw new Error("Invalid currentRetryCount");case 7:return se||(se=(0,D.uuidv4)()),ve=g.default.defaultHeaders,ye="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatGetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),this.liveChatVersion===P.LiveChatVersion.V2||ae&&ae===P.LiveChatVersion.V2?(ye="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatv2GetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),te&&(ye="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatv2AuthGetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),ve[F.default.authenticatedUserToken]=te)):te&&(ye="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthGetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),ve[F.default.authenticatedUserToken]=te),ne&&(ye+="/".concat(ne)),ye+="?channelId=".concat(this.omnichannelConfiguration.channelId),ge={headers:ve,method:"GET",url:ye},be=S.default.create(),(0,k.default)(be,{retries:this.configuration.maxRequestRetriesOnFailure}),Ie.abrupt("return",new Promise(function(){var Le=(0,d.default)(_.default.mark(function We(Ve,Be){var $e,Ye,Ke,qe;return _.default.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,be(ge);case 3:if(Ye=J.milliSecondsElapsed,!(Ke=($e=Ue.sent).data)){Ue.next=11;break}return Ke.requestId=se,K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETCHATTOKENSUCCEEDED,{RequestId:se,Region:$e.data.Region,ElapsedTimeInMilliseconds:Ye,TransactionId:$e.headers["transaction-id"]},"Get Chat Token Succeeded"),Ve(Ke),Ue.abrupt("return");case 11:if(!ne||$e.status!==g.default.noContentStatusCode){Ue.next=14;break}return Be($e),Ue.abrupt("return");case 14:Ue.next=25;break;case 16:if(Ue.prev=16,Ue.t0=Ue.catch(0),qe=J.milliSecondsElapsed,!K.logger){Ue.next=23;break}return Ue.next=22,m.LoggingSanitizer.stripErrorSensitiveProperties(Ue.t0);case 22:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.GETCHATTOKENFAILED,{RequestId:se,ExceptionDetails:Ue.t0,ElapsedTimeInMilliseconds:qe},"Get Chat Token Failed");case 23:return Be(Ue.t0),Ue.abrupt("return");case 25:if(!(re+1>=K.configuration.getChatTokenRetryCount)){Ue.next=28;break}return Be(new Error("The retry for getchattoken has exceeded its max value of ".concat(K.configuration.getChatTokenRetryCount))),Ue.abrupt("return");case 28:setTimeout(function(){K.getChatToken(se,pe,re+1).then(function(Gt){return Ve(Gt)}).catch(function(Gt){return Be(Gt)})},K.configuration.getChatTokenTimeBetweenRetriesOnFailure);case 29:case"end":return Ue.stop()}},We,null,[[0,16]])}));return function(We,Ve){return Le.apply(this,arguments)}}()));case 17:case"end":return Ie.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"getReconnectableChats",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,J,ne,te,ae,K=this;return _.default.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return pe=U.Timer.TIMER(),re=se.authenticatedUserToken,this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETRECONNECTABLECHATS,"Get Reconnectable chat Started"),J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatGetReconnectableChatsPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(this.omnichannelConfiguration.orgId,"?channelId=").concat(this.omnichannelConfiguration.channelId),(ne=g.default.defaultHeaders)[F.default.authenticatedUserToken]=re,te={headers:ne,method:"GET",url:J},ae=S.default.create(),ye.abrupt("return",new Promise(function(){var ge=(0,d.default)(_.default.mark(function be(Ae,xe){var Ie,Le,We,Ve;return _.default.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return $e.prev=0,$e.next=3,ae(te);case 3:if(Le=pe.milliSecondsElapsed,!(We=(Ie=$e.sent).data)){$e.next=10;break}return K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETRECONNECTABLECHATS,{Region:Ie.data.Region,ElapsedTimeInMilliseconds:Le,TransactionId:Ie.headers[g.default.transactionid]},"Get Reconnectable Chats Succeeded and old session returned"),Ae(We),$e.abrupt("return");case 10:return Ae(),$e.abrupt("return");case 14:if($e.prev=14,$e.t0=$e.catch(0),Ve=pe.milliSecondsElapsed,!K.logger){$e.next=21;break}return $e.next=20,m.LoggingSanitizer.stripErrorSensitiveProperties($e.t0);case 20:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.GETRECONNECTABLECHATS,{ExceptionDetails:$e.t0,ElapsedTimeInMilliseconds:Ve},"Get Reconnectable Chats Failed");case 21:return xe($e.t0),$e.abrupt("return");case 23:case"end":return $e.stop()}},be,null,[[0,14]])}));return function(be,Ae){return ge.apply(this,arguments)}}()));case 9:case"end":return ye.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"getReconnectAvailability",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,ne,te,K=this;return _.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return pe=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,"Get Reconnect availability started"),re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatReconnectAvailabilityPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),ne={headers:g.default.defaultHeaders,method:"GET",url:re},te=S.default.create(),ve.abrupt("return",new Promise(function(){var ye=(0,d.default)(_.default.mark(function ge(be,Ae){var xe,Ie,Le,We;return _.default.wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return Be.prev=0,Be.next=3,te(ne);case 3:if(Ie=pe.milliSecondsElapsed,!(Le=(xe=Be.sent).data)){Be.next=10;break}return K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,{Region:xe.data.Region,ElapsedTimeInMilliseconds:Ie,TransactionId:xe.headers[g.default.transactionid]},"Get Reconnect availability Succeeded"),be(Le),Be.abrupt("return");case 10:return K.logger&&K.logger.log(I.LogLevel.WARN,P.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,{Region:xe.data.Region,ElapsedTimeInMilliseconds:Ie,TransactionId:xe.headers[g.default.transactionid]},"Get Reconnect availability didn't send any valid data."),be(),Be.abrupt("return");case 15:if(Be.prev=15,Be.t0=Be.catch(0),We=pe.milliSecondsElapsed,!K.logger){Be.next=22;break}return Be.next=21,m.LoggingSanitizer.stripErrorSensitiveProperties(Be.t0);case 21:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,{ExceptionDetails:Be.t0,ElapsedTimeInMilliseconds:We},"Get Reconnect Availability Failed");case 22:return Ae(Be.t0),Be.abrupt("return");case 24:case"end":return Be.stop()}},ge,null,[[0,15]])}));return function(ge,be){return ye.apply(this,arguments)}}()));case 7:case"end":return ve.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"getQueueAvailability",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,J,ne,te,ae,ve,ye,ge,be,K=this,Ae=arguments;return _.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:if(pe=Ae.length>1&&void 0!==Ae[1]?Ae[1]:{},re=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETQUEUEAVAILABILITYSTARTED,{RequestId:se},"Get queue availability started"),J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.GetQueueAvailabilityPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se,"?channelId=lcw"),ne=S.default.create(),(0,k.default)(ne,{retries:this.configuration.maxRequestRetriesOnFailure}),ae=pe.initContext,ve=pe.getContext,ye=g.default.defaultHeaders,(te=pe.authenticatedUserToken)&&(ye[F.default.authenticatedUserToken]=te),ge=ae||{},!ve||window.document){Ie.next=12;break}return Ie.abrupt("return",Promise.reject(new Error("getContext is only supported on web browsers")));case 12:if(ve&&(ge.browser=f.BrowserInfo.getBrowserName(),ge.device=E.DeviceInfo.getDeviceType(),ge.originurl=window.location.href,ge.os=x.OSInfo.getOsType()),ge.locale||(ge.locale=g.default.defaultLocale),!ge.locale||b.default.supportedLocales.includes(ge.locale)){Ie.next=16;break}return Ie.abrupt("return",Promise.reject(new Error("Unsupported locale: '".concat(ge.locale,"'"))));case 16:return be={data:ge,headers:ye,method:"POST",url:J},Ie.abrupt("return",new Promise(function(){var Le=(0,d.default)(_.default.mark(function We(Ve,Be){var $e,Ye,Ke,qe;return _.default.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,ne(be);case 3:Ye=re.milliSecondsElapsed,(Ke=($e=Ue.sent).data)&&(K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETQUEUEAVAILABILITYSUCCEEDED,{RequestId:se,Region:$e.data.Region,ElapsedTimeInMilliseconds:Ye,TransactionId:$e.headers["transaction-id"]},"Get queue availability Succeeded"),Ve(Ke)),Ue.next=17;break;case 9:if(Ue.prev=9,Ue.t0=Ue.catch(0),qe=re.milliSecondsElapsed,!K.logger){Ue.next=16;break}return Ue.next=15,m.LoggingSanitizer.stripErrorSensitiveProperties(Ue.t0);case 15:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.GETQUEUEAVAILABILITYFAILED,{RequestId:se,ExceptionDetails:Ue.t0,ElapsedTimeInMilliseconds:qe},"Get queue availability failed");case 16:Be(Ue.t0);case 17:case"end":return Ue.stop()}},We,null,[[0,9]])}));return function(We,Ve){return Le.apply(this,arguments)}}()));case 18:case"end":return Ie.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"sessionInit",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,J,ne,te,ae,ve,ye,ge,be,Ae,K=this,xe=arguments;return _.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:if(pe=xe.length>1&&void 0!==xe[1]?xe[1]:{},re=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SESSIONINITSTARTED,{RequestId:se},"Session Init Started"),J=S.default.create(),(0,k.default)(J,{retries:this.configuration.maxRequestRetriesOnFailure}),ne=pe.reconnectId,te=pe.authenticatedUserToken,ae=pe.initContext,ve=pe.getContext,ye=g.default.defaultHeaders,ge="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatSessionInitPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),te&&(ge="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthSessionInitPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),ye[F.default.authenticatedUserToken]=te),ne&&(ge+="/".concat(ne)),ge+="?channelId=".concat(this.omnichannelConfiguration.channelId),be=ae||{},!ve||window.document){Le.next=14;break}return Le.abrupt("return",Promise.reject(new Error("getContext is only supported on web browsers")));case 14:if(ve&&(be.browser=f.BrowserInfo.getBrowserName(),be.device=E.DeviceInfo.getDeviceType(),be.originurl=window.location.href,be.os=x.OSInfo.getOsType()),be.locale||(be.locale=g.default.defaultLocale),!be.locale||b.default.supportedLocales.includes(be.locale)){Le.next=18;break}return Le.abrupt("return",Promise.reject(new Error("Unsupported locale: '".concat(be.locale,"'"))));case 18:return Ae={data:be,headers:ye,method:"POST",url:ge},Le.abrupt("return",new Promise(function(){var We=(0,d.default)(_.default.mark(function Ve(Be,$e){var Ye,Ke,qe;return _.default.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,J(Ae);case 3:Ye=Ue.sent,Ke=re.milliSecondsElapsed,K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SESSIONINITSUCCEEDED,{RequestId:se,Region:Ye.data.Region,ElapsedTimeInMilliseconds:Ke,TransactionId:Ye.headers["transaction-id"]},"Session Init Succeeded"),Be(),Ue.next=17;break;case 9:if(Ue.prev=9,Ue.t0=Ue.catch(0),qe=re.milliSecondsElapsed,!K.logger){Ue.next=16;break}return Ue.next=15,m.LoggingSanitizer.stripErrorSensitiveProperties(Ue.t0);case 15:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.SESSIONINITFAILED,{RequestId:se,ExceptionDetails:Ue.t0,ElapsedTimeInMilliseconds:qe},"Session Init Failed");case 16:$e(Ue.t0);case 17:case"end":return Ue.stop()}},Ve,null,[[0,9]])}));return function(Ve,Be){return We.apply(this,arguments)}}()));case 20:case"end":return Le.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"sessionClose",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,J,ne,te,ae,ve,ge,be,Ae,K=this,xe=arguments;return _.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return pe=xe.length>1&&void 0!==xe[1]?xe[1]:{},re=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SESSIONCLOSESTARTED,{RequestId:se},"Session Close Started"),J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatSessionClosePath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),ne=S.default.create(),(0,k.default)(ne,{retries:this.configuration.maxRequestRetriesOnFailure}),te=pe.authenticatedUserToken,ae=pe.isReconnectChat,ve=pe.isPersistentChat,ge=g.default.defaultHeaders,(be={}).chatId=pe.chatId,te&&(J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthSessionClosePath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),ge[F.default.authenticatedUserToken]=te),ae&&(J+="&isReconnectChat=true"),ve&&(J+="&isPersistentChat=true"),Ae={data:be,headers:ge,method:"POST",url:J},Le.abrupt("return",new Promise(function(){var We=(0,d.default)(_.default.mark(function Ve(Be,$e){var Ye,Ke,qe;return _.default.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,ne(Ae);case 3:Ye=Ue.sent,Ke=re.milliSecondsElapsed,K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SESSIONCLOSESUCCEEDED,{RequestId:se,Region:Ye.data.Region,ElapsedTimeInMilliseconds:Ke,TransactionId:Ye.headers["transaction-id"]},"Session Close Succeeded"),Be(),Ue.next=17;break;case 9:if(Ue.prev=9,Ue.t0=Ue.catch(0),qe=re.milliSecondsElapsed,!K.logger){Ue.next=16;break}return Ue.next=15,m.LoggingSanitizer.stripErrorSensitiveProperties(Ue.t0);case 15:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.SESSIONCLOSEFAILED,{RequestId:se,ExceptionDetails:Ue.t0,ElapsedTimeInMilliseconds:qe},"Session Close Failed");case 16:$e();case 17:case"end":return Ue.stop()}},Ve,null,[[0,9]])}));return function(Ve,Be){return We.apply(this,arguments)}}()));case 15:case"end":return Le.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"validateAuthChatRecord",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se,K){var pe,re,J,ne,te,ae,ve,ye,ge,be,Ae,xe,Ie,Le;return _.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return pe=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDSTARTED,{RequestId:se},"Validate Auth Chat Record Started"),re=K.authenticatedUserToken,J=K.chatId,ne="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatValidateAuthChatMapRecordPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(J,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),te=S.default.create(),(0,k.default)(te,{retries:this.configuration.maxRequestRetriesOnFailure}),ae=g.default.defaultHeaders,re&&(ae[F.default.authenticatedUserToken]=re),ve={headers:ae,method:"GET",url:ne},Ve.prev=9,Ve.next=12,te(ve);case 12:if(be=pe.milliSecondsElapsed,!0!==(null===(ye=(ge=Ve.sent).data)||void 0===ye?void 0:ye.authChatExist)){Ve.next=19;break}return null===(Ae=this.logger)||void 0===Ae||Ae.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDSUCCEEDED,{RequestId:se,Region:ge.data.Region,ElapsedTimeInMilliseconds:be,TransactionId:ge.headers["transaction-id"]},"Validate Auth Chat Record Succeeded"),Ve.abrupt("return",Promise.resolve(ge.data));case 19:return null===(xe=this.logger)||void 0===xe||xe.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDFAILED,{RequestId:se,Region:ge.data.Region,ElapsedTimeInMilliseconds:be,TransactionId:ge.headers["transaction-id"],ErrorCode:ge.status},"Validate Auth Chat Record Failed. Record is not found or request is not authorized"),Ve.abrupt("return",Promise.reject(new Error("Validate Auth Chat Record Failed. Record is not found or request is not authorized")));case 21:Ve.next=34;break;case 23:return Ve.prev=23,Ve.t0=Ve.catch(9),Le=pe.milliSecondsElapsed,Ve.next=28,m.LoggingSanitizer.stripErrorSensitiveProperties(Ve.t0);case 28:if(null===(Ie=this.logger)||void 0===Ie||Ie.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDFAILED,{RequestId:se,ExceptionDetails:Ve.t0,ElapsedTimeInMilliseconds:Le},"Validate Auth Chat Record Failed"),"Error: Request failed with status code 404"!==Ve.t0.toString()){Ve.next=33;break}return Ve.abrupt("return",Promise.resolve({}));case 33:return Ve.abrupt("return",Promise.reject());case 34:case"end":return Ve.stop()}},Ee,this,[[9,23]])}));return function(Ee,se){return ue.apply(this,arguments)}}()},{key:"submitPostChatResponse",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se,K){var re,J,ne,te,ae,ve,ye,pe=this,ge=arguments;return _.default.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return re=ge.length>2&&void 0!==ge[2]?ge[2]:{},J=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SUBMITPOSTCHATSTARTED,{RequestId:se},"Submit Post Chat Started"),ne="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatSubmitPostChatPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),te=S.default.create(),(0,k.default)(te,{retries:this.configuration.maxRequestRetriesOnFailure}),ve=g.default.defaultHeaders,(ae=re.authenticatedUserToken)&&(ne="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthSubmitPostChatPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),ve[F.default.authenticatedUserToken]=ae),ye={data:JSON.stringify(K),headers:ve,method:"POST",url:ne},Ae.abrupt("return",new Promise(function(){var xe=(0,d.default)(_.default.mark(function Ie(Le,We){var Ve,Be,$e;return _.default.wrap(function(Ke){for(;;)switch(Ke.prev=Ke.next){case 0:return Ke.prev=0,Ke.next=3,te(ye);case 3:Ve=Ke.sent,Be=J.milliSecondsElapsed,pe.logger&&pe.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SUBMITPOSTCHATSUCCEEDED,{RequestId:se,Region:Ve.data.Region,ElapsedTimeInMilliseconds:Be,TransactionId:Ve.headers["transaction-id"]},"Submit Post Chat Succeeded"),Le(),Ke.next=17;break;case 9:if(Ke.prev=9,Ke.t0=Ke.catch(0),$e=J.milliSecondsElapsed,!pe.logger){Ke.next=16;break}return Ke.next=15,m.LoggingSanitizer.stripErrorSensitiveProperties(Ke.t0);case 15:pe.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.SUBMITPOSTCHATFAILED,{RequestId:se,ExceptionDetails:Ke.t0,ElapsedTimeInMilliseconds:$e},"Submit Post Chat Failed");case 16:We();case 17:case"end":return Ke.stop()}},Ie,null,[[0,9]])}));return function(Ie,Le){return xe.apply(this,arguments)}}()));case 11:case"end":return Ae.stop()}},Ee,this)}));return function(Ee,se){return ue.apply(this,arguments)}}()},{key:"getSurveyInviteLink",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se,K){var re,J,ne,te,ae,ve,ye,ge,pe=this,be=arguments;return _.default.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return re=be.length>2&&void 0!==be[2]?be[2]:{},J=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETSURVEYINVITELINKSTARTED,{SurveyOwnerId:se},"Get Survey Invite Link Started"),ne="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatGetSurveyInviteLinkPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(se),te=S.default.create(),(0,k.default)(te,{retries:this.configuration.maxRequestRetriesOnFailure}),ve=re.requestId,ye=g.default.defaultHeaders,(ae=re.authenticatedUserToken)&&(ne="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthGetSurveyInviteLinkPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(se),ye[F.default.authenticatedUserToken]=ae,ye[F.default.widgetAppId]=this.omnichannelConfiguration.widgetId),ve&&(ye[F.default.requestId]=ve),ge={data:JSON.stringify(K),headers:ye,method:"POST",url:ne},xe.abrupt("return",new Promise(function(){var Ie=(0,d.default)(_.default.mark(function Le(We,Ve){var Be,$e,Ye,Ke;return _.default.wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:return Qe.prev=0,Qe.next=3,te(ge);case 3:$e=(Be=Qe.sent).data,Ye=J.milliSecondsElapsed,pe.logger&&pe.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETSURVEYINVITELINKSUCCEEDED,{Region:Be.data.Region,ElapsedTimeInMilliseconds:Ye,TransactionId:Be.headers["transaction-id"]},"Get Survey Invite Link Succeeded"),We($e),Qe.next=18;break;case 10:if(Qe.prev=10,Qe.t0=Qe.catch(0),Ke=J.milliSecondsElapsed,!pe.logger){Qe.next=17;break}return Qe.next=16,m.LoggingSanitizer.stripErrorSensitiveProperties(Qe.t0);case 16:pe.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.GETSURVEYINVITELINKFAILED,{ExceptionDetails:Qe.t0,ElapsedTimeInMilliseconds:Ke},"Get Survey Invite Link Failed");case 17:Ve();case 18:case"end":return Qe.stop()}},Le,null,[[0,10]])}));return function(Le,We){return Ie.apply(this,arguments)}}()));case 12:case"end":return xe.stop()}},Ee,this)}));return function(Ee,se){return ue.apply(this,arguments)}}()},{key:"getChatTranscripts",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se,K,pe){var J,ne,te,ae,ve,ye,ge,be,re=this,Ae=arguments;return _.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return J=Ae.length>3&&void 0!==Ae[3]?Ae[3]:{},ne=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETCHATTRANSCRIPTSTARTED,{RequestId:se},"Get Chat Transcript Started"),te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatGetChatTranscriptPath,"/").concat(K,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),ae=S.default.create(),(0,k.default)(ae,{retries:this.configuration.maxRequestRetriesOnFailure}),ve=J.authenticatedUserToken,ye=J.currentLiveChatVersion,(ge=g.default.defaultHeaders)[F.default.organizationId]=this.omnichannelConfiguration.orgId,ge[F.default.widgetAppId]=this.omnichannelConfiguration.widgetId,ge[F.default.authorization]=pe,this.liveChatVersion===P.LiveChatVersion.V2||ye&&ye===P.LiveChatVersion.V2?(te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatv2GetChatTranscriptPath,"/").concat(K,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),ve&&(te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatv2AuthGetChatTranscriptPath,"/").concat(K,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId))):ve&&(te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthGetChatTranscriptPath,"/").concat(K,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId)),be={headers:ge,method:"GET",url:te},Ie.abrupt("return",new Promise(function(){var Le=(0,d.default)(_.default.mark(function We(Ve,Be){var $e,Ye,Ke,qe;return _.default.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,ae(be);case 3:Ye=ne.milliSecondsElapsed,Ke=($e=Ue.sent).data,re.logger&&re.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.GETCHATTRANSCRIPTSUCCEEDED,{RequestId:se,Region:$e.data.Region,ElapsedTimeInMilliseconds:Ye,TransactionId:$e.headers["transaction-id"]},"Get Chat Transcript Succeeded"),Ve(Ke),Ue.next=18;break;case 10:if(Ue.prev=10,Ue.t0=Ue.catch(0),qe=ne.milliSecondsElapsed,!re.logger){Ue.next=17;break}return Ue.next=16,m.LoggingSanitizer.stripErrorSensitiveProperties(Ue.t0);case 16:re.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.GETCHATTRANSCRIPTFAILED,{RequestId:se,ExceptionDetails:Ue.t0,ElapsedTimeInMilliseconds:qe},"Get Chat Transcript Failed");case 17:Be(Ue.t0);case 18:case"end":return Ue.stop()}},We,null,[[0,10]])}));return function(We,Ve){return Le.apply(this,arguments)}}()));case 14:case"end":return Ie.stop()}},Ee,this)}));return function(Ee,se,K){return ue.apply(this,arguments)}}()},{key:"emailTranscript",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se,K,pe){var J,ne,te,ae,ve,ye,ge,re=this,be=arguments;return _.default.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return J=be.length>3&&void 0!==be[3]?be[3]:{},ne=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.EMAILTRANSCRIPTSTARTED,{RequestId:se},"Email Transcript Started"),te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatTranscriptEmailRequestPath,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId),ae=S.default.create(),(0,k.default)(ae,{retries:this.configuration.maxRequestRetriesOnFailure}),ve=J.authenticatedUserToken,(ye=g.default.defaultHeaders)[F.default.organizationId]=this.omnichannelConfiguration.orgId,ye[F.default.widgetAppId]=this.omnichannelConfiguration.widgetId,ye[F.default.authorization]=K,ve&&(te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthTranscriptEmailRequestPath,"/").concat(se,"?channelId=").concat(this.omnichannelConfiguration.channelId)),ge={data:JSON.stringify(pe),headers:ye,method:"POST",url:te},xe.abrupt("return",new Promise(function(){var Ie=(0,d.default)(_.default.mark(function Le(We,Ve){var Be,$e,Ye;return _.default.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.prev=0,qe.next=3,ae(ge);case 3:Be=qe.sent,$e=ne.milliSecondsElapsed,re.logger&&re.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.EMAILTRANSCRIPTSUCCEEDED,{RequestId:se,Region:Be.data.Region,ElapsedTimeInMilliseconds:$e,TransactionId:Be.headers["transaction-id"]},"Email Transcript Succeeded"),We(),qe.next=17;break;case 9:if(qe.prev=9,qe.t0=qe.catch(0),Ye=ne.milliSecondsElapsed,!re.logger){qe.next=16;break}return qe.next=15,m.LoggingSanitizer.stripErrorSensitiveProperties(qe.t0);case 15:re.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.EMAILTRANSCRIPTFAILED,{RequestId:se,ExceptionDetails:qe.t0,ElapsedTimeInMilliseconds:Ye},"Email Transcript Failed");case 16:Ve();case 17:case"end":return qe.stop()}},Le,null,[[0,9]])}));return function(Le,We){return Ie.apply(this,arguments)}}()));case 14:case"end":return xe.stop()}},Ee,this)}));return function(Ee,se,K){return ue.apply(this,arguments)}}()},{key:"fetchDataMaskingInfo",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se){var pe,re,J,ne,te,K=this;return _.default.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return pe=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.FETCHDATAMASKINGSTARTED,{RequestId:se},"Fetch Data Masking Started"),se||(se=(0,D.uuidv4)()),re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatFetchDataMaskingInfoPath,"/").concat(this.omnichannelConfiguration.orgId),J=S.default.create(),(0,k.default)(J,{retries:this.configuration.maxRequestRetriesOnFailure}),(ne=g.default.defaultHeaders)[F.default.organizationId]=this.omnichannelConfiguration.orgId,ne[F.default.requestId]=se,te={headers:ne,method:"GET",url:re},ve.abrupt("return",new Promise(function(){var ye=(0,d.default)(_.default.mark(function ge(be,Ae){var xe,Ie,Le,We;return _.default.wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return Be.prev=0,Be.next=3,J(te);case 3:Ie=pe.milliSecondsElapsed,Le=(xe=Be.sent).data,K.logger&&K.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.FETCHDATAMASKINGSUCCEEDED,{RequestId:se,Region:xe.data.Region,ElapsedTimeInMilliseconds:Ie,TransactionId:xe.headers["transaction-id"]},"Fetch Data Masking Succeeded"),be(Le),Be.next=18;break;case 10:if(Be.prev=10,Be.t0=Be.catch(0),We=pe.milliSecondsElapsed,!K.logger){Be.next=17;break}return Be.next=16,m.LoggingSanitizer.stripErrorSensitiveProperties(Be.t0);case 16:K.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.FETCHDATAMASKINGFAILED,{RequestId:se,ExceptionDetails:Be.t0,ElapsedTimeInMilliseconds:We},"Fetch Data Masking Failed");case 17:Ae();case 18:case"end":return Be.stop()}},ge,null,[[0,10]])}));return function(ge,be){return ye.apply(this,arguments)}}()));case 11:case"end":return ve.stop()}},Ee,this)}));return function(Ee){return ue.apply(this,arguments)}}()},{key:"makeSecondaryChannelEventRequest",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se,K){var pe,re,J,ne,te,ae,ve,ye,ge,be,Ae,xe=arguments;return _.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return pe=xe.length>2&&void 0!==xe[2]?xe[2]:{},re=U.Timer.TIMER(),this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SECONDARYCHANNELEVENTREQUESTSTARTED,{RequestId:se},"Secondary Channel Event Request Started"),J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatSecondaryChannelEventPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se),ne=S.default.create(),(0,k.default)(ne,{retries:this.configuration.maxRequestRetriesOnFailure}),te=pe.authenticatedUserToken,(ae=g.default.defaultHeaders)[F.default.organizationId]=this.omnichannelConfiguration.orgId,te&&(ae[F.default.authenticatedUserToken]=te,J="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.LiveChatAuthSecondaryChannelEventPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(se)),J+="?channelId="+g.default.defaultChannelId,ve={data:JSON.stringify(K),headers:ae,method:"POST",url:J},Le.prev=12,Le.next=15,ne(ve);case 15:ge=re.milliSecondsElapsed,be=(ye=Le.sent).data,this.logger&&this.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SECONDARYCHANNELEVENTREQUESTSUCCEEDED,{RequestId:se,Region:be.Region,ElapsedTimeInMilliseconds:ge,TransactionId:ye.headers["transaction-id"]},"Secondary Channel Event Request Succeeded"),Le.next=29;break;case 21:if(Le.prev=21,Le.t0=Le.catch(12),Ae=re.milliSecondsElapsed,!this.logger){Le.next=28;break}return Le.next=27,m.LoggingSanitizer.stripErrorSensitiveProperties(Le.t0);case 27:this.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.SECONDARYCHANNELEVENTREQUESTFAILED,{RequestId:se,ExceptionDetails:Le.t0,ElapsedTimeInMilliseconds:Ae},"Secondary Channel Event Request Failed");case 28:throw Le.t0;case 29:case"end":return Le.stop()}},Ee,this,[[12,21]])}));return function(Ee,se){return ue.apply(this,arguments)}}()},{key:"sendTypingIndicator",value:function(){var ue=(0,d.default)(_.default.mark(function Ee(se,K){var re,J,ne,te,ae,ve,ye,pe=this,ge=arguments;return _.default.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:if(re=ge.length>2&&void 0!==ge[2]?ge[2]:{},K&&K===P.LiveChatVersion.V2){Ae.next=3;break}return Ae.abrupt("return",Promise.resolve());case 3:if(J=U.Timer.TIMER(),ne=re.customerDisplayName,K&&K===P.LiveChatVersion.V2){Ae.next=7;break}throw new Error("Typing indicator is only supported on v2");case 7:return te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(N.default.SendTypingIndicatorPath,"/").concat(se),ae=S.default.create(),(ve=g.default.defaultHeaders)[F.default.organizationId]=this.omnichannelConfiguration.orgId,ne&&(ve[g.default.customerDisplayName]=ne),ye={headers:ve,method:"POST",url:te},Ae.abrupt("return",new Promise(function(){var xe=(0,d.default)(_.default.mark(function Ie(Le,We){var Ve,Be,$e,Ye;return _.default.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.prev=0,qe.next=3,ae(ye);case 3:Be=J.milliSecondsElapsed,$e=(Ve=qe.sent).data,pe.logger&&pe.logger.log(I.LogLevel.INFO,P.OCSDKTelemetryEvent.SENDTYPINGINDICATORSUCCEEDED,{RequestId:se,Region:$e.Region,ElapsedTimeInMilliseconds:Be,TransactionId:Ve.headers["transaction-id"]},"Send Typing Indicator Succeeded"),Le(),qe.next=18;break;case 10:if(qe.prev=10,qe.t0=qe.catch(0),Ye=J.milliSecondsElapsed,!pe.logger){qe.next=17;break}return qe.next=16,m.LoggingSanitizer.stripErrorSensitiveProperties(qe.t0);case 16:pe.logger.log(I.LogLevel.ERROR,P.OCSDKTelemetryEvent.SENDTYPINGINDICATORFAILED,{RequestId:se,ExceptionDetails:qe.t0,ElapsedTimeInMilliseconds:Ye},"Send Typing Indicator Failed");case 17:We(qe.t0);case 18:case"end":return qe.stop()}},Ie,null,[[0,10]])}));return function(Ie,Le){return xe.apply(this,arguments)}}()));case 14:case"end":return Ae.stop()}},Ee,this)}));return function(Ee,se){return ue.apply(this,arguments)}}()}]),Z;var ue}();u.default=oe,(0,C.default)(oe,"defaultConfiguration",{getChatTokenRetryCount:35,getChatTokenTimeBetweenRetriesOnFailure:1e4,maxRequestRetriesOnFailure:3})},4491:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(2805)),p=s(c(5413)),T=s(c(4162)),l=s(c(8634));u.default=function(){function P(){(0,_.default)(this,P)}return(0,d.default)(P,null,[{key:"getSDK",value:function(f,g,E){var b=new T.default(E);return new l.default({channelId:f.channelId||p.default.defaultChannelId,orgId:f.orgId,orgUrl:f.orgUrl,widgetId:f.widgetId},g||{},b)}}]),P}()},4717:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.BrowserInfo=u.UNKNOWN_VERSION=void 0;var _=s(c(8884)),d=s(c(2805)),p=s(c(1819)),T=c(2e3),l="([\\d,.]+)";u.UNKNOWN_VERSION="U";var P=function(){function S(){(0,_.default)(this,S)}return(0,d.default)(S,null,[{key:"getUserAgent",value:function(){return this.userAgent()}},{key:"userAgentContainsString",value:function(g){return this.getUserAgent().indexOf(g)>-1}},{key:"isChrome",value:function(){return this.userAgentContainsString(T.BrowserVendor.CHROME)&&!this.userAgentContainsString(T.BrowserVendor.EDGE)&&!this.userAgentContainsString(T.BrowserVendor.EDGE_CHROMIUM)}},{key:"isIe",value:function(){return this.userAgentContainsString("Trident")}},{key:"isEdge",value:function(){return this.userAgentContainsString(T.BrowserVendor.EDGE)||this.userAgentContainsString(T.BrowserVendor.EDGE_CHROMIUM)}},{key:"isOpera",value:function(){return this.userAgentContainsString("OPR/")}},{key:"getBrowserName",value:function(){return this.isOpera()?T.BrowserVendor.OPERA:this.isEdge()?T.BrowserVendor.EDGE:this.isChrome()?T.BrowserVendor.CHROME:this.userAgentContainsString(T.BrowserVendor.FIREFOX)?T.BrowserVendor.FIREFOX:this.userAgentContainsString(T.BrowserVendor.SAFARI)?T.BrowserVendor.SAFARI:this.isIe()?T.BrowserVendor.IE:T.BrowserVendor.UNKNOWN}},{key:"getBrowserVersion",value:function(){var g=this;return this.isIe()?function(){var I=g.getUserAgent(),x=I.match(new RegExp(T.BrowserVendor.IE+" "+l));if(x)return x[1];var N=I.match(new RegExp("rv:"+l));return N?N[1]:void 0}():function(I){I===T.BrowserVendor.SAFARI&&(I="Version"),I===T.BrowserVendor.OPERA&&(I="OPR"),I===T.BrowserVendor.EDGE&&(I="Edge?");var x=g.getUserAgent().match(new RegExp(I+"/"+l));return x?x[1]:"U"}(this.getBrowserName())}}]),S}();u.BrowserInfo=P,(0,p.default)(P,"userAgent",function(){return window.navigator.userAgent})},6812:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.DeviceInfo=void 0;var _=s(c(8884)),d=s(c(2805)),p=c(2e3);u.DeviceInfo=function(){function l(){(0,_.default)(this,l)}return(0,d.default)(l,null,[{key:"getDeviceType",value:function(){return window.navigator.userAgent.match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?p.DeviceType.Mobile:window.navigator.userAgent.match(/tablet|ipad/i)?p.DeviceType.Tablet:p.DeviceType.Desktop}}]),l}()},682:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(2805));u.default=function(){function T(){(0,_.default)(this,T)}return(0,d.default)(T,null,[{key:"raiseCustomEvent",value:function(C,P){var S=T.createCustomEvent(C,P);window.dispatchEvent(S)}},{key:"createCustomEvent",value:function(C,P){var S=P?{detail:P}:void 0,f=null;try{f=new CustomEvent(C,S)}catch(g){(f=document.createEvent("CustomEvent")).initCustomEvent(C,!0,!0,S)}return f}}]),T}()},9569:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.LoggingSanitizer=void 0;var _=s(c(1298)),d=s(c(8884)),p=s(c(2805)),T=s(c(5413));u.LoggingSanitizer=function(){function C(){(0,d.default)(this,C)}return(0,p.default)(C,null,[{key:"stripErrorSensitiveProperties",value:function(S){var f,E,g=this;S&&"object"===(0,_.default)(S)&&(null===(f=Object.keys(S))||void 0===f?void 0:f.length)>0&&(null===(E=Object.keys(S))||void 0===E||E.forEach(function(b){-1!==T.default.sensitiveProperties.indexOf(b)&&delete S["".concat(b)],null===S["".concat(b)]||"object"!==(0,_.default)(S["".concat(b)])||g.stripErrorSensitiveProperties(S["".concat(b)])}))}}]),C}()},7169:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.OSInfo=void 0;var _=s(c(8884)),d=s(c(2805)),p=c(2e3);u.OSInfo=function(){function l(){(0,_.default)(this,l)}return(0,d.default)(l,null,[{key:"getOsType",value:function(){var I=function(){return window.navigator.userAgent};return I().match(/windows\sphone\s\d+\.\d+/i)?p.OperatingSystem.WINDOWS_PHONE:I().match(/ arm;/i)?p.OperatingSystem.WINDOWS_RT:I().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?p.OperatingSystem.IOS:I().match(/android/i)?p.OperatingSystem.ANDROID:I().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?p.OperatingSystem.LINUX:I().match(/(macintosh|mac os x)/i)?p.OperatingSystem.MACOSX:I().match(/(windows|win32)/i)?p.OperatingSystem.WINDOWS:p.OperatingSystem.UNKNOWN}}]),l}()},7276:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0;var _=s(c(8884)),d=s(c(2805));u.default=function(){function T(){(0,_.default)(this,T)}return(0,d.default)(T,null,[{key:"GETTELEMETRYEVENTDATA",value:function(C,P,S){return{Description:S,ElapsedTimeInMilliseconds:P.ElapsedTimeInMilliseconds,Event:C,ExceptionDetails:P.ExceptionDetails,Region:P.Region,RequestId:P.RequestId,TransactionId:P.TransactionId}}}]),T}()},3945:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),u.Timer=void 0;var _=s(c(8884)),d=s(c(2805));u.Timer=function(){function T(){(0,_.default)(this,T)}return(0,d.default)(T,null,[{key:"TIMER",value:function(){var C=(new Date).getTime();return{get milliSecondsElapsed(){return(new Date).getTime()-C}}}}]),T}()},1729:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.default=void 0,u.default=function(d,p){var T=p.retries,l=0;d.interceptors.response.use(void 0,function(f){var g=f.config;return g&&l<T?(l++,new Promise(function(b){return b(d(g))})):Promise.reject(f)})}},8566:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.uuidv4=void 0,u.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(_){var d=16*Math.random()|0;return("x"===_?d:3&d|8).toString(16)})}},3762:(Q,u,c)=>{"use strict";var s=c(1127);Object.defineProperty(u,"__esModule",{value:!0}),Object.defineProperty(u,"SDKProvider",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(u,"uuidv4",{enumerable:!0,get:function(){return l.uuidv4}});var _=s(c(1298)),d=s(c(3096)),p=s(c(4491)),T=s(c(682)),l=c(8566);!function(){if(void 0===global.window&&(global.window=global),void 0===("undefined"==typeof window?"undefined":(0,_.default)(window)))throw new Error("window object not found");"Microsoft"in window||(window.Microsoft={}),"CRM"in window.Microsoft||(window.Microsoft.CRM={}),"Omnichannel"in window.Microsoft.CRM||(window.Microsoft.CRM.Omnichannel={}),"SDK"in window.Microsoft.CRM.Omnichannel||(window.Microsoft.CRM.Omnichannel.SDK={SDKProvider:p.default,Util:{uuidv4:l.uuidv4}}),window.document&&T.default.raiseCustomEvent(d.default.OCSDKLOAD)}()},7987:function(Q,u){"use strict";var c=this&&this.__assign||function(){return(c=Object.assign||function(_){for(var d,p=1,T=arguments.length;p<T;p++)for(var l in d=arguments[p])Object.prototype.hasOwnProperty.call(d,l)&&(_[l]=d[l]);return _}).apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0});var s=function(){function _(d){this.debug=!1,this.debug=!1,this.logger=d}return _.prototype.setDebug=function(d){this.debug=d},_.prototype.log=function(d,p,T){var l,C=c(c({},T),{Event:p});this.debug&&console.log(C),null===(l=this.logger)||void 0===l||l.logClientSdkTelemetryEvent(d,C)},_}();u.default=s},9237:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(x){for(var N,F=1,U=arguments.length;F<U;F++)for(var k in N=arguments[F])Object.prototype.hasOwnProperty.call(N,k)&&(x[k]=N[k]);return x}).apply(this,arguments)},_=this&&this.__awaiter||function(x,N,F,U){return new(F||(F=Promise))(function(D,M){function j(ce){try{$(U.next(ce))}catch(oe){M(oe)}}function W(ce){try{$(U.throw(ce))}catch(oe){M(oe)}}function $(ce){ce.done?D(ce.value):function(D){return D instanceof F?D:new F(function(M){M(D)})}(ce.value).then(j,W)}$((U=U.apply(x,N||[])).next())})},d=this&&this.__generator||function(x,N){var U,k,D,M,F={label:0,sent:function(){if(1&D[0])throw D[1];return D[1]},trys:[],ops:[]};return M={next:j(0),throw:j(1),return:j(2)},"function"==typeof Symbol&&(M[Symbol.iterator]=function(){return this}),M;function j($){return function(ce){return function($){if(U)throw new TypeError("Generator is already executing.");for(;F;)try{if(U=1,k&&(D=2&$[0]?k.return:$[0]?k.throw||((D=k.return)&&D.call(k),0):k.next)&&!(D=D.call(k,$[1])).done)return D;switch(k=0,D&&($=[2&$[0],D.value]),$[0]){case 0:case 1:D=$;break;case 4:return F.label++,{value:$[1],done:!1};case 5:F.label++,k=$[1],$=[0];continue;case 7:$=F.ops.pop(),F.trys.pop();continue;default:if(!(D=(D=F.trys).length>0&&D[D.length-1])&&(6===$[0]||2===$[0])){F=0;continue}if(3===$[0]&&(!D||$[1]>D[0]&&$[1]<D[3])){F.label=$[1];break}if(6===$[0]&&F.label<D[1]){F.label=D[1],D=$;break}if(D&&F.label<D[2]){F.label=D[2],F.ops.push($);break}D[2]&&F.ops.pop(),F.trys.pop();continue}$=N.call(x,F)}catch(ce){$=[6,ce],k=0}finally{U=D=0}if(5&$[0])throw $[1];return{value:$[0]?$[1]:void 0,done:!0}}([$,ce])}}};Object.defineProperty(u,"__esModule",{value:!0});var p=c(7643),T=(()=>{return(x=T||(T={})).Accept="Accept",x.AcceptEncoding="Accept-Encoding",x.BehaviorOverride="BehaviorOverride",x.Authorization="Authorization",x.ClientVersion="X-MS-Client-Version",x.ContentType="Content-Type",T;var x})(),l=(()=>{return(x=l||(l={})).applicationFormUrlEncoded="application/x-www-form-urlencoded",x.applicationJson="application/json",l;var x})(),C=(()=>{return(x=C||(C={})).Expired="expired",x.Failed="failed",x.InProgress="in progress",x.Malware="malware",x.Ready="ready",C;var x})(),P=["jpeg","jpg","gif","png","bmp","tiff","jfif"],S=function(x){x.regionGTMS||(x.regionGTMS={ams:"https://us-api.asm.skype.com"})},f=function(x){var N;return(N={})[T.Authorization]="skype_token "+x,N[T.ClientVersion]="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country=IN; clientName=swc; clientVer=912/0.106.0.34//swc",N};u.default={skypeTokenAuth:function(x){return _(void 0,void 0,void 0,function(){var N,U,D,M,j;return d(this,function(W){switch(W.label){case 0:p.default.debug&&console.log("[API][skypeTokenAuth]"),S(x),N=(x.amsEndpoint||(null===(j=x.regionGTMS)||void 0===j?void 0:j.ams))+"/v1/skypetokenauth",(M={})[T.Authorization]="skype_token "+x.token,M[T.Accept]=l.applicationJson,M[T.BehaviorOverride]="redirectAs404",M[T.ContentType]=l.applicationFormUrlEncoded,U={headers:M,method:"POST",body:"skypetoken="+x.token},W.label=1;case 1:return W.trys.push([1,3,,4]),[4,fetch(N,U)];case 2:return[2,W.sent()];case 3:throw D=W.sent(),!p.default.silentError&&console.log(D),new Error("AMSAuth");case 4:return[2]}})})},createObject:function(x,N,F){return _(void 0,void 0,void 0,function(){var k,D,M,j,ce,oe,Z,ue;return d(this,function(he){switch(he.label){case 0:p.default.debug&&console.log("[API][createObject]"),(oe={})[x]=["read"],k={filename:N.name,permissions:oe,type:N.type.includes("image")?"pish/image":"sharing/file"},S(F),D=(F.amsEndpoint||(null===(ue=null==F?void 0:F.regionGTMS)||void 0===ue?void 0:ue.ams))+"/v1/objects",M=s(s({},f(F.token)),((Z={})[T.ContentType]=l.applicationJson,Z)),j={headers:M,method:"POST",body:JSON.stringify(k),credentials:"include"},he.label=1;case 1:return he.trys.push([1,4,,5]),[4,fetch(D,j)];case 2:return[4,he.sent().json()];case 3:return[2,he.sent()];case 4:throw ce=he.sent(),!p.default.silentError&&console.log(ce),new Error("AMSCreateObjectFailed");case 5:return[2]}})})},uploadDocument:function(x,N,F){return _(void 0,void 0,void 0,function(){var U,k,D,j,W,$;return d(this,function(ce){switch(ce.label){case 0:p.default.debug&&console.log("[API][uploadDocument]"),S(F),U=(F.amsEndpoint||(null===($=null==F?void 0:F.regionGTMS)||void 0===$?void 0:$.ams))+"/v1/objects/"+x+"/content/"+(N.type.includes("image")?"imgpsh":"original"),k=s(s({},f(F.token)),((W={})[T.ContentType]=l.applicationFormUrlEncoded,W)),D={headers:k,method:"PUT",body:N.data?N.data:N},ce.label=1;case 1:return ce.trys.push([1,3,,4]),[4,fetch(U,D)];case 2:return ce.sent(),[2,{name:N.name,size:N.size,type:N.type,id:x,url:U,fileSharingProtocolType:0}];case 3:throw j=ce.sent(),!p.default.silentError&&console.log(j),new Error("AMSUploadDocumentFailed");case 4:return[2]}})})},getViewStatus:function(x,N){return _(void 0,void 0,void 0,function(){var F,U,k,M,j,W,ce,oe;return d(this,function(Z){switch(Z.label){case 0:p.default.debug&&console.log("[API][getViewStatus]"),S(N),F=(N.amsEndpoint||(null===(oe=null==N?void 0:N.regionGTMS)||void 0===oe?void 0:oe.ams))+"/v1/objects/"+x.id+"/views/"+(P.includes(x.type)?"imgpsh_fullsize_anim":"original")+"/status",U=f(N.token),k={headers:U,method:"GET"},Z.label=1;case 1:return Z.trys.push([1,4,,5]),[4,fetch(F,k)];case 2:return[4,Z.sent().json()];case 3:if(M=Z.sent(),j=M.content_state,W=M.view_state,!M.view_location)throw new Error("view_location is empty");if(W&&W!==C.Ready.toString()&&!p.default.silentError&&console.error("view_state is not ready"),j===C.Expired.toString())throw new Error("content_state is expired");return[2,M];case 4:throw ce=Z.sent(),!p.default.silentError&&console.log(ce),new Error("AMSGetViewStatusFailed");case 5:return[2]}})})},getView:function(x,N,F){return _(void 0,void 0,void 0,function(){var U,k,D,W;return d(this,function($){switch($.label){case 0:p.default.debug&&console.log("[API][getView]"),S(F),U=N,k=f(F.token),P.includes(x.type)&&(k[T.Accept]="image/webp,image/ *,*/*;q=0.8",k[T.AcceptEncoding]="gzip, deflate, sdch, br"),D={headers:k,method:"GET"},$.label=1;case 1:return $.trys.push([1,4,,5]),[4,fetch(U,D)];case 2:return[4,$.sent().blob()];case 3:return[2,$.sent()];case 4:throw W=$.sent(),!p.default.silentError&&console.log(W),new Error("AMSGetViewFailed");case 5:return[2]}})})}}},4543:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(b){for(var m,I=1,x=arguments.length;I<x;I++)for(var N in m=arguments[I])Object.prototype.hasOwnProperty.call(m,N)&&(b[N]=m[N]);return b}).apply(this,arguments)},_=this&&this.__awaiter||function(b,m,I,x){return new(I||(I=Promise))(function(F,U){function k(j){try{M(x.next(j))}catch(W){U(W)}}function D(j){try{M(x.throw(j))}catch(W){U(W)}}function M(j){j.done?F(j.value):function(F){return F instanceof I?F:new I(function(U){U(F)})}(j.value).then(k,D)}M((x=x.apply(b,m||[])).next())})},d=this&&this.__generator||function(b,m){var x,N,F,U,I={label:0,sent:function(){if(1&F[0])throw F[1];return F[1]},trys:[],ops:[]};return U={next:k(0),throw:k(1),return:k(2)},"function"==typeof Symbol&&(U[Symbol.iterator]=function(){return this}),U;function k(M){return function(j){return function(M){if(x)throw new TypeError("Generator is already executing.");for(;I;)try{if(x=1,N&&(F=2&M[0]?N.return:M[0]?N.throw||((F=N.return)&&F.call(N),0):N.next)&&!(F=F.call(N,M[1])).done)return F;switch(N=0,F&&(M=[2&M[0],F.value]),M[0]){case 0:case 1:F=M;break;case 4:return I.label++,{value:M[1],done:!1};case 5:I.label++,N=M[1],M=[0];continue;case 7:M=I.ops.pop(),I.trys.pop();continue;default:if(!(F=(F=I.trys).length>0&&F[F.length-1])&&(6===M[0]||2===M[0])){I=0;continue}if(3===M[0]&&(!F||M[1]>F[0]&&M[1]<F[3])){I.label=M[1];break}if(6===M[0]&&I.label<F[1]){I.label=F[1],F=M;break}if(F&&I.label<F[2]){I.label=F[2],I.ops.push(M);break}F[2]&&I.ops.pop(),I.trys.pop();continue}M=m.call(b,I)}catch(j){M=[6,j],N=0}finally{x=F=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([M,j])}}};Object.defineProperty(u,"__esModule",{value:!0});var p=c(2782),T=c(7643),l=c(4239),C=c(9638),P=c(759),S=c(8202),f=p.sdkVersion,E=function(){function b(m,I){void 0===m&&(m=void 0),void 0===I&&(I=void 0),this.clientId=S.uuidv4(),this.origin=window.location.origin,this.requestCallbacks={},this.debug=!1,this.iframeLoaded=!1,this.logger=m,this.iframeId="Microsoft_Omnichannel_AMSClient_Iframe_Window",I&&I.multiClient&&(this.iframeId=this.clientId)}return b.prototype.setDebug=function(m){this.debug=m},b.prototype.setup=function(){return _(this,void 0,void 0,function(){var m=this;return d(this,function(I){switch(I.label){case 0:if(this.debug&&console.log("[FramedClient][initialize]"),this.onMessageEvent(function(x){return m.handleEvent(x)}),!l.default.isBrowser())throw new Error("FramedMode was used in non-Web platform");return[4,this.loadIframe()];case 1:return I.sent(),this.iframeLoaded||!T.default.silentError&&console.error("iframe not loaded"),[2]}})})},b.prototype.initialize=function(m){return _(this,void 0,void 0,function(){return d(this,function(I){switch(I.label){case 0:return this.debug&&console.log("[FramedClient][initialize]"),this.chatToken=m.chatToken,[4,this.skypeTokenAuth()];case 1:return I.sent(),[2]}})})},b.prototype.skypeTokenAuth=function(m){return void 0===m&&(m=null),_(this,void 0,void 0,function(){var I,x=this;return d(this,function(N){switch(N.label){case 0:return this.debug&&console.log("[FramedClient][skypeAuth]"),I={chatToken:m||this.chatToken},[4,this.loadIframe()];case 1:return N.sent(),[2,new Promise(function(F,U){x.postMessage(P.default.Request,C.default.SkypeTokenAuth,I,F,U)})]}})})},b.prototype.createObject=function(m,I,x){return void 0===x&&(x=null),_(this,void 0,void 0,function(){var N,F=this;return d(this,function(U){switch(U.label){case 0:return this.debug&&console.log("[FramedClient][createObject]"),N={id:m,file:I,chatToken:x||this.chatToken},[4,this.loadIframe()];case 1:return U.sent(),[2,new Promise(function(k,D){F.postMessage(P.default.Request,C.default.CreateObject,N,k,D)})]}})})},b.prototype.uploadDocument=function(m,I,x){return void 0===x&&(x=null),_(this,void 0,void 0,function(){var N,F=this;return d(this,function(U){switch(U.label){case 0:return this.debug&&console.log("[FramedClient][uploadDocument]"),N={documentId:m,file:I,chatToken:x||this.chatToken},[4,this.loadIframe()];case 1:return U.sent(),[2,new Promise(function(k,D){F.postMessage(P.default.Request,C.default.UploadDocument,N,k,D)})]}})})},b.prototype.getViewStatus=function(m,I){return void 0===I&&(I=null),_(this,void 0,void 0,function(){var x,N=this;return d(this,function(F){switch(F.label){case 0:return x={fileMetadata:m,chatToken:I||this.chatToken},[4,this.loadIframe()];case 1:return F.sent(),[2,new Promise(function(U,k){N.postMessage(P.default.Request,C.default.GetViewStatus,x,U,k)})]}})})},b.prototype.getView=function(m,I,x){return void 0===x&&(x=null),_(this,void 0,void 0,function(){var N,F=this;return d(this,function(U){switch(U.label){case 0:return N={fileMetadata:m,viewLocation:I,chatToken:x||this.chatToken},[4,this.loadIframe()];case 1:return U.sent(),[2,new Promise(function(k,D){F.postMessage(P.default.Request,C.default.GetView,N,k,D)})]}})})},b.prototype.fetchBlob=function(m){return _(this,void 0,void 0,function(){var N;return d(this,function(F){switch(F.label){case 0:return F.trys.push([0,3,,4]),[4,fetch(m)];case 1:return[4,F.sent().blob()];case 2:return[2,F.sent()];case 3:throw N=F.sent(),!T.default.silentError&&console.log(N),new Error("fetchBlob");case 4:return[2]}})})},b.prototype.onMessageEvent=function(m){window.addEventListener("message",m,!0)},b.prototype.postMessage=function(m,I,x,N,F){void 0===x&&(x={}),void 0===N&&(N=function(k){return{}}),void 0===F&&(F=function(k){return{}});var U=S.uuidv4();this.requestCallbacks[U]={resolve:N,reject:F},this.targetWindow?this.targetWindow.postMessage(s({clientId:this.clientId,requestId:U,eventType:m,eventName:I},x),"*"):!T.default.silentError&&console.error("Target window not found!")},b.prototype.handleEvent=function(m){var I;return _(this,void 0,void 0,function(){var x;return d(this,function(N){return m.origin===this.origin||p.baseUrl.includes(m.origin)?(m.data.clientId!==this.clientId||(this.debug&&console.log(m),m.source&&(this.targetWindow=m.source),m.data.eventType===P.default.Response&&(this.debug&&console.log("[FramedClient][Response]"),x=m.data,m.data.eventName===C.default.SkypeTokenAuth?x.requestId in this.requestCallbacks&&(this.requestCallbacks[x.requestId].resolve(),delete this.requestCallbacks[x.requestId]):m.data.eventName===C.default.CreateObject||m.data.eventName===C.default.UploadDocument||m.data.eventName===C.default.GetViewStatus||m.data.eventName===C.default.GetView?x.requestId in this.requestCallbacks&&(this.requestCallbacks[x.requestId].resolve(x.response),delete this.requestCallbacks[x.requestId]):m.data.eventName===C.default.SendTelemetry&&(null===(I=this.logger)||void 0===I||I.log(x.logLevel,x.logData.Event,x.logData)))),[2]):[2]})})},b.prototype.dispose=function(){var m;null===(m=document.getElementById(this.iframeId))||void 0===m||m.remove(),this.requestCallbacks={},this.iframeLoaded=!1},b.prototype.loadIframe=function(){return _(this,void 0,void 0,function(){var m=this;return d(this,function(I){return[2,new Promise(function(x,N){if(Array.from(document.getElementsByTagName("iframe")).filter(function(D){return D.id==m.iframeId}).length)return x();var k=document.createElement("iframe");k.id=m.iframeId,k.src=p.baseUrl+"/"+f+"/iframe.html?clientId="+m.clientId+"&debug="+m.debug+"&telemetry=true",k.addEventListener("load",function(){m.debug&&console.log("iframe loaded!"),m.iframeLoaded=!0,x()}),k.addEventListener("error",function(){N()}),document.head.append(k)})]})})},b}();u.default=E},1700:function(Q,u,c){"use strict";var s=this&&this.__awaiter||function(S,f,g,E){return new(g||(g=Promise))(function(m,I){function x(U){try{F(E.next(U))}catch(k){I(k)}}function N(U){try{F(E.throw(U))}catch(k){I(k)}}function F(U){U.done?m(U.value):function(m){return m instanceof g?m:new g(function(I){I(m)})}(U.value).then(x,N)}F((E=E.apply(S,f||[])).next())})},_=this&&this.__generator||function(S,f){var E,b,m,I,g={label:0,sent:function(){if(1&m[0])throw m[1];return m[1]},trys:[],ops:[]};return I={next:x(0),throw:x(1),return:x(2)},"function"==typeof Symbol&&(I[Symbol.iterator]=function(){return this}),I;function x(F){return function(U){return function(F){if(E)throw new TypeError("Generator is already executing.");for(;g;)try{if(E=1,b&&(m=2&F[0]?b.return:F[0]?b.throw||((m=b.return)&&m.call(b),0):b.next)&&!(m=m.call(b,F[1])).done)return m;switch(b=0,m&&(F=[2&F[0],m.value]),F[0]){case 0:case 1:m=F;break;case 4:return g.label++,{value:F[1],done:!1};case 5:g.label++,b=F[1],F=[0];continue;case 7:F=g.ops.pop(),g.trys.pop();continue;default:if(!(m=(m=g.trys).length>0&&m[m.length-1])&&(6===F[0]||2===F[0])){g=0;continue}if(3===F[0]&&(!m||F[1]>m[0]&&F[1]<m[3])){g.label=F[1];break}if(6===F[0]&&g.label<m[1]){g.label=m[1],m=F;break}if(m&&g.label<m[2]){g.label=m[2],g.ops.push(F);break}m[2]&&g.ops.pop(),g.trys.pop();continue}F=f.call(S,g)}catch(U){F=[6,U],b=0}finally{E=m=0}if(5&F[0])throw F[1];return{value:F[0]?F[1]:void 0,done:!0}}([F,U])}}};Object.defineProperty(u,"__esModule",{value:!0});var d=c(9237),p=c(5356),T=c(9638),l=c(4239),C=c(2782),P=function(){function S(f){void 0===f&&(f=void 0),this.debug=!1,this.logger=f,l.default.isBrowser()&&console.error("FramedMode should be used on Web platform")}return S.prototype.setDebug=function(f){this.debug=f},S.prototype.setup=function(){return s(this,void 0,void 0,function(){return _(this,function(f){return[2,Promise.resolve()]})})},S.prototype.initialize=function(f){return s(this,void 0,void 0,function(){return _(this,function(g){switch(g.label){case 0:return this.debug&&console.log("[FramedlessClient][initialize]"),this.chatToken=f.chatToken,[4,this.skypeTokenAuth()];case 1:return g.sent(),[2]}})})},S.prototype.skypeTokenAuth=function(f){var g,E,b;return void 0===f&&(f=null),s(this,void 0,void 0,function(){var m,I;return _(this,function(x){switch(x.label){case 0:return x.trys.push([0,2,,3]),[4,d.default.skypeTokenAuth(f||this.chatToken)];case 1:return(m=x.sent()).ok||null===(g=this.logger)||void 0===g||g.log(p.default.ERROR,T.default.SkypeTokenAuth,{ChatId:f?f.chatId:null===(E=this.chatToken)||void 0===E?void 0:E.chatId,AMSClientVersion:C.sdkVersion,ExceptionDetails:{status:m.status}}),[2,m];case 2:throw I=x.sent(),null===(b=this.logger)||void 0===b||b.log(p.default.ERROR,T.default.SkypeTokenAuth,{ChatId:f?f.chatId:this.chatToken.chatId,AMSClientVersion:C.sdkVersion,ExceptionDetails:I}),new Error("skypeTokenAuth");case 3:return[2]}})})},S.prototype.createObject=function(f,g,E){var b;return void 0===E&&(E=null),s(this,void 0,void 0,function(){var I;return _(this,function(x){switch(x.label){case 0:return x.trys.push([0,2,,3]),[4,d.default.createObject(f,g,E||this.chatToken)];case 1:return[2,x.sent()];case 2:throw I=x.sent(),null===(b=this.logger)||void 0===b||b.log(p.default.ERROR,T.default.CreateObject,{ChatId:E?E.chatId:this.chatToken.chatId,AMSClientVersion:C.sdkVersion,ExceptionDetails:I}),new Error("createObject");case 3:return[2]}})})},S.prototype.uploadDocument=function(f,g,E){var b;return void 0===E&&(E=null),s(this,void 0,void 0,function(){var I;return _(this,function(x){switch(x.label){case 0:return x.trys.push([0,2,,3]),[4,d.default.uploadDocument(f,g,E||this.chatToken)];case 1:return[2,x.sent()];case 2:throw I=x.sent(),null===(b=this.logger)||void 0===b||b.log(p.default.ERROR,T.default.UploadDocument,{ChatId:E?E.chatId:this.chatToken.chatId,AMSClientVersion:C.sdkVersion,ExceptionDetails:I}),new Error("uploadDocument");case 3:return[2]}})})},S.prototype.getViewStatus=function(f,g){var E;return void 0===g&&(g=null),s(this,void 0,void 0,function(){var m;return _(this,function(I){switch(I.label){case 0:return I.trys.push([0,2,,3]),[4,d.default.getViewStatus(f,g||this.chatToken)];case 1:return[2,I.sent()];case 2:throw m=I.sent(),null===(E=this.logger)||void 0===E||E.log(p.default.ERROR,T.default.GetViewStatus,{ChatId:g?g.chatId:this.chatToken.chatId,AMSClientVersion:C.sdkVersion,ExceptionDetails:m}),new Error("getViewStatus");case 3:return[2]}})})},S.prototype.getView=function(f,g,E){var b;return void 0===E&&(E=null),s(this,void 0,void 0,function(){var I;return _(this,function(x){switch(x.label){case 0:return x.trys.push([0,2,,3]),[4,d.default.getView(f,g,E||this.chatToken)];case 1:return[2,x.sent()];case 2:throw I=x.sent(),null===(b=this.logger)||void 0===b||b.log(p.default.ERROR,T.default.GetView,{ChatId:E?E.chatId:this.chatToken.chatId,AMSClientVersion:C.sdkVersion,ExceptionDetails:I}),new Error("getView");case 3:return[2]}})})},S.prototype.fetchBlob=function(f){return s(this,void 0,void 0,function(){var b;return _(this,function(m){switch(m.label){case 0:return m.trys.push([0,3,,4]),[4,fetch(f)];case 1:return[4,m.sent().blob()];case 2:return[2,m.sent()];case 3:throw b=m.sent(),console.log(b),new Error("fetchBlob");case 4:return[2]}})})},S}();u.default=P},7643:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.silentError=!0,s.debug=!1,s}();u.default=c},5356:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR",s.LOG="LOG",c;var s})();u.default=c},9638:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).IframeLoaded="AMSIframeLoaded",s.SkypeTokenAuth="AMSSkypeTokenAuth",s.CreateObject="AMSCreateObject",s.UploadDocument="AMSUploadDocument",s.GetViewStatus="AMSGetViewStatus",s.GetView="AMSGetView",s.SendTelemetry="AMSSendTelemetry",c;var s})();u.default=c},759:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).None="None",s.Request="Request",s.Response="Response",c;var s})();u.default=c},2782:(Q,u)=>{u.baseUrl="https://comms.omnichannelengagementhub.com/ams",u.sdkVersion="0.1.0"},3285:function(Q,u,c){"use strict";var s=this&&this.__awaiter||function(P,S,f,g){return new(f||(f=Promise))(function(b,m){function I(F){try{N(g.next(F))}catch(U){m(U)}}function x(F){try{N(g.throw(F))}catch(U){m(U)}}function N(F){F.done?b(F.value):function(b){return b instanceof f?b:new f(function(m){m(b)})}(F.value).then(I,x)}N((g=g.apply(P,S||[])).next())})},_=this&&this.__generator||function(P,S){var g,E,b,m,f={label:0,sent:function(){if(1&b[0])throw b[1];return b[1]},trys:[],ops:[]};return m={next:I(0),throw:I(1),return:I(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m;function I(N){return function(F){return function(N){if(g)throw new TypeError("Generator is already executing.");for(;f;)try{if(g=1,E&&(b=2&N[0]?E.return:N[0]?E.throw||((b=E.return)&&b.call(E),0):E.next)&&!(b=b.call(E,N[1])).done)return b;switch(E=0,b&&(N=[2&N[0],b.value]),N[0]){case 0:case 1:b=N;break;case 4:return f.label++,{value:N[1],done:!1};case 5:f.label++,E=N[1],N=[0];continue;case 7:N=f.ops.pop(),f.trys.pop();continue;default:if(!(b=(b=f.trys).length>0&&b[b.length-1])&&(6===N[0]||2===N[0])){f=0;continue}if(3===N[0]&&(!b||N[1]>b[0]&&N[1]<b[3])){f.label=N[1];break}if(6===N[0]&&f.label<b[1]){f.label=b[1],b=N;break}if(b&&f.label<b[2]){f.label=b[2],f.ops.push(N);break}b[2]&&f.ops.pop(),f.trys.pop();continue}N=S.call(P,f)}catch(F){N=[6,F],E=0}finally{g=b=0}if(5&N[0])throw N[1];return{value:N[0]?N[1]:void 0,done:!0}}([N,F])}}};Object.defineProperty(u,"__esModule",{value:!0});var d=c(7987),p=c(4543),T=c(1700),l=c(7643);u.default=function(P){return s(void 0,void 0,void 0,function(){var S,f,g;return _(this,function(E){switch(E.label){case 0:return P.debug&&console.log("[createAMSClient] "+(P.framedMode?"FramedClient":"FramedlessClient")),S=new d.default(P.logger),f={multiClient:P.multiClient||!1},[4,(g=P.framedMode?new p.default(S,f):new T.default(S)).setup()];case 1:return E.sent(),P.debug&&g.setDebug(P.debug||!1),l.default.debug=P.debug||!1,l.default.silentError=P.silentError||!0,[2,g]}})})}},7463:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(3285),_=c(1700),d=c(4543);u.default=s.default,function(){if(void 0===typeof window)throw new Error("window object not found");"Microsoft"in window||(window.Microsoft={}),"CRM"in window.Microsoft||(window.Microsoft.CRM={}),"Omnichannel"in window.Microsoft.CRM||(window.Microsoft.CRM.Omnichannel={}),"AMSClient"in window.Microsoft.CRM.Omnichannel||(window.Microsoft.CRM.Omnichannel.AMS={SDK:{createAMSClient:s.default,FramedClient:d.default,FramedlessClient:_.default}})}()},4239:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.isReactNative=u.isNode=u.isBrowser=void 0,u.isBrowser=function(){return"undefined"!=typeof window&&void 0!==window.document},u.isNode=function(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node},u.isReactNative=function(){return"undefined"!=typeof navigator&&"ReactNative"==navigator.product},u.default={isBrowser:u.isBrowser,isNode:u.isNode,isReactNative:u.isReactNative}},8202:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.uuidv4=void 0,u.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var _=16*Math.random()|0;return("x"===s?_:3&_|8).toString(16)})}},7626:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(ne){for(var te,ae=1,ve=arguments.length;ae<ve;ae++)for(var ye in te=arguments[ae])Object.prototype.hasOwnProperty.call(te,ye)&&(ne[ye]=te[ye]);return ne}).apply(this,arguments)},_=this&&this.__awaiter||function(ne,te,ae,ve){return new(ae||(ae=Promise))(function(ge,be){function Ae(Le){try{Ie(ve.next(Le))}catch(We){be(We)}}function xe(Le){try{Ie(ve.throw(Le))}catch(We){be(We)}}function Ie(Le){Le.done?ge(Le.value):function(ge){return ge instanceof ae?ge:new ae(function(be){be(ge)})}(Le.value).then(Ae,xe)}Ie((ve=ve.apply(ne,te||[])).next())})},d=this&&this.__generator||function(ne,te){var ve,ye,ge,be,ae={label:0,sent:function(){if(1&ge[0])throw ge[1];return ge[1]},trys:[],ops:[]};return be={next:Ae(0),throw:Ae(1),return:Ae(2)},"function"==typeof Symbol&&(be[Symbol.iterator]=function(){return this}),be;function Ae(Ie){return function(Le){return function(Ie){if(ve)throw new TypeError("Generator is already executing.");for(;ae;)try{if(ve=1,ye&&(ge=2&Ie[0]?ye.return:Ie[0]?ye.throw||((ge=ye.return)&&ge.call(ye),0):ye.next)&&!(ge=ge.call(ye,Ie[1])).done)return ge;switch(ye=0,ge&&(Ie=[2&Ie[0],ge.value]),Ie[0]){case 0:case 1:ge=Ie;break;case 4:return ae.label++,{value:Ie[1],done:!1};case 5:ae.label++,ye=Ie[1],Ie=[0];continue;case 7:Ie=ae.ops.pop(),ae.trys.pop();continue;default:if(!(ge=(ge=ae.trys).length>0&&ge[ge.length-1])&&(6===Ie[0]||2===Ie[0])){ae=0;continue}if(3===Ie[0]&&(!ge||Ie[1]>ge[0]&&Ie[1]<ge[3])){ae.label=Ie[1];break}if(6===Ie[0]&&ae.label<ge[1]){ae.label=ge[1],ge=Ie;break}if(ge&&ae.label<ge[2]){ae.label=ge[2],ae.ops.push(Ie);break}ge[2]&&ae.ops.pop(),ae.trys.pop();continue}Ie=te.call(ne,ae)}catch(Le){Ie=[6,Le],ye=0}finally{ve=ge=0}if(5&Ie[0])throw Ie[1];return{value:Ie[0]?Ie[1]:void 0,done:!0}}([Ie,Le])}}},p=this&&this.__spreadArrays||function(){for(var ne=0,te=0,ae=arguments.length;te<ae;te++)ne+=arguments[te].length;var ve=Array(ne),ye=0;for(te=0;te<ae;te++)for(var ge=arguments[te],be=0,Ae=ge.length;be<Ae;be++,ye++)ve[ye]=ge[be];return ve};Object.defineProperty(u,"__esModule",{value:!0});var T=c(2902),l=c(8953),C=c(2921),P=c(6419),S=c(2562),f=c(7925),g=c(7463),E=c(2811),b=c(9340),m=c(838),I=c(6633),x=c(813),N=c(2900),F=c(4694),U=c(2217),k=c(9425),D=c(6406),M=c(5642),j=c(8191),W=c(6345),$=c(448),ce=c(3372),oe=c(4352),Z=c(8098),ue=c(5655),he=c(1247),Ee=c(3762),se=c(6194),K=c(9600),pe=c(7616),re=c(641),J=function(){function ne(te,ae){var ve,ye,ge,be,Ae,xe,Ie;void 0===ae&&(ae=re.defaultChatSDKConfig),this.ACSClient=null,this.AMSClient=null,this.authSettings=null,this.authenticatedUserToken=null,this.conversation=null,this.callingOption=P.default.NoCalling,this.telemetry=null,this.ic3ClientLogger=null,this.ocSdkLogger=null,this.acsClientLogger=null,this.acsAdapterLogger=null,this.isPersistentChat=!1,this.isChatReconnect=!1,this.reconnectId=null,this.refreshTokenTimer=null,this.debug=!1,this.omnichannelConfig=te,this.chatSDKConfig=s(s({},re.defaultChatSDKConfig),ae),this.isInitialized=!1,this.liveChatVersion=j.default.V1,this.requestId=Ee.uuidv4(),this.chatToken={},this.liveChatConfig={},this.dataMaskingRules={},this.authSettings=null,this.preChatSurvey=null,this.telemetry=m.default(this.debug),this.scenarioMarker=new he.default(this.omnichannelConfig),this.ic3ClientLogger=E.createIC3ClientLogger(this.omnichannelConfig),this.ocSdkLogger=E.createOCSDKLogger(this.omnichannelConfig),this.acsClientLogger=E.createACSClientLogger(this.omnichannelConfig),this.acsAdapterLogger=E.createACSAdapterLogger(this.omnichannelConfig),this.scenarioMarker.useTelemetry(this.telemetry),this.ic3ClientLogger.useTelemetry(this.telemetry),this.ocSdkLogger.useTelemetry(this.telemetry),this.acsClientLogger.useTelemetry(this.telemetry),this.acsAdapterLogger.useTelemetry(this.telemetry),pe.default(te),re.default(ae),(null===(ve=this.chatSDKConfig.telemetry)||void 0===ve?void 0:ve.disable)&&(null===(ye=this.telemetry)||void 0===ye||ye.disable()),(null===(ge=this.chatSDKConfig.telemetry)||void 0===ge?void 0:ge.ariaTelemetryKey)&&this.telemetry.initialize(this.chatSDKConfig.telemetry.ariaTelemetryKey),null===(be=this.ic3ClientLogger)||void 0===be||be.setRequestId(this.requestId),null===(Ae=this.ocSdkLogger)||void 0===Ae||Ae.setRequestId(this.requestId),null===(xe=this.acsClientLogger)||void 0===xe||xe.setRequestId(this.requestId),null===(Ie=this.acsAdapterLogger)||void 0===Ie||Ie.setRequestId(this.requestId)}return ne.prototype.setDebug=function(te){var ae,ve,ye,ge,be,Ae;this.debug=te,null===(ae=this.AMSClient)||void 0===ae||ae.setDebug(te),null===(ve=this.telemetry)||void 0===ve||ve.setDebug(te),this.scenarioMarker.setDebug(te),null===(ye=this.ic3ClientLogger)||void 0===ye||ye.setDebug(te),null===(ge=this.ocSdkLogger)||void 0===ge||ge.setDebug(te),null===(be=this.acsClientLogger)||void 0===be||be.setDebug(te),null===(Ae=this.acsAdapterLogger)||void 0===Ae||Ae.setDebug(te)},ne.prototype.initialize=function(){return _(this,void 0,void 0,function(){var te,ae,ve;return d(this,function(ge){switch(ge.label){case 0:if(this.scenarioMarker.startScenario(K.default.InitializeChatSDK),this.isInitialized)return this.scenarioMarker.completeScenario(K.default.InitializeChatSDK),[2,this.liveChatConfig];ge.label=1;case 1:return ge.trys.push([1,8,,9]),this.OCSDKProvider=Ee.SDKProvider,te=this,[4,Ee.SDKProvider.getSDK(this.omnichannelConfig,{},this.ocSdkLogger)];case 2:return te.OCClient=ge.sent(),[4,this.getChatConfig()];case 3:return ge.sent(),this.liveChatVersion!==j.default.V2?[3,5]:(this.ACSClient=new T.default(this.acsClientLogger),ae=this,[4,g.default({framedMode:Z.isBrowser(),debug:!1,logger:void 0})]);case 4:return ae.AMSClient=ge.sent(),[3,7];case 5:return ve=this,[4,this.getIC3Client()];case 6:ve.IC3Client=ge.sent(),ge.label=7;case 7:return this.isInitialized=!0,this.scenarioMarker.completeScenario(K.default.InitializeChatSDK),[3,9];case 8:return ge.sent(),this.scenarioMarker.failScenario(K.default.InitializeChatSDK),[3,9];case 9:return[2,this.liveChatConfig]}})})},ne.prototype.getChatReconnectContext=function(te){return void 0===te&&(te={}),_(this,void 0,void 0,function(){var ae,ye,ge,Ae,xe,be;return d(this,function(Ie){switch(Ie.label){case 0:if(this.scenarioMarker.startScenario(K.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),ae={reconnectId:null,redirectURL:null},!this.authenticatedUserToken)return[3,5];Ie.label=1;case 1:return Ie.trys.push([1,3,,4]),[4,this.OCClient.getReconnectableChats({authenticatedUserToken:this.authenticatedUserToken})];case 2:return(ye=Ie.sent())&&ye.reconnectid&&(ae.reconnectId=ye.reconnectid),this.scenarioMarker.completeScenario(K.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:return ge=Ie.sent(),be={response:"OCClientGetReconnectableChatsFailed"},this.scenarioMarker.failScenario(K.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(be)}),console.error("OmnichannelChatSDK/GetChatReconnectContext/error "+ge),[3,4];case 4:return[3,9];case 5:if(!te.reconnectId)return[3,9];Ie.label=6;case 6:return Ie.trys.push([6,8,,9]),[4,this.OCClient.getReconnectAvailability(te.reconnectId)];case 7:return(Ae=Ie.sent())&&!Ae.isReconnectAvailable?Ae.reconnectRedirectionURL&&(ae.redirectURL=Ae.reconnectRedirectionURL):ae.reconnectId=te.reconnectId,this.scenarioMarker.completeScenario(K.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,9];case 8:return xe=Ie.sent(),be={response:"OCClientGetReconnectAvailabilityFailed"},this.scenarioMarker.failScenario(K.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(be)}),console.error("OmnichannelChatSDK/GetChatReconnectContext/error "+xe),[3,9];case 9:return[2,ae]}})})},ne.prototype.startChat=function(te){var ae,ve,ye,ge,be,Ae,xe,Ie,Le,We,Ve,Be,$e;return void 0===te&&(te={}),_(this,void 0,void 0,function(){var Ke,Ue,Gt,rr,Tn,Nr,ke,ze,bt,Nt,Pt,Qe,an=this;return d(this,function(Ot){switch(Ot.label){case 0:if(this.scenarioMarker.startScenario(K.default.StartChat,{RequestId:this.requestId}),this.isChatReconnect&&!(null===(ae=this.chatSDKConfig.chatReconnect)||void 0===ae?void 0:ae.disable)&&!this.isPersistentChat&&te.reconnectId&&(this.reconnectId=te.reconnectId),!this.isPersistentChat||(null===(ve=this.chatSDKConfig.persistentChat)||void 0===ve?void 0:ve.disable))return[3,4];Ot.label=1;case 1:return Ot.trys.push([1,3,,4]),[4,this.OCClient.getReconnectableChats({authenticatedUserToken:this.authenticatedUserToken})];case 2:return(Ke=Ot.sent())&&Ke.reconnectid&&(this.reconnectId=Ke.reconnectid),[3,4];case 3:throw Ot.sent(),Qe={response:"OCClientGetReconnectableChatsFailed"},Error(Qe.response);case 4:return!te.liveChatContext||this.isPersistentChat||this.isChatReconnect?[3,6]:(this.chatToken=te.liveChatContext.chatToken||{},this.requestId=te.liveChatContext.requestId||Ee.uuidv4(),[4,this.getConversationDetails()]);case 5:if(Ue=Ot.sent(),0===Object.keys(Ue).length)throw Qe={response:"InvalidConversation"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),console.error("Conversation not found"),Error(Qe.response);if(Ue.state===M.default.WrapUp||Ue.state===M.default.Closed)throw Qe={response:"ClosedConversation"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),console.error("Unable to join conversation that's in '"+Ue.state+"' state"),Error(Qe.response);Ot.label=6;case 6:return this.chatToken&&0===Object.keys(this.chatToken).length?[4,this.getChatToken(!1)]:[3,8];case 7:Ot.sent(),Ot.label=8;case 8:null===(ye=this.ic3ClientLogger)||void 0===ye||ye.setChatId(this.chatToken.chatId||""),null===(ge=this.ocSdkLogger)||void 0===ge||ge.setChatId(this.chatToken.chatId||""),null===(be=this.acsClientLogger)||void 0===be||be.setChatId(this.chatToken.chatId||""),null===(Ae=this.acsAdapterLogger)||void 0===Ae||Ae.setChatId(this.chatToken.chatId||""),Gt={initContext:{}},this.isPersistentChat&&!(null===(xe=this.chatSDKConfig.persistentChat)||void 0===xe?void 0:xe.disable)&&(Gt.reconnectId=this.reconnectId),this.isChatReconnect&&!(null===(Ie=this.chatSDKConfig.chatReconnect)||void 0===Ie?void 0:Ie.disable)&&!this.isPersistentChat&&(Gt.reconnectId=this.reconnectId),te.customContext&&(Gt.initContext.customContextData=te.customContext),te.browser&&(Gt.initContext.browser=te.browser),te.os&&(Gt.initContext.os=te.os),te.locale&&(Gt.initContext.locale=te.locale),te.device&&(Gt.initContext.device=te.device),te.preChatResponse&&(Gt.initContext.preChatResponse=te.preChatResponse),te.initContext&&(Gt.initContext=te.initContext),this.authenticatedUserToken&&(Gt.authenticatedUserToken=this.authenticatedUserToken),Ot.label=9;case 9:return Ot.trys.push([9,11,,12]),[4,this.OCClient.sessionInit(this.requestId,Gt)];case 10:return Ot.sent(),[3,12];case 11:return rr=Ot.sent(),Qe={response:"OCClientSessionInitFailed"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),console.error("OmnichannelChatSDK/startChat/sessionInit/error "+rr),[2,rr];case 12:if(this.liveChatVersion!==j.default.V2)return[3,23];Tn={token:this.chatToken.token,id:this.chatToken.visitorId||"teamsvisitor",threadId:this.chatToken.chatId,environmentUrl:this.chatToken.acsEndpoint,pollingInterval:1e3},Ot.label=13;case 13:return Ot.trys.push([13,15,,16]),[4,null===(Le=this.ACSClient)||void 0===Le?void 0:Le.initialize({token:Tn.token,environmentUrl:Tn.environmentUrl})];case 14:return Ot.sent(),[3,16];case 15:return Nr=Ot.sent(),Qe={response:"ACSClientInitializeFailed"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),console.error("OmnichannelChatSDK/startChat/initialize/error "+Nr),[2,Nr];case 16:return Ot.trys.push([16,18,,19]),ke=this,[4,null===(We=this.ACSClient)||void 0===We?void 0:We.joinConversation({id:Tn.id,threadId:Tn.threadId,pollingInterval:Tn.pollingInterval})];case 17:return ke.conversation=Ot.sent(),this.scenarioMarker.completeScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,19];case 18:throw ze=Ot.sent(),Qe={response:"ACSClientJoinConversationFailed"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),console.error("OmnichannelChatSDK/startChat/joinConversation/error "+ze),Error(Qe.response);case 19:return Ot.trys.push([19,21,,22]),[4,null===(Ve=this.AMSClient)||void 0===Ve?void 0:Ve.initialize({chatToken:this.chatToken})];case 20:return Ot.sent(),[3,22];case 21:throw Ot.sent(),Qe={response:"AMSClientInitializeFailed"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),Error(Qe.response);case 22:return[3,29];case 23:return Ot.trys.push([23,25,,26]),[4,this.IC3Client.initialize({token:this.chatToken.token,regionGtms:this.chatToken.regionGTMS,visitor:!0})];case 24:return Ot.sent(),[3,26];case 25:return bt=Ot.sent(),Qe={response:"IC3ClientInitializeFailed"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),console.error("OmnichannelChatSDK/startChat/initialize/error "+bt),[2,bt];case 26:return Ot.trys.push([26,28,,29]),Nt=this,[4,this.IC3Client.joinConversation(this.chatToken.chatId)];case 27:return Nt.conversation=Ot.sent(),this.scenarioMarker.completeScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,29];case 28:return Pt=Ot.sent(),Qe={response:"IC3ClientJoinConversationFailed"},this.scenarioMarker.failScenario(K.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Qe)}),console.error("OmnichannelChatSDK/startChat/joinConversation/error "+Pt),[2,Pt];case 29:return this.isPersistentChat&&!(null===(Be=this.chatSDKConfig.persistentChat)||void 0===Be?void 0:Be.disable)&&(this.refreshTokenTimer=setInterval(function(){return _(an,void 0,void 0,function(){return d(this,function(si){switch(si.label){case 0:return[4,this.getChatToken(!1)];case 1:return si.sent(),this.updateChatToken(this.chatToken.token,this.chatToken.regionGTMS),[2]}})})},null===($e=this.chatSDKConfig.persistentChat)||void 0===$e?void 0:$e.tokenUpdateTime)),[2]}})})},ne.prototype.endChat=function(){var te,ae,ve,ye,ge,be,Ae,xe,Ie,Le,We;return _(this,void 0,void 0,function(){var Ve,Be,Ye;return d(this,function(qe){switch(qe.label){case 0:this.scenarioMarker.startScenario(K.default.EndChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),Ve={},this.isPersistentChat&&!(null===(te=this.chatSDKConfig.persistentChat)||void 0===te?void 0:te.disable)&&(Be=null!==this.reconnectId,Ve.isPersistentChat=this.isPersistentChat,Ve.isReconnectChat=Be),this.isChatReconnect&&!(null===(ae=this.chatSDKConfig.chatReconnect)||void 0===ae?void 0:ae.disable)&&!this.isPersistentChat&&(Ve.isReconnectChat=null!==this.reconnectId),this.authenticatedUserToken&&(Ve.authenticatedUserToken=this.authenticatedUserToken),qe.label=1;case 1:return qe.trys.push([1,3,,4]),[4,this.OCClient.sessionClose(this.requestId,Ve)];case 2:return qe.sent(),this.scenarioMarker.completeScenario(K.default.EndChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),null===(ve=this.conversation)||void 0===ve||ve.disconnect(),this.conversation=null,this.requestId=Ee.uuidv4(),this.chatToken={},this.reconnectId=null,null===(ye=this.ic3ClientLogger)||void 0===ye||ye.setRequestId(this.requestId),null===(ge=this.ic3ClientLogger)||void 0===ge||ge.setChatId(""),null===(be=this.ocSdkLogger)||void 0===be||be.setRequestId(this.requestId),null===(Ae=this.ocSdkLogger)||void 0===Ae||Ae.setChatId(""),null===(xe=this.acsClientLogger)||void 0===xe||xe.setRequestId(this.requestId),null===(Ie=this.acsClientLogger)||void 0===Ie||Ie.setChatId(""),null===(Le=this.acsAdapterLogger)||void 0===Le||Le.setRequestId(this.requestId),null===(We=this.acsAdapterLogger)||void 0===We||We.setChatId(""),[3,4];case 3:return Ye=qe.sent(),this.scenarioMarker.failScenario(K.default.EndChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify({response:"OCClientSessionCloseFailed"})}),console.error("OmnichannelChatSDK/endChat/error "+Ye),[2,Ye];case 4:return null!==this.refreshTokenTimer&&(clearInterval(this.refreshTokenTimer),this.refreshTokenTimer=null),[2]}})})},ne.prototype.getCurrentLiveChatContext=function(){return _(this,void 0,void 0,function(){var te,ae,ve;return d(this,function(ye){switch(ye.label){case 0:return[4,this.getChatToken()];case 1:return te=ye.sent(),this.scenarioMarker.startScenario(K.default.GetCurrentLiveChatContext,{RequestId:ae=this.requestId,ChatId:te.chatId}),ve={chatToken:te,requestId:ae},0===Object.keys(ve.chatToken).length?[2,{}]:(this.scenarioMarker.completeScenario(K.default.GetCurrentLiveChatContext,{RequestId:ae,ChatId:te.chatId}),[2,ve])}})})},ne.prototype.getConversationDetails=function(){var te,ae;return _(this,void 0,void 0,function(){var ve,be,Ae,xe;return d(this,function(Ie){switch(Ie.label){case 0:this.scenarioMarker.startScenario(K.default.GetConversationDetails,{RequestId:this.requestId,ChatId:(null===(te=this.chatToken)||void 0===te?void 0:te.chatId)||""}),Ie.label=1;case 1:return Ie.trys.push([1,3,,4]),[4,this.OCClient.getLWIDetails(this.requestId)];case 2:return ve=Ie.sent(),Ae={state:ve.State,conversationId:ve.ConversationId},(be=ve.AgentAcceptedOn)&&(Ae.agentAcceptedOn=be),this.scenarioMarker.completeScenario(K.default.GetConversationDetails,{RequestId:this.requestId,ChatId:(null===(ae=this.chatToken)||void 0===ae?void 0:ae.chatId)||""}),[2,Ae];case 3:return xe=Ie.sent(),this.scenarioMarker.failScenario(K.default.GetConversationDetails,{RequestId:this.requestId,ChatId:this.chatToken.chatId||""}),console.error("OmnichannelChatSDK/getConversationDetails/error "+xe),[3,4];case 4:return[2,{}]}})})},ne.prototype.getPreChatSurvey=function(te){return void 0===te&&(te=!0),_(this,void 0,void 0,function(){var ae;return d(this,function(ve){this.scenarioMarker.startScenario(K.default.GetPreChatSurvey);try{return ae=te?JSON.parse(this.preChatSurvey):this.preChatSurvey,this.scenarioMarker.completeScenario(K.default.GetPreChatSurvey),[2,ae]}catch(ye){this.scenarioMarker.failScenario(K.default.GetPreChatSurvey)}return[2]})})},ne.prototype.getLiveChatConfig=function(te){return void 0===te&&(te=!0),_(this,void 0,void 0,function(){return d(this,function(ae){return te?[2,this.liveChatConfig]:[2,this.getChatConfig()]})})},ne.prototype.getChatToken=function(te){var ae,ve;return void 0===te&&(te=!0),_(this,void 0,void 0,function(){var ye,ge,Ae,Ie,Le,We,Ve,Be,$e;return d(this,function(Ke){switch(Ke.label){case 0:if(this.scenarioMarker.startScenario(K.default.GetChatToken,{RequestId:this.requestId}),te)return[3,5];Ke.label=1;case 1:return Ke.trys.push([1,3,,4]),ye={},this.authenticatedUserToken&&(ye.authenticatedUserToken=this.authenticatedUserToken),this.isPersistentChat&&!(null===(ae=this.chatSDKConfig.persistentChat)||void 0===ae?void 0:ae.disable)&&(ye.reconnectId=this.reconnectId),this.isChatReconnect&&!(null===(ve=this.chatSDKConfig.chatReconnect)||void 0===ve?void 0:ve.disable)&&!this.isPersistentChat&&(ye.reconnectId=this.reconnectId),[4,this.OCClient.getChatToken(this.requestId,ye)];case 2:return ge=Ke.sent(),Ae=ge.Token,Ie=ge.ExpiresIn,Le=ge.VisitorId,We=ge.VoiceVideoCallToken,Ve=ge.ACSEndpoint,Be=ge.AttachmentConfiguration,this.chatToken={chatId:ge.ChatId,regionGTMS:JSON.parse(ge.RegionGtms),requestId:this.requestId,token:Ae,expiresIn:Ie,visitorId:Le,voiceVideoCallToken:We,acsEndpoint:Ve},Be&&Be.AttachmentServiceEndpoint&&(this.chatToken.amsEndpoint=Be.AttachmentServiceEndpoint),this.scenarioMarker.completeScenario(K.default.GetChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:return $e=Ke.sent(),this.scenarioMarker.failScenario(K.default.GetChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify({response:"OCClientGetChatTokenFailed"})}),console.error("OmnichannelChatSDK/getChatToken/error "+$e),[3,4];case 4:return[3,6];case 5:this.scenarioMarker.completeScenario(K.default.GetChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),Ke.label=6;case 6:return[2,this.chatToken]}})})},ne.prototype.getCallingToken=function(){return _(this,void 0,void 0,function(){return d(this,function(te){return this.chatToken&&0===Object.keys(this.chatToken).length?[2,""]:this.chatToken.voiceVideoCallToken?(this.debug&&console.log("calling:acs"),[2,this.chatToken.voiceVideoCallToken.Token]):(this.debug&&console.log("calling:skype"),[2,this.chatToken.token])})})},ne.prototype.getMessages=function(){var te;return _(this,void 0,void 0,function(){var ae;return d(this,function(ye){switch(ye.label){case 0:this.scenarioMarker.startScenario(K.default.GetMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),ye.label=1;case 1:return ye.trys.push([1,3,,4]),[4,null===(te=this.conversation)||void 0===te?void 0:te.getMessages()];case 2:return ae=ye.sent(),this.scenarioMarker.completeScenario(K.default.GetMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,ae];case 3:return ye.sent(),this.scenarioMarker.failScenario(K.default.GetMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 4:return[2]}})})},ne.prototype.getDataMaskingRules=function(){return _(this,void 0,void 0,function(){return d(this,function(te){return[2,this.dataMaskingRules]})})},ne.prototype.sendMessage=function(te){var ae;return _(this,void 0,void 0,function(){var ve,ye,ge,be,Ae,xe,Le,We,Ve,Be,Ye;return d(this,function(qe){switch(qe.label){case 0:if(this.scenarioMarker.startScenario(K.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),ye=(ve=this.chatSDKConfig.dataMasking).disable,ge=ve.maskingCharacter,be=te.content,Object.keys(this.dataMaskingRules).length>0&&!ye)for(Ae=0,xe=Object.values(this.dataMaskingRules);Ae<xe.length;Ae++)for(Le=new RegExp(xe[Ae],"g"),We=void 0;We=Le.exec(be);)Ve=We[0].replace(/./g,ge),be=be.replace(We[0],Ve);if(te.content=be,this.liveChatVersion!==j.default.V2)return[3,5];Be={content:te.content},qe.label=1;case 1:return qe.trys.push([1,3,,4]),[4,null===(ae=this.conversation)||void 0===ae?void 0:ae.sendMessage(Be)];case 2:return qe.sent(),this.scenarioMarker.completeScenario(K.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:throw qe.sent(),this.scenarioMarker.failScenario(K.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("ChatSDKSendMessageFailed");case 4:return[3,9];case 5:Ye={content:te.content,timestamp:new Date,contentType:$.default.Text,deliveryMode:N.default.Bridged,messageType:ce.default.UserMessage,properties:void 0,tags:p(x.defaultMessageTags),sender:{displayName:"Customer",id:"customer",type:oe.default.User}},te.tags&&(Ye.tags=te.tags),te.timestamp&&(Ye.timestamp=te.timestamp),qe.label=6;case 6:return qe.trys.push([6,8,,9]),[4,this.conversation.sendMessage(Ye)];case 7:return qe.sent(),this.scenarioMarker.completeScenario(K.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,9];case 8:throw qe.sent(),this.scenarioMarker.failScenario(K.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("ChatSDKSendMessageFailed");case 9:return[2]}})})},ne.prototype.onNewMessage=function(te,ae){var ve,ye;return void 0===ae&&(ae={}),_(this,void 0,void 0,function(){var ge,Ae,xe,Le,We,be,Ve,Be,Ie,$e,Ye,Ke=this;return d(this,function(qe){switch(qe.label){case 0:return this.scenarioMarker.startScenario(K.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==j.default.V2?[3,3]:(ge=new Set,ae.rehydrate?(this.debug&&console.log("[OmnichannelChatSDK][onNewMessage] rehydrate"),[4,this.getMessages()]):[3,2]);case 1:for(be=qe.sent(),Ae=0,xe=be.reverse();Ae<xe.length;Ae++)!ge.has(Le=(Ie=xe[Ae]).id)&&(ge.add(Le),te(Ie));qe.label=2;case 2:try{null===(ve=this.conversation)||void 0===ve||ve.registerOnNewMessage(function(Qe){var Ue=Qe.id,Gt=b.default(Qe,{liveChatVersion:Ke.liveChatVersion,debug:Ke.debug});ge.has(Ue)||(te(Gt),ge.add(Ue))}),this.scenarioMarker.completeScenario(K.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(Qe){this.scenarioMarker.failScenario(K.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[3,6];case 3:return We=new Set,ae.rehydrate?(this.debug&&console.log("[OmnichannelChatSDK][onNewMessage] rehydrate"),[4,this.getMessages()]):[3,5];case 4:if(be=qe.sent())for(Ve=0,Be=be.reverse();Ve<Be.length;Ve++)!We.has($e=(Ie=Be[Ve]).clientmessageid)&&(We.add($e),Ye=b.default(Ie,{liveChatVersion:this.liveChatVersion,debug:this.debug}),te(Ye));qe.label=5;case 5:try{null===(ye=this.conversation)||void 0===ye||ye.registerOnNewMessage(function(Qe){var Ue=Qe.clientmessageid,Gt=Qe.messageType;if(!k.isCustomerMessage(Qe)&&!We.has(Ue)&&Gt!==ce.default.Typing){var rr=b.default(Qe,{liveChatVersion:Ke.liveChatVersion,debug:Ke.debug});te(rr)}}),this.scenarioMarker.completeScenario(K.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(Qe){this.scenarioMarker.failScenario(K.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}qe.label=6;case 6:return[2]}})})},ne.prototype.sendTypingEvent=function(){return _(this,void 0,void 0,function(){var ae,ve,ye,ge;return d(this,function(be){switch(be.label){case 0:if(this.scenarioMarker.startScenario(K.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==j.default.V2)return[3,6];be.label=1;case 1:return be.trys.push([1,4,,5]),[4,this.OCClient.sendTypingIndicator(this.requestId,j.default.V2,{customerDisplayName:l.default.Customer})];case 2:return be.sent(),[4,this.conversation.sendTyping()];case 3:return be.sent(),this.scenarioMarker.completeScenario(K.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,5];case 4:throw be.sent(),this.scenarioMarker.failScenario(K.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("OCClientSendTypingFailed");case 5:return[3,12];case 6:ae="{isTyping: 0}",be.label=7;case 7:return be.trys.push([7,11,,12]),[4,this.conversation.indicateTypingStatus(0)];case 8:return be.sent(),[4,this.conversation.getMembers()];case 9:return ve=be.sent(),ye=ve.filter(function(Ae){return Ae.type===oe.default.Bot}),[4,this.conversation.sendMessageToBot(ye[0].id,{payload:ae})];case 10:return be.sent(),this.scenarioMarker.completeScenario(K.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,12];case 11:return ge=be.sent(),console.error("OmnichannelChatSDK/sendTypingEvent/error"),this.scenarioMarker.failScenario(K.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,ge];case 12:return[2]}})})},ne.prototype.onTypingEvent=function(te){var ae;return _(this,void 0,void 0,function(){return d(this,function(ve){if(this.scenarioMarker.startScenario(K.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion===j.default.V2)try{this.conversation.onTypingEvent(te),this.scenarioMarker.completeScenario(K.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(ye){this.scenarioMarker.failScenario(K.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}else try{null===(ae=this.conversation)||void 0===ae||ae.registerOnNewMessage(function(ye){var ge=ye.messageType;k.isCustomerMessage(ye)||ge===ce.default.Typing&&te(ye)}),this.scenarioMarker.completeScenario(K.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(ye){this.scenarioMarker.failScenario(K.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},ne.prototype.onAgentEndSession=function(te){var ae;return _(this,void 0,void 0,function(){var ve=this;return d(this,function(ye){if(this.scenarioMarker.startScenario(K.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion===j.default.V2)try{this.conversation.registerOnThreadUpdate(function(ge){te(ge)}),this.scenarioMarker.completeScenario(K.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(ge){this.scenarioMarker.failScenario(K.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}else try{null===(ae=this.conversation)||void 0===ae||ae.registerOnThreadUpdate(function(ge){1===ge.members.length&&(te(ge),null!==ve.refreshTokenTimer&&(clearInterval(ve.refreshTokenTimer),ve.refreshTokenTimer=null))}),this.scenarioMarker.completeScenario(K.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(ge){this.scenarioMarker.failScenario(K.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},ne.prototype.uploadFileAttachment=function(te){var ae,ve,ye,ge;return _(this,void 0,void 0,function(){var be,Ae,xe,Ie,Le,We,$e,Ve,Ye;return d(this,function(Ke){switch(Ke.label){case 0:return this.scenarioMarker.startScenario(K.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==j.default.V2?[3,7]:[4,null===(ae=this.AMSClient)||void 0===ae?void 0:ae.createObject(null===(ve=this.chatToken)||void 0===ve?void 0:ve.chatId,te)];case 1:return be=Ke.sent(),Ae=be.id,[4,null===(ye=this.AMSClient)||void 0===ye?void 0:ye.uploadDocument(Ae,te)];case 2:xe=Ke.sent(),Ie={amsReferences:JSON.stringify([Ae])},Le={amsMetadata:JSON.stringify([{contentType:te.type,fileName:te.name}])},We={content:"",metadata:s(s({},Ie),Le)},Ve={content:"",timestamp:new Date,contentType:$.default.Text,deliveryMode:N.default.Bridged,messageType:ce.default.UserMessage,tags:p(x.defaultMessageTags),sender:{displayName:"Customer",id:"customer",type:oe.default.User},fileMetadata:xe},Ke.label=3;case 3:return Ke.trys.push([3,5,,6]),[4,null===(ge=this.conversation)||void 0===ge?void 0:ge.sendMessage(We)];case 4:return Ke.sent(),this.scenarioMarker.completeScenario(K.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Ve];case 5:return Ke.sent(),console.error("OmnichannelChatSDK/uploadFileAttachment/sendMessage/error"),this.scenarioMarker.failScenario(K.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,6];case 6:return[2,{}];case 7:return $e=void 0,Z.default.isReactNative()||Z.default.isNode()?[4,this.conversation.sendFileData(te,F.default.AmsBasedFileSharing)]:[3,9];case 8:return $e=Ke.sent(),[3,11];case 9:return[4,this.conversation.uploadFile(te,F.default.AmsBasedFileSharing)];case 10:$e=Ke.sent(),Ke.label=11;case 11:Ve={content:"",timestamp:new Date,contentType:$.default.Text,deliveryMode:N.default.Bridged,messageType:ce.default.UserMessage,tags:p(x.defaultMessageTags),sender:{displayName:"Customer",id:"customer",type:oe.default.User},fileMetadata:$e},Ke.label=12;case 12:return Ke.trys.push([12,14,,15]),[4,this.conversation.sendFileMessage($e,Ve)];case 13:return Ke.sent(),this.scenarioMarker.completeScenario(K.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Ve];case 14:return Ye=Ke.sent(),console.error("OmnichannelChatSDK/uploadFileAttachment/error: "+Ye),this.scenarioMarker.failScenario(K.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Ye];case 15:return[2]}})})},ne.prototype.downloadFileAttachment=function(te){var ae,ve;return _(this,void 0,void 0,function(){var ye,ge,be,xe,Ie;return d(this,function(Le){switch(Le.label){case 0:if(this.scenarioMarker.startScenario(K.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==j.default.V2)return[3,6];Le.label=1;case 1:return Le.trys.push([1,4,,5]),[4,null===(ae=this.AMSClient)||void 0===ae?void 0:ae.getViewStatus(te)];case 2:return ye=Le.sent(),ge=ye.view_location,[4,null===(ve=this.AMSClient)||void 0===ve?void 0:ve.getView(te,ge)];case 3:return be=Le.sent(),this.scenarioMarker.completeScenario(K.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,be];case 4:throw Le.sent(),this.scenarioMarker.failScenario(K.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("DownloadFileAttachmentFailed");case 5:return[3,9];case 6:return Le.trys.push([6,8,,9]),[4,this.conversation.downloadFile(te)];case 7:return xe=Le.sent(),this.scenarioMarker.completeScenario(K.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,xe];case 8:throw Ie=Le.sent(),console.error("OmnichannelChatSDK/downloadFileAttachment/error: "+Ie),this.scenarioMarker.failScenario(K.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("DownloadFileAttachmentFailed");case 9:return[2]}})})},ne.prototype.emailLiveChatTranscript=function(te){return _(this,void 0,void 0,function(){var ae,ye;return d(this,function(ge){ae={},this.scenarioMarker.startScenario(K.default.EmailLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId});try{return this.authenticatedUserToken&&(ae.authenticatedUserToken=this.authenticatedUserToken),ye=this.OCClient.emailTranscript(this.requestId,this.chatToken.token,{ChatId:this.chatToken.chatId,EmailAddress:te.emailAddress,DefaultAttachmentMessage:te.attachmentMessage,CustomerLocale:te.locale},ae),this.scenarioMarker.completeScenario(K.default.EmailLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,ye]}catch(be){console.error("OmnichannelChatSDK/emailLiveChatTranscript/error: "+be),this.scenarioMarker.failScenario(K.default.EmailLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},ne.prototype.getLiveChatTranscript=function(){return _(this,void 0,void 0,function(){var te,ae;return d(this,function(ve){te={},this.scenarioMarker.startScenario(K.default.GetLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId});try{return this.authenticatedUserToken&&(te.authenticatedUserToken=this.authenticatedUserToken),ae=this.OCClient.getChatTranscripts(this.requestId,this.chatToken.chatId,this.chatToken.token,te),this.scenarioMarker.completeScenario(K.default.GetLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,ae]}catch(ye){this.scenarioMarker.failScenario(K.default.GetLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},ne.prototype.createChatAdapter=function(te){return void 0===te&&(te=null),_(this,void 0,void 0,function(){var ae,ve=this;return d(this,function(ye){return Z.default.isNode()||Z.default.isReactNative()?[2,Promise.reject("ChatAdapter is only supported on browser")]:(ae=[S.default.ACS,S.default.IC3],te&&!ae.includes(te)?[2,Promise.reject("ChatAdapter for protocol "+te+" currently not supported")]:te===S.default.ACS||this.liveChatVersion===j.default.V2?[2,new Promise(function(ge,be){return _(ve,void 0,void 0,function(){var Ae,xe,Le,Ie=this;return d(this,function(We){switch(We.label){case 0:return Ae={enableAdaptiveCards:!1,enableThreadMemberUpdateNotification:!0,enableLeaveThreadOnWindowClosed:!1},xe=this.resolveChatAdapterUrl(te||S.default.ACS),null===(Le=this.telemetry)||void 0===Le||Le.setCDNPackages({ACSAdapter:xe}),[4,W.loadScript(xe,function(){Ie.debug&&console.debug("ACSAdapter loaded!");try{var Ve=window.ChatAdapter,Be=new C.default(Ie.AMSClient,Ie.acsAdapterLogger),$e=Ve.createACSAdapter(Ie.chatToken.token,Ie.chatToken.visitorId||"teamsvisitor",Ie.chatToken.chatId,Ie.chatToken.acsEndpoint,Be,1e3,l.default.Customer,void 0,Ae);ge($e)}catch(Ye){throw new Error("Failed to load ACSAdapter")}},function(){be("Failed to load ACSADapter")})];case 1:return We.sent(),[2]}})})})]:te===S.default.IC3||this.liveChatVersion===j.default.V1?[2,new Promise(function(ge,be){return _(ve,void 0,void 0,function(){var Ae,Ie,xe=this;return d(this,function(Le){switch(Le.label){case 0:return Ae=this.resolveChatAdapterUrl(te||S.default.IC3),null===(Ie=this.telemetry)||void 0===Ie||Ie.setCDNPackages({IC3Adapter:Ae}),this.scenarioMarker.startScenario(K.default.CreateIC3Adapter),[4,W.loadScript(Ae,function(){xe.debug&&console.debug("IC3Adapter loaded!");var We={chatToken:xe.chatToken,userDisplayName:"Customer",userId:"teamsvisitor",sdkURL:xe.resolveIC3ClientUrl(),sdk:xe.IC3Client},Ve=new window.Microsoft.BotFramework.WebChat.IC3Adapter(We);Ve.logger=xe.ic3ClientLogger,window.Microsoft.BotFramework.WebChat.IC3SDKProvider.disposeSdk=function(){},xe.scenarioMarker.completeScenario(K.default.CreateIC3Adapter),ge(Ve)},function(){xe.scenarioMarker.failScenario(K.default.CreateIC3Adapter),be("Failed to load IC3Adapter")})];case 1:return Le.sent(),[2]}})})})]:[2,Promise.reject("ChatAdapter for protocol "+te+" currently not supported")])})})},ne.prototype.getVoiceVideoCalling=function(te){return void 0===te&&(te={}),_(this,void 0,void 0,function(){var ae,ye,ge,be,Ae=this;return d(this,function(xe){switch(xe.label){case 0:return Z.default.isNode()||Z.default.isReactNative()?[2,Promise.reject("VoiceVideoCalling is only supported on browser")]:this.callingOption.toString()===P.default.NoCalling.toString()?[2,Promise.reject("Voice and video call is not enabled")]:[4,this.getChatConfig()];case 1:return ae=xe.sent(),ye=ae.LiveWSAndLiveChatEngJoin.msdyn_widgetsnippet,ge=new RegExp('src="(https:\\/\\/[\\w-.]+)[\\w-.\\/]+"'),(be=ye.match(ge))&&be.length?[2,new Promise(function(Ie,Le){return _(Ae,void 0,void 0,function(){var We,Be,Ve=this;return d(this,function($e){switch($e.label){case 0:return this.scenarioMarker.startScenario(K.default.GetVoiceVideoCalling),We=be[1]+"/livechatwidget/WebChatControl/lib/CallingBundle.js",null===(Be=this.telemetry)||void 0===Be||Be.setCDNPackages({VoiceVideoCalling:We}),[4,W.loadScript(We,function(){return _(Ve,void 0,void 0,function(){var Ye;return d(this,function(Ke){switch(Ke.label){case 0:return this.debug&&console.debug(We+" loaded!"),[4,I.default(te)];case 1:return Ye=Ke.sent(),this.scenarioMarker.completeScenario(K.default.GetVoiceVideoCalling),Ye.useScenarioMarker(this.scenarioMarker),Ie(Ye),[2]}})})},function(){return _(Ve,void 0,void 0,function(){return d(this,function(Ke){return this.scenarioMarker.failScenario(K.default.GetVoiceVideoCalling,{ExceptionDetails:JSON.stringify({response:"VoiceVideoCallingLoadFailed"})}),Le("Failed to load VoiceVideoCalling"),[2]})})})];case 1:return $e.sent(),[2]}})})})]:[2]}})})},ne.prototype.getIC3Client=function(){return _(this,void 0,void 0,function(){var te,ae=this;return d(this,function(ve){switch(ve.label){case 0:return Z.default.isNode()||Z.default.isReactNative()?(this.debug&&console.debug("IC3Core"),this.scenarioMarker.startScenario(K.default.GetIC3Client),this.IC3SDKProvider=se.SDKProvider,[4,se.SDKProvider.getSDK({hostType:U.default.Page,protocolType:ue.default.IC3V1SDK})]):[3,2];case 1:return(te=ve.sent()).setDebug(this.debug),this.scenarioMarker.completeScenario(K.default.GetIC3Client),[2,te];case 2:return this.debug&&console.debug("IC3Client"),[2,new Promise(function(ye,ge){return _(ae,void 0,void 0,function(){var be,xe,Ae=this;return d(this,function(Ie){switch(Ie.label){case 0:return be=this.resolveIC3ClientUrl(),null===(xe=this.telemetry)||void 0===xe||xe.setCDNPackages({IC3Client:be}),this.scenarioMarker.startScenario(K.default.GetIC3Client),window.addEventListener("ic3:sdk:load",function(){return _(Ae,void 0,void 0,function(){var Le,We,Ve;return d(this,function(Be){switch(Be.label){case 0:return this.debug&&console.debug("ic3:sdk:load"),Le=window.Microsoft.CRM.Omnichannel.IC3Client.SDK,this.IC3SDKProvider=We=Le.SDKProvider,[4,We.getSDK({hostType:U.default.IFrame,protocolType:ue.default.IC3V1SDK,logger:this.ic3ClientLogger})];case 1:return Ve=Be.sent(),this.scenarioMarker.completeScenario(K.default.GetIC3Client),ye(Ve),[2]}})})}),[4,W.loadScript(be,function(){Ae.debug&&console.debug("IC3Client loaded!")},function(){Ae.scenarioMarker.failScenario(K.default.GetIC3Client,{ExceptionDetails:JSON.stringify({response:"IC3ClientLoadFailed"})}),ge("Failed to load IC3Client")})];case 1:return Ie.sent(),[2]}})})})]}})})},ne.prototype.getChatConfig=function(){return _(this,void 0,void 0,function(){var te,ae,ve,ye,Ae,xe,Ie,Le,We,Ve,Be,$e,Ye,qe;return d(this,function(Qe){switch(Qe.label){case 0:return Qe.trys.push([0,8,,9]),[4,this.OCClient.getChatConfig()];case 1:if(te=Qe.sent(),ae=te.DataMaskingInfo,ve=te.LiveChatConfigAuthSettings,ye=te.LiveWSAndLiveChatEngJoin,this.liveChatVersion=te.LiveChatVersion||j.default.V1,this.debug&&console.log("[OmnichannelChatSDK][getChatConfig][liveChatVersion] "+this.liveChatVersion),ae.setting.msdyn_maskforcustomer&&(this.dataMaskingRules=ae.dataMaskingRules),ve&&(this.authSettings=ve),Ae=ye.PreChatSurvey,Ie=ye.msdyn_callingoptions,Ve=!0===(xe=ye.msdyn_prechatenabled)||"true"==xe,Be=!0===(We=ye.msdyn_enablechatreconnect)||"true"==We,(null==(Le=ye.msdyn_conversationmode)?void 0:Le.toString())===f.default.PersistentChat.toString()&&(this.isPersistentChat=!0),Be&&!this.isPersistentChat&&(this.isChatReconnect=!0),Ve&&Ae&&Ae.trim().length>0&&(this.preChatSurvey=Ae),!this.authSettings)return[3,7];if(this.scenarioMarker.startScenario(K.default.GetAuthToken),!this.chatSDKConfig.getAuthToken)return[3,6];Qe.label=2;case 2:return Qe.trys.push([2,4,,5]),[4,this.chatSDKConfig.getAuthToken()];case 3:return($e=Qe.sent())?(this.authenticatedUserToken=$e,this.scenarioMarker.completeScenario(K.default.GetAuthToken)):(Ye={response:"UndefinedAuthToken"},this.scenarioMarker.failScenario(K.default.GetAuthToken,{ExceptionDetails:JSON.stringify(Ye)})),[3,5];case 4:return Qe.sent(),Ye={response:"GetAuthTokenFailed"},this.scenarioMarker.failScenario(K.default.GetAuthToken,{ExceptionDetails:JSON.stringify(Ye)}),[3,5];case 5:return[3,7];case 6:Ye={response:"GetAuthTokenNotFound"},this.scenarioMarker.failScenario(K.default.GetAuthToken,{ExceptionDetails:JSON.stringify(Ye)}),Qe.label=7;case 7:return this.preChatSurvey&&this.debug&&console.log("Prechat Survey!"),this.callingOption=Ie,this.liveChatConfig=te,[2,this.liveChatConfig];case 8:return qe=Qe.sent(),console.error("OmnichannelChatSDK/getChatConfig/error "+qe),[2,qe];case 9:return[2]}})})},ne.prototype.resolveIC3ClientUrl=function(){return this.chatSDKConfig.ic3Config&&"ic3ClientCDNUrl"in this.chatSDKConfig.ic3Config?this.chatSDKConfig.ic3Config.ic3ClientCDNUrl:this.chatSDKConfig.ic3Config&&"ic3ClientVersion"in this.chatSDKConfig.ic3Config?D.default.getIC3ClientCDNUrl(this.chatSDKConfig.ic3Config.ic3ClientVersion):D.default.getIC3ClientCDNUrl()},ne.prototype.resolveChatAdapterUrl=function(te){if(te&&![S.default.ACS,S.default.IC3].includes(te))throw new Error("ChatAdapter for protocol "+te+" currently not supported");return te===S.default.ACS||this.liveChatVersion===j.default.V2?this.chatSDKConfig.chatAdapterConfig&&"webChatACSAdapterCDNUrl"in this.chatSDKConfig.chatAdapterConfig?this.chatSDKConfig.chatAdapterConfig.webChatACSAdapterCDNUrl:this.chatSDKConfig.chatAdapterConfig&&"webChatACSAdapterVersion"in this.chatSDKConfig.chatAdapterConfig?D.default.getACSAdapterCDNUrl(this.chatSDKConfig.chatAdapterConfig.webChatACSAdapterVersion):D.default.getACSAdapterCDNUrl():te===S.default.IC3||this.liveChatVersion===j.default.V1?this.chatSDKConfig.chatAdapterConfig&&"webChatIC3AdapterCDNUrl"in this.chatSDKConfig.chatAdapterConfig?this.chatSDKConfig.chatAdapterConfig.webChatIC3AdapterCDNUrl:this.chatSDKConfig.chatAdapterConfig&&"webChatIC3AdapterVersion"in this.chatSDKConfig.chatAdapterConfig?D.default.getIC3AdapterCDNUrl(this.chatSDKConfig.chatAdapterConfig.webChatIC3AdapterVersion):D.default.getIC3AdapterCDNUrl():""},ne.prototype.updateChatToken=function(te,ae){return _(this,void 0,void 0,function(){var ye;return d(this,function(be){switch(be.label){case 0:this.scenarioMarker.startScenario(K.default.UpdateChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),be.label=1;case 1:return be.trys.push([1,3,,4]),[4,this.IC3Client.initialize({token:te,regionGtms:ae,visitor:!0})];case 2:return be.sent(),this.scenarioMarker.completeScenario(K.default.UpdateChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:return ye=be.sent(),this.scenarioMarker.failScenario(K.default.UpdateChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify({response:"UpdateChatTokenFailed"})}),console.error("OmnichannelChatSDK/updateChatToken/error "+ye),[3,4];case 4:return[2]}})})},ne}();u.default=J},6633:function(Q,u,c){"use strict";var s=this&&this.__awaiter||function(S,f,g,E){return new(g||(g=Promise))(function(m,I){function x(U){try{F(E.next(U))}catch(k){I(k)}}function N(U){try{F(E.throw(U))}catch(k){I(k)}}function F(U){U.done?m(U.value):function(m){return m instanceof g?m:new g(function(I){I(m)})}(U.value).then(x,N)}F((E=E.apply(S,f||[])).next())})},_=this&&this.__generator||function(S,f){var E,b,m,I,g={label:0,sent:function(){if(1&m[0])throw m[1];return m[1]},trys:[],ops:[]};return I={next:x(0),throw:x(1),return:x(2)},"function"==typeof Symbol&&(I[Symbol.iterator]=function(){return this}),I;function x(F){return function(U){return function(F){if(E)throw new TypeError("Generator is already executing.");for(;g;)try{if(E=1,b&&(m=2&F[0]?b.return:F[0]?b.throw||((m=b.return)&&m.call(b),0):b.next)&&!(m=m.call(b,F[1])).done)return m;switch(b=0,m&&(F=[2&F[0],m.value]),F[0]){case 0:case 1:m=F;break;case 4:return g.label++,{value:F[1],done:!1};case 5:g.label++,b=F[1],F=[0];continue;case 7:F=g.ops.pop(),g.trys.pop();continue;default:if(!(m=(m=g.trys).length>0&&m[m.length-1])&&(6===F[0]||2===F[0])){g=0;continue}if(3===F[0]&&(!m||F[1]>m[0]&&F[1]<m[3])){g.label=F[1];break}if(6===F[0]&&g.label<m[1]){g.label=m[1],m=F;break}if(m&&g.label<m[2]){g.label=m[2],g.ops.push(F);break}m[2]&&g.ops.pop(),g.trys.pop();continue}F=f.call(S,g)}catch(U){F=[6,U],b=0}finally{E=m=0}if(5&F[0])throw F[1];return{value:F[0]?F[1]:void 0,done:!0}}([F,U])}}};Object.defineProperty(u,"__esModule",{value:!0}),u.VoiceVideoCallingProxy=void 0;var d=c(9600),p=(()=>{return(S=p||(p={}))[S.Voice=19237e4]="Voice",S[S.Video=19238e4]="Video",S[S.Cobrowse=19239e4]="Cobrowse",p;var S})(),T=(()=>{return(S=T||(T={})).Accept="accept",S.Reject="reject",S.Connect="connect",S.End="end",T;var S})(),l=(()=>{return(S=l||(l={})).CallAdded="callAdded",S.LocalVideoStreamAdded="localVideoStreamAdded",S.LocalVideoStreamRemoved="localVideoStreamRemoved",S.RemoteVideoStreamAdded="remoteVideoStreamAdded",S.RemoteVideoStreamRemoved="remoteVideoStreamRemoved",S.CallDisconnected="callDisconnected",S.ParticipantDisconnected="participantDisconnected",S.IncomingCallEnded="incomingCallEnded",l;var S})(),C=function(){function S(){this.debug=!1,this.callClientName="ElevateToVoiceVideo",this.proxy=window["Microsoft.Omnichannel.Calling.SDK"].VoiceVideoCalling,this.proxyInstance=this.proxy.getInstance()}return S.getInstance=function(){return this._instance||(this._instance=new S),this._instance},S.prototype.setDebug=function(f){this.debug=f},S.prototype.useScenarioMarker=function(f){this.scenarioMarker=f},S.prototype.load=function(f){return void 0===f&&(f={}),s(this,void 0,void 0,function(){return _(this,function(g){return f.logger&&(this.logger=f.logger),this.proxyInstance.load(f),[2]})})},S.prototype.isInitialized=function(){return this.proxyInstance.isInitialized()},S.prototype.initialize=function(f){var g,E,b,m,I,x,N,F;return s(this,void 0,void 0,function(){var U;return _(this,function(k){switch(k.label){case 0:return this.debug&&console.debug("[VoiceVideoCallingProxy] VoiceVideoCallingParams: "+JSON.stringify(f)),this.callingParams=f,null===(g=this.scenarioMarker)||void 0===g||g.startScenario(d.default.InitializeVoiceVideoCallingSDK),this.debug&&console.debug("[VoiceVideoCallingProxy][initialize] _isLoaded: "+this.proxyInstance._isLoaded),this.proxyInstance._isLoaded?[3,2]:[4,this.proxyInstance.load(this.logger||{})];case 1:k.sent(),k.label=2;case 2:return k.trys.push([2,4,,5]),[4,this.proxyInstance.initialize({callClientName:this.callClientName,accesstoken:(null===(b=null===(E=this.callingParams)||void 0===E?void 0:E.chatToken.voiceVideoCallToken)||void 0===b?void 0:b.Token)||(null===(m=this.callingParams)||void 0===m?void 0:m.chatToken.token),selfVideoHTMLElementId:null===(I=this.callingParams)||void 0===I?void 0:I.selfVideoHTMLElementId,remoteVideoHTMLElementId:null===(x=this.callingParams)||void 0===x?void 0:x.remoteVideoHTMLElementId})];case 3:return k.sent(),null===(N=this.scenarioMarker)||void 0===N||N.completeScenario(d.default.InitializeVoiceVideoCallingSDK),[3,5];case 4:return U=k.sent(),console.log(U),null===(F=this.scenarioMarker)||void 0===F||F.failScenario(d.default.InitializeVoiceVideoCallingSDK),[3,5];case 5:return[2]}})})},S.prototype.addEventListener=function(f,g){var E=this;this.proxyInstance.registerEvent(f,function(b){var m=b.callId;f===l.CallAdded&&(E.callId=m),E.debug&&console.debug("[VoiceVideoCallingProxy]["+f+"] callId: "+m),m===E.callId&&g(b)})},S.prototype.isMicrophoneMuted=function(){return this.proxyInstance.isMicrophoneMuted({callClientName:this.callClientName,callId:this.callId})},S.prototype.acceptCall=function(f){var g,E,b,m,I,x;return void 0===f&&(f={}),s(this,void 0,void 0,function(){var N,F,U,M,D;return _(this,function(j){switch(j.label){case 0:F=(N=this).callClientName,U=N.callId,null===(g=this.scenarioMarker)||void 0===g||g.startScenario(f.withVideo?d.default.AcceptVideoCall:d.default.AcceptVoiceCall,{CallId:U||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][acceptCall] callId: "+U),this.debug&&console.debug(f),j.label=1;case 1:return j.trys.push([1,3,,4]),[4,this.proxyInstance.acceptCall({callClientName:F,callId:U,withVideo:f.withVideo||!1})];case 2:return j.sent(),[3,4];case 3:return j.sent(),D={response:f.withVideo?"AcceptVideoCallFailed":"AcceptVoiceCallFailed"},null===(E=this.scenarioMarker)||void 0===E||E.failScenario(f.withVideo?d.default.AcceptVideoCall:d.default.AcceptVoiceCall,{CallId:U||"",ExceptionDetails:JSON.stringify(D)}),[3,4];case 4:M={SecondaryChannelType:f.withVideo?p.Video:p.Voice,SecondaryChannelEventType:T.Accept};try{null===(b=this.callingParams)||void 0===b||b.OCClient.makeSecondaryChannelEventRequest(null===(m=this.callingParams)||void 0===m?void 0:m.chatToken.requestId,M),null===(I=this.scenarioMarker)||void 0===I||I.completeScenario(f.withVideo?d.default.AcceptVideoCall:d.default.AcceptVoiceCall,{CallId:U||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][acceptCall][makeSecondaryChannelEventRequest]")}catch(W){D={response:"OCClientMakeSecondaryChannelEventRequestFailed"},null===(x=this.scenarioMarker)||void 0===x||x.failScenario(f.withVideo?d.default.AcceptVideoCall:d.default.AcceptVoiceCall,{CallId:U||"",ExceptionDetails:JSON.stringify(D)}),console.error("[VoiceVideoCallingProxy][acceptCall][makeSecondaryChannelEventRequest] Failure "+W)}return[2]}})})},S.prototype.rejectCall=function(){var f,g,E,b,m,I;return s(this,void 0,void 0,function(){var x,N,F,D,k;return _(this,function(M){switch(M.label){case 0:N=(x=this).callClientName,F=x.callId,null===(f=this.scenarioMarker)||void 0===f||f.startScenario(d.default.RejectCall,{CallId:F||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][rejectCall] callId: "+F),M.label=1;case 1:return M.trys.push([1,3,,4]),[4,this.proxyInstance.rejectCall({callClientName:N,callId:F})];case 2:return M.sent(),null===(g=this.scenarioMarker)||void 0===g||g.completeScenario(d.default.RejectCall,{CallId:F||""}),[3,4];case 3:return M.sent(),k={response:"RejectCallFailed"},null===(E=this.scenarioMarker)||void 0===E||E.failScenario(d.default.RejectCall,{CallId:F||"",ExceptionDetails:JSON.stringify(k)}),[3,4];case 4:D={SecondaryChannelType:this.isRemoteVideoEnabled()?p.Video:p.Voice,SecondaryChannelEventType:T.Reject};try{null===(b=this.callingParams)||void 0===b||b.OCClient.makeSecondaryChannelEventRequest(null===(m=this.callingParams)||void 0===m?void 0:m.chatToken.requestId,D),this.debug&&console.debug("[VoiceVideoCallingProxy][rejectCall][makeSecondaryChannelEventRequest]")}catch(j){return k={response:"OCClientMakeSecondaryChannelEventRequestFailed"},null===(I=this.scenarioMarker)||void 0===I||I.failScenario(d.default.RejectCall,{CallId:F||"",ExceptionDetails:JSON.stringify(k)}),console.error("[VoiceVideoCallingProxy][rejectCall][makeSecondaryChannelEventRequest] Failure "+j),[2,j]}return[2]}})})},S.prototype.stopCall=function(){var f,g,E,b,m;return s(this,void 0,void 0,function(){var I,x,N,F;return _(this,function(k){switch(k.label){case 0:x=(I=this).callClientName,N=I.callId,null===(f=this.scenarioMarker)||void 0===f||f.startScenario(d.default.StopCall,{CallId:N||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][stopCall] callId: "+N),F=!!(null===(E=null===(g=this.callingParams)||void 0===g?void 0:g.chatToken.voiceVideoCallToken)||void 0===E?void 0:E.Token),k.label=1;case 1:return k.trys.push([1,3,,4]),[4,this.proxyInstance.stopCall({callClientName:x,callId:N,forEveryone:F})];case 2:return k.sent(),null===(b=this.scenarioMarker)||void 0===b||b.completeScenario(d.default.StopCall,{CallId:N||""}),[3,4];case 3:return k.sent(),null===(m=this.scenarioMarker)||void 0===m||m.failScenario(d.default.StopCall,{CallId:N||""}),[3,4];case 4:return[2]}})})},S.prototype.toggleMute=function(){return s(this,void 0,void 0,function(){var f;return _(this,function(b){return[2,this.proxyInstance.toggleMute({callClientName:(f=this).callClientName,callId:f.callId})]})})},S.prototype.isRemoteVideoEnabled=function(){return this.proxyInstance.isRemoteVideoEnabled({callClientName:this.callClientName,callId:this.callId})},S.prototype.isLocalVideoEnabled=function(){return this.proxyInstance.isLocalVideoEnabled({callClientName:this.callClientName,callId:this.callId})},S.prototype.toggleLocalVideo=function(){return s(this,void 0,void 0,function(){var f;return _(this,function(b){return[2,this.proxyInstance.toggleLocalVideo({callClientName:(f=this).callClientName,callId:f.callId})]})})},S.prototype.isInACall=function(){return this.proxyInstance.isInACall({callClientName:this.callClientName,callId:this.callId})},S.prototype.renderVideoStreams=function(){return this.proxyInstance.renderVideoStreams({callClientName:this.callClientName,callId:this.callId})},S.prototype.disposeVideoRenderers=function(){return this.proxyInstance.disposeVideoRenderers({callClientName:this.callClientName,callId:this.callId})},S.prototype.close=function(){this.debug&&console.debug("[VoiceVideoCallingProxy][close]"),this.proxyInstance.dispose(),this.callingParams=void 0,this.callId=void 0},S.prototype.onCallAdded=function(f){var g=l.CallAdded;this.debug&&console.debug("[VoiceVideoCallingProxy]["+g+"]"),this.addEventListener(g,f)},S.prototype.onLocalVideoStreamAdded=function(f){var g=l.LocalVideoStreamAdded;this.debug&&console.debug("[VoiceVideoCallingProxy]["+g+"]"),this.addEventListener(g,f)},S.prototype.onLocalVideoStreamRemoved=function(f){var g=l.LocalVideoStreamRemoved;this.debug&&console.debug("[VoiceVideoCallingProxy]["+g+"]"),this.addEventListener(g,f)},S.prototype.onRemoteVideoStreamAdded=function(f){var g=l.RemoteVideoStreamAdded;this.debug&&console.debug("[VoiceVideoCallingProxy]["+g+"]"),this.addEventListener(g,f)},S.prototype.onRemoteVideoStreamRemoved=function(f){var g=l.RemoteVideoStreamRemoved;this.debug&&console.debug("[VoiceVideoCallingProxy]["+g+"]"),this.addEventListener(g,f)},S.prototype.onCallDisconnected=function(f){var g=this,E=l.CallDisconnected;this.debug&&console.debug("[VoiceVideoCallingProxy]["+E+"]"),this.addEventListener(E,function(b){return s(g,void 0,void 0,function(){var m,I,x,N,F,U,k;return _(this,function(D){m={SecondaryChannelType:p.Voice,SecondaryChannelEventType:T.End},null===(x=this.scenarioMarker)||void 0===x||x.startScenario(d.default.OnCallDisconnected,{CallId:this.callId||""});try{null===(N=this.callingParams)||void 0===N||N.OCClient.makeSecondaryChannelEventRequest(null===(F=this.callingParams)||void 0===F?void 0:F.chatToken.requestId,m),this.debug&&console.debug("[VoiceVideoCallingProxy][onCallDisconnected][makeSecondaryChannelEventRequest]"),null===(U=this.scenarioMarker)||void 0===U||U.completeScenario(d.default.OnCallDisconnected,{CallId:this.callId||""})}catch(M){console.error("[VoiceVideoCallingProxy][onCallDisconnected][makeSecondaryChannelEventRequest] Failure "+M),I={response:"OCClientMakeSecondaryChannelEventRequestFailed"},null===(k=this.scenarioMarker)||void 0===k||k.failScenario(d.default.OnCallDisconnected,{CallId:this.callId||"",ExceptionDetails:JSON.stringify(I)})}return this.clearRemoteVideoElementChildren(),f(b),[2]})})})},S.prototype.clearRemoteVideoElementChildren=function(){var f,g;if(null===(f=this.callingParams)||void 0===f?void 0:f.remoteVideoHTMLElementId)for(var E=document.getElementById(null===(g=this.callingParams)||void 0===g?void 0:g.remoteVideoHTMLElementId);null==E?void 0:E.firstChild;)this.debug&&console.debug("[VoiceVideoCallingProxy][clearRemoteVideoElement]"),E.firstChild.remove()},S}();u.VoiceVideoCallingProxy=C,u.default=function(S){return void 0===S&&(S={}),s(void 0,void 0,void 0,function(){var f;return _(this,function(g){switch(g.label){case 0:return[4,(f=C.getInstance()).load(S.logger)];case 1:return g.sent(),[2,Promise.resolve(f)]}})})}},4151:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.ariaTelemetryKey=u.webChatACSAdapterVersion=u.webChatIC3AdapterVersion=u.ic3ClientVersion=void 0,u.ic3ClientVersion="2021.08.14.1",u.webChatIC3AdapterVersion="0.1.0-master.2dba07b",u.webChatACSAdapterVersion="0.0.30",u.ariaTelemetryKey="c7655518acf1403f93ff6b9f77942f0a-d01a02fd-6b50-4de3-a566-62eda11f93bc-7083"},6419:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={}))[s.NoCalling=19235e4]="NoCalling",s[s.VideoAndVoiceCalling=192350001]="VideoAndVoiceCalling",s[s.VoiceOnly=192350002]="VoiceOnly",c;var s})();u.default=c},7925:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={}))[s.LiveChat=19235e4]="LiveChat",s[s.PersistentChat=192350001]="PersistentChat",c;var s})();u.default=c},8191:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={}))[s.V1=1]="V1",s[s.V2=2]="V2",c;var s})();u.default=c},5642:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).Active="Active",s.Closed="Closed",s.Open="Open",s.Waiting="Waiting",s.WrapUp="WrapUp",c;var s})();u.default=c},1974:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).Text="text",s.TopicUpdated="topicUpdated",s.ParticipantAdded="participantAdded",s.ParticipantRemoved="participantRemoved",c;var s})();u.default=c},2902:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(I){for(var x,N=1,F=arguments.length;N<F;N++)for(var U in x=arguments[N])Object.prototype.hasOwnProperty.call(x,U)&&(I[U]=x[U]);return I}).apply(this,arguments)},_=this&&this.__awaiter||function(I,x,N,F){return new(N||(N=Promise))(function(k,D){function M($){try{W(F.next($))}catch(ce){D(ce)}}function j($){try{W(F.throw($))}catch(ce){D(ce)}}function W($){$.done?k($.value):function(k){return k instanceof N?k:new N(function(D){D(k)})}($.value).then(M,j)}W((F=F.apply(I,x||[])).next())})},d=this&&this.__generator||function(I,x){var F,U,k,D,N={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return D={next:M(0),throw:M(1),return:M(2)},"function"==typeof Symbol&&(D[Symbol.iterator]=function(){return this}),D;function M(W){return function($){return function(W){if(F)throw new TypeError("Generator is already executing.");for(;N;)try{if(F=1,U&&(k=2&W[0]?U.return:W[0]?U.throw||((k=U.return)&&k.call(U),0):U.next)&&!(k=k.call(U,W[1])).done)return k;switch(U=0,k&&(W=[2&W[0],k.value]),W[0]){case 0:case 1:k=W;break;case 4:return N.label++,{value:W[1],done:!1};case 5:N.label++,U=W[1],W=[0];continue;case 7:W=N.ops.pop(),N.trys.pop();continue;default:if(!(k=(k=N.trys).length>0&&k[k.length-1])&&(6===W[0]||2===W[0])){N=0;continue}if(3===W[0]&&(!k||W[1]>k[0]&&W[1]<k[3])){N.label=W[1];break}if(6===W[0]&&N.label<k[1]){N.label=k[1],k=W;break}if(k&&N.label<k[2]){N.label=k[2],N.ops.push(W);break}k[2]&&N.ops.pop(),N.trys.pop();continue}W=x.call(I,N)}catch($){W=[6,$],U=0}finally{F=k=0}if(5&W[0])throw W[1];return{value:W[0]?W[1]:void 0,done:!0}}([W,$])}}};Object.defineProperty(u,"__esModule",{value:!0}),u.ACSConversation=void 0;var p=c(1974),T=c(8953),l=c(351),C=c(9116),P=c(9340),S=c(813),f=c(2900),g=c(8191),E=(()=>{return(I=E||(E={})).InitializeACSClient="InitializeACSClient",I.InitializeACSConversation="InitializeACSConversation",I.GetParticipants="GetParticipants",I.RegisterOnNewMessage="RegisterOnNewMessage",I.RegisterOnThreadUpdate="RegisterOnThreadUpdate",I.OnTypingEvent="OnTypingEvent",I.GetMessages="GetMessages",I.SendMessage="SendMessage",I.SendTyping="SendTyping",I.Disconnect="Disconnect",E;var I})(),b=function(){function I(x,N,F){void 0===F&&(F=null),this.logger=null,this.logger=F,this.tokenCredential=x,this.chatClient=N,this.eventListeners={}}return I.prototype.initialize=function(x){var N,F,U,k,D;return _(this,void 0,void 0,function(){var M,j,$,W,ce;return d(this,function(oe){switch(oe.label){case 0:null===(N=this.logger)||void 0===N||N.startScenario(E.InitializeACSConversation),this.sessionInfo=x,oe.label=1;case 1:return oe.trys.push([1,3,,4]),M=this,[4,null===(F=this.chatClient)||void 0===F?void 0:F.getChatThreadClient(x.threadId)];case 2:return M.chatThreadClient=oe.sent(),[3,4];case 3:throw j=oe.sent(),W={response:"ChatClientGetChatThreadClientFailure",errorObject:""+j},null===(U=this.logger)||void 0===U||U.failScenario(E.InitializeACSConversation,{ExceptionDetails:JSON.stringify(W)}),new Error("GetChatThreadClientFailed");case 4:return oe.trys.push([4,6,,7]),[4,this.chatClient.startRealtimeNotifications()];case 5:return oe.sent(),[3,7];case 6:throw $=oe.sent(),W={response:"StartRealtimeNotificationsFailed",errorObject:""+$},null===(k=this.logger)||void 0===k||k.failScenario(E.InitializeACSConversation,{ExceptionDetails:JSON.stringify(W)}),new Error(W.response);case 7:return ce=this,[4,this.createParticipantsMapping()];case 8:return ce.participantsMapping=oe.sent(),null===(D=this.logger)||void 0===D||D.completeScenario(E.InitializeACSConversation),[2]}})})},I.prototype.getMessages=function(){var x,N,F,U,k;return _(this,void 0,void 0,function(){var D,M,j,W,oe,Z,ue;return d(this,function(he){switch(he.label){case 0:null===(x=this.logger)||void 0===x||x.startScenario(E.GetMessages),D=[],he.label=1;case 1:return he.trys.push([1,9,,10]),[4,this.chatThreadClient.listMessages()];case 2:return[4,(M=he.sent()).next()];case 3:j=he.sent(),he.label=4;case 4:return j.done?[3,8]:(W=j.value).type===p.default.Text?[3,6]:[4,M.next()];case 5:return j=he.sent(),[3,4];case 6:return(null===(N=W.content)||void 0===N?void 0:N.message)&&Object.assign(W,{content:null===(F=W.content)||void 0===F?void 0:F.message}),Object.assign(W.sender,{alias:this.participantsMapping[W.sender.communicationUserId].displayName}),oe=P.default(W,{liveChatVersion:g.default.V2}),D.push(oe),[4,M.next()];case 7:return j=he.sent(),[3,4];case 8:return null===(U=this.logger)||void 0===U||U.completeScenario(E.GetMessages),[3,10];case 9:throw Z=he.sent(),ue={errorObject:""+Z},null===(k=this.logger)||void 0===k||k.failScenario(E.GetMessages,{ExceptionDetails:JSON.stringify(ue)}),new Error(E.GetMessages);case 10:return[2,D]}})})},I.prototype.getParticipants=function(){var x,N,F;return _(this,void 0,void 0,function(){var U,k,D,j,W;return d(this,function($){switch($.label){case 0:null===(x=this.logger)||void 0===x||x.startScenario(E.GetParticipants),U=[],$.label=1;case 1:return $.trys.push([1,7,,8]),[4,this.chatThreadClient.listParticipants()];case 2:return[4,(k=$.sent()).next()];case 3:D=$.sent(),$.label=4;case 4:return D.done?[3,6]:(U.push(D.value),[4,k.next()]);case 5:return D=$.sent(),[3,4];case 6:return null===(N=this.logger)||void 0===N||N.completeScenario(E.GetParticipants),[3,8];case 7:throw j=$.sent(),W={errorObject:""+j},null===(F=this.logger)||void 0===F||F.failScenario(E.GetParticipants,{ExceptionDetails:JSON.stringify(W)}),new Error(E.GetParticipants);case 8:return[2,U]}})})},I.prototype.registerOnNewMessage=function(x){var N,F,U,k,D;return _(this,void 0,void 0,function(){var M,j,W,$,ce,oe,Z=this;return d(this,function(ue){switch(ue.label){case 0:null===(N=this.logger)||void 0===N||N.startScenario(E.RegisterOnNewMessage),M=!1,j=new Set,ue.label=1;case 1:return ue.trys.push([1,3,,4]),[4,(W=function(he){return _(Z,void 0,void 0,function(){var Ee,se,K,pe,re;return d(this,function(ae){switch(ae.label){case 0:if(M)return[2];ae.label=1;case 1:return ae.trys.push([1,3,,4]),[4,this.getMessages()];case 2:for(Ee=ae.sent(),se=0,K=Ee.reverse();se<K.length;se++)re=(pe=K[se]).id,pe.sender.displayName!==T.default.Customer&&(j.has(re)||(x(pe),j.add(re)));return[3,4];case 3:return ae.sent(),[3,4];case 4:return setTimeout(function(){W(he)},he),[2]}})})})(null===(F=this.sessionInfo)||void 0===F?void 0:F.pollingInterval)];case 2:return ue.sent(),$=function(he){var Ee;M=!0;var se=he.id,K=he.sender;K.communicationUserId===(null===(Ee=Z.sessionInfo)||void 0===Ee?void 0:Ee.id)||j.has(se)||(he.message&&Object.assign(he,{content:he.message}),Object.assign(he.sender,{alias:Z.participantsMapping[K.communicationUserId].displayName}),x(he),j.add(se))},null===(U=this.chatClient)||void 0===U||U.on("chatMessageReceived",$),this.trackListener("chatMessageReceived",$),null===(k=this.logger)||void 0===k||k.completeScenario(E.RegisterOnNewMessage),[3,4];case 3:throw ce=ue.sent(),oe={errorObject:""+ce},null===(D=this.logger)||void 0===D||D.failScenario(E.RegisterOnNewMessage,{ExceptionDetails:JSON.stringify(oe)}),new Error(E.RegisterOnNewMessage);case 4:return[2]}})})},I.prototype.registerOnThreadUpdate=function(x){var N,F,U,k;return _(this,void 0,void 0,function(){var D;return d(this,function(M){null===(N=this.logger)||void 0===N||N.startScenario(E.RegisterOnThreadUpdate);try{D=function(j){x(j)},null===(F=this.chatClient)||void 0===F||F.on("participantsRemoved",D),this.trackListener("participantsRemoved",D),null===(U=this.logger)||void 0===U||U.completeScenario(E.RegisterOnThreadUpdate)}catch(j){null===(k=this.logger)||void 0===k||k.failScenario(E.RegisterOnThreadUpdate)}return[2]})})},I.prototype.onTypingEvent=function(x){var N,F,U,k;return _(this,void 0,void 0,function(){var D;return d(this,function(M){null===(N=this.logger)||void 0===N||N.startScenario(E.OnTypingEvent);try{D=function(j){x(j)},null===(F=this.chatClient)||void 0===F||F.on("typingIndicatorReceived",D),this.trackListener("typingIndicatorReceived",D),null===(U=this.logger)||void 0===U||U.completeScenario(E.OnTypingEvent)}catch(j){null===(k=this.logger)||void 0===k||k.failScenario(E.OnTypingEvent)}return[2]})})},I.prototype.sendMessage=function(x){var N,F,U,k;return _(this,void 0,void 0,function(){var D,M;return d(this,function(W){switch(W.label){case 0:null===(N=this.logger)||void 0===N||N.startScenario(E.SendMessage),x.metadata||(x.metadata={}),D={content:x.content},M={senderDisplayName:T.default.Customer,metadata:s({deliveryMode:f.default.Bridged,tags:JSON.stringify([S.defaultMessageTags])},x.metadata)},W.label=1;case 1:return W.trys.push([1,3,,4]),[4,null===(F=this.chatThreadClient)||void 0===F?void 0:F.sendMessage(D,M)];case 2:return W.sent(),null===(U=this.logger)||void 0===U||U.completeScenario(E.SendMessage),[3,4];case 3:throw W.sent(),null===(k=this.logger)||void 0===k||k.failScenario(E.SendMessage),new Error("SendMessageFailed");case 4:return[2]}})})},I.prototype.sendTyping=function(){var x,N,F,U;return _(this,void 0,void 0,function(){return d(this,function(D){switch(D.label){case 0:null===(x=this.logger)||void 0===x||x.startScenario(E.SendTyping),D.label=1;case 1:return D.trys.push([1,3,,4]),[4,null===(N=this.chatThreadClient)||void 0===N?void 0:N.sendTypingNotification()];case 2:return D.sent(),null===(F=this.logger)||void 0===F||F.completeScenario(E.SendTyping),[3,4];case 3:throw D.sent(),null===(U=this.logger)||void 0===U||U.failScenario(E.SendTyping),new Error("SendTypingFailed");case 4:return[2]}})})},I.prototype.sendFileMessage=function(){return _(this,void 0,void 0,function(){return d(this,function(x){return[2,void 0]})})},I.prototype.sendFileData=function(){return _(this,void 0,void 0,function(){return d(this,function(x){return[2,void 0]})})},I.prototype.uploadFile=function(){return _(this,void 0,void 0,function(){return d(this,function(x){return[2,void 0]})})},I.prototype.downloadFile=function(){return _(this,void 0,void 0,function(){return d(this,function(x){return[2,void 0]})})},I.prototype.disconnect=function(){var x,N,F;return _(this,void 0,void 0,function(){var U,k,D,M,$=this;return d(this,function(ce){null===(x=this.logger)||void 0===x||x.startScenario(E.Disconnect);try{for(U=function(oe,Z){Z.forEach(function(ue){$.chatClient.off(oe,ue)})},k=0,D=Object.entries(this.eventListeners);k<D.length;k++)U((M=D[k])[0],M[1]);null===(N=this.logger)||void 0===N||N.completeScenario(E.Disconnect)}catch(oe){null===(F=this.logger)||void 0===F||F.failScenario(E.Disconnect)}return[2]})})},I.prototype.createParticipantsMapping=function(){return _(this,void 0,void 0,function(){var x,N,F,U,k,D,M;return d(this,function(j){switch(j.label){case 0:return[4,this.getParticipants()];case 1:for(x=j.sent(),N={},F=0,U=x;F<U.length;F++)D=(k=U[F]).id,Object.keys(N).includes(D.communicationUserId)||Object.assign(N,((M={})[D.communicationUserId]=k,M));return[2,N]}})})},I.prototype.trackListener=function(x,N){x in this.eventListeners||(this.eventListeners[x]=[]),this.eventListeners[x].push(N)},I}();u.ACSConversation=b;var m=function(){function I(x){void 0===x&&(x=null),this.logger=null,this.tokenCredential=null,this.chatClient=null,this.logger=x}return I.prototype.initialize=function(x){var N,F,U,k;return _(this,void 0,void 0,function(){var D;return d(this,function(M){null===(N=this.logger)||void 0===N||N.startScenario(E.InitializeACSClient);try{this.tokenCredential=new C.AzureCommunicationTokenCredential(x.token)}catch(j){throw D={response:"CreateTokenCredentialFailure",errorObject:""+j},null===(F=this.logger)||void 0===F||F.failScenario(E.InitializeACSClient,{ExceptionDetails:JSON.stringify(D)}),new Error("CreateTokenCredentialFailed")}try{this.chatClient=new l.ChatClient(x.environmentUrl,this.tokenCredential)}catch(j){throw D={response:"CreateChatClientFailure",errorObject:""+j},null===(U=this.logger)||void 0===U||U.failScenario(E.InitializeACSClient,{ExceptionDetails:JSON.stringify(D)}),new Error("CreateChatClientFailed")}return null===(k=this.logger)||void 0===k||k.completeScenario(E.InitializeACSClient),[2]})})},I.prototype.joinConversation=function(x){return _(this,void 0,void 0,function(){var N;return d(this,function(F){switch(F.label){case 0:return[4,(N=new b(this.tokenCredential,this.chatClient,this.logger)).initialize(x)];case 1:return F.sent(),[2,N]}})})},I}();u.default=m},8953:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).Customer="Customer",s.Agent="__agent__",s.System="__system__",c;var s})();u.default=c},2562:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.default={IC3:"IC3",DirectLine:"DirectLine",ACS:"ACS"}},813:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.defaultMessageTags=void 0,u.defaultMessageTags=["ChannelId-lcw","FromCustomer"]},3709:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.ResourceType=u.FileSharingProtocolType=u.PersonType=u.MessageType=u.DeliveryMode=u.MessageContentType=void 0;var c=function(){function l(){}return l.RichText="RichText",l.Text="Text",l}();u.MessageContentType=c;var s=function(){function l(){}return l.Bridged="bridged",l.Unbridged="unbridged",l}();u.DeliveryMode=s;var l,_=function(){function l(){}return l.UserMessage="UserMessage",l.SwiftCard="SwiftCard",l.Typing="Control/Typing",l.ClearTyping="Control/ClearTyping",l.LiveState="Control/LiveState",l}();u.MessageType=_,(l=u.PersonType||(u.PersonType={}))[l.Unknown=0]="Unknown",l[l.User=1]="User",l[l.Bot=2]="Bot",function(l){l[l.AmsBasedFileSharing=0]="AmsBasedFileSharing"}(u.FileSharingProtocolType||(u.FileSharingProtocolType={}));var T=function(){function l(){}return l.NewMessage="NewMessage",l.MessageUpdate="MessageUpdate",l.UserPresence="UserPresence",l.ConversationUpdate="ConversationUpdate",l.ThreadUpdate="ThreadUpdate",l}();u.ResourceType=T},2921:function(Q,u){"use strict";var c=this&&this.__awaiter||function(T,l,C,P){return new(C||(C=Promise))(function(f,g){function E(I){try{m(P.next(I))}catch(x){g(x)}}function b(I){try{m(P.throw(I))}catch(x){g(x)}}function m(I){I.done?f(I.value):function(f){return f instanceof C?f:new C(function(g){g(f)})}(I.value).then(E,b)}m((P=P.apply(T,l||[])).next())})},s=this&&this.__generator||function(T,l){var P,S,f,g,C={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return g={next:E(0),throw:E(1),return:E(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function E(m){return function(I){return function(m){if(P)throw new TypeError("Generator is already executing.");for(;C;)try{if(P=1,S&&(f=2&m[0]?S.return:m[0]?S.throw||((f=S.return)&&f.call(S),0):S.next)&&!(f=f.call(S,m[1])).done)return f;switch(S=0,f&&(m=[2&m[0],f.value]),m[0]){case 0:case 1:f=m;break;case 4:return C.label++,{value:m[1],done:!1};case 5:C.label++,S=m[1],m=[0];continue;case 7:m=C.ops.pop(),C.trys.pop();continue;default:if(!(f=(f=C.trys).length>0&&f[f.length-1])&&(6===m[0]||2===m[0])){C=0;continue}if(3===m[0]&&(!f||m[1]>f[0]&&m[1]<f[3])){C.label=m[1];break}if(6===m[0]&&C.label<f[1]){C.label=f[1],f=m;break}if(f&&C.label<f[2]){C.label=f[2],C.ops.push(m);break}f[2]&&C.ops.pop(),C.trys.pop();continue}m=l.call(T,C)}catch(I){m=[6,I],S=0}finally{P=f=0}if(5&m[0])throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}([m,I])}}};Object.defineProperty(u,"__esModule",{value:!0});var d=(()=>{return(T=d||(d={})).AMSUpload="AMSUpload",T.AMSDownload="AMSDownload",T.GetFileIds="GetFileIds",T.CreateFileIdProperty="CreateFileIdProperty",T.GetFileMetadata="GetFileMetadata",T.CreateFileMetadataProperty="CreateFileMetadataProperty",d;var T})(),p=function(){function T(l,C){void 0===C&&(C=null),this.logger=C,this.amsClient=l}return T.prototype.uploadFiles=function(l){return c(this,void 0,void 0,function(){var C=this;return s(this,function(P){return[2,Promise.all(l.map(function(S){return c(C,void 0,void 0,function(){return s(this,function(f){return[2,this.uploadFileToAMS(S)]})})}))]})})},T.prototype.downloadFiles=function(l){return c(this,void 0,void 0,function(){var C=this;return s(this,function(P){return[2,Promise.all(l.map(function(S){return c(C,void 0,void 0,function(){return s(this,function(f){return[2,this.downloadFileFromAMS(S)]})})}))]})})},T.prototype.updatePermissions=function(){return c(this,void 0,void 0,function(){return s(this,function(l){return[2,void 0]})})},T.prototype.getFileIds=function(l){var C,P,S;null===(C=this.logger)||void 0===C||C.startScenario(d.GetFileIds);try{var f=JSON.parse(null==l?void 0:l.amsReferences);return null===(P=this.logger)||void 0===P||P.completeScenario(d.GetFileIds),f}catch(E){return void(null===(S=this.logger)||void 0===S||S.failScenario(d.GetFileIds,{ExceptionDetails:JSON.stringify({metadata:""+l,errorObject:""+E})}))}},T.prototype.createFileIdProperty=function(l){var C,P,S;null===(C=this.logger)||void 0===C||C.startScenario(d.CreateFileIdProperty);try{var f={amsReferences:JSON.stringify(l)};return null===(P=this.logger)||void 0===P||P.completeScenario(d.CreateFileIdProperty),f}catch(E){return void(null===(S=this.logger)||void 0===S||S.failScenario(d.CreateFileIdProperty,{ExceptionDetails:JSON.stringify({fileIds:""+l,errorObject:""+E})}))}},T.prototype.getFileMetadata=function(l){var C,P,S;null===(C=this.logger)||void 0===C||C.startScenario(d.GetFileMetadata);try{var f=JSON.parse(null==l?void 0:l.amsMetadata);return null===(P=this.logger)||void 0===P||P.completeScenario(d.GetFileMetadata),f}catch(E){return void(null===(S=this.logger)||void 0===S||S.failScenario(d.GetFileMetadata,{ExceptionDetails:JSON.stringify({metadata:""+l,errorObject:""+E})}))}},T.prototype.createFileMetadataProperty=function(l){var C,P,S;null===(C=this.logger)||void 0===C||C.startScenario(d.CreateFileMetadataProperty);try{var f={amsMetadata:JSON.stringify(l)};return null===(P=this.logger)||void 0===P||P.completeScenario(d.CreateFileMetadataProperty),f}catch(E){return void(null===(S=this.logger)||void 0===S||S.failScenario(d.CreateFileMetadataProperty,{ExceptionDetails:JSON.stringify({metadata:""+l,errorObject:""+E})}))}},T.prototype.uploadFileToAMS=function(l){var C,P,S,f,g;return c(this,void 0,void 0,function(){var E,b,I,x,N,F,m;return s(this,function(U){switch(U.label){case 0:if(null===(C=this.logger)||void 0===C||C.startScenario(d.AMSUpload),!l.contentUrl||!l.name)return[3,12];E=void 0,U.label=1;case 1:return U.trys.push([1,3,,4]),[4,this.amsClient.fetchBlob(l.contentUrl)];case 2:return E=U.sent(),[3,4];case 3:return b=U.sent(),m={response:"AMSFetchBlobFailure",errorObject:""+b},null===(P=this.logger)||void 0===P||P.failScenario(d.AMSUpload,{ExceptionDetails:JSON.stringify(m)}),[2,void 0];case 4:I=new File([E],l.name,{type:l.contentType}),x=void 0,U.label=5;case 5:return U.trys.push([5,7,,8]),[4,this.amsClient.createObject(this.amsClient.chatToken.chatId,I)];case 6:return x=U.sent(),[3,8];case 7:return N=U.sent(),m={response:"AMSCreateObjectFailure",errorObject:""+N},null===(S=this.logger)||void 0===S||S.failScenario(d.AMSUpload,{ExceptionDetails:JSON.stringify(m)}),[2,void 0];case 8:return U.trys.push([8,10,,11]),[4,this.amsClient.uploadDocument(x.id,I)];case 9:return U.sent(),[3,11];case 10:return F=U.sent(),m={response:"AMSUploadDocumentFailure",errorObject:""+F},null===(f=this.logger)||void 0===f||f.failScenario(d.AMSUpload,{ExceptionDetails:JSON.stringify(m)}),[2,void 0];case 11:return null===(g=this.logger)||void 0===g||g.completeScenario(d.AMSUpload),[2,{fileId:x.id,metadata:{contentType:l.contentType,fileName:l.name}}];case 12:return[2]}})})},T.prototype.downloadFileFromAMS=function(l){var C,P,S,f;return c(this,void 0,void 0,function(){var g,E,b,I,x,N,m,F;return s(this,function(U){switch(U.label){case 0:if(null===(C=this.logger)||void 0===C||C.startScenario(d.AMSDownload),!(l.fileId&&l.metadata&&l.metadata.fileName))return[3,9];g={id:l.fileId,type:l.metadata.contentType.split("/").pop()},E=void 0,U.label=1;case 1:return U.trys.push([1,3,,4]),[4,this.amsClient.getViewStatus(g)];case 2:return E=U.sent(),[3,4];case 3:return b=U.sent(),m={response:"AMSGetViewStatusFailure",errorObject:""+b},null===(P=this.logger)||void 0===P||P.failScenario(d.AMSDownload,{ExceptionDetails:JSON.stringify(m)}),[2,void 0];case 4:I=E.view_location,x=void 0,U.label=5;case 5:return U.trys.push([5,7,,8]),[4,this.amsClient.getView(g,I)];case 6:return x=U.sent(),[3,8];case 7:return N=U.sent(),m={response:"AMSGetViewFailure",errorObject:""+N},null===(S=this.logger)||void 0===S||S.failScenario(d.AMSDownload,{ExceptionDetails:JSON.stringify(m)}),[2,void 0];case 8:return F=new File([x],l.metadata.fileName,{type:l.metadata.contentType}),null===(f=this.logger)||void 0===f||f.completeScenario(d.AMSDownload),[2,F];case 9:return[2]}})})},T}();u.default=p},9451:(Q,u)=>{"use strict";var s;Object.defineProperty(u,"__esModule",{value:!0}),(s=u._BondDataType||(u._BondDataType={}))[s._BT_STOP=0]="_BT_STOP",s[s._BT_STOP_BASE=1]="_BT_STOP_BASE",s[s._BT_BOOL=2]="_BT_BOOL",s[s._BT_DOUBLE=8]="_BT_DOUBLE",s[s._BT_STRING=9]="_BT_STRING",s[s._BT_STRUCT=10]="_BT_STRUCT",s[s._BT_LIST=11]="_BT_LIST",s[s._BT_MAP=13]="_BT_MAP",s[s._BT_INT32=16]="_BT_INT32",s[s._BT_INT64=17]="_BT_INT64"},1464:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(6649),_=c(5644),d=c(514);u._Utf8_GetBytes=function(g){for(var E=[],b=0;b<g.length;++b){var m=g.charCodeAt(b);m<128?E.push(m):m<2048?E.push(192|m>>6,128|63&m):m<55296||m>=57344?E.push(224|m>>12,128|m>>6&63,128|63&m):(m=65536+((1023&m)<<10|1023&g.charCodeAt(++b)),E.push(240|m>>18,128|m>>12&63,128|m>>6&63,128|63&m))}return E},u._Base64_GetString=function(g){for(var E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=[],m=g.length%3,x=0,N=g.length-m;x<N;x+=3)b.push([E.charAt((k=F=(g[x]<<16)+(g[x+1]<<8)+g[x+2])>>18&63),E.charAt(k>>12&63),E.charAt(k>>6&63),E.charAt(63&k)].join(""));var k;switch(m){case 1:var F;b.push(E.charAt((F=g[g.length-1])>>2)),b.push(E.charAt(F<<4&63)),b.push("==");break;case 2:var U=(g[g.length-2]<<8)+g[g.length-1];b.push(E.charAt(U>>10)),b.push(E.charAt(U>>4&63)),b.push(E.charAt(U<<2&63)),b.push("=")}return b.join("")},u._Varint_GetBytes=function(g){for(var E=[];4294967168&g;)E.push(127&g|128),g>>>=7;return E.push(127&g),E},u._Varint64_GetBytes=function(g){for(var E=g.low,b=g.high,m=[];b||4294967168&E;)m.push(127&E|128),E=(127&b)<<25|E>>>7,b>>>=7;return m.push(127&E),m},u._Double_GetBytes=function(g){if(d.BrowserChecker._IsDataViewSupport()){var E=new DataView(new ArrayBuffer(8));E.setFloat64(0,g,!0);for(var b=[],m=0;m<8;++m)b.push(E.getUint8(m));return b}return _.FloatUtils._ConvertNumberToArray(g,!0)},u._Zigzag_EncodeZigzag32=function(g){return(g=s.Number._ToInt32(g))<<1^g>>31},u._Zigzag_EncodeZigzag64=function(g){var E=g.low,b=g.high,m=b<<1|E>>>31,I=E<<1;2147483648&b&&(m=~m,I=~I);var x=new s.UInt64("0");return x.low=I,x.high=m,x}},5644:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s._ConvertNumberToArray=function(_,d){if(!_)return d?this._doubleZero:this._floatZero;var T=d?52:23,l=(1<<(d?11:8)-1)-1,C=1-l,P=l,S=_<0?1:0;_=Math.abs(_);for(var f=Math.floor(_),g=_-f,E=2*(l+2)+T,b=new Array(E),m=0;m<E;)b[m++]=0;for(m=l+2;m&&f;)b[--m]=f%2,f=Math.floor(f/2);for(m=l+1;m<E-1&&g>0;)(g*=2)>=1?(b[++m]=1,--g):b[++m]=0;for(var I=0;I<E&&!b[I];)I++;var x=l+1-I,N=I+T;if(b[N+1]){for(m=N;m>I&&(b[m]=1-b[m],!b);--m);m===I&&++x}if(x>P||f)return S?d?this._doubleNegInifinity:this._floatNegInifinity:d?this._doubleInifinity:this._floatInifinity;if(x<C)return d?this._doubleZero:this._floatZero;if(d){var F=0;for(m=0;m<20;++m)F=F<<1|b[++I];for(var U=0;m<52;++m)U=U<<1|b[++I];return[255&U,U>>8&255,U>>16&255,U>>>24,255&(F=S<<31|2147483647&(F|=x+l<<20)),F>>8&255,F>>16&255,F>>>24]}var D=0;for(m=0;m<23;++m)D=D<<1|b[++I];return[255&(D=S<<31|2147483647&(D|=x+l<<23)),D>>8&255,D>>16&255,D>>>24]},s._floatZero=[0,0,0,0],s._doubleZero=[0,0,0,0,0,0,0,0],s._floatInifinity=[0,0,128,127],s._floatNegInifinity=[0,0,128,255],s._doubleInifinity=[0,0,0,0,0,0,240,127],s._doubleNegInifinity=[0,0,0,0,0,0,240,255],s}();u.FloatUtils=c},67:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(6649),_=function(){function d(){this._buffer=[]}return d.prototype._WriteByte=function(p){this._buffer.push(s.Number._ToByte(p))},d.prototype._Write=function(p,T,l){for(;l--;)this._WriteByte(p[T++])},d.prototype._GetBuffer=function(){return this._buffer},d}();u.MemoryStream=_},4356:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(9451);u._BondDataType=s._BondDataType;var _=c(1464);u._Encoding=_;var d=c(67);u.IO=d;var p=c(6649);u.Int64=p.Int64,u.UInt64=p.UInt64,u.Number=p.Number;var T=function(){function l(C){this._stream=C}return l.prototype._WriteBlob=function(C){this._stream._Write(C,0,C.length)},l.prototype._WriteBool=function(C){this._stream._WriteByte(C?1:0)},l.prototype._WriteContainerBegin=function(C,P){this._WriteUInt8(P),this._WriteUInt32(C)},l.prototype._WriteMapContainerBegin=function(C,P,S){this._WriteUInt8(P),this._WriteUInt8(S),this._WriteUInt32(C)},l.prototype._WriteDouble=function(C){var P=_._Double_GetBytes(C);this._stream._Write(P,0,P.length)},l.prototype._WriteFieldBegin=function(C,P,S){P<=5?this._stream._WriteByte(C|P<<5):P<=255?(this._stream._WriteByte(192|C),this._stream._WriteByte(P)):(this._stream._WriteByte(224|C),this._stream._WriteByte(P),this._stream._WriteByte(P>>8))},l.prototype._WriteInt32=function(C){C=_._Zigzag_EncodeZigzag32(C),this._WriteUInt32(C)},l.prototype._WriteInt64=function(C){this._WriteUInt64(_._Zigzag_EncodeZigzag64(C))},l.prototype._WriteString=function(C){if(""===C)this._WriteUInt32(0);else{var P=_._Utf8_GetBytes(C);this._WriteUInt32(P.length),this._stream._Write(P,0,P.length)}},l.prototype._WriteStructEnd=function(C){this._WriteUInt8(C?s._BondDataType._BT_STOP_BASE:s._BondDataType._BT_STOP)},l.prototype._WriteUInt32=function(C){var P=_._Varint_GetBytes(p.Number._ToUInt32(C));this._stream._Write(P,0,P.length)},l.prototype._WriteUInt64=function(C){var P=_._Varint64_GetBytes(C);this._stream._Write(P,0,P.length)},l.prototype._WriteUInt8=function(C){this._stream._WriteByte(p.Number._ToUInt8(C))},l}();u.CompactBinaryProtocolWriter=T},6649:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function d(p){this.low=0,this.high=0,this.low=parseInt(p,10),this.low<0&&(this.high=-1)}return d.prototype._Equals=function(p){var T=new d(p);return this.low===T.low&&this.high===T.high},d}();u.Int64=c;var s=function(){function d(p){this.low=0,this.high=0,this.low=parseInt(p,10)}return d.prototype._Equals=function(p){var T=new d(p);return this.low===T.low&&this.high===T.high},d}();u.UInt64=s;var _=function(){function d(){}return d._ToByte=function(p){return this._ToUInt8(p)},d._ToUInt8=function(p){return 255&p},d._ToInt32=function(p){return 2147483647&p|2147483648&p},d._ToUInt32=function(p){return 4294967295&p},d}();u.Number=_},514:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},s}();u.BrowserChecker=c},4501:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(_){this.clockSkewRefreshDurationInMins=_,this._reset()}return s.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},s.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},s.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},s.prototype.setClockSkew=function(_){this._clockSkewSet||(_?this._clockSkewHeaderValue=_:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},s.prototype._reset=function(){var _=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout(function(){return _._reset()},6e4*this.clockSkewRefreshDurationInMins)},s}();u.default=c},7190:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=function(){function _(){this._killedTokenDictionary={}}return _.prototype.setKillSwitchTenants=function(d,p){if(d&&p)try{var T=d.split(",");if("this-request-only"===p)return T;for(var l=1e3*parseInt(p,10),C=0;C<T.length;++C)this._killedTokenDictionary[T[C]]=Date.now()+l}catch(P){return[]}return[]},_.prototype.isTenantKilled=function(d){return void 0!==this._killedTokenDictionary[d]&&this._killedTokenDictionary[d]>Date.now()||(delete this._killedTokenDictionary[d],!1)},_}();u.default=s},2551:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.addNotificationListener=function(_){this.listeners.push(_)},s.removeNotificationListener=function(_){for(var d=this.listeners.indexOf(_);d>-1;)this.listeners.splice(d,1),d=this.listeners.indexOf(_)},s.eventsSent=function(_){for(var d=this,p=function(C){T.listeners[C].eventsSent&&setTimeout(function(){return d.listeners[C].eventsSent(_)},0)},T=this,l=0;l<this.listeners.length;++l)p(l)},s.eventsDropped=function(_,d){for(var p=this,T=function(P){l.listeners[P].eventsDropped&&setTimeout(function(){return p.listeners[P].eventsDropped(_,d)},0)},l=this,C=0;C<this.listeners.length;++C)T(C)},s.eventsRetrying=function(_){for(var d=this,p=function(C){T.listeners[C].eventsRetrying&&setTimeout(function(){return d.listeners[C].eventsRetrying(_)},0)},T=this,l=0;l<this.listeners.length;++l)p(l)},s.eventsRejected=function(_,d){for(var p=this,T=function(P){l.listeners[P].eventsRejected&&setTimeout(function(){return p.listeners[P].eventsRejected(_,d)},0)},l=this,C=0;C<this.listeners.length;++C)T(C)},s.listeners=[],s}();u.default=c},2659:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(676),_=function(){function d(p,T){this._outboundQueue=p,this._maxNumberOfEvents=T,this._currentBatch={},this._currentNumEventsInBatch=0}return d.prototype.addEventToBatch=function(p){if(p.priority===s.AWTEventPriority.Immediate_sync){var T={};return T[p.apiKey]=[p],T}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[p.apiKey]&&(this._currentBatch[p.apiKey]=[]),this._currentBatch[p.apiKey].push(p),this._currentNumEventsInBatch++,null},d.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},d.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},d}();u.default=_},7270:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var p=function(){function T(){}return T.shouldRetryForStatus=function(l){return!(l>=300&&l<500&&408!==l||501===l||505===l)},T.getMillisToBackoffForRetry=function(l){var C,f=Math.floor(1200*Math.random())+2400;return C=Math.pow(4,l)*f,Math.min(C,12e4)},T}();u.default=p},6064:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(4356),_=c(676),d=c(2551),p=c(5593),T=2936012,l=function(){function C(){}return C.getPayloadBlob=function(P,S){var g,f=!1,E=new s.IO.MemoryStream,b=new s.CompactBinaryProtocolWriter(E);for(var m in b._WriteFieldBegin(s._BondDataType._BT_MAP,3,null),b._WriteMapContainerBegin(S,s._BondDataType._BT_STRING,s._BondDataType._BT_LIST),P)if(f)g||(g={}),g[m]=P[m],delete P[m];else if(P.hasOwnProperty(m)){b._WriteString(m);var I=P[m];b._WriteContainerBegin(1,s._BondDataType._BT_STRUCT),b._WriteFieldBegin(s._BondDataType._BT_STRING,2,null),b._WriteString("act_default_source"),b._WriteFieldBegin(s._BondDataType._BT_STRING,5,null),b._WriteString(p.newGuid()),b._WriteFieldBegin(s._BondDataType._BT_INT64,6,null),b._WriteInt64(p.numberToBondInt64(Date.now())),b._WriteFieldBegin(s._BondDataType._BT_LIST,8,null);var x=E._GetBuffer().length+1;b._WriteContainerBegin(P[m].length,s._BondDataType._BT_STRUCT);for(var N=E._GetBuffer().length-x,F=0;F<I.length;++F){var U=E._GetBuffer().length;if(this.writeEvent(I[F],b),E._GetBuffer().length-U>T)d.default.eventsRejected([I[F]],_.AWTEventsRejectedReason.SizeLimitExceeded),I.splice(F--,1),E._GetBuffer().splice(U),this._addNewDataPackageSize(I.length,E,N,x);else if(E._GetBuffer().length>T){E._GetBuffer().splice(U),g||(g={}),P[m]=I.splice(0,F),g[m]=I,this._addNewDataPackageSize(P[m].length,E,N,x),f=!0;break}}b._WriteStructEnd(!1)}return b._WriteStructEnd(!1),{payloadBlob:E._GetBuffer(),remainingRequest:g}},C._addNewDataPackageSize=function(P,S,f,g){for(var E=s._Encoding._Varint_GetBytes(s.Number._ToUInt32(P)),b=0;b<f;++b){if(!(b<E.length)){S._GetBuffer().slice(g+b,f-b);break}S._GetBuffer()[g+b]=E[b]}},C.writeEvent=function(P,S){S._WriteFieldBegin(s._BondDataType._BT_STRING,1,null),S._WriteString(P.id),S._WriteFieldBegin(s._BondDataType._BT_INT64,3,null),S._WriteInt64(p.numberToBondInt64(P.timestamp)),S._WriteFieldBegin(s._BondDataType._BT_STRING,5,null),S._WriteString(P.type),S._WriteFieldBegin(s._BondDataType._BT_STRING,6,null),S._WriteString(P.name);var f={},g=0,E={},b=0,m={},I=0,x={},N=0,F={},U=0,k={},D=0,M={},j=0;for(var W in P.properties)if(P.properties.hasOwnProperty(W))if(($=P.properties[W]).cc>0)M[W]=$,j++;else if($.pii>0)k[W]=$,D++;else switch($.type){case _.AWTPropertyType.String:f[W]=$.value,g++;break;case _.AWTPropertyType.Int64:E[W]=$.value,b++;break;case _.AWTPropertyType.Double:m[W]=$.value,I++;break;case _.AWTPropertyType.Boolean:x[W]=$.value,N++;break;case _.AWTPropertyType.Date:F[W]=$.value,U++}if(g)for(var W in S._WriteFieldBegin(s._BondDataType._BT_MAP,13,null),S._WriteMapContainerBegin(g,s._BondDataType._BT_STRING,s._BondDataType._BT_STRING),f)if(f.hasOwnProperty(W)){var ce=f[W];S._WriteString(W),S._WriteString(ce.toString())}if(D)for(var W in S._WriteFieldBegin(s._BondDataType._BT_MAP,30,null),S._WriteMapContainerBegin(D,s._BondDataType._BT_STRING,s._BondDataType._BT_STRUCT),k)if(k.hasOwnProperty(W)){var $=k[W];S._WriteString(W),S._WriteFieldBegin(s._BondDataType._BT_INT32,1,null),S._WriteInt32(1),S._WriteFieldBegin(s._BondDataType._BT_INT32,2,null),S._WriteInt32($.pii),S._WriteFieldBegin(s._BondDataType._BT_STRING,3,null),S._WriteString($.value.toString()),S._WriteStructEnd(!1)}if(N)for(var W in S._WriteFieldBegin(s._BondDataType._BT_MAP,31,null),S._WriteMapContainerBegin(N,s._BondDataType._BT_STRING,s._BondDataType._BT_BOOL),x)x.hasOwnProperty(W)&&(ce=x[W],S._WriteString(W),S._WriteBool(ce));if(U)for(var W in S._WriteFieldBegin(s._BondDataType._BT_MAP,32,null),S._WriteMapContainerBegin(U,s._BondDataType._BT_STRING,s._BondDataType._BT_INT64),F)F.hasOwnProperty(W)&&(ce=F[W],S._WriteString(W),S._WriteInt64(p.numberToBondInt64(ce)));if(b)for(var W in S._WriteFieldBegin(s._BondDataType._BT_MAP,33,null),S._WriteMapContainerBegin(b,s._BondDataType._BT_STRING,s._BondDataType._BT_INT64),E)E.hasOwnProperty(W)&&(ce=E[W],S._WriteString(W),S._WriteInt64(p.numberToBondInt64(ce)));if(I)for(var W in S._WriteFieldBegin(s._BondDataType._BT_MAP,34,null),S._WriteMapContainerBegin(I,s._BondDataType._BT_STRING,s._BondDataType._BT_DOUBLE),m)m.hasOwnProperty(W)&&(ce=m[W],S._WriteString(W),S._WriteDouble(ce));if(j)for(var W in S._WriteFieldBegin(s._BondDataType._BT_MAP,36,null),S._WriteMapContainerBegin(j,s._BondDataType._BT_STRING,s._BondDataType._BT_STRUCT),M)M.hasOwnProperty(W)&&($=M[W],S._WriteString(W),S._WriteFieldBegin(s._BondDataType._BT_INT32,1,null),S._WriteInt32($.cc),S._WriteFieldBegin(s._BondDataType._BT_STRING,2,null),S._WriteString($.value.toString()),S._WriteStructEnd(!1));S._WriteStructEnd(!1)},C.base64Encode=function(P){return s._Encoding._Base64_GetString(P)},C}();u.default=l},5816:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(5593),_=c(2551),d=c(676),T=function(){function l(){}return l.initialize=function(C){var P=this;this._sendStats=C,this._isInitalized=!0,_.default.addNotificationListener({eventsSent:function(S){P._addStat("records_sent_count",S.length,S[0].apiKey)},eventsDropped:function(S,f){switch(f){case d.AWTEventsDroppedReason.NonRetryableStatus:P._addStat("d_send_fail",S.length,S[0].apiKey),P._addStat("records_dropped_count",S.length,S[0].apiKey);break;case d.AWTEventsDroppedReason.MaxRetryLimit:P._addStat("d_retry_limit",S.length,S[0].apiKey),P._addStat("records_dropped_count",S.length,S[0].apiKey);break;case d.AWTEventsDroppedReason.QueueFull:P._addStat("d_queue_full",S.length,S[0].apiKey)}},eventsRejected:function(S,f){switch(f){case d.AWTEventsRejectedReason.InvalidEvent:P._addStat("r_inv",S.length,S[0].apiKey);break;case d.AWTEventsRejectedReason.KillSwitch:P._addStat("r_kl",S.length,S[0].apiKey);break;case d.AWTEventsRejectedReason.SizeLimitExceeded:P._addStat("r_size",S.length,S[0].apiKey)}P._addStat("r_count",S.length,S[0].apiKey)},eventsRetrying:null}),setTimeout(function(){return P.flush()},6e4)},l.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},l.eventReceived=function(C){l._addStat("records_received_count",1,C)},l.flush=function(){var C=this;if(this._isInitalized){for(var P in this._stats)this._stats.hasOwnProperty(P)&&this._sendStats(this._stats[P],P);this._stats={},setTimeout(function(){return C.flush()},6e4)}},l._addStat=function(C,P,S){if(this._isInitalized&&S!==s.StatsApiKey){var f=s.getTenantId(S);this._stats[f]||(this._stats[f]={}),this._stats[f][C]=this._stats[f][C]?this._stats[f][C]+P:P}},l._isInitalized=!1,l._stats={},l}();u.default=T},676:(Q,u)=>{"use strict";var l;Object.defineProperty(u,"__esModule",{value:!0}),(l=u.AWTPropertyType||(u.AWTPropertyType={}))[l.Unspecified=0]="Unspecified",l[l.String=1]="String",l[l.Int64=2]="Int64",l[l.Double=3]="Double",l[l.Boolean=4]="Boolean",l[l.Date=5]="Date",function(l){l[l.NotSet=0]="NotSet",l[l.DistinguishedName=1]="DistinguishedName",l[l.GenericData=2]="GenericData",l[l.IPV4Address=3]="IPV4Address",l[l.IPv6Address=4]="IPv6Address",l[l.MailSubject=5]="MailSubject",l[l.PhoneNumber=6]="PhoneNumber",l[l.QueryString=7]="QueryString",l[l.SipAddress=8]="SipAddress",l[l.SmtpAddress=9]="SmtpAddress",l[l.Identity=10]="Identity",l[l.Uri=11]="Uri",l[l.Fqdn=12]="Fqdn",l[l.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(u.AWTPiiKind||(u.AWTPiiKind={})),function(l){l[l.NotSet=0]="NotSet",l[l.GenericContent=1]="GenericContent"}(u.AWTCustomerContentKind||(u.AWTCustomerContentKind={})),function(l){l[l.Low=1]="Low",l[l.Normal=2]="Normal",l[l.High=3]="High",l[l.Immediate_sync=5]="Immediate_sync"}(u.AWTEventPriority||(u.AWTEventPriority={})),function(l){l[l.NonRetryableStatus=1]="NonRetryableStatus",l[l.QueueFull=3]="QueueFull",l[l.MaxRetryLimit=4]="MaxRetryLimit"}(u.AWTEventsDroppedReason||(u.AWTEventsDroppedReason={})),function(l){l[l.InvalidEvent=1]="InvalidEvent",l[l.SizeLimitExceeded=2]="SizeLimitExceeded",l[l.KillSwitch=3]="KillSwitch"}(u.AWTEventsRejectedReason||(u.AWTEventsRejectedReason={}))},5593:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(6649),_=c(676),d=/[xy]/g,l=null;u.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,u.EventNameDotRegex=/\./g,u.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,u.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var C=l,P=l,S=l;function E(J){return"string"==typeof J}function b(J){return"number"==typeof J}function m(J){return"boolean"==typeof J}function I(J){return J instanceof Date}function x(J){return 1e4*(J+621355968e5)}function $(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function ce(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function oe(J){return J<10?"0"+J:J.toString()}function re(J){return void 0===J||J===l||""===J}u.numberToBondInt64=function(J){var ne=new s.Int64("0");return ne.low=4294967295&J,ne.high=Math.floor(J/4294967296),ne},u.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(d,function(J){var ne=16*Math.random()|0;return("x"===J?ne:3&ne|8).toString(16)})},u.isString=E,u.isNumber=b,u.isBoolean=m,u.isDate=I,u.msToTicks=x,u.getTenantId=function(J){var ne=J.indexOf("-");return ne>-1?J.substring(0,ne):""},u.isBeaconsSupported=function(){return C===l&&(C="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),C},u.isUint8ArrayAvailable=function(){return P===l&&(P="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var J=navigator.userAgent.toLowerCase();if((J.indexOf("safari")>=0||J.indexOf("firefox")>=0)&&J.indexOf("chrome")<0)return!0}return!1}()&&!$()),P},u.isPriority=function(J){return!(!b(J)||!(J>=1&&J<=3||5===J))},u.sanitizeProperty=function(J,ne){return!u.PropertyNameRegex.test(J)||re(ne)||(re(ne.value)&&(ne={value:ne,type:_.AWTPropertyType.Unspecified}),ne.type=function(J,ne){switch(ne=function(J){return!!(b(J)&&J>=0&&J<=4)}(ne)?ne:_.AWTPropertyType.Unspecified){case _.AWTPropertyType.Unspecified:return function(J){switch(typeof J){case"string":return _.AWTPropertyType.String;case"boolean":return _.AWTPropertyType.Boolean;case"number":return _.AWTPropertyType.Double;case"object":return I(J)?_.AWTPropertyType.Date:l}return l}(J);case _.AWTPropertyType.String:return E(J)?ne:l;case _.AWTPropertyType.Boolean:return m(J)?ne:l;case _.AWTPropertyType.Date:return I(J)&&NaN!==J.getTime()?ne:l;case _.AWTPropertyType.Int64:return b(J)&&J%1==0?ne:l;case _.AWTPropertyType.Double:return b(J)?ne:l}return l}(ne.value,ne.type),!ne.type)||(I(ne.value)&&(ne.value=x(ne.value.getTime())),ne.pii>0&&ne.cc>0)?l:ne.pii?function(J){return!!(b(J)&&J>=0&&J<=13)}(ne.pii)?ne:l:ne.cc?function(J){return!!(b(J)&&J>=0&&J<=1)}(ne.cc)?ne:l:ne},u.getISOString=function(J){return J.getUTCFullYear()+"-"+oe(J.getUTCMonth()+1)+"-"+oe(J.getUTCDate())+"T"+oe(J.getUTCHours())+":"+oe(J.getUTCMinutes())+":"+oe(J.getUTCSeconds())+"."+function(J){return J<10?"00"+J:J<100?"0"+J:J.toString()}(J.getUTCMilliseconds())+"Z"},u.useXDomainRequest=function(){if(S===l){var J=new XMLHttpRequest;S=void 0===J.withCredentials&&"undefined"!=typeof XDomainRequest}return S},u.useFetchRequest=function(){return $()||ce()},u.isReactNative=$,u.isServiceWorkerGlobalScope=ce},4094:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(5593),_="MicrosoftApplicationsTelemetryDeviceId",d="MicrosoftApplicationsTelemetryFirstLaunchTime",l_WIN=/(windows|win32)/i,l_WINRT=/ arm;/i,l_WINPHONE=/windows\sphone\s\d+\.\d+/i,l_OSX=/(macintosh|mac os x)/i,l_IOS=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,l_LINUX=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,l_ANDROID=/android/i,l_CROS=/CrOS/i,C={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},P="([\\d,.]+)",f="Unknown",g="undefined",E=function(){function b(){}return b.addPropertyStorageOverride=function(m){return!!m&&(this._propertyStorage=m,!0)},b.autoCollect=function(m,I,x){if(this._semanticContext=m,this._disableCookies=I,this._autoCollect(),!x&&typeof navigator!==g&&(x=navigator.userAgent||""),this._autoCollectFromUserAgent(x),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(_),void this._deleteCookie(d);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},b.checkAndSaveDeviceId=function(m){if(m){var I=this._getData(_),x=this._getData(d);I!==m&&(x=s.getISOString(new Date)),this._saveData(_,m),this._saveData(d,x),this._setFirstLaunchTime(x)}},b._autoCollectDeviceId=function(){var m=this._getData(_);m||(m=s.newGuid()),this._semanticContext.setDeviceId(m)},b._autoCollect=function(){typeof document!==g&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),typeof navigator!==g&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var m=(new Date).getTimezoneOffset(),I=m%60,x=(m-I)/60,N="+";x>0&&(N="-"),x=Math.abs(x),I=Math.abs(I),this._semanticContext.setUserTimeZone(N+(x<10?"0"+x:x.toString())+":"+(I<10?"0"+I:I.toString()))},b._autoCollectFromUserAgent=function(m){if(m){var I=this._getBrowserName(m);this._semanticContext.setDeviceBrowserName(I),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(m,I));var x=this._getOsName(m);this._semanticContext.setDeviceOsName(x),this._semanticContext.setDeviceOsVersion(this._getOsVersion(m,x))}},b._getBrowserName=function(m){return this._userAgentContainsString("OPR/",m)?"Opera":this._userAgentContainsString("PhantomJS",m)?"PhantomJS":this._userAgentContainsString("Edge",m)||this._userAgentContainsString("Edg",m)?"Edge":this._userAgentContainsString("Electron",m)?"Electron":this._userAgentContainsString("Chrome",m)?"Chrome":this._userAgentContainsString("Trident",m)?"MSIE":this._userAgentContainsString("Firefox",m)?"Firefox":this._userAgentContainsString("Safari",m)?"Safari":this._userAgentContainsString("SkypeShell",m)?"SkypeShell":f},b._setFirstLaunchTime=function(m){if(!isNaN(m)){var I=new Date;I.setTime(parseInt(m,10)),m=s.getISOString(I)}this.firstLaunchTime=m},b._userAgentContainsString=function(m,I){return I.indexOf(m)>-1},b._getBrowserVersion=function(m,I){if("MSIE"===I)return this._getIeVersion(m);if("Edge"===I){var x=this._getOtherVersion(I,m);return x===f?this._getOtherVersion("Edg",m):x}return this._getOtherVersion(I,m)},b._getIeVersion=function(m){var I=m.match(new RegExp("MSIE "+P));if(I)return I[1];var x=m.match(new RegExp("rv:"+P));return x?x[1]:void 0},b._getOtherVersion=function(m,I){"Safari"===m&&(m="Version");var x=I.match(new RegExp(m+"/"+P));return x?x[1]:f},b._getOsName=function(m){return m.match(l_WINPHONE)?"Windows Phone":m.match(l_WINRT)?"Windows RT":m.match(l_IOS)?"iOS":m.match(l_ANDROID)?"Android":m.match(l_LINUX)?"Linux":m.match(l_OSX)?"Mac OS X":m.match(l_WIN)?"Windows":m.match(l_CROS)?"Chrome OS":f},b._getOsVersion=function(m,I){return"Windows"===I?this._getGenericOsVersion(m,"Windows NT"):"Android"===I?this._getGenericOsVersion(m,I):"Mac OS X"===I?this._getMacOsxVersion(m):f},b._getGenericOsVersion=function(m,I){var x=m.match(new RegExp(I+" "+P));return x?C[x[1]]?C[x[1]]:x[1]:f},b._getMacOsxVersion=function(m){var I=m.match(new RegExp("Mac OS X ([\\d,_,.]+)"));if(I){var x=I[1].replace(/_/g,".");if(x){var N=this._getDelimiter(x);return N?x.split(N)[0]:x}}return f},b._getDelimiter=function(m){return m.indexOf(".")>-1?".":m.indexOf("_")>-1?"_":null},b._saveData=function(m,I){if(this._propertyStorage)this._propertyStorage.setProperty(m,I);else if(this._areCookiesAvailable){var x=new Date;x.setTime(x.getTime()+31536e6);var N="expires="+x.toUTCString();document.cookie=m+"="+I+"; "+N}},b._getData=function(m){if(this._propertyStorage)return this._propertyStorage.getProperty(m)||"";if(this._areCookiesAvailable){m+="=";for(var I=document.cookie.split(";"),x=0;x<I.length;x++){for(var N=I[x],F=0;" "===N.charAt(F);)F++;if(0===(N=N.substring(F)).indexOf(m))return N.substring(m.length,N.length)}}return""},b._deleteCookie=function(m){this._areCookiesAvailable&&(document.cookie=m+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},b._disableCookies=!1,b._areCookiesAvailable=typeof document!==g&&typeof document.cookie!==g,b}();u.default=E},58:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(5593),_=c(676),d=function(){function p(T){this._event={name:"",properties:{}},T&&this.setName(T)}return p.prototype.setName=function(T){this._event.name=T},p.prototype.getName=function(){return this._event.name},p.prototype.setType=function(T){this._event.type=T},p.prototype.getType=function(){return this._event.type},p.prototype.setTimestamp=function(T){this._event.timestamp=T},p.prototype.getTimestamp=function(){return this._event.timestamp},p.prototype.setEventPriority=function(T){this._event.priority=T},p.prototype.getEventPriority=function(){return this._event.priority},p.prototype.setProperty=function(T,l,C){void 0===C&&(C=_.AWTPropertyType.Unspecified);var P={value:l,type:C,pii:_.AWTPiiKind.NotSet,cc:_.AWTCustomerContentKind.NotSet};null!==(P=s.sanitizeProperty(T,P))?this._event.properties[T]=P:delete this._event.properties[T]},p.prototype.setPropertyWithPii=function(T,l,C,P){void 0===P&&(P=_.AWTPropertyType.Unspecified);var S={value:l,type:P,pii:C,cc:_.AWTCustomerContentKind.NotSet};null!==(S=s.sanitizeProperty(T,S))?this._event.properties[T]=S:delete this._event.properties[T]},p.prototype.setPropertyWithCustomerContent=function(T,l,C,P){void 0===P&&(P=_.AWTPropertyType.Unspecified);var S={value:l,type:P,pii:_.AWTPiiKind.NotSet,cc:C};null!==(S=s.sanitizeProperty(T,S))?this._event.properties[T]=S:delete this._event.properties[T]},p.prototype.getPropertyMap=function(){return this._event.properties},p.prototype.getEvent=function(){return this._event},p}();u.default=d},9449:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(676),_=c(6064),d=c(7270),p=c(7190),T=c(4501),l=c(8779),C=c(5593),P=c(2551),S=c(4023),E="POST",b=function(){function m(I,x,N,F,U){var k=this;this._requestQueue=I,this._queueManager=N,this._httpInterface=F,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+l.FullVersionString,this._killSwitch=new p.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new T.default(U),C.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=x+this._urlString,this._httpInterface||(this._useBeacons=!C.isReactNative(),this._httpInterface={sendPOST:function(D,M,j,W,$,ce){try{if(C.useFetchRequest())fetch(D,{body:M,method:E}).then(function(ue){var he={};ue.headers&&ue.headers.forEach(function(Ee,se){he[se]=Ee}),$(ue.status,he)}).catch(function(ue){W(0,{})});else if(C.useXDomainRequest()){var oe=new XDomainRequest;oe.open(E,D),oe.onload=function(){$(200,null)},oe.onerror=function(){W(400,null)},oe.ontimeout=function(){j(500,null)},oe.send(M)}else{var Z=new XMLHttpRequest;Z.open(E,D,!ce),Z.onload=function(){$(Z.status,k._convertAllHeadersToMap(Z.getAllResponseHeaders()))},Z.onerror=function(){W(Z.status,k._convertAllHeadersToMap(Z.getAllResponseHeaders()))},Z.ontimeout=function(){j(Z.status,k._convertAllHeadersToMap(Z.getAllResponseHeaders()))},Z.send(M)}}catch(ue){W(400,null)}}})}return m.prototype.hasIdleConnection=function(){return this._activeConnections<2},m.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&S.default.scheduleTimer()},m.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},m.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},m.prototype.pause=function(){this._paused=!0},m.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},m.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},m.prototype.sendSynchronousRequest=function(I,x){this._paused&&(I[x][0].priority=s.AWTEventPriority.High),this._activeConnections++,this._sendRequest(I,0,!1,!0)},m.prototype._sendRequest=function(I,x,N,F){var U=this;void 0===F&&(F=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(I);var k=0,D="";for(var M in I)I.hasOwnProperty(M)&&(this._killSwitch.isTenantKilled(M)?(P.default.eventsRejected(I[M],s.AWTEventsRejectedReason.KillSwitch),delete I[M]):(D.length>0&&(D+=","),D+=M,k++));if(k>0){var j=_.default.getPayloadBlob(I,k);j.remainingRequest&&this._requestQueue.push(j.remainingRequest);var W=this._urlString+"&x-apikey="+D+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(W=W+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var $;for(var M in $=C.isUint8ArrayAvailable()?new Uint8Array(j.payloadBlob):_.default.base64Encode(j.payloadBlob),I)if(I.hasOwnProperty(M))for(var ce=0;ce<I[M].length;++ce)I[M][ce].sendAttempt>0?I[M][ce].sendAttempt++:I[M][ce].sendAttempt=1;if(this._useBeacons&&N&&C.isBeaconsSupported()&&navigator.sendBeacon(W,$))return;this._httpInterface.sendPOST(W,$,function(oe,Z){U._retryRequestIfNeeded(oe,Z,I,k,D,x,N,F)},function(oe,Z){U._retryRequestIfNeeded(oe,Z,I,k,D,x,N,F)},function(oe,Z){U._retryRequestIfNeeded(oe,Z,I,k,D,x,N,F)},N||F)}else N||this._handleRequestFinished(!1,{},N,F)}catch(oe){this._handleRequestFinished(!1,{},N,F)}},m.prototype._retryRequestIfNeeded=function(I,x,N,F,U,k,D,M){var j=this,W=!0;if(void 0!==I){if(x){var $=this._killSwitch.setKillSwitchTenants(x["kill-tokens"],x["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(x["time-delta-millis"]);for(var ce=0;ce<$.length;++ce)P.default.eventsRejected(N[$[ce]],s.AWTEventsRejectedReason.KillSwitch),delete N[$[ce]],F--}else this._clockSkewManager.setClockSkew(null);if(200===I)return void this._handleRequestFinished(!0,N,D,M);(!d.default.shouldRetryForStatus(I)||F<=0)&&(W=!1)}if(W)if(M)this._activeConnections--,N[U][0].priority=s.AWTEventPriority.High,this._queueManager.addBackRequest(N);else if(k<1){for(var oe in N)N.hasOwnProperty(oe)&&P.default.eventsRetrying(N[oe]);setTimeout(function(){return j._sendRequest(N,k+1,!1)},d.default.getMillisToBackoffForRetry(k))}else this._activeConnections--,S.default.backOffTransmission(),this._queueManager.addBackRequest(N);else this._handleRequestFinished(!1,N,D,M)},m.prototype._handleRequestFinished=function(I,x,N,F){for(var U in I&&S.default.clearBackOff(),x)x.hasOwnProperty(U)&&(I?P.default.eventsSent(x[U]):P.default.eventsDropped(x[U],s.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,!F&&!N&&this.sendQueuedRequests()},m.prototype._convertAllHeadersToMap=function(I){var x={};if(I)for(var N=I.split("\n"),F=0;F<N.length;++F){var U=N[F].split(": ");x[U[0]]=U[1]}return x},m}();u.default=b},7613:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(676),_=c(5640),d=c(4189),p=c(6208),T=c(4023),l=c(2551),C=c(4094),P=function(){function S(){}return S.initialize=function(f,g){if(void 0===g&&(g={}),!this._isInitialized)return this._isInitialized=!0,d.default.defaultTenantToken=f,this._overrideValuesFromConfig(g),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(d.default.sessionEnabled=!1),C.default.addPropertyStorageOverride(this._config.propertyStorageOverride),C.default.autoCollect(d.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),T.default.initialize(this._config),d.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(_.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},S.getSemanticContext=function(){return d.default.semanticContext},S.flush=function(f){this._isInitialized&&!this._isDestroyed&&T.default.flush(f)},S.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(_.AWTSessionState.Ended),T.default.flushAndTeardown(),d.default.loggingEnabled=!1,this._isDestroyed=!0)},S.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&T.default.pauseTransmission()},S.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&T.default.resumeTransmision()},S.setTransmitProfile=function(f){this._isInitialized&&!this._isDestroyed&&T.default.setTransmitProfile(f)},S.loadTransmitProfiles=function(f){this._isInitialized&&!this._isDestroyed&&T.default.loadTransmitProfiles(f)},S.setContext=function(f,g,E){void 0===E&&(E=s.AWTPropertyType.Unspecified),d.default.logManagerContext.setProperty(f,g,E)},S.setContextWithPii=function(f,g,E,b){void 0===b&&(b=s.AWTPropertyType.Unspecified),d.default.logManagerContext.setPropertyWithPii(f,g,E,b)},S.setContextWithCustomerContent=function(f,g,E,b){void 0===b&&(b=s.AWTPropertyType.Unspecified),d.default.logManagerContext.setPropertyWithCustomerContent(f,g,E,b)},S.getLogger=function(f){var g=f;return(!g||g===d.default.defaultTenantToken)&&(g=""),this._loggers[g]||(this._loggers[g]=new p.default(g)),this._loggers[g]},S.addNotificationListener=function(f){l.default.addNotificationListener(f)},S.removeNotificationListener=function(f){l.default.removeNotificationListener(f)},S._overrideValuesFromConfig=function(f){f.collectorUri&&(this._config.collectorUri=f.collectorUri),f.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=f.cacheMemorySizeLimitInNumberOfEvents),f.httpXHROverride&&f.httpXHROverride.sendPOST&&(this._config.httpXHROverride=f.httpXHROverride),f.propertyStorageOverride&&f.propertyStorageOverride.getProperty&&f.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=f.propertyStorageOverride),f.userAgent&&(this._config.userAgent=f.userAgent),f.disableCookiesUsage&&(this._config.disableCookiesUsage=f.disableCookiesUsage),f.canSendStatEvent&&(this._config.canSendStatEvent=f.canSendStatEvent),f.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=f.enableAutoUserSession),f.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=f.clockSkewRefreshDurationInMins)},S._loggers={},S._isInitialized=!1,S._isDestroyed=!1,S._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(f){return!0},clockSkewRefreshDurationInMins:0},S}();u.default=P},4189:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(58),_=c(1009),d=function(){function p(){}return p.logManagerContext=new s.default,p.sessionEnabled=!0,p.loggingEnabled=!1,p.defaultTenantToken="",p.semanticContext=new _.default(!0,p.logManagerContext),p}();u.default=d},6208:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(676),_=c(5640),d=c(58),p=c(5593),T=c(5816),l=c(2551),C=c(4023),P=c(4189),S=c(8779),f=c(1009),g=c(4094),E=function(){function b(m){this._apiKey=m,this._contextProperties=new d.default,this._semanticContext=new f.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return b.prototype.setContext=function(m,I,x){void 0===x&&(x=s.AWTPropertyType.Unspecified),this._contextProperties.setProperty(m,I,x)},b.prototype.setContextWithPii=function(m,I,x,N){void 0===N&&(N=s.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(m,I,x,N)},b.prototype.setContextWithCustomerContent=function(m,I,x,N){void 0===N&&(N=s.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(m,I,x,N)},b.prototype.getSemanticContext=function(){return this._semanticContext},b.prototype.logEvent=function(m){if(P.default.loggingEnabled){this._apiKey||(this._apiKey=P.default.defaultTenantToken,this._createInitId());var I=!0;p.isString(m)?m={name:m}:m instanceof d.default&&(m=m.getEvent(),I=!1),T.default.eventReceived(this._apiKey),b._logEvent(b._getInternalEvent(m,this._apiKey,I),this._contextProperties)}},b.prototype.logSession=function(m,I){if(P.default.sessionEnabled){var x={name:"session",type:"session",properties:{}};if(b._addPropertiesToEvent(x,I),x.priority=s.AWTEventPriority.High,m===_.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=p.newGuid(),this.setContext("Session.Id",this._sessionId),x.properties["Session.State"]="Started"}else{if(m!==_.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var N=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);x.properties["Session.Id"]=this._sessionId,x.properties["Session.State"]="Ended",x.properties["Session.Duration"]=N.toString(),x.properties["Session.DurationBucket"]=b._getSessionDurationFromTime(N),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}x.properties["Session.FirstLaunchTime"]=g.default.firstLaunchTime,this.logEvent(x)}},b.prototype.getSessionId=function(){return this._sessionId},b.prototype.logFailure=function(m,I,x,N,F){if(m&&I){var U={name:"failure",type:"failure",properties:{}};b._addPropertiesToEvent(U,F),U.properties["Failure.Signature"]=m,U.properties["Failure.Detail"]=I,x&&(U.properties["Failure.Category"]=x),N&&(U.properties["Failure.Id"]=N),U.priority=s.AWTEventPriority.High,this.logEvent(U)}},b.prototype.logPageView=function(m,I,x,N,F,U){if(m&&I){var k={name:"pageview",type:"pageview",properties:{}};b._addPropertiesToEvent(k,U),k.properties["PageView.Id"]=m,k.properties["PageView.Name"]=I,x&&(k.properties["PageView.Category"]=x),N&&(k.properties["PageView.Uri"]=N),F&&(k.properties["PageView.ReferrerUri"]=F),this.logEvent(k)}},b.prototype._createInitId=function(){!b._initIdMap[this._apiKey]&&this._apiKey&&(b._initIdMap[this._apiKey]=p.newGuid())},b._addPropertiesToEvent=function(m,I){if(I)for(var x in I instanceof d.default&&(I=I.getEvent()),I.name&&(m.name=I.name),I.priority&&(m.priority=I.priority),I.properties)I.properties.hasOwnProperty(x)&&(m.properties[x]=I.properties[x])},b._getSessionDurationFromTime=function(m){return m<0?"Undefined":m<=3?"UpTo3Sec":m<=10?"UpTo10Sec":m<=30?"UpTo30Sec":m<=60?"UpTo60Sec":m<=180?"UpTo3Min":m<=600?"UpTo10Min":m<=1800?"UpTo30Min":"Above30Min"},b._logEvent=function(m,I){m.name&&p.isString(m.name)?(m.name=m.name.toLowerCase(),m.name=m.name.replace(p.EventNameDotRegex,"_"),m.type=m.type&&p.isString(m.type)?m.type.toLowerCase():"custom",p.EventNameAndTypeRegex.test(m.name)&&p.EventNameAndTypeRegex.test(m.type)?((!p.isNumber(m.timestamp)||m.timestamp<0)&&(m.timestamp=(new Date).getTime()),m.properties||(m.properties={}),this._addContextIfAbsent(m,I.getPropertyMap()),this._addContextIfAbsent(m,P.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(m,"EventInfo.InitId",this._getInitId(m.apiKey)),this._setDefaultProperty(m,"EventInfo.Sequence",this._getSequenceId(m.apiKey)),this._setDefaultProperty(m,"EventInfo.SdkVersion",S.FullVersionString),this._setDefaultProperty(m,"EventInfo.Name",m.name),this._setDefaultProperty(m,"EventInfo.Time",new Date(m.timestamp).toISOString()),p.isPriority(m.priority)||(m.priority=s.AWTEventPriority.Normal),this._sendEvent(m)):l.default.eventsRejected([m],s.AWTEventsRejectedReason.InvalidEvent)):l.default.eventsRejected([m],s.AWTEventsRejectedReason.InvalidEvent)},b._addContextIfAbsent=function(m,I){if(I)for(var x in I)I.hasOwnProperty(x)&&(m.properties[x]||(m.properties[x]=I[x]))},b._setDefaultProperty=function(m,I,x){m.properties[I]={value:x,pii:s.AWTPiiKind.NotSet,type:s.AWTPropertyType.String}},b._sendEvent=function(m){C.default.sendEvent(m)},b._getInternalEvent=function(m,I,x){if(m.properties=m.properties||{},x)for(var N in m.properties)m.properties.hasOwnProperty(N)&&(m.properties[N]=p.sanitizeProperty(N,m.properties[N]),null===m.properties[N]&&delete m.properties[N]);var F=m;return F.id=p.newGuid(),F.apiKey=I,F},b._getInitId=function(m){return b._initIdMap[m]},b._getSequenceId=function(m){return void 0===b._sequenceIdMap[m]&&(b._sequenceIdMap[m]=0),(++b._sequenceIdMap[m]).toString()},b._sequenceIdMap={},b._initIdMap={},b}();u.default=E},4220:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(676),_=c(9449),d=c(4023),p=c(2659),T=c(2551),l=c(5593),f=function(){function g(E,b,m,I){this._queueSizeLimit=b,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[s.AWTEventPriority.High]=[],this._inboundQueues[s.AWTEventPriority.Normal]=[],this._inboundQueues[s.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new p.default(this._outboundQueue,500),this._httpManager=new _.default(this._outboundQueue,E,this,m,I)}return g.prototype.addEvent=function(E){l.isPriority(E.priority)||(E.priority=s.AWTEventPriority.Normal),E.priority===s.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(E),E.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(E.priority)?this._addEventToProperQueue(E):T.default.eventsDropped([E],s.AWTEventsDroppedReason.QueueFull)},g.prototype.sendEventsForPriorityAndAbove=function(E){this._batchEvents(E),this._httpManager.sendQueuedRequests()},g.prototype.hasEvents=function(){return(this._inboundQueues[s.AWTEventPriority.High][0].length>0||this._inboundQueues[s.AWTEventPriority.Normal][0].length>0||this._inboundQueues[s.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},g.prototype.addBackRequest=function(E){if(!this._paused||!this._shouldDropEventsOnPause){for(var b in E)if(E.hasOwnProperty(b))for(var m=0;m<E[b].length;++m)E[b][m].sendAttempt<6?this.addEvent(E[b][m]):T.default.eventsDropped([E[b][m]],s.AWTEventsDroppedReason.MaxRetryLimit);d.default.scheduleTimer()}},g.prototype.teardown=function(){this._paused||(this._batchEvents(s.AWTEventPriority.Low),this._httpManager.teardown())},g.prototype.uploadNow=function(E){var b=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(E):(this._isCurrentlyUploadingNow=!0,setTimeout(function(){return b._uploadNow(E)},0))},g.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this._shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[s.AWTEventPriority.High][0].length+this._inboundQueues[s.AWTEventPriority.Normal][0].length+this._inboundQueues[s.AWTEventPriority.Low][0].length,this._inboundQueues[s.AWTEventPriority.High][0]=[],this._inboundQueues[s.AWTEventPriority.Normal][0]=[],this._inboundQueues[s.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},g.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},g.prototype.shouldDropEventsOnPause=function(E){this._shouldDropEventsOnPause=E},g.prototype._removeFirstQueues=function(){this._inboundQueues[s.AWTEventPriority.High].shift(),this._inboundQueues[s.AWTEventPriority.Normal].shift(),this._inboundQueues[s.AWTEventPriority.Low].shift()},g.prototype._addEmptyQueues=function(){this._inboundQueues[s.AWTEventPriority.High].push([]),this._inboundQueues[s.AWTEventPriority.Normal].push([]),this._inboundQueues[s.AWTEventPriority.Low].push([])},g.prototype._addEventToProperQueue=function(E){(!this._paused||!this._shouldDropEventsOnPause)&&(this._queueSize++,this._inboundQueues[E.priority][this._inboundQueues[E.priority].length-1].push(E))},g.prototype._dropEventWithPriorityOrLess=function(E){for(var b=s.AWTEventPriority.Low;b<=E;){if(this._inboundQueues[b][this._inboundQueues[b].length-1].length>0)return T.default.eventsDropped([this._inboundQueues[b][this._inboundQueues[b].length-1].shift()],s.AWTEventsDroppedReason.QueueFull),!0;b++}return!1},g.prototype._batchEvents=function(E){for(var b=s.AWTEventPriority.High;b>=E;){for(;this._inboundQueues[b][0].length>0;){var m=this._inboundQueues[b][0].pop();this._queueSize--,this._batcher.addEventToBatch(m)}b--}this._batcher.flushBatch()},g.prototype._uploadNow=function(E){var b=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(s.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent(function(){b._removeFirstQueues(),null!=E&&E(),b._uploadNowQueue.length>0?setTimeout(function(){return b._uploadNow(b._uploadNowQueue.shift())},0):(b._isCurrentlyUploadingNow=!1,b.hasEvents()&&d.default.scheduleTimer())})},g.prototype._checkOutboundQueueEmptyAndSent=function(E){var b=this;this._httpManager.isCompletelyIdle()?E():setTimeout(function(){return b._checkOutboundQueueEmptyAndSent(E)},250)},g}();u.default=f},1009:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(4094),_=c(676),d=c(5640),p="UserInfo.IdType",T=function(){function l(C,P){this._allowDeviceFields=C,this._properties=P}return l.prototype.setAppId=function(C){this._addContext("AppInfo.Id",C)},l.prototype.setAppVersion=function(C){this._addContext("AppInfo.Version",C)},l.prototype.setAppLanguage=function(C){this._addContext("AppInfo.Language",C)},l.prototype.setDeviceId=function(C){this._allowDeviceFields&&(s.default.checkAndSaveDeviceId(C),this._addContext("DeviceInfo.Id",C))},l.prototype.setDeviceOsName=function(C){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",C)},l.prototype.setDeviceOsVersion=function(C){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",C)},l.prototype.setDeviceBrowserName=function(C){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",C)},l.prototype.setDeviceBrowserVersion=function(C){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",C)},l.prototype.setDeviceMake=function(C){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",C)},l.prototype.setDeviceModel=function(C){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",C)},l.prototype.setUserId=function(C,P,S){if(!isNaN(S)&&null!==S&&S>=0&&S<=12)this._addContext(p,S.toString());else{var f=void 0;switch(P){case _.AWTPiiKind.SipAddress:f=d.AWTUserIdType.SipAddress;break;case _.AWTPiiKind.PhoneNumber:f=d.AWTUserIdType.PhoneNumber;break;case _.AWTPiiKind.SmtpAddress:f=d.AWTUserIdType.EmailAddress;break;default:f=d.AWTUserIdType.Unknown}this._addContext(p,f.toString())}if(isNaN(P)||null===P||P===_.AWTPiiKind.NotSet||P>13)switch(S){case d.AWTUserIdType.Skype:P=_.AWTPiiKind.Identity;break;case d.AWTUserIdType.EmailAddress:P=_.AWTPiiKind.SmtpAddress;break;case d.AWTUserIdType.PhoneNumber:P=_.AWTPiiKind.PhoneNumber;break;case d.AWTUserIdType.SipAddress:P=_.AWTPiiKind.SipAddress;break;default:P=_.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",C,P)},l.prototype.setUserAdvertisingId=function(C){this._addContext("UserInfo.AdvertisingId",C)},l.prototype.setUserTimeZone=function(C){this._addContext("UserInfo.TimeZone",C)},l.prototype.setUserLanguage=function(C){this._addContext("UserInfo.Language",C)},l.prototype._addContext=function(C,P){"string"==typeof P&&this._properties.setProperty(C,P)},l.prototype._addContextWithPii=function(C,P,S){"string"==typeof P&&this._properties.setPropertyWithPii(C,P,S)},l}();u.default=T},2621:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(4023),_=function(){function d(){}return d.setEventsHandler=function(p){s.default.setEventsHandler(p)},d.getEventsHandler=function(){return s.default.getEventsHandler()},d.scheduleTimer=function(){s.default.scheduleTimer()},d}();u.default=_},4023:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(1842),_=c(676),d=c(4220),p=c(5816),T=c(58),l=c(7613),C=c(5593),f="awt_stats",g=function(){function E(){}return E.setEventsHandler=function(b){this._eventHandler=b},E.getEventsHandler=function(){return this._eventHandler},E.scheduleTimer=function(){var b=this,m=this._profiles[this._currentProfile][2];this._timeout<0&&m>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===m&&this._currentBackoffCount>0&&(m=1),this._timeout=setTimeout(function(){return b._batchAndSendEvents()},m*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},E.initialize=function(b){var m=this;this._newEventsAllowed=!0,this._config=b,this._eventHandler=new d.default(b.collectorUri,b.cacheMemorySizeLimitInNumberOfEvents,b.httpXHROverride,b.clockSkewRefreshDurationInMins),this._initializeProfiles(),p.default.initialize(function(I,x){if(m._config.canSendStatEvent(f)){var N=new T.default(f);for(var F in N.setEventPriority(_.AWTEventPriority.High),N.setProperty("TenantId",x),I)I.hasOwnProperty(F)&&N.setProperty(F,I[F].toString());l.default.getLogger(C.StatsApiKey).logEvent(N)}})},E.setTransmitProfile=function(b){this._currentProfile!==b&&void 0!==this._profiles[b]&&(this.clearTimeout(),this._currentProfile=b,this.scheduleTimer())},E.loadTransmitProfiles=function(b){for(var m in this._resetTransmitProfiles(),b)if(b.hasOwnProperty(m)){if(3!==b[m].length)continue;for(var I=2;I>=0;--I)if(b[m][I]<0){for(var x=I;x>=0;--x)b[m][x]=-1;break}for(I=2;I>0;--I)b[m][I]>0&&b[m][I-1]>0&&(b[m][I-1]=Math.ceil(b[m][I-1]/b[m][I])*b[m][I]);this._profiles[m]=b[m]}},E.sendEvent=function(b){this._newEventsAllowed&&(this._currentBackoffCount>0&&b.priority===_.AWTEventPriority.Immediate_sync&&(b.priority=_.AWTEventPriority.High),this._eventHandler.addEvent(b),this.scheduleTimer())},E.flush=function(b){var m=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<m&&(this._lastUploadNowCall=m,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(b))},E.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},E.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},E.flushAndTeardown=function(){p.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},E.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},E.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},E._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=s.AWT_REAL_TIME,this.scheduleTimer()},E.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},E._batchAndSendEvents=function(){var b=_.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(b=_.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(b=_.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(b),this._timeout=-1,this.scheduleTimer()},E._initializeProfiles=function(){this._profiles={},this._profiles[s.AWT_REAL_TIME]=[4,2,1],this._profiles[s.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[s.AWT_BEST_EFFORT]=[36,18,9]},E._newEventsAllowed=!1,E._currentProfile=s.AWT_REAL_TIME,E._timeout=-1,E._currentBackoffCount=0,E._paused=!1,E._timerCount=0,E._lastUploadNowCall=0,E}();u.default=g},5234:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(676);u.AWTPropertyType=s.AWTPropertyType,u.AWTPiiKind=s.AWTPiiKind,u.AWTEventPriority=s.AWTEventPriority,u.AWTEventsDroppedReason=s.AWTEventsDroppedReason,u.AWTEventsRejectedReason=s.AWTEventsRejectedReason,u.AWTCustomerContentKind=s.AWTCustomerContentKind;var _=c(5640);u.AWTUserIdType=_.AWTUserIdType,u.AWTSessionState=_.AWTSessionState;var d=c(1842);u.AWT_BEST_EFFORT=d.AWT_BEST_EFFORT,u.AWT_NEAR_REAL_TIME=d.AWT_NEAR_REAL_TIME,u.AWT_REAL_TIME=d.AWT_REAL_TIME;var p=c(58);u.AWTEventProperties=p.default;var T=c(6208);u.AWTLogger=T.default;var l=c(7613);u.AWTLogManager=l.default;var C=c(2621);u.AWTTransmissionManager=C.default;var P=c(6064);u.AWTSerializer=P.default;var S=c(1009);u.AWTSemanticContext=S.default,u.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",u.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",u.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",u.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",u.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",u.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",u.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},1842:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.AWT_REAL_TIME="REAL_TIME",u.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",u.AWT_BEST_EFFORT="BEST_EFFORT"},5640:(Q,u)=>{"use strict";var _;Object.defineProperty(u,"__esModule",{value:!0}),(_=u.AWTUserIdType||(u.AWTUserIdType={}))[_.Unknown=0]="Unknown",_[_.MSACID=1]="MSACID",_[_.MSAPUID=2]="MSAPUID",_[_.ANID=3]="ANID",_[_.OrgIdCID=4]="OrgIdCID",_[_.OrgIdPUID=5]="OrgIdPUID",_[_.UserObjectId=6]="UserObjectId",_[_.Skype=7]="Skype",_[_.Yammer=8]="Yammer",_[_.EmailAddress=9]="EmailAddress",_[_.PhoneNumber=10]="PhoneNumber",_[_.SipAddress=11]="SipAddress",_[_.MUID=12]="MUID",function(_){_[_.Started=0]="Started",_[_.Ended=1]="Ended"}(u.AWTSessionState||(u.AWTSessionState={}))},8779:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.Version="1.8.7",u.FullVersionString="AWT-Web-JS-"+u.Version},5436:(Q,u,c)=>{"use strict";u.Mg=void 0;c(3762),c(6194);var p=c(7626);u.Mg=p.default,c(448),c(2900),c(3372),c(4352);c(9425)},2235:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(g){for(var E,b=1,m=arguments.length;b<m;b++)for(var I in E=arguments[b])Object.prototype.hasOwnProperty.call(E,I)&&(g[I]=E[I]);return g}).apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0});var _=c(4151),d=c(676),p=c(5234),T=c(7095),l=c(3037),C=c(4151),P=c(8098),S=(()=>((S||(S={})).ReactNative="ReactNative",S))(),f=function(){function g(){}return g.initialize=function(E){this._debug&&console.log("[AriaTelemetry][logger][initialize][custom]"),g._logger=p.AWTLogManager.initialize(E)},g.setDebug=function(E){g._debug=E},g.disable=function(){this._debug&&console.log("[AriaTelemetry][disable]"),g._disable=!0},g.setCDNPackages=function(E){g._CDNPackagesInfo=s(s({},g._CDNPackagesInfo),E)},g.info=function(E,b){var m;void 0===b&&(b=l.default.EVENTS);var I={name:l.default.EVENTS,properties:s(s(s(s(s({},g.populateBaseProperties()),g.fillWebPlatformData()),g.fillMobilePlatformData()),E),{LogLevel:T.default.INFO}),priority:d.AWTEventPriority.High};b==l.default.IC3CLIENT&&(I={name:l.default.IC3CLIENT,properties:s(s(s({},g.populateIC3ClientBaseProperties()),E),{LogLevel:T.default.INFO}),priority:d.AWTEventPriority.High}),b==l.default.OCSDK&&(I={name:l.default.OCSDK,properties:s(s(s({},g.populateOCSDKBaseProperties()),E),{LogLevel:T.default.INFO}),priority:d.AWTEventPriority.High}),b==l.default.ACSCLIENT&&(I={name:l.default.ACSCLIENT,properties:s(s(s({},g.populateACSClientBaseProperties()),E),{LogLevel:T.default.INFO}),priority:d.AWTEventPriority.High}),b==l.default.ACSADAPTER&&(I={name:l.default.ACSADAPTER,properties:s(s(s({},g.populateACSAdapterBaseProperties()),E),{LogLevel:T.default.INFO}),priority:d.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][info] "+b),this._debug&&console.log(I),this._debug&&console.log(I.properties.Event),!g._disable&&(null===(m=g.logger)||void 0===m||m.logEvent(I))},g.debug=function(E,b){var m;void 0===b&&(b=l.default.EVENTS);var I={name:l.default.EVENTS,properties:s(s(s(s(s({},g.populateBaseProperties()),g.fillWebPlatformData()),g.fillMobilePlatformData()),E),{LogLevel:T.default.DEBUG}),priority:d.AWTEventPriority.High};b==l.default.IC3CLIENT&&(I={name:l.default.IC3CLIENT,properties:s(s(s({},g.populateIC3ClientBaseProperties()),E),{LogLevel:T.default.DEBUG}),priority:d.AWTEventPriority.High}),b==l.default.OCSDK&&(I={name:l.default.OCSDK,properties:s(s(s({},g.populateOCSDKBaseProperties()),E),{LogLevel:T.default.DEBUG}),priority:d.AWTEventPriority.High}),b==l.default.ACSCLIENT&&(I={name:l.default.ACSCLIENT,properties:s(s(s({},g.populateACSClientBaseProperties()),E),{LogLevel:T.default.DEBUG}),priority:d.AWTEventPriority.High}),b==l.default.ACSADAPTER&&(I={name:l.default.ACSADAPTER,properties:s(s(s({},g.populateACSAdapterBaseProperties()),E),{LogLevel:T.default.DEBUG}),priority:d.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][debug] "+b),this._debug&&console.log(I),this._debug&&console.log(I.properties.Event),!g._disable&&(null===(m=g.logger)||void 0===m||m.logEvent(I))},g.warn=function(E,b){var m;void 0===b&&(b=l.default.EVENTS);var I={name:l.default.EVENTS,properties:s(s(s(s(s({},g.populateBaseProperties()),g.fillWebPlatformData()),g.fillMobilePlatformData()),E),{LogLevel:T.default.WARN}),priority:d.AWTEventPriority.High};b==l.default.IC3CLIENT&&(I={name:l.default.IC3CLIENT,properties:s(s(s({},g.populateIC3ClientBaseProperties()),E),{LogLevel:T.default.WARN}),priority:d.AWTEventPriority.High}),b==l.default.OCSDK&&(I={name:l.default.OCSDK,properties:s(s(s({},g.populateOCSDKBaseProperties()),E),{LogLevel:T.default.WARN}),priority:d.AWTEventPriority.High}),b==l.default.ACSCLIENT&&(I={name:l.default.ACSCLIENT,properties:s(s(s({},g.populateACSClientBaseProperties()),E),{LogLevel:T.default.WARN}),priority:d.AWTEventPriority.High}),b==l.default.ACSADAPTER&&(I={name:l.default.ACSADAPTER,properties:s(s(s({},g.populateACSAdapterBaseProperties()),E),{LogLevel:T.default.WARN}),priority:d.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][warn] "+b),this._debug&&console.log(I),this._debug&&console.log(I.properties.Event),!g._disable&&(null===(m=g.logger)||void 0===m||m.logEvent(I))},g.error=function(E,b){var m;void 0===b&&(b=l.default.EVENTS);var I={name:l.default.EVENTS,properties:s(s(s(s(s({},g.populateBaseProperties()),g.fillWebPlatformData()),g.fillMobilePlatformData()),E),{LogLevel:T.default.ERROR}),priority:d.AWTEventPriority.High};b==l.default.IC3CLIENT&&(I={name:l.default.IC3CLIENT,properties:s(s(s({},g.populateIC3ClientBaseProperties()),E),{LogLevel:T.default.ERROR}),priority:d.AWTEventPriority.High}),b==l.default.OCSDK&&(I={name:l.default.OCSDK,properties:s(s(s({},g.populateOCSDKBaseProperties()),E),{LogLevel:T.default.ERROR}),priority:d.AWTEventPriority.High}),b==l.default.ACSCLIENT&&(I={name:l.default.ACSCLIENT,properties:s(s(s({},g.populateACSClientBaseProperties()),E),{LogLevel:T.default.ERROR}),priority:d.AWTEventPriority.High}),b==l.default.ACSADAPTER&&(I={name:l.default.ACSADAPTER,properties:s(s(s({},g.populateACSAdapterBaseProperties()),E),{LogLevel:T.default.ERROR}),priority:d.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][error] "+b),this._debug&&console.log(I),this._debug&&console.log(I.properties.Event),!g._disable&&(null===(m=g.logger)||void 0===m||m.logEvent(I))},g.log=function(E,b){var m;void 0===b&&(b=l.default.EVENTS);var I={name:l.default.EVENTS,properties:s(s(s(s(s({},g.populateBaseProperties()),g.fillWebPlatformData()),g.fillMobilePlatformData()),E),{LogLevel:T.default.LOG}),priority:d.AWTEventPriority.High};b==l.default.IC3CLIENT&&(I={name:l.default.IC3CLIENT,properties:s(s(s({},g.populateIC3ClientBaseProperties()),E),{LogLevel:T.default.LOG}),priority:d.AWTEventPriority.High}),b==l.default.OCSDK&&(I={name:l.default.OCSDK,properties:s(s(s({},g.populateOCSDKBaseProperties()),E),{LogLevel:T.default.LOG}),priority:d.AWTEventPriority.High}),b==l.default.ACSCLIENT&&(I={name:l.default.ACSCLIENT,properties:s(s(s({},g.populateACSClientBaseProperties()),E),{LogLevel:T.default.LOG}),priority:d.AWTEventPriority.High}),b==l.default.ACSADAPTER&&(I={name:l.default.ACSADAPTER,properties:s(s(s({},g.populateACSAdapterBaseProperties()),E),{LogLevel:T.default.LOG}),priority:d.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][log]"),this._debug&&console.log(I),this._debug&&console.log(I.properties.Event),!g._disable&&(null===(m=g.logger)||void 0===m||m.logEvent(I))},Object.defineProperty(g,"logger",{get:function(){return g._logger||(this._debug&&console.log("[AriaTelemetry][logger][initialize]"),g._logger=p.AWTLogManager.initialize(_.ariaTelemetryKey)),g._logger},enumerable:!1,configurable:!0}),g.populateBaseProperties=function(){var E={OCSDK:c(1528).i8,IC3Core:c(5233).i8,ACSChat:c(2861).i8,ACSCommon:c(6638).i8,AMSClient:c(5500).i8};return{OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",CallId:"",Domain:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",ChatSDKVersion:c(8464).i8,NPMPackagesInfo:JSON.stringify(E),CDNPackagesInfo:JSON.stringify(g._CDNPackagesInfo),PlatformDetails:""}},g.fillMobilePlatformData=function(){var E={},b={};if(!P.isReactNative())return E;try{var I=c(Object(function(){var N=new Error("Cannot find module 'react-native'");throw N.code="MODULE_NOT_FOUND",N}())).Platform;b.Renderer=S.ReactNative,E.DeviceInfo_OsVersion=I.Version,b.DeviceInfo_OsVersion=I.Version,"android"===I.OS.toLowerCase()?(E.DeviceInfo_OsName="Android",b.DeviceInfo_OsName="Android"):"ios"===I.OS.toLowerCase()?(E.DeviceInfo_OsName="iOS",b.DeviceInfo_OsName="iOS"):(E.DeviceInfo_OsName=""+I.OS,b.DeviceInfo_OsName=""+I.OS),this._debug&&console.log("[AriaTelemetry][fillMobilePlatformData]["+E.DeviceInfo_OsName+"]")}catch(x){this._debug&&console.log("[AriaTelemetry][fillMobilePlatformData][Web]")}return E.PlatformDetails=JSON.stringify(b),E},g.fillWebPlatformData=function(){var E={};if(!P.isBrowser())return E;try{E.Domain=window.location.origin||"",this._debug&&console.log("[AriaTelemetry][fillWebPlatformData]")}catch(b){this._debug&&console.log("[AriaTelemetry][fillWebPlatformData][Error]")}return E},g.populateIC3ClientBaseProperties=function(){return{OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",Event:"",Description:"",SubscriptionId:"",EndpointId:"",EndpointUrl:"",ErrorCode:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",IC3ClientVersion:C.ic3ClientVersion}},g.populateOCSDKBaseProperties=function(){return{OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",TransactionId:"",Event:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",OCSDKVersion:c(1528).i8}},g.populateACSClientBaseProperties=function(){return{OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",Event:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",ACSChatVersion:c(2861).i8}},g.populateACSAdapterBaseProperties=function(){return{OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",Event:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",ACSAdapterVersion:C.webChatACSAdapterVersion}},g._debug=!1,g._disable=!1,g}();u.default=f},9066:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.failEvent=u.completeEvent=u.startEvent=void 0,u.startEvent=function(c){return c+"Started"},u.completeEvent=function(c){return c+"Completed"},u.failEvent=function(c){return c+"Failed"}},7095:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR",s.LOG="LOG",c;var s})();u.default=c},1247:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(l){for(var C,P=1,S=arguments.length;P<S;P++)for(var f in C=arguments[P])Object.prototype.hasOwnProperty.call(C,f)&&(l[f]=C[f]);return l}).apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0});var _=c(3037),d=c(8485),p=c(9066),T=function(){function l(C){this.omnichannelConfig=C,this.telemetry=null,this.debug=!1,this.telemetryEvents=new Map,this.scenarioType=_.default.EVENTS}return l.prototype.setDebug=function(C){var P;this.debug=C,null===(P=this.telemetry)||void 0===P||P.setDebug(C)},l.prototype.setScenarioType=function(C){this.scenarioType=C},l.prototype.useTelemetry=function(C){this.debug&&console.log("[ScenarioMarker][useTelemetry]"),this.telemetry=C},l.prototype.startScenario=function(C,P){var S;if(void 0===P&&(P={}),this.debug&&console.log("[ScenarioMarker][startScenario]"),!this.telemetryEvents.has(C)){var f=new d.default;f.start(),this.telemetryEvents.set(C,f)}var g=s({Event:p.startEvent(C),OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId},P);null===(S=this.telemetry)||void 0===S||S.info(g,this.scenarioType)},l.prototype.failScenario=function(C,P){var S;if(void 0===P&&(P={}),this.debug&&console.log("[ScenarioMarker][failScenario]"),this.telemetryEvents.has(C)){var f=this.telemetryEvents.get(C);this.telemetryEvents.delete(C);var g=s({Event:p.failEvent(C),OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,ElapsedTimeInMilliseconds:f.stop()},P);null===(S=this.telemetry)||void 0===S||S.error(g,this.scenarioType)}else console.warn("'"+C+"' event has not started.")},l.prototype.completeScenario=function(C,P){var S;if(void 0===P&&(P={}),this.debug&&console.log("[ScenarioMarker][completeScenario]"),this.telemetryEvents.has(C)){var f=this.telemetryEvents.get(C);this.telemetryEvents.delete(C);var g=s({Event:p.completeEvent(C),OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,ElapsedTimeInMilliseconds:f.stop()},P);null===(S=this.telemetry)||void 0===S||S.info(g,this.scenarioType)}else console.warn("'"+C+"' event has not started.")},l}();u.default=T},3037:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).EVENTS="occhatsdk_events",s.IC3CLIENT="occhatsdk_ic3clientevents",s.OCSDK="occhatsdk_ocsdkevents",s.ACSCLIENT="occhatsdk_acsclientevents",s.ACSADAPTER="occhatsdk_acsadapterevents",s.UNDEFINED="undefined",c;var s})();u.default=c},8485:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.prototype.start=function(){this.timeStart=(new Date).getTime()},s.prototype.stop=function(){return(new Date).getTime()-this.timeStart},s}();u.default=c},9600:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).ValidateOmnichannelConfig="ValidateOmnichannelConfig",s.ValidateSDKConfig="ValidateSDKConfig",s.InitializeChatSDK="InitializeChatSDK",s.StartChat="StartChat",s.EndChat="EndChat",s.GetLiveChatConfig="GetLiveChatConfig",s.GetAuthToken="GetAuthToken",s.GetPreChatSurvey="GetPreChatSurvey",s.GetChatToken="GetChatToken",s.GetConversationDetails="GetConversationDetails",s.GetCurrentLiveChatContext="GetCurrentLiveChatContext",s.GetMessages="GetMessages",s.SendMessages="SendMessages",s.SendTypingEvent="SendTypingEvent",s.OnAgentEndSession="OnAgentEndSession",s.OnNewMessage="OnNewMessage",s.OnTypingEvent="OnTypingEvent",s.UploadFileAttachment="UploadFileAttachment",s.DownloadFileAttachment="DownloadFileAttachment",s.EmailLiveChatTranscript="EmailLiveChatTranscript",s.GetLiveChatTranscript="GetLiveChatTranscript",s.CreateIC3Adapter="CreateChatAdapter",s.CreateACSAdapter="CreateACSAdapter",s.GetVoiceVideoCalling="GetVoiceVideoCalling",s.GetIC3Client="GetIC3Client",s.InitializeVoiceVideoCallingSDK="InitializeVoiceVideoCallingSDK",s.AcceptVoiceCall="AcceptVoiceCall",s.AcceptVideoCall="AcceptVideoCall",s.RejectCall="RejectCall",s.StopCall="StopCall",s.OnCallDisconnected="OnCallDisconnected",s.UpdateChatToken="UpdateChatToken",s.GetChatReconnectContext="GetChatReconnectContext",c;var s})();u.default=c},6345:function(Q,u){"use strict";var c=this&&this.__awaiter||function(d,p,T,l){return new(T||(T=Promise))(function(P,S){function f(b){try{E(l.next(b))}catch(m){S(m)}}function g(b){try{E(l.throw(b))}catch(m){S(m)}}function E(b){b.done?P(b.value):function(P){return P instanceof T?P:new T(function(S){S(P)})}(b.value).then(f,g)}E((l=l.apply(d,p||[])).next())})},s=this&&this.__generator||function(d,p){var l,C,P,S,T={label:0,sent:function(){if(1&P[0])throw P[1];return P[1]},trys:[],ops:[]};return S={next:f(0),throw:f(1),return:f(2)},"function"==typeof Symbol&&(S[Symbol.iterator]=function(){return this}),S;function f(E){return function(b){return function(E){if(l)throw new TypeError("Generator is already executing.");for(;T;)try{if(l=1,C&&(P=2&E[0]?C.return:E[0]?C.throw||((P=C.return)&&P.call(C),0):C.next)&&!(P=P.call(C,E[1])).done)return P;switch(C=0,P&&(E=[2&E[0],P.value]),E[0]){case 0:case 1:P=E;break;case 4:return T.label++,{value:E[1],done:!1};case 5:T.label++,C=E[1],E=[0];continue;case 7:E=T.ops.pop(),T.trys.pop();continue;default:if(!(P=(P=T.trys).length>0&&P[P.length-1])&&(6===E[0]||2===E[0])){T=0;continue}if(3===E[0]&&(!P||E[1]>P[0]&&E[1]<P[3])){T.label=E[1];break}if(6===E[0]&&T.label<P[1]){T.label=P[1],P=E;break}if(P&&T.label<P[2]){T.label=P[2],T.ops.push(E);break}P[2]&&T.ops.pop(),T.trys.pop();continue}E=p.call(d,T)}catch(b){E=[6,b],C=0}finally{l=P=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}([E,b])}}};Object.defineProperty(u,"__esModule",{value:!0}),u.loadScript=void 0;var _=function(d,p,T){return void 0===p&&(p=function(){}),void 0===T&&(T=function(){}),c(void 0,void 0,void 0,function(){return s(this,function(l){return[2,new Promise(function(C,P){return c(void 0,void 0,void 0,function(){var g;return s(this,function(E){switch(E.label){case 0:return Array.from(document.getElementsByTagName("script")).filter(function(b){return b.src==d}).length?[4,p()]:[3,2];case 1:return E.sent(),[2,C()];case 2:return(g=document.createElement("script")).setAttribute("src",d),g.setAttribute("type","text/javascript"),document.head.appendChild(g),g.addEventListener("load",function(){return c(void 0,void 0,void 0,function(){return s(this,function(b){switch(b.label){case 0:return[4,p()];case 1:return b.sent(),C(),[2]}})})}),g.addEventListener("error",function(){return c(void 0,void 0,void 0,function(){return s(this,function(b){switch(b.label){case 0:return[4,T()];case 1:return b.sent(),P(),[2]}})})}),[2]}})})})]})})};u.loadScript=_,u.default={loadScript:_}},9340:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(T){for(var l,C=1,P=arguments.length;C<P;C++)for(var S in l=arguments[C])Object.prototype.hasOwnProperty.call(l,S)&&(T[S]=l[S]);return T}).apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0});var _=c(8191),d=c(3709);u.default=function(T,l){var C={};if(C.liveChatVersion=l.liveChatVersion||_.default.V1,l.debug&&console.log(T),l.liveChatVersion===_.default.V2){var f=T.content,g=T.metadata,E=T.sender,b=T.senderDisplayName,m=T.createdOn;if(C.id=T.id,C.messageid=void 0,C.clientmessageid=void 0,C.deliveryMode=void 0,C.properties={},C.content=f||"",C.properties.tags=g&&g.tags?g.tags:[],C.tags=g&&g.tags?g.tags.replace(/\"/g,"").split(",").filter(function(U){return U.length>0}):[],C.timestamp=m,C.messageType=d.MessageType.UserMessage,C.sender={id:E.communicationUserId,displayName:b,type:d.PersonType.Bot},g&&g.amsMetadata&&g.amsReferences)try{var I=JSON.parse(g.amsReferences),N=JSON.parse(g.amsMetadata)[0].fileName;C.fileMetadata={},C.fileMetadata.fileSharingProtocolType=0,C.fileMetadata.id=I[0],C.fileMetadata.name=N,C.fileMetadata.size=0,C.fileMetadata.type=N.split(".").pop(),C.fileMetadata.url=""}catch(U){}}else C.id=T.clientmessageid,C=s({},T);return C}},838:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(2235);u.default=function(d){return void 0===d&&(d=!1),s.default.setDebug(d),s.default}},6406:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.getACSAdapterCDNUrl=u.getIC3AdapterCDNUrl=u.getIC3ClientCDNUrl=void 0;var s=c(4151),_=function(T){return void 0===T&&(T=s.ic3ClientVersion),"https://comms.omnichannelengagementhub.com/release/"+T+"/Scripts/SDK/SDK.min.js"};u.getIC3ClientCDNUrl=_;var d=function(T){return void 0===T&&(T=s.webChatIC3AdapterVersion),"https://webchatic3.blob.core.windows.net/webchat-ic3adapter/"+T+"/botframework-webchat-adapter-ic3.production.min.js"};u.getIC3AdapterCDNUrl=d;var p=function(T){return void 0===T&&(T=s.webChatACSAdapterVersion),"https://unpkg.com/acs_webchat-chat-adapter@"+T+"/dist/chat-adapter.js"};u.getACSAdapterCDNUrl=p,u.default={getIC3ClientCDNUrl:_,getIC3AdapterCDNUrl:d,getACSAdapterCDNUrl:p}},2811:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(S){for(var f,g=1,E=arguments.length;g<E;g++)for(var b in f=arguments[g])Object.prototype.hasOwnProperty.call(f,b)&&(S[b]=f[b]);return S}).apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0}),u.createACSAdapterLogger=u.createACSClientLogger=u.createOCSDKLogger=u.createIC3ClientLogger=u.ACSAdapterLogger=u.ACSClientLogger=u.OCSDKLogger=u.IC3ClientLogger=void 0;var _=c(7095),d=c(3037),p=c(1247),T=function(){function S(f){this.omnichannelConfig=f,this.debug=!1,this.requestId="",this.chatId="",this.telemetry=null,this.debug=!1}return S.prototype.setDebug=function(f){this.debug=f},S.prototype.setRequestId=function(f){this.requestId=f},S.prototype.setChatId=function(f){this.chatId=f},S.prototype.useTelemetry=function(f){this.debug&&console.log("[IC3ClientLogger][useTelemetry]"),this.telemetry=f},S.prototype.logClientSdkTelemetryEvent=function(f,g){var E,b,m,I;this.debug&&console.log("[IC3ClientLogger][logClientSdkTelemetryEvent]["+f+"]"),this.debug&&console.log(g);var x={OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},N=s(s({},g),{ExceptionDetails:g.ExceptionDetails?JSON.stringify(g.ExceptionDetails):""});switch(f){case _.default.DEBUG:null===(E=this.telemetry)||void 0===E||E.debug(s(s({},x),N),d.default.IC3CLIENT);break;case _.default.WARN:null===(b=this.telemetry)||void 0===b||b.warn(s(s({},x),N),d.default.IC3CLIENT);break;case _.default.ERROR:null===(m=this.telemetry)||void 0===m||m.error(s(s({},x),N),d.default.IC3CLIENT);break;case _.default.INFO:default:null===(I=this.telemetry)||void 0===I||I.info(s(s({},x),N),d.default.IC3CLIENT)}},S}();u.IC3ClientLogger=T;var l=function(){function S(f){this.omnichannelConfig=f,this.debug=!1,this.requestId="",this.chatId="",this.telemetry=null,this.debug=!1}return S.prototype.setDebug=function(f){this.debug=f},S.prototype.setRequestId=function(f){this.requestId=f},S.prototype.setChatId=function(f){this.chatId=f},S.prototype.useTelemetry=function(f){this.debug&&console.log("[OCSDKLogger][useTelemetry]"),this.telemetry=f},S.prototype.logClientSdkTelemetryEvent=function(f,g){var E,b,m,I;this.debug&&console.log("[OCSDKLogger][logClientSdkTelemetryEvent]["+f+"]"),this.debug&&console.log(g);var x={OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},N=s(s({},g),{ExceptionDetails:g.ExceptionDetails?JSON.stringify(g.ExceptionDetails):""});switch(f){case _.default.DEBUG:null===(E=this.telemetry)||void 0===E||E.debug(s(s({},x),N),d.default.OCSDK);break;case _.default.WARN:null===(b=this.telemetry)||void 0===b||b.warn(s(s({},x),N),d.default.OCSDK);break;case _.default.ERROR:null===(m=this.telemetry)||void 0===m||m.error(s(s({},x),N),d.default.OCSDK);break;case _.default.INFO:default:null===(I=this.telemetry)||void 0===I||I.info(s(s({},x),N),d.default.OCSDK)}},S}();u.OCSDKLogger=l;var C=function(){function S(f){this.omnichannelConfig=f,this.debug=!1,this.requestId="",this.chatId="",this.telemetry=null,this.scenarioMarker=null,this.debug=!1,this.scenarioMarker=new p.default(f),this.scenarioMarker.setScenarioType(d.default.ACSCLIENT)}return S.prototype.setDebug=function(f){var g;this.debug=f,null===(g=this.scenarioMarker)||void 0===g||g.setDebug(f)},S.prototype.setRequestId=function(f){this.requestId=f},S.prototype.setChatId=function(f){this.chatId=f},S.prototype.useTelemetry=function(f){var g;this.debug&&console.log("[ACSClientLogger][useTelemetry]"),this.telemetry=f,null===(g=this.scenarioMarker)||void 0===g||g.useTelemetry(this.telemetry)},S.prototype.logClientSdkTelemetryEvent=function(f,g){var E,b,m,I;this.debug&&console.log("[ACSClientLogger][logClientSdkTelemetryEvent]["+f+"]"),this.debug&&console.log(g);var x={OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},N=s(s({},g),{ExceptionDetails:g.ExceptionDetails?JSON.stringify(g.ExceptionDetails):""});switch(f){case _.default.DEBUG:null===(E=this.telemetry)||void 0===E||E.debug(s(s({},x),N),d.default.ACSCLIENT);break;case _.default.WARN:null===(b=this.telemetry)||void 0===b||b.warn(s(s({},x),N),d.default.ACSCLIENT);break;case _.default.ERROR:null===(m=this.telemetry)||void 0===m||m.error(s(s({},x),N),d.default.ACSCLIENT);break;case _.default.INFO:default:null===(I=this.telemetry)||void 0===I||I.info(s(s({},x),N),d.default.ACSCLIENT)}},S.prototype.startScenario=function(f,g){var E;void 0===g&&(g={}),null===(E=this.scenarioMarker)||void 0===E||E.startScenario(f,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),g))},S.prototype.failScenario=function(f,g){var E;void 0===g&&(g={}),null===(E=this.scenarioMarker)||void 0===E||E.failScenario(f,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),g))},S.prototype.completeScenario=function(f,g){var E;void 0===g&&(g={}),null===(E=this.scenarioMarker)||void 0===E||E.completeScenario(f,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),g))},S}();u.ACSClientLogger=C;var P=function(){function S(f){this.omnichannelConfig=f,this.debug=!1,this.requestId="",this.chatId="",this.telemetry=null,this.scenarioMarker=null,this.debug=!1,this.scenarioMarker=new p.default(f),this.scenarioMarker.setScenarioType(d.default.ACSADAPTER)}return S.prototype.setDebug=function(f){var g;this.debug=f,null===(g=this.scenarioMarker)||void 0===g||g.setDebug(f)},S.prototype.setRequestId=function(f){this.requestId=f},S.prototype.setChatId=function(f){this.chatId=f},S.prototype.useTelemetry=function(f){var g;this.debug&&console.log("[ACSAdapterLogger][useTelemetry]"),this.telemetry=f,null===(g=this.scenarioMarker)||void 0===g||g.useTelemetry(this.telemetry)},S.prototype.logClientSdkTelemetryEvent=function(f,g){var E,b,m,I;this.debug&&console.log("[ACSAdapterLogger][logClientSdkTelemetryEvent]["+f+"]"),this.debug&&console.log(g);var x={OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},N=s(s({},g),{ExceptionDetails:g.ExceptionDetails?JSON.stringify(g.ExceptionDetails):""});switch(f){case _.default.DEBUG:null===(E=this.telemetry)||void 0===E||E.debug(s(s({},x),N),d.default.ACSADAPTER);break;case _.default.WARN:null===(b=this.telemetry)||void 0===b||b.warn(s(s({},x),N),d.default.ACSADAPTER);break;case _.default.ERROR:null===(m=this.telemetry)||void 0===m||m.error(s(s({},x),N),d.default.ACSADAPTER);break;case _.default.INFO:default:null===(I=this.telemetry)||void 0===I||I.info(s(s({},x),N),d.default.ACSADAPTER)}},S.prototype.startScenario=function(f,g){var E;void 0===g&&(g={}),null===(E=this.scenarioMarker)||void 0===E||E.startScenario(f,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),g))},S.prototype.failScenario=function(f,g){var E;void 0===g&&(g={}),null===(E=this.scenarioMarker)||void 0===E||E.failScenario(f,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),g))},S.prototype.completeScenario=function(f,g){var E;void 0===g&&(g={}),null===(E=this.scenarioMarker)||void 0===E||E.completeScenario(f,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),g))},S}();u.ACSAdapterLogger=P,u.createIC3ClientLogger=function(S,f){void 0===f&&(f=!1);var g=new T(S);return g.setDebug(f),g},u.createOCSDKLogger=function(S,f){void 0===f&&(f=!1);var g=new l(S);return g.setDebug(f),g},u.createACSClientLogger=function(S,f){void 0===f&&(f=!1);var g=new C(S);return g.setDebug(f),g},u.createACSAdapterLogger=function(S,f){void 0===f&&(f=!1);var g=new P(S);return g.setDebug(f),g}},8098:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.isReactNative=u.isNode=u.isBrowser=void 0,u.isBrowser=function(){return"undefined"!=typeof window&&void 0!==window.document},u.isNode=function(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node},u.isReactNative=function(){return"undefined"!=typeof navigator&&"ReactNative"==navigator.product},u.default={isBrowser:u.isBrowser,isNode:u.isNode,isReactNative:u.isReactNative}},9425:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.isCustomerMessage=u.isSystemMessage=void 0;var s=c(3372),_=c(8953);u.isSystemMessage=function(d){var T=d.properties,l=d.messageType===s.default.UserMessage&&T&&T.tags&&T.tags.includes("system"),C=d.tags&&d.tags.includes("system");return l||C||!1},u.isCustomerMessage=function(d){var p=d.sender;return p&&p.id&&p.id.includes("contacts/8:")||p&&p.displayName&&p.displayName===_.default.Customer||!1}},7616:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=["orgUrl","orgId","widgetId"];u.default=function(_){if(!_)throw new Error("OmnichannelConfiguration not found");for(var d=Object.keys(_),p=0,T=c;p<T.length;p++){var l=T[p];if(!d.includes(l))throw new Error("Missing '"+l+"' in OmnichannelConfiguration")}}},641:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.defaultChatSDKConfig=void 0;var _={dataMasking:{disable:!1,maskingCharacter:"#"},telemetry:{disable:!1,ariaTelemetryKey:c(4151).ariaTelemetryKey},persistentChat:{disable:!0,tokenUpdateTime:216e5},chatReconnect:{disable:!0}};u.defaultChatSDKConfig=_,u.default=function(l){l.dataMasking&&function(l){"boolean"!=typeof l.disable&&(l.disable=_.dataMasking.disable),("string"!=typeof l.maskingCharacter||1!==l.maskingCharacter.length)&&(l.maskingCharacter=_.dataMasking.maskingCharacter)}(l.dataMasking),l.persistentChat&&function(l){("number"!=typeof l.tokenUpdateTime||!l.tokenUpdateTime)&&(l.tokenUpdateTime=_.persistentChat.tokenUpdateTime)}(l.persistentChat)}},5145:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.read="read",s}();u.default=c},3865:function(Q,u,c){"use strict";var s=this&&this.__awaiter||function(b,m,I,x){return new(I||(I=Promise))(function(F,U){function k(j){try{M(x.next(j))}catch(W){U(W)}}function D(j){try{M(x.throw(j))}catch(W){U(W)}}function M(j){j.done?F(j.value):function(F){return F instanceof I?F:new I(function(U){U(F)})}(j.value).then(k,D)}M((x=x.apply(b,m||[])).next())})},_=this&&this.__generator||function(b,m){var x,N,F,U,I={label:0,sent:function(){if(1&F[0])throw F[1];return F[1]},trys:[],ops:[]};return U={next:k(0),throw:k(1),return:k(2)},"function"==typeof Symbol&&(U[Symbol.iterator]=function(){return this}),U;function k(M){return function(j){return function(M){if(x)throw new TypeError("Generator is already executing.");for(;I;)try{if(x=1,N&&(F=2&M[0]?N.return:M[0]?N.throw||((F=N.return)&&F.call(N),0):N.next)&&!(F=F.call(N,M[1])).done)return F;switch(N=0,F&&(M=[2&M[0],F.value]),M[0]){case 0:case 1:F=M;break;case 4:return I.label++,{value:M[1],done:!1};case 5:I.label++,N=M[1],M=[0];continue;case 7:M=I.ops.pop(),I.trys.pop();continue;default:if(!(F=(F=I.trys).length>0&&F[F.length-1])&&(6===M[0]||2===M[0])){I=0;continue}if(3===M[0]&&(!F||M[1]>F[0]&&M[1]<F[3])){I.label=M[1];break}if(6===M[0]&&I.label<F[1]){I.label=F[1],F=M;break}if(F&&I.label<F[2]){I.label=F[2],I.ops.push(M);break}F[2]&&I.ops.pop(),I.trys.pop();continue}M=m.call(b,I)}catch(j){M=[6,j],N=0}finally{x=F=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([M,j])}}};Object.defineProperty(u,"__esModule",{value:!0});var d=c(501),p=c(6849),T=c(5874),l=c(2915),C=c(1927),P=c(6648),S=c(5145),f=c(6355),g=c(8636),E=function(){function b(){}return b.getDocumentTypeFromContentType=function(m){return g.default.isDocumentTypeImage(m)?d.default.DocumentTypeImage:d.default.DocumentTypeFile},b.createNewDocument=function(m,I,x){return s(this,void 0,void 0,function(){var F,U,k,D,M;return _(this,function(j){return(M={})[m]=[S.default[S.default.read]],F={filename:I.name,permissions:M,type:b.getDocumentTypeFromContentType(I.type)},U=C.default.getAmsObjectsUrl(x.RegionGtms),(k=P.default.getDefaultAMSHeaders(x.SkypeToken))[p.default.ContentTypeHeader]=d.default.ContentTypeJson,D={data:JSON.stringify(F),headers:k,type:T.default.POST,url:U},[2,l.HttpClient.MakeRequest(D)]})})},b.uploadDocument=function(m,I,x){return s(this,void 0,void 0,function(){var N,F,U;return _(this,function(D){return console.log("AmsHelper.ts uploadDocument(): "+m+", "+I+", "+x),N=g.default.isDocumentTypeImage(I.type),F=C.default.getAmsObjectContentUrl(m,x.RegionGtms,N),U=P.default.getDefaultAMSHeaders(x.SkypeToken),[2,l.HttpClient.MakeRequest({data:I.data,headers:U,processData:!1,type:T.default.PUT,url:F})]})})},b.getFileStatus=function(m,I){var x=g.default.isImageType(m.type),N=C.default.getAmsStatusUrl(m.id,I.RegionGtms,x);return this.getViewStatus(N,I).then(function(F){return F.scan&&F.scan.status===d.default.Malware?f.default.Error:F.view_state===d.default.Ready?f.default.Success:F.scan&&F.scan.status===d.default.InProgress||F.view_state&&F.view_state!==d.default.Failed?f.default.InProgress:f.default.Error}).catch(function(){return Promise.reject({})})},b.downloadDocument=function(m,I){var x=this,N=g.default.isImageType(m.type),F=C.default.getAmsStatusUrl(m.id,I.RegionGtms,N);return new Promise(function(U){x.getViewUri(F,I).then(function(k){var D=new Headers;return D.append("Authorization","skype_token "+I.SkypeToken),D.append("X-MS-Client-Version",d.default.ClientVersion),N&&(D.append("accept",d.default.AMSAcceptHeaderValue),D.append("Accept-Encoding",d.default.AMSAcceptEncodingHeaderValue)),fetch(k,{headers:D,method:T.default.GET}).then(function(j){U(j.blob())}).catch(function(){return Promise.reject({})})})})},b.getViewUri=function(m,I){var x=this;return this.getViewStatus(m,I).then(function(N){return!N.view_location||N.view_state===d.default.Failed||N.scan&&N.scan.status===d.default.Malware?Promise.reject({}):N.view_state&&N.view_state!==d.default.Ready?x.getViewUri(m,I):N.content_state===d.default.Expired?Promise.reject({}):Promise.resolve(N.view_location)}).catch(function(){return Promise.reject("")})},b.getViewStatus=function(m,I){var x=this;return console.log("AmsHelper.ts getViewStatus(): "+m+", "+I),new Promise(function(N){setTimeout(N,d.default.DelayForAms)}).then(function(){var N=P.default.getDefaultAMSViewHeaders(I.SkypeToken);return l.HttpClient.MakeRequest({headers:N,type:T.default.GET,url:m}).then(function(U){return U.status_location&&!U.view_state?x.getViewStatus(U.status_location,I):Promise.resolve(U)}).catch(function(U){return Promise.reject(401===U.status||403===U.status?"unauthorized":{})})})},b}();u.default=E},501:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.NewMessageEvent="NewMessage",s.MessageUpdateEvent="MessageUpdate",s.ThreadUpdateEvent="ThreadUpdate",s.ConversationUpdateEvent="ConversationUpdate",s.HttpLongPoll="HttpLongPoll",s.ContentTypeJson="application/json",s.ContentTypeTextPlain="text/plain;charset=UTF-8",s.ContentTypeForm="application/x-www-form-urlencoded",s.RedirectAs404="redirectAs404",s.NoCache="no-cache",s.User="user",s.Web="web",s.ClientInfoValue="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country=IN; clientName=swc; clientVer=912/0.106.0.34//swc",s.TextPlainMimeType="text/plain",s.SwcName="SWC",s.Image="image",s.ClientVersion="937/0.123.0.9",s.DelayForAms=50,s.Reset_Flag="reset_ic3_needed",s.Malware="malware",s.Ready="ready",s.InProgress="in progress",s.Failed="failed",s.Expired="expired",s.ImageView="imgpsh_fullsize_anim",s.FileView="original",s.DocumentTypeImage="pish/image",s.DocumentTypeFile="sharing/file",s.ImageContent="imgpsh",s.FileContent="original",s.AMSAcceptHeaderValue="image/webp,image/ *,*/*;q=0.8",s.AMSAcceptEncodingHeaderValue="gzip, deflate, sdch, br",s.AMSAuthorizationSkypeTokenValue="skype_token ",s.stabilizePollMaxRetryCount=50,s.timeBetweenStabilizingPoll=1e3,s.retryCount=2,s.retry404Count=3,s.retryOtherCount=3,s.liveStateRetryCount=3,s.timeBetweenOperationRetry=1e3,s.heartBeatDuration=3e4,s.endpointRequestLog="Endpoint request",s.subscriptionRequestLog="Subscription request",s.setPropertiesRequestLog="Set message properties request",s.unsubscribeRequestLog="Unsubscribe from endpoint request",s.pollRequestLog="Polling",s.oldInitializer="Old initializer",s.newInitializer="New Initializer",s.skypeTokenAuthURL="/v1/skypetokenauth",s.skypeTokenConstantForData="skypetoken=",s}();u.default=c},1927:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(501),_=c(6849),d=c(909),p=function(){function T(){}return T.getV2EndpointUrl=function(l,C){return C.chatService+"/v2/users/ME/endpoints/"+l},T.getThreadUrl=function(l,C){return C.chatService+"/v1/threads/"+l+"?view=msnp24Equivalent"},T.getMessagesUrl=function(l,C){return C.chatService+"/v1/users/ME/conversations/"+l+"/messages"},T.getBotMessagesUrl=function(l,C){return C.chatService+"/v1/agents/"+l+"/invoke"},T.getAmsObjectsUrl=function(l){return d.default.sanitizeUrlWithBackSlash(l.ams)+"v1/objects"},T.getAmsObjectContentUrl=function(l,C,P){void 0===P&&(P=!1);var S=P?s.default.ImageContent:s.default.FileContent;return d.default.sanitizeUrlWithBackSlash(C.ams)+"v1/objects/"+l+"/content/"+S},T.getAmsObjectViewUrl=function(l,C,P){void 0===P&&(P=!1);var S=P?s.default.ImageView:s.default.FileView;return d.default.sanitizeUrlWithBackSlash(C.ams)+"v1/objects/"+l+"/views/"+S},T.getAmsStatusUrl=function(l,C,P){void 0===P&&(P=!1);var S=P?s.default.ImageView:s.default.FileView;return d.default.sanitizeUrlWithBackSlash(C.ams)+"v1/objects/"+l+"/views/"+S+"/status"},T.getV1EndpointUrl=function(l){return l.chatService+"/v1/users/ME/endpoints"},T.getV1DeleteEndpointUrl=function(l,C){return l.chatService+"/v1/users/ME/endpoints/"+C},T.getV1SubscriptionUrl=function(l){return l.chatService+"/v1/users/ME/endpoints/SELF/subscriptions"},T.getV1PollUrl=function(l,C){return l.chatService+"/v1/users/ME/endpoints/SELF/subscriptions/"+C+"/poll"},T.getV1SetPropertiesUrl=function(l){return l.chatService+"/v1/users/ME/endpoints/SELF/properties?name="+_.default.SetEndpointProperty},T}();u.default=p},8636:function(Q,u,c){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(m){for(var I,x=1,N=arguments.length;x<N;x++)for(var F in I=arguments[x])Object.prototype.hasOwnProperty.call(I,F)&&(m[F]=I[F]);return m}).apply(this,arguments)};Object.defineProperty(u,"__esModule",{value:!0});var _=c(501),d=c(2900),p=c(4694),T=c(9306),l=c(448),C=c(3207),P=c(3372),S=c(4352),f=c(1927),g=c(7708),E=c(909),b=function(){function m(){}return m.createMessageData=function(I){var N=I.content,F=m.createBaseMessageData(I.contentType===l.default.Text?C.default.Text:C.default.RichTextHtml,I.contentType.toString(),N);return F.properties=this.getMessageProperties(I),E.default.isNullOrUndefined(I.sender.displayName)||(F.imdisplayname=I.sender.displayName),F},m.createBaseMessageData=function(I,x,N){return{"Has-Mentions":"false",clientmessageid:Date.now().toString(),composetime:(new Date).toISOString(),content:N,contenttype:x,messagetype:I}},m.getMessageProperties=function(I){var x={};if(x.deliveryMode=I.deliveryMode.toString(),I.tags){var N=[];I.tags.forEach(function(F){N.push(F)}),x.tags=N.join()}return x},m.createTypingStatusThreadMessageData=function(I,x){var N="";switch(I){case g.default.Typing:N=C.default.ControlTyping;break;case g.default.ClearTyping:N=C.default.ControlClearTyping}var F=m.createBaseMessageData(N,l.default.Text,"");return E.default.isNullOrUndefined(x)||(F=s(s({},x),F)),F},m.createBotMessageData=function(I,x){return JSON.stringify({conversation:{id:I},value:x})},m.createFileMessage=function(I,x,N){var F=C.default.Text,U=l.default.Text.toString().toLowerCase(),k=m.createBaseMessageData(F,U.toString(),"");return k.amsreferences=JSON.stringify([I.id]),k.properties=JSON.stringify(this.createFileMessageProperties(I,x,N)),E.default.isNullOrUndefined(N.sender.displayName)||(k.imdisplayname=N.sender.displayName),k},m.createFileMessageProperties=function(I,x,N){var F={};if(F.deliveryMode=N.deliveryMode.toString(),F.files=JSON.stringify([this.createFileProperty(I,x)]),F.importance="",F.subject="",N.tags){var U=[];N.tags.forEach(function(k){U.push(k)}),F.tags=U.join()}return F},m.createFileProperty=function(I,x){var N=!!m.isDocumentTypeImage(I.type);return{"@type":"http://schema.skype.com/File",type:I.type,itemid:"",baseUrl:"",providerData:"",version:2,id:I.id,title:I.name,state:"active",objectUrl:f.default.getAmsObjectViewUrl(I.id,x.RegionGtms,N),fileName:I.name,fileType:m.getNameAndExtension(I.name).extension,botFileProperties:{url:f.default.getAmsObjectViewUrl(I.id,x.RegionGtms,N)},fileInfo:{fileUrl:f.default.getAmsObjectContentUrl(I.id,x.RegionGtms,N),siteUrl:"",serverRelativeUrl:""},filePreview:{previewUrl:""}}},m.getNameAndExtension=function(I){var x=(I||"").split("."),N="",F="";return x.length>1?(F=x.pop().toLowerCase(),N=x.join(".")):(F="",N=x[0]),{name:N,extension:F}},m.createIRawMessage=function(I,x,N){var U,k,F={clientmessageid:I.clientmessageid,content:I.content,contentType:m.getMessageContentType(I),deliveryMode:E.default.isNullOrUndefined(I.properties)||I.properties.deliveryMode!==d.default.Bridged?d.default.Unbridged:d.default.Bridged,messageType:m.getMessageType(I),properties:I.properties,sender:{displayName:I.imdisplayname,id:I.from,type:m.getPersonType(I.from)},timestamp:new Date(Date.parse(I.originalarrivaltime))};(N&&(F.resourceType=N),E.default.isNullOrUndefined(I.properties)||E.default.isNullOrEmptyString(I.properties.tags))||(U=I.properties.tags.split(","),F.tags=U);if(!E.default.isNullOrUndefined(I.properties)&&!E.default.isNullOrEmptyString(I.properties.files)&&(k=JSON.parse(I.properties.files)).length>0){var D=k[0].id;E.default.isNullOrUndefined(D)&&I.amsreferences&&(D=I.amsreferences[0]);var M=m.getFileUrl(k[0],D,x);F.fileMetadata={fileSharingProtocolType:p.default.AmsBasedFileSharing,id:D,name:k[0].fileName,size:k[0].version,type:k[0].fileType,url:M}}return F},m.createIRawThread=function(I){return{id:I.id,members:I.members,messages:I.messages,properties:I.properties,rosterVersion:I.rosterVersion,type:I.type,version:I.version}},m.getConversationIdFromUrl=function(I){var x=I&&I.match(/\/(\d+:[^\/]*)[\/]?/);return x&&x[1]?x[1]:void 0},m.isSystemMessage=function(I){var x=!1;return E.default.isNullOrEmptyString(I.messagetype)||(x=m.getSystemMessageTypes().reduce(function(N,F){return N||0===I.messagetype.toLowerCase().indexOf(F.toLowerCase())},x)),x},m.getPersonType=function(I){var x=S.default.Unknown,N=I.split("/").pop();return 0===N.indexOf("28:")?x=S.default.Bot:0===N.indexOf("19:")&&(x=S.default.User),x},m.isImageType=function(I){switch(I.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"bmp":case"tiff":case"jfif":return!0;default:return!1}},m.getMessageType=function(I){var x;switch(I.messagetype){case P.default.Typing:x=P.default.Typing;break;case P.default.ClearTyping:x=P.default.ClearTyping;break;default:x=P.default.UserMessage}return x},m.getMessageContentType=function(I){var N=I.contenttype?I.contenttype:I.messagetype;return N===C.default.Text.toLowerCase()||N.indexOf(_.default.TextPlainMimeType)>=0?l.default.Text:l.default.RichText},m.getSystemMessageTypes=function(){return["ThreadActivity"]},m.getFileUrl=function(I,x,N){var U,F=I.fileInfo;if(F&&F.fileUrl)U=F.fileUrl;else if(x){var k=m.isImageType(I.fileType);U=f.default.getAmsObjectContentUrl(x,N.RegionGtms,k)}return U},m.isDocumentTypeImage=function(I){return-1!==I.indexOf(_.default.Image)},m.getDomainRegexp=function(){return new RegExp(/^(https?:.+?\.microsoft\.com)/i)},m.parseDomain=function(I){var x=I.match(m.getDomainRegexp());return x?x[1]:null},m.parseChatServiceHostUrl=function(I){return m.parseDomain(I)},m.shouldRetryOnFailure=function(I){return I!==T.default.Accepted&&I!==T.default.Created},m}();u.default=b},909:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(6849),_=function(){function d(){}return d.isNullOrEmptyString=function(p){return d.isNullOrUndefined(p)||""===p},d.isNullOrUndefinedOrEmptyArray=function(p){return d.isNullOrUndefined(p)||0===p.length},d.isNullOrUndefined=function(p){return null==p},d.isPrimitiveString=function(p){return"string"==typeof p},d.convertStringToBoolean=function(p){return!d.isNullOrUndefined(p)&&"true"===p.toLowerCase()},d.sanitizeUrlWithBackSlash=function(p){return p.endsWith("/")?p:p+"/"},d.getRegistrationTokenValue=function(p){var T=p.match(/registrationToken=(.+); expires=(\d+)/);return T&&T.length>=2?s.default.RegistrationTokenHeaderValue+T[1]:""},d.addQueryParametersToPath=function(p,T){var l=p;if(!d.isNullOrUndefined(T))for(var C in l.indexOf("?")>=0||(l+="?"),T)if(T.hasOwnProperty(C)){var P=C+"="+T[C];"?"!==l[l.length-1]&&(P="&"+P),l+=P}return l},d.getResponseHeader=function(p,T){var l;return d.isNullOrUndefined(p)||(l=p.headers[T]),l},d.timer=function(){var p=(new Date).getTime();return{get milliSecondsElapsed(){return(new Date).getTime()-p}}},d.concatArrays=function(p,T){!d.isNullOrUndefined(p)&&!d.isNullOrUndefined(T)&&T.forEach(function(l){p.push(l)})},d}();u.default=_},1288:function(Q,u,c){"use strict";var s=this&&this.__awaiter||function(l,C,P,S){return new(P||(P=Promise))(function(g,E){function b(x){try{I(S.next(x))}catch(N){E(N)}}function m(x){try{I(S.throw(x))}catch(N){E(N)}}function I(x){x.done?g(x.value):function(g){return g instanceof P?g:new P(function(E){E(g)})}(x.value).then(b,m)}I((S=S.apply(l,C||[])).next())})},_=this&&this.__generator||function(l,C){var S,f,g,E,P={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return E={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function b(I){return function(x){return function(I){if(S)throw new TypeError("Generator is already executing.");for(;P;)try{if(S=1,f&&(g=2&I[0]?f.return:I[0]?f.throw||((g=f.return)&&g.call(f),0):f.next)&&!(g=g.call(f,I[1])).done)return g;switch(f=0,g&&(I=[2&I[0],g.value]),I[0]){case 0:case 1:g=I;break;case 4:return P.label++,{value:I[1],done:!1};case 5:P.label++,f=I[1],I=[0];continue;case 7:I=P.ops.pop(),P.trys.pop();continue;default:if(!(g=(g=P.trys).length>0&&g[g.length-1])&&(6===I[0]||2===I[0])){P=0;continue}if(3===I[0]&&(!g||I[1]>g[0]&&I[1]<g[3])){P.label=I[1];break}if(6===I[0]&&P.label<g[1]){P.label=g[1],g=I;break}if(g&&P.label<g[2]){P.label=g[2],P.ops.push(I);break}g[2]&&P.ops.pop(),P.trys.pop();continue}I=C.call(l,P)}catch(x){I=[6,x],f=0}finally{S=g=0}if(5&I[0])throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}([I,x])}}};Object.defineProperty(u,"__esModule",{value:!0});var d=c(2217),p=c(737),T=function(){function l(C){this.hostType=d.default.Page,this.id=(0,p.uuidv4)(),this.protocolType=C,this.newConversationMessageListeners={},this.threadUpdateListeners={},this.debug=!1}return l.prototype.setDebug=function(C){this.debug=C},l.prototype.joinConversation=function(C,P){var S=this;return this.onJoinConversation(C,P).then(function(f){return{disconnect:S.disconnectFromConversation.bind(S,f),downloadFile:S.downloadFile.bind(S,f),getFileStatus:S.getFileStatus.bind(S,f),getMembers:S.getMembers.bind(S,f),getMessages:S.getMessages.bind(S,f),id:f.id,indicateTypingStatus:S.indicateTypingStatus.bind(S,f),registerOnNewMessage:S.registerOnNewMessage.bind(S,f),registerOnThreadUpdate:S.registerOnThreadUpdate.bind(S,f),sendFileMessage:S.sendFileMessage.bind(S,f),sendMessage:S.sendMessage.bind(S,f),sendMessageToBot:S.sendMessageToBot.bind(S,f),uploadFile:S.uploadFile.bind(S,f),sendFileData:S.sendFileData.bind(S,f)}})},l.prototype.registerOnNewMessage=function(C,P){return s(this,void 0,void 0,function(){return _(this,function(S){return[2,Promise.resolve()]})})},l.prototype.registerOnThreadUpdate=function(C,P){return s(this,void 0,void 0,function(){return _(this,function(S){return[2,Promise.resolve()]})})},l.prototype.uploadFile=function(C,P,S){return Promise.resolve()},l.prototype.downloadFile=function(C,P){return this.debug&&console.debug("IC3Core/ClientBridge/downloadFile"),this.downloadFileData(C,P).then(function(S){if(S&&S.size)return S;var g=new Blob([new Uint8Array(S)]);return!g||0===g.size&&""===g.type?S:g})},l}();u.default=T},2518:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(333),_=c(2217),d=function(){function p(){}return p.getClientBridge=function(T){switch(T.hostType){case _.default.IFrame:throw new Error("Framed bridge not implemented for "+T.hostType+" in IC3Core");case _.default.Page:return new s.default(T.protocolType);default:throw new Error("Client bridge not implemented for "+T.hostType+" in IC3Core")}},p}();u.default=d},333:function(Q,u,c){"use strict";var P,s=this&&this.__extends||(P=function(S,f){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,E){g.__proto__=E}||function(g,E){for(var b in E)Object.prototype.hasOwnProperty.call(E,b)&&(g[b]=E[b])})(S,f)},function(S,f){if("function"!=typeof f&&null!==f)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function g(){this.constructor=S}P(S,f),S.prototype=null===f?Object.create(f):(g.prototype=f.prototype,new g)}),_=this&&this.__awaiter||function(P,S,f,g){return new(f||(f=Promise))(function(b,m){function I(F){try{N(g.next(F))}catch(U){m(U)}}function x(F){try{N(g.throw(F))}catch(U){m(U)}}function N(F){F.done?b(F.value):function(b){return b instanceof f?b:new f(function(m){m(b)})}(F.value).then(I,x)}N((g=g.apply(P,S||[])).next())})},d=this&&this.__generator||function(P,S){var g,E,b,m,f={label:0,sent:function(){if(1&b[0])throw b[1];return b[1]},trys:[],ops:[]};return m={next:I(0),throw:I(1),return:I(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m;function I(N){return function(F){return function(N){if(g)throw new TypeError("Generator is already executing.");for(;f;)try{if(g=1,E&&(b=2&N[0]?E.return:N[0]?E.throw||((b=E.return)&&b.call(E),0):E.next)&&!(b=b.call(E,N[1])).done)return b;switch(E=0,b&&(N=[2&N[0],b.value]),N[0]){case 0:case 1:b=N;break;case 4:return f.label++,{value:N[1],done:!1};case 5:f.label++,E=N[1],N=[0];continue;case 7:N=f.ops.pop(),f.trys.pop();continue;default:if(!(b=(b=f.trys).length>0&&b[b.length-1])&&(6===N[0]||2===N[0])){f=0;continue}if(3===N[0]&&(!b||N[1]>b[0]&&N[1]<b[3])){f.label=N[1];break}if(6===N[0]&&f.label<b[1]){f.label=b[1],b=N;break}if(b&&f.label<b[2]){f.label=b[2],f.ops.push(N);break}b[2]&&f.ops.pop(),f.trys.pop();continue}N=S.call(P,f)}catch(F){N=[6,F],E=0}finally{g=b=0}if(5&N[0])throw N[1];return{value:N[0]?N[1]:void 0,done:!0}}([N,F])}}};Object.defineProperty(u,"__esModule",{value:!0});var p=c(1288),T=c(2217),l=c(9515),C=function(P){function S(f){var g=P.call(this,f)||this;return g.hostType=T.default.Page,g.protocolAdapter=new l.default("",g.hostType),g}return s(S,P),S.prototype.setup=function(f){return Promise.resolve()},S.prototype.update=function(f){return Promise.resolve()},S.prototype.onRegisterOnNewMessage=function(f){return Promise.resolve()},S.prototype.onRegisterOnThreadUpdate=function(f){return Promise.resolve()},S.prototype.initialize=function(f){return this.protocolAdapter.initialize(f)},S.prototype.dispose=function(){return this.protocolAdapter.dispose()},S.prototype.sendMessage=function(f,g){return this.protocolAdapter.sendMessage(f,g)},S.prototype.sendFileMessage=function(f,g,E){return this.protocolAdapter.sendFileMessage(f,g,E)},S.prototype.getMessages=function(f){return this.protocolAdapter.getMessages(f)},S.prototype.disconnectFromConversation=function(f){return this.protocolAdapter.disconnectFromConversation(f)},S.prototype.onJoinConversation=function(f,g){return this.protocolAdapter.joinConversation(f,g)},S.prototype.sendFileData=function(f,g,E){return this.protocolAdapter.sendFileData(f,g,E)},S.prototype.downloadFileData=function(f,g){return this.protocolAdapter.downloadFileData(f,g)},S.prototype.getFileStatus=function(f,g){return this.protocolAdapter.getFileStatus(f,g)},S.prototype.indicateTypingStatus=function(f,g,E){return this.protocolAdapter.indicateTypingStatus(f,g,E)},S.prototype.sendMessageToBot=function(f,g,E){return this.protocolAdapter.sendMessageToBot(f,g,E)},S.prototype.getMembers=function(f){return this.protocolAdapter.getMembers(f)},S.prototype.registerOnNewMessage=function(f,g){return _(this,void 0,void 0,function(){return d(this,function(E){return this.protocolAdapter.registerOnNewMessage(f,g),[2,Promise.resolve()]})})},S.prototype.registerOnThreadUpdate=function(f,g){return _(this,void 0,void 0,function(){return d(this,function(E){return this.protocolAdapter.registerOnThreadUpdate(f,g),[2,Promise.resolve()]})})},S.prototype.setDebug=function(f){void 0===f&&(f=!1),this.protocolAdapter.setDebug(f)},S}(p.default);u.default=C},1218:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(3865),_=c(501),d=c(4694),p=c(6355),T=c(2217),l=c(2915),C=c(5256),P=c(6849),S=c(5874),f=c(3671),g=c(752),E=c(448),b=c(3207),m=c(5655),I=c(6648),x=c(1927),N=c(8636),F=c(909),U=function(){function k(D){this.hostType=T.default.Page,this.protocolType=m.default.IC3V1SDK,this.id=D,this.conversations=[],this.newConversationMessageListeners={},this.threadUpdateListeners={},this.internalConversationsData={},this.liveStateFailureCount=0,this.debug=!1}return k.prototype.startPolling=function(){this.ic3Initializer&&this.ic3Initializer.startPolling()},k.prototype.stopPolling=function(){this.ic3Initializer&&this.ic3Initializer.stopPolling()},k.prototype.setup=function(D){return this.logger=D.logger,l.HttpClient.setLogger(this.logger),Promise.resolve()},k.prototype.initialize=function(D){return this.setupSession(D),Promise.resolve()},k.prototype.update=function(D){return Promise.resolve()},k.prototype.dispose=function(){return this.conversations=[],this.newConversationMessageListeners={},this.threadUpdateListeners={},this.internalConversationsData={},Promise.resolve()},k.prototype.joinConversation=function(D,M){var j;void 0===M&&(M=!0);var W=F.default.timer(),$={id:D};return-1===this.conversations.findIndex(function(oe){return oe.id===$.id})&&(this.conversations.push($),this.newConversationMessageListeners[$.id]=this.newConversationMessageListeners[$.id]||[],this.threadUpdateListeners[$.id]=this.threadUpdateListeners[$.id]||[]),null===(j=this.logger)||void 0===j||j.log(g.default.INFO,f.default.JoinConversation,{ElapsedTimeInMilliseconds:W.milliSecondsElapsed,EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}),!F.default.isNullOrUndefined(M)&&!0===M&&this.sendHeartBeat($.id),Promise.resolve($)},k.prototype.sendLiveState=function(D){var M=this;this.debug&&console.debug("IC3Core/sendLiveState");var $=N.default.createBaseMessageData(b.default.LiveState,E.default.Text,"");return this.sendMessageToIC3(D,$).then(function(){return M.liveStateFailureCount=0,Promise.resolve()}).catch(function(ce){var oe;M.liveStateFailureCount++,M.liveStateFailureCount>=_.default.liveStateRetryCount&&(null===(oe=M.logger)||void 0===oe||oe.log(g.default.ERROR,f.default.SendLiveStateFailure,{ExceptionDetails:ce,EndpointUrl:M.EndpointUrl,EndpointId:M.EndpointId}),M.stopHeartBeat(),M.liveStateFailureCount=0)})},k.prototype.sendHeartBeat=function(D){this.heartBeatTimer||(this.debug&&console.debug("IC3Core/sendHeartBeat"),this.sendLiveState(D),this.heartBeatTimer=window.setInterval(this.sendLiveState.bind(this,D),_.default.heartBeatDuration))},k.prototype.stopHeartBeat=function(){clearInterval(this.heartBeatTimer)},k.prototype.sendMessage=function(D,M){var j=N.default.createMessageData(M);return this.sendMessageToIC3(D.id,j)},k.prototype.getMessages=function(D){var M=this,j=I.default.getDefaultGetMessagesQueryParameters(),W=F.default.addQueryParametersToPath(x.default.getMessagesUrl(D.id,this.ic3Info.RegionGtms),j),$=I.default.getDefaultIC3Headers();return $[P.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,$[P.default.ContentTypeHeader]=_.default.ContentTypeJson,l.HttpClient.MakeRequest({enableExponentialBackoff:!0,headers:$,redirect404RetryCount:_.default.retryCount,retryCount:_.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:N.default.shouldRetryOnFailure,timeBetweenRetry:_.default.timeBetweenOperationRetry,type:S.default.GET,url:W}).then(function(oe){for(var Z=[],ue=0,he=oe.messages;ue<he.length;ue++){var Ee=he[ue];N.default.isSystemMessage(Ee)||Z.push(N.default.createIRawMessage(Ee,M.ic3Info))}return M.getAllMessagesFromBackwardLinkUrl(oe._metadata.backwardLink,j.startTime,Z)})},k.prototype.registerOnNewMessage=function(D,M){var j;return this.newConversationMessageListeners[D.id].push(M),null===(j=this.logger)||void 0===j||j.log(g.default.INFO,f.default.RegisterOnNewMessage,{EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}),Promise.resolve()},k.prototype.registerOnThreadUpdate=function(D,M){var j;return this.threadUpdateListeners[D.id].push(M),null===(j=this.logger)||void 0===j||j.log(g.default.INFO,f.default.RegisterOnThreadUpdate,{EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}),Promise.resolve()},k.prototype.disconnectFromConversation=function(D){return this.conversations.findIndex(function(M){return M.id===D.id}),delete this.internalConversationsData[D.id],this.ic3Info.visitor&&(this.stopHeartBeat(),this.stopPolling()),Promise.resolve()},k.prototype.sendFileData=function(D,M,j){var W=this;if(F.default.isNullOrUndefined(j)&&(j=d.default.AmsBasedFileSharing),M.size<=0)throw new Error("File size is lesser or equal to zero.");var $={fileSharingProtocolType:j,id:"",name:M.name,size:M.size,type:M.type,url:""};return new Promise(function(ce,oe){s.default.createNewDocument(D.id,M,W.ic3Info).then(function(Z){$.id=Z.id;var ue=N.default.isDocumentTypeImage(M.type);$.url=x.default.getAmsObjectContentUrl(Z.id,W.ic3Info.RegionGtms,ue),s.default.uploadDocument(Z.id,M,W.ic3Info).then(function(){ce($)}).catch(function(he){oe(he)})}).catch(function(Z){oe(Z)})})},k.prototype.sendFileMessage=function(D,M,j){return this.sendMessageToIC3(D.id,N.default.createFileMessage(M,this.ic3Info,j))},k.prototype.downloadFileData=function(D,M){var j=this;return this.debug&&console.debug("IC3Core/IC3ClientAdapter/downloadFileData"),new Promise(function(W,$){var ce=M.fileSharingProtocolType;F.default.isNullOrUndefined(ce)&&(ce=d.default.AmsBasedFileSharing),ce===d.default.AmsBasedFileSharing?s.default.downloadDocument(M,j.ic3Info).then(function(oe){W(oe)}).catch(function(oe){$(oe)}):$("This Protocol is not implemented")})},k.prototype.getFileStatus=function(D,M){var j=this;return new Promise(function(W,$){var ce=M.fileSharingProtocolType;F.default.isNullOrUndefined(ce)&&(ce=d.default.AmsBasedFileSharing),ce===d.default.AmsBasedFileSharing?s.default.getFileStatus(M,j.ic3Info).then(function(oe){W(oe)}).catch(function(oe){$(p.default.Error+" e")}):$("This Protocol is not implemented")})},k.prototype.indicateTypingStatus=function(D,M,j){var W=N.default.createTypingStatusThreadMessageData(M,j);return this.sendMessageToIC3(D.id,W)},k.prototype.sendMessageToBot=function(D,M,j){var W=N.default.createBotMessageData(D.id,j),$=x.default.getBotMessagesUrl(M,this.ic3Info.RegionGtms),ce=I.default.getDefaultIC3Headers();return ce[P.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,ce[P.default.ContentTypeHeader]=_.default.ContentTypeTextPlain,l.HttpClient.MakeRequest({data:W,dataType:C.default.TEXT,enableExponentialBackoff:!0,headers:ce,redirect404RetryCount:_.default.retryCount,retryCount:_.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:N.default.shouldRetryOnFailure,timeBetweenRetry:_.default.timeBetweenOperationRetry,type:S.default.POST,url:$})},k.prototype.getMembers=function(D){var M=this.internalConversationsData[D.id].members,j=[];return F.default.isNullOrUndefinedOrEmptyArray(M)||M.forEach(function(W){var $={displayName:W.friendlyName,id:W.id,type:N.default.getPersonType(W.id)};j.push($)}),Promise.resolve(j)},k.prototype.sendMessageToIC3=function(D,M){var j=x.default.getMessagesUrl(D,this.ic3Info.RegionGtms),W=I.default.getDefaultIC3Headers();W[P.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,W[P.default.ContentTypeHeader]=_.default.ContentTypeJson;var $={data:JSON.stringify(M),enableExponentialBackoff:!0,headers:W,redirect404RetryCount:_.default.retryCount,retryCount:_.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:N.default.shouldRetryOnFailure,timeBetweenRetry:_.default.timeBetweenOperationRetry,type:S.default.POST,url:j};return l.HttpClient.MakeRequest($)},k.prototype.onNewMessage=function(D,M,j){var $,W=this,ce=F.default.timer();try{D&&(F.default.isNullOrUndefined(this.newConversationMessageListeners[D.id])||N.default.isSystemMessage(M)||this.newConversationMessageListeners[D.id].forEach(function(Z){Z(N.default.createIRawMessage(M,W.ic3Info,j))}))}catch(Z){return void(null===($=this.logger)||void 0===$||$.log(g.default.ERROR,f.default.OnNewMessageFailure,{ExceptionDetails:Z,ElapsedTimeInMilliseconds:ce.milliSecondsElapsed,EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}))}},k.prototype.onThreadUpdate=function(D,M){var j,W=F.default.timer();try{D&&(F.default.isNullOrUndefined(this.threadUpdateListeners[D.id])||this.threadUpdateListeners[D.id].forEach(function(ce){ce(N.default.createIRawThread(M))}))}catch(ce){return void(null===(j=this.logger)||void 0===j||j.log(g.default.ERROR,f.default.OnThreadUpdateFailure,{ExceptionDetails:ce,ElapsedTimeInMilliseconds:W.milliSecondsElapsed,EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}))}},k.prototype.getAllMessagesFromBackwardLinkUrl=function(D,M,j){var W=this;return F.default.isNullOrEmptyString(D)?Promise.resolve(j):this.getMessagesFromBackwardLinkUrl(D,M).then(function($){for(var ce=0,oe=$.messages;ce<oe.length;ce++){var Z=oe[ce];N.default.isSystemMessage(Z)||j.push(N.default.createIRawMessage(Z,W.ic3Info))}return W.getAllMessagesFromBackwardLinkUrl($._metadata.backwardLink,M,j)})},k.prototype.getMessagesFromBackwardLinkUrl=function(D,M){var W=F.default.addQueryParametersToPath(D,{startTime:M}),$=I.default.getDefaultIC3Headers();return $[P.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,$[P.default.ContentTypeHeader]=_.default.ContentTypeJson,l.HttpClient.MakeRequest({enableExponentialBackoff:!0,headers:$,redirect404RetryCount:_.default.retryCount,retryCount:_.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:N.default.shouldRetryOnFailure,timeBetweenRetry:_.default.timeBetweenOperationRetry,type:S.default.GET,url:W})},k.prototype.setupSession=function(D){this.ic3Info={SkypeToken:D.token,RegionGtms:D.regionGtms,visitor:D.visitor},F.default.isNullOrUndefined(this.ic3Info)||(this.EndpointId=this.ic3Info.endpointId,this.EndpointUrl=this.ic3Info.RegionGtms?this.ic3Info.RegionGtms.chatService:"")},k.prototype.setDebug=function(D){void 0===D&&(D=!1),this.debug=D},k}();u.default=U},9515:function(Q,u,c){"use strict";var U,s=this&&this.__extends||(U=function(k,D){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,j){M.__proto__=j}||function(M,j){for(var W in j)Object.prototype.hasOwnProperty.call(j,W)&&(M[W]=j[W])})(k,D)},function(k,D){if("function"!=typeof D&&null!==D)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");function M(){this.constructor=k}U(k,D),k.prototype=null===D?Object.create(D):(M.prototype=D.prototype,new M)}),_=this&&this.__awaiter||function(U,k,D,M){return new(D||(D=Promise))(function(W,$){function ce(ue){try{Z(M.next(ue))}catch(he){$(he)}}function oe(ue){try{Z(M.throw(ue))}catch(he){$(he)}}function Z(ue){ue.done?W(ue.value):function(W){return W instanceof D?W:new D(function($){$(W)})}(ue.value).then(ce,oe)}Z((M=M.apply(U,k||[])).next())})},d=this&&this.__generator||function(U,k){var M,j,W,$,D={label:0,sent:function(){if(1&W[0])throw W[1];return W[1]},trys:[],ops:[]};return $={next:ce(0),throw:ce(1),return:ce(2)},"function"==typeof Symbol&&($[Symbol.iterator]=function(){return this}),$;function ce(Z){return function(ue){return function(Z){if(M)throw new TypeError("Generator is already executing.");for(;D;)try{if(M=1,j&&(W=2&Z[0]?j.return:Z[0]?j.throw||((W=j.return)&&W.call(j),0):j.next)&&!(W=W.call(j,Z[1])).done)return W;switch(j=0,W&&(Z=[2&Z[0],W.value]),Z[0]){case 0:case 1:W=Z;break;case 4:return D.label++,{value:Z[1],done:!1};case 5:D.label++,j=Z[1],Z=[0];continue;case 7:Z=D.ops.pop(),D.trys.pop();continue;default:if(!(W=(W=D.trys).length>0&&W[W.length-1])&&(6===Z[0]||2===Z[0])){D=0;continue}if(3===Z[0]&&(!W||Z[1]>W[0]&&Z[1]<W[3])){D.label=Z[1];break}if(6===Z[0]&&D.label<W[1]){D.label=W[1],W=Z;break}if(W&&D.label<W[2]){D.label=W[2],D.ops.push(Z);break}W[2]&&D.ops.pop(),D.trys.pop();continue}Z=k.call(U,D)}catch(ue){Z=[6,ue],j=0}finally{M=W=0}if(5&Z[0])throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}([Z,ue])}}};Object.defineProperty(u,"__esModule",{value:!0});var p=c(501),T=c(6849),l=c(5874),C=c(1218),P=c(7037),S=c(3671),f=c(2915),g=c(752),E=c(5655),b=c(6648),m=c(5785),I=c(1927),x=c(8636),N=c(909),F=function(U){function k(D,M){var j=U.call(this,D)||this;return j.debug&&console.debug("IC3Core/Constructor"),j.protocolType=E.default.IC3V1SDK,j.hostType=M,j.ic3Initializer=new P.default,j}return s(k,U),k.prototype.startPolling=function(){U.prototype.startPolling.call(this)},k.prototype.stopPolling=function(){U.prototype.stopPolling.call(this)},k.prototype.setup=function(D){return U.prototype.setup.call(this,D)},k.prototype.initialize=function(D){var M=this;return U.prototype.initialize.call(this,D).then(function(){var W;return null===(W=M.ic3Initializer)||void 0===W?void 0:W.setup(M.logger).then(function(){return M.setSkypeTokenCookie()}).then(function(){var $;return null===($=M.ic3Initializer)||void 0===$?void 0:$.setIc3Info(M.ic3Info)}).then(function(){var $;return null===($=M.ic3Initializer)||void 0===$?void 0:$.initializeIC3(M.handlePollData.bind(M))}).then(function($){M.ic3Info=$})})},k.prototype.update=function(D){var M=this;return U.prototype.update.call(this,D).then(function(){return M.updateToken({RegionGtms:D.regionGtms,SkypeToken:D.token,visitor:D.visitor})})},k.prototype.dispose=function(){var D;return _(this,void 0,void 0,function(){return d(this,function(M){return null===(D=this.ic3Initializer)||void 0===D||D.stopPolling(),this.heartBeatTimer&&clearInterval(this.heartBeatTimer),Promise.resolve(),[2]})})},k.prototype.joinConversation=function(D,M){var j=this,W=N.default.timer();return U.prototype.joinConversation.call(this,D,M).then(function($){return j.getThreadRequest($.id).then(function(ce){return j.internalConversationsData[$.id]={id:D,members:ce.members},$}).catch(function(ce){return j.logger&&j.logger.log(g.default.WARN,S.default.JoinConversationV1GetThreadRequestFailed,{Description:"Unable to retrieve thread: "+ce,ElapsedTimeInMilliseconds:W.milliSecondsElapsed,EndpointUrl:j.EndpointUrl,EndpointId:j.ic3Info.endpointId}),j.internalConversationsData[$.id]={id:D,members:[]},$})})},k.prototype.sendMessage=function(D,M){return U.prototype.sendMessage.call(this,D,M)},k.prototype.sendFileMessage=function(D,M,j){return U.prototype.sendFileMessage.call(this,D,M,j)},k.prototype.getMessages=function(D){return U.prototype.getMessages.call(this,D)},k.prototype.registerOnNewMessage=function(D,M){return U.prototype.registerOnNewMessage.call(this,D,M)},k.prototype.registerOnThreadUpdate=function(D,M){return U.prototype.registerOnThreadUpdate.call(this,D,M)},k.prototype.disconnectFromConversation=function(D){return U.prototype.disconnectFromConversation.call(this,D)},k.prototype.setSkypeTokenCookie=function(){var D=this.ic3Info.RegionGtms.ams.concat(p.default.skypeTokenAuthURL),M=b.default.getDefaultBaseIC3Headers();return M[T.default.ContentTypeHeader]=p.default.ContentTypeForm,f.HttpClient.MakeRequest({data:p.default.skypeTokenConstantForData+this.ic3Info.SkypeToken,enableExponentialBackoff:!0,useXHRWithCredentials:!0,headers:M,redirect404RetryCount:p.default.retryCount,retryCount:p.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:x.default.shouldRetryOnFailure,timeBetweenRetry:p.default.timeBetweenOperationRetry,type:l.default.POST,url:D})},k.prototype.getThreadRequest=function(D){var M=I.default.getThreadUrl(D,this.ic3Info.RegionGtms),j=b.default.getDefaultBaseIC3Headers();return j[T.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,f.HttpClient.MakeRequest({enableExponentialBackoff:!0,headers:j,redirect404RetryCount:p.default.retryCount,retryCount:p.default.retryCount,shouldRedirectOn404:!0,shouldRetryOnFailure:x.default.shouldRetryOnFailure,timeBetweenRetry:p.default.timeBetweenOperationRetry,type:l.default.GET,url:M})},k.prototype.newMessageReceived=function(D,M,j){U.prototype.onNewMessage.call(this,D,M,j)},k.prototype.newThreadUpdate=function(D,M){U.prototype.onThreadUpdate.call(this,D,M)},k.prototype.handleNewMessageEvent=function(D){var M;M=D.resource&&D.resource.conversationid?D.resource.conversationid:x.default.getConversationIdFromUrl(D.resource.conversationLink?D.resource.conversationLink:D.resourceLink);var j=this.conversations.findIndex(function($){return $.id===M});this.newMessageReceived(this.conversations[j],D.resource,D.resourceType)},k.prototype.handleConversationUpdateEvent=function(D){},k.prototype.handleThreadUpdate=function(D){if(D.resourceType===m.default.ThreadUpdate){var M;M=D.resource&&D.resource.id?D.resource.id:x.default.getConversationIdFromUrl(D.resource.messages?D.resource.messages:D.resourceLink);var j=this.conversations.findIndex(function($){return $.id===M});this.newThreadUpdate(this.conversations[j],D.resource)}},k.prototype.handlePollData=function(D){if(D&&D.eventMessages)for(var M=0,j=D.eventMessages;M<j.length;M++)this.handlePollEventMessage(j[M])},k.prototype.handlePollEventMessage=function(D){D.resourceType===m.default.NewMessage||D.resourceType===m.default.MessageUpdate?this.handleNewMessageEvent(D):D.resourceType===m.default.ThreadUpdate?this.handleThreadUpdate(D):D.resourceType===m.default.ConversationUpdate&&this.handleConversationUpdateEvent(D)},k.prototype.updateToken=function(D){return _(this,void 0,void 0,function(){var M,j,W,$,ce,oe,Z,ue,he,Ee,K=this;return d(this,function(pe){switch(pe.label){case 0:return this.logger&&this.logger.log(g.default.INFO,S.default.UpdateToken,{EndpointUrl:this.EndpointUrl,EndpointId:this.ic3Info.endpointId}),M=[],j=function(re){re&&re.eventMessages&&N.default.concatArrays(M,re.eventMessages)},W=[],$=function(re){re&&re.eventMessages&&N.default.concatArrays(W,re.eventMessages)},ce=this.ic3Initializer,oe=new P.default,Z=this.updateTokenClearTimeoutHandle,ue=this.ic3Info,ce.getPoller().onNewData=j,this.logger?[4,oe.setup(this.logger)]:[3,2];case 1:pe.sent(),pe.label=2;case 2:return[2,oe.setIc3Info(D).then(function(){return oe.initializeIC3($)}).then(function(re){he=re}).then(function(){return K.getMatchingIC3EventIndex(M,W)}).then(function(re){Ee=re}).then(function(){return ce.reset(!0)}).then(function(){return K.syncPollingData(M,W,Ee)}).then(function(){K.ic3Info=he,K.ic3Initializer=oe,K.ic3Initializer.getPoller().onNewData=K.handlePollData.bind(K)}).catch(function(re){throw K.updateTokenClearTimeoutHandle!==Z&&(clearTimeout(K.updateTokenClearTimeoutHandle),K.updateTokenClearTimeoutHandle=Z),K.ic3Info=ue,K.ic3Initializer.getPoller().onNewData=K.handlePollData.bind(K),K.ic3Initializer.getPoller().start(),new Error("Update token failed: "+(re&&re.message))})]}})})},k.prototype.getMatchingIC3EventIndex=function(D,M,j){var W=this;return new Promise(function($,ce){if((j=j||0)===p.default.stabilizePollMaxRetryCount)$({newPollIndex:-1,previousPollIndex:-1});else{for(var oe=0,Z=0;oe<D.length&&Z<M.length;){var ue=D[oe];if(ue.time===M[Z].time)return void $({newPollIndex:Z,previousPollIndex:oe});new Date(ue.time)<new Date(ue.time)?oe++:Z++}setTimeout(function(){W.getMatchingIC3EventIndex(D,M,j+1).then(function(Ee){$(Ee)}).catch(function(Ee){ce(Ee)})},p.default.timeBetweenStabilizingPoll)}})},k.prototype.syncPollingData=function(D,M,j){this.logger&&this.logger.log(g.default.INFO,S.default.SyncingPollData,{EndpointUrl:this.EndpointUrl,EndpointId:this.ic3Info.endpointId});var W=j.previousPollIndex,$=j.newPollIndex+1;-1===j.previousPollIndex&&-1===j.newPollIndex&&(W=D.length-1,$=0);for(var ce=0;ce<=W;ce++)this.handlePollEventMessage(D[ce]);for(ce=$;ce<M.length;ce++)this.handlePollEventMessage(M[ce])},k}(C.default);u.default=F},7037:function(Q,u,c){"use strict";var s=this&&this.__awaiter||function(F,U,k,D){return new(k||(k=Promise))(function(j,W){function $(Z){try{oe(D.next(Z))}catch(ue){W(ue)}}function ce(Z){try{oe(D.throw(Z))}catch(ue){W(ue)}}function oe(Z){Z.done?j(Z.value):function(j){return j instanceof k?j:new k(function(W){W(j)})}(Z.value).then($,ce)}oe((D=D.apply(F,U||[])).next())})},_=this&&this.__generator||function(F,U){var D,M,j,W,k={label:0,sent:function(){if(1&j[0])throw j[1];return j[1]},trys:[],ops:[]};return W={next:$(0),throw:$(1),return:$(2)},"function"==typeof Symbol&&(W[Symbol.iterator]=function(){return this}),W;function $(oe){return function(Z){return function(oe){if(D)throw new TypeError("Generator is already executing.");for(;k;)try{if(D=1,M&&(j=2&oe[0]?M.return:oe[0]?M.throw||((j=M.return)&&j.call(M),0):M.next)&&!(j=j.call(M,oe[1])).done)return j;switch(M=0,j&&(oe=[2&oe[0],j.value]),oe[0]){case 0:case 1:j=oe;break;case 4:return k.label++,{value:oe[1],done:!1};case 5:k.label++,M=oe[1],oe=[0];continue;case 7:oe=k.ops.pop(),k.trys.pop();continue;default:if(!(j=(j=k.trys).length>0&&j[j.length-1])&&(6===oe[0]||2===oe[0])){k=0;continue}if(3===oe[0]&&(!j||oe[1]>j[0]&&oe[1]<j[3])){k.label=oe[1];break}if(6===oe[0]&&k.label<j[1]){k.label=j[1],j=oe;break}if(j&&k.label<j[2]){k.label=j[2],k.ops.push(oe);break}j[2]&&k.ops.pop(),k.trys.pop();continue}oe=U.call(F,k)}catch(Z){oe=[6,Z],M=0}finally{D=j=0}if(5&oe[0])throw oe[1];return{value:oe[0]?oe[1]:void 0,done:!0}}([oe,Z])}}};Object.defineProperty(u,"__esModule",{value:!0});var d=c(501),p=c(6849),T=c(5850),l=c(8311),C=c(6648),P=c(1927),S=c(909),f=c(3805),g=c(752),E=c(3671),b=c(9306),m=c(8636),I=c(2915),x=c(5874),N=function(){function F(){this.debug=!1,this.current404RetryCount=0,this.currentOtherRetryCount=0,this.skipUnsubscribe=!1,this.telemetryMessage="",this.errorCode="",this.pollDataHandler=function(U){},this.resetRetryCount()}return F.prototype.setup=function(U){return s(this,void 0,void 0,function(){return _(this,function(k){return this.logger=U,[2]})})},F.prototype.getPoller=function(){var U=this.pollDataHandler.bind(this);return this.poller||(this.poller=new f.default(this.ic3Info,U,this.redirectErrorHandler.bind(this),this.onRequestCreationFailure.bind(this))),this.poller},F.prototype.setIc3Info=function(U){return s(this,void 0,void 0,function(){var k;return _(this,function(D){return k={RegionGtms:JSON.parse(JSON.stringify(U.RegionGtms)),SkypeToken:U.SkypeToken,visitor:U.visitor},this.ic3Info=k,[2]})})},F.prototype.initializeIC3=function(U){var D,k=this;return U&&(this.pollDataHandler=U),null===(D=this.logger)||void 0===D||D.log(g.default.INFO,E.default.IC3InitializationBegins,{Description:"Endpoint to poll is "+JSON.stringify(this.ic3Info.RegionGtms.chatService),EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.createEndpoint().then(function(){return k.createSubscription()}).then(function(){return k.setEndpointProperty()}).then(function(){return k.startPolling(U)}).then(function(){return k.resetRetryCount()}).then(function(){return Promise.resolve(k.ic3Info)}).catch(function(j){return k.redirectErrorHandler(j)})},F.prototype.startPolling=function(U){var k,D=!U&&this.pollDataHandler?this.pollDataHandler.bind(this):this.pollDataHandler;this.poller||(this.poller=new f.default(this.ic3Info,D,this.redirectErrorHandler.bind(this),this.onRequestCreationFailure.bind(this))),this.poller.ic3Info=this.ic3Info,null===(k=this.logger)||void 0===k||k.log(g.default.INFO,E.default.IC3StartedPolling,{EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.poller.start()},F.prototype.stopPolling=function(U){var k;null===(k=this.logger)||void 0===k||k.log(g.default.INFO,E.default.IC3StoppedPolling,{Description:(U?d.default.oldInitializer:d.default.newInitializer)+" stopped polling.",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.poller&&this.poller.stop()},F.prototype.reset=function(U){return this.stopPolling(U),this.unsubscribeFromEndpoint()},F.prototype.resetRetryCount=function(){this.current404RetryCount=0,this.currentOtherRetryCount=0},F.prototype.onEndpointCreationFailure=function(U){this.onRequestCreationFailure(U,d.default.endpointRequestLog)},F.prototype.onEndpointCreationSuccess=function(U){var k,D,M=S.default.getResponseHeader(U,p.default.SetRegistrationTokenHeader);S.default.isNullOrUndefined(M)||(this.ic3Info.RegistrationToken=S.default.getRegistrationTokenValue(M));var j=S.default.getResponseHeader(U,p.default.LocationHeader);if(!S.default.isNullOrUndefined(j)){var W=j.match(/endpoints\/(%7B[\da-z\-]+%7D)/);this.ic3Info.endpointId=W&&W[1],null===(k=this.logger)||void 0===k||k.log(g.default.INFO,E.default.IC3EndpointCreationSuccess,{Description:"IC3 endpoint Id is "+this.ic3Info.endpointId,EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),U.status===b.default.Created&&m.default.parseChatServiceHostUrl(j)!==this.ic3Info.RegionGtms.chatService&&(this.ic3Info.RegionGtms.chatService=m.default.parseChatServiceHostUrl(j),null===(D=this.logger)||void 0===D||D.log(g.default.WARN,E.default.OnRequestCreationSuccessRedirect,{Description:"Endpoint changed",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}))}},F.prototype.createEndpointRequest=function(){var U=P.default.getV1EndpointUrl(this.ic3Info.RegionGtms),k=C.default.getDefaultIC3Headers();k[p.default.AuthenticationHeader]=p.default.SkypeTokenHeaderValue+this.ic3Info.SkypeToken,k[p.default.ContentTypeHeader]=d.default.ContentTypeJson;var M={endpointFeatures:[l.default.Agent,l.default.InviteFree,l.default.MessageProperties].join(",")},j={callbackOnFailure:this.onEndpointCreationFailure.bind(this),callbackOnSuccess:this.onEndpointCreationSuccess.bind(this),data:JSON.stringify(M),enableExponentialBackoff:!0,headers:k,redirect404RetryCount:d.default.retryCount,retryCount:d.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:m.default.shouldRetryOnFailure,timeBetweenRetry:d.default.timeBetweenOperationRetry,type:x.default.POST,url:U};return I.HttpClient.MakeRequest(j)},F.prototype.createEndpoint=function(){var U=this;return this.createEndpointRequest().then(function(k){return k.subscriptions&&k.subscriptions.length>0&&(U.ic3Info.subscriptionId=k.subscriptions[0].id),k})},F.prototype.onSubscriptionCreationFailure=function(U){this.onRequestCreationFailure(U,d.default.subscriptionRequestLog)},F.prototype.onSubscriptionCreationSuccess=function(U){var k,D=S.default.getResponseHeader(U,p.default.LocationHeader)||"";U.status===b.default.Created&&!S.default.isNullOrUndefined(D)&&m.default.parseChatServiceHostUrl(D)!==this.ic3Info.RegionGtms.chatService&&(this.ic3Info.RegionGtms.chatService=m.default.parseChatServiceHostUrl(D),null===(k=this.logger)||void 0===k||k.log(g.default.WARN,E.default.OnRequestCreationSuccessRedirect,{Description:"Endpoint changed",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}));var M=D.match(/\/(\d+)$/);M&&(this.ic3Info.subscriptionId=M[1])},F.prototype.createSubscriptionRequest=function(){var U=P.default.getV1SubscriptionUrl(this.ic3Info.RegionGtms),k=C.default.getDefaultIC3Headers();k[p.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,k[p.default.ContentTypeHeader]=d.default.ContentTypeJson;var D={channelType:d.default.HttpLongPoll,interestedResources:[T.default.ConversationMessages,T.default.ConversationProperties,T.default.Threads,T.default.Contacts]},M={callbackOnFailure:this.onSubscriptionCreationFailure.bind(this),callbackOnSuccess:this.onSubscriptionCreationSuccess.bind(this),data:JSON.stringify(D),enableExponentialBackoff:!0,headers:k,redirect404RetryCount:d.default.retryCount,retryCount:d.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:m.default.shouldRetryOnFailure,timeBetweenRetry:d.default.timeBetweenOperationRetry,type:x.default.POST,url:U};return I.HttpClient.MakeRequest(M)},F.prototype.createSubscription=function(){return this.createSubscriptionRequest()},F.prototype.onSetEndpointPropertyCreationFailure=function(U){this.onRequestCreationFailure(U,d.default.setPropertiesRequestLog)},F.prototype.setEndpointProperty=function(){if(this.ic3Info.visitor)return Promise.resolve();var U=P.default.getV1SetPropertiesUrl(this.ic3Info.RegionGtms),k={};k[p.default.SetEndpointProperty]=!0;var M=C.default.getDefaultIC3Headers();M[p.default.AuthenticationHeader]=p.default.SkypeTokenHeaderValue+this.ic3Info.SkypeToken,M[p.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,M[p.default.ContentTypeHeader]=d.default.ContentTypeJson;var j={callbackOnFailure:this.onSetEndpointPropertyCreationFailure.bind(this),data:JSON.stringify(k),enableExponentialBackoff:!0,headers:M,redirect404RetryCount:d.default.retryCount,retryCount:d.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:m.default.shouldRetryOnFailure,timeBetweenRetry:d.default.timeBetweenOperationRetry,type:x.default.PUT,url:U};return I.HttpClient.MakeRequest(j)},F.prototype.onUnsubscribeCreationFailure=function(U){this.onRequestCreationFailure(U,d.default.unsubscribeRequestLog)},F.prototype.unsubscribeFromEndpoint=function(){if(this.ic3Info.visitor||S.default.isNullOrUndefined(this.ic3Info.endpointId)||this.skipUnsubscribe)return this.skipUnsubscribe=!0,Promise.resolve();var U=P.default.getV1DeleteEndpointUrl(this.ic3Info.RegionGtms,this.ic3Info.endpointId),k=C.default.getDefaultIC3Headers();k[p.default.AuthenticationHeader]=p.default.SkypeTokenHeaderValue+this.ic3Info.SkypeToken,k[p.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,k[p.default.ContentTypeHeader]=d.default.ContentTypeJson;var D={callbackOnFailure:this.onUnsubscribeCreationFailure.bind(this),enableExponentialBackoff:!0,headers:k,redirect404RetryCount:d.default.retryCount,retryCount:d.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:m.default.shouldRetryOnFailure,timeBetweenRetry:d.default.timeBetweenOperationRetry,type:x.default.DELETE,url:U};return I.HttpClient.MakeRequest(D)},F.prototype.onRequestCreationFailure=function(U,k){var D,M,j=S.default.getResponseHeader(U,p.default.LocationHeader);this.telemetryMessage=k+" failed. Error Code: "+U.status+".",this.errorCode=U.status.toString(),this.skipUnsubscribe=!0,U.status!==b.default.Redirect||S.default.isNullOrEmptyString(j)?(null===(M=this.logger)||void 0===M||M.log(g.default.WARN,E.default.ResetOnRequestCreationFailure,{Description:this.telemetryMessage+" Trying to reset.",ErrorCode:U.status.toString(),EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.current404RetryCount=0,this.currentOtherRetryCount++):(null===(D=this.logger)||void 0===D||D.log(g.default.WARN,E.default.RedirectOnRequestCreationFailure,{Description:this.telemetryMessage+" Trying to redirect.",ErrorCode:U.status.toString(),EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.onRequestCreationFailureRedirect(U))},F.prototype.redirectErrorHandler=function(U){var D,k=this;return U.message===d.default.Reset_Flag&&this.current404RetryCount<=d.default.retry404Count&&this.currentOtherRetryCount<=d.default.retryCount?this.reset().then(function(){return k.initializeIC3()}):(null===(D=this.logger)||void 0===D||D.log(g.default.ERROR,E.default.MaxRetryCountReachedForRedirect,{Description:"Fatal Error. Initialization failed. Maximum retry count reached. Exiting. "+this.telemetryMessage,ErrorCode:this.errorCode,ExceptionDetails:U,EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.reset().then(function(){return Promise.reject(U.message)}))},F.prototype.onRequestCreationFailureRedirect=function(U){var k;this.current404RetryCount++,this.currentOtherRetryCount=0,this.ic3Info.RegionGtms.chatService=m.default.parseChatServiceHostUrl(S.default.getResponseHeader(U,p.default.LocationHeader)),null===(k=this.logger)||void 0===k||k.log(g.default.WARN,E.default.OnRequestCreationFailureRedirect,{Description:"Endpoint changed.",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId})},F}();u.default=N},9202:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(2518),_=c(1356),d=function(){function p(){}return p.getSDK=function(T){return new Promise(function(l){var P=s.default.getClientBridge({hostType:T.hostType,protocolType:T.protocolType}),S={logger:new _.default(P,T.logger)};return P.setup(S).then(function(){var f={dispose:P.dispose.bind(P),id:P.id,initialize:P.initialize.bind(P),joinConversation:P.joinConversation.bind(P),update:P.update.bind(P),setDebug:P.setDebug.bind(P)};return l(f)})})},p}();u.default=d},2915:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.HttpClient=void 0;var s=c(909),_=c(501),d=c(3671),p=c(752),T=c(6849),l=c(9306),C=c(8686),P=function(){function S(){}return S.MakeRequest=function(f){return new Promise(function(E,b){var x=0,N=f.retryCount||1,F={url:f.url,method:f.type,data:f.data,timeout:f.timeout,headers:f.headers,withCredentials:f.useXHRWithCredentials||!1},U=function(){C.default.request(F).then(function(k){!function(k,D){if(D.status>=400){var M={ResponseText:D.statusText,Status:status};S.logWarning("Requesting "+f.url,D.status,M)}f.callbackOnSuccess&&f.callbackOnSuccess(D),E(k)}(k.data,k)}).catch(function(k){!function(k){var D,M,j,W,$,ce,oe,Z,ue,he,Ee={ErrorThrown:k.message,ResponseText:null===(D=k.response)||void 0===D?void 0:D.statusText,Status:null===(M=k.response)||void 0===M?void 0:M.status},se=function(){var ne,te;S.logError("Request to "+f.url+" failed.",(null===(ne=k.response)||void 0===ne?void 0:ne.status)||0,Ee),b(new Error((null===(te=k.response)||void 0===te?void 0:te.statusText)||""))},K=function(){var ne;S.logError("Request to "+f.url+" failed. Resetting endpoint.",(null===(ne=k.response)||void 0===ne?void 0:ne.status)||0,Ee),f.callbackOnFailure&&f.callbackOnFailure(k),b(new Error(_.default.Reset_Flag))},pe=function(){var ne;x++;var te=f.timeBetweenRetry||0;(f.enableExponentialBackoff||(null===(ne=k.response)||void 0===ne?void 0:ne.status)===l.default.TooManyRequests)&&(te*=Math.exp(x)),setTimeout(function(){U()},te)},re=null===(j=k.response)||void 0===j?void 0:j.headers[T.default.LocationHeader],J=null===(W=k.response)||void 0===W?void 0:W.headers[T.default.SetRegistrationTokenHeader];(null===($=k.response)||void 0===$?void 0:$.status)!==l.default.Redirect||s.default.isNullOrEmptyString(re)?(null===(ce=k.response)||void 0===ce?void 0:ce.status)!==l.default.Unauthorized&&(null===(oe=k.response)||void 0===oe?void 0:oe.status)!==l.default.Forbidden||s.default.isNullOrEmptyString(J)?x<=N&&f.shouldRetryOnFailure&&f.shouldRetryOnFailure((null===(ue=k.response)||void 0===ue?void 0:ue.status)||0)||(null===(he=k.response)||void 0===he?void 0:he.status)===l.default.TooManyRequests?pe():f.shouldResetOnFailure?K():se():x<=N&&f.shouldRetryOnFailure&&f.shouldRetryOnFailure((null===(Z=k.response)||void 0===Z?void 0:Z.status)||0)?(f.headers&&(f.headers[T.default.RegistrationTokenHeader]=s.default.getRegistrationTokenValue(J)),pe()):f.shouldResetOnFailure?K():se():f.shouldRedirectOn404?K():x<=N?(f.url=re,pe()):se()}(k)})};U()})},S.isClientError=function(f){if(!f)return!1;var g=f.message,E=!1;return s.default.isNullOrEmptyString(g)||(E=g.search(/Status- 40\d/)>=-1),E},S.setLogger=function(f){S.logger=f},S.logError=function(f,g,E){S.logger&&S.logger.log(p.default.ERROR,d.default.HTTPRequestFailed,{Description:f,ErrorCode:g.toString(),ExceptionDetails:E})},S.logWarning=function(f,g,E){S.logger&&S.logger.log(p.default.INFO,d.default.HTTPRequestUnusualResponse,{Description:f,ErrorCode:g.toString(),ExceptionDetails:E})},S}();u.HttpClient=P},9306:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.OK=200,s.Created=201,s.Accepted=202,s.NoContent=204,s.Unauthorized=401,s.Forbidden=403,s.Redirect=404,s.TooManyRequests=429,s.InternalServerError=500,s.ServiceUnavailable=503,s.NotFound=729,s}();u.default=c},5256:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.TEXT="text",s}();u.default=c},6849:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.LocationHeader="location",s.SetRegistrationTokenHeader="set-registrationtoken",s.RegistrationTokenHeader="RegistrationToken",s.RegistrationTokenHeaderValue="registrationToken=",s.ContentTypeHeader="content-type",s.AuthenticationHeader="authentication",s.BehaviorOverrideHeader="behavioroverride",s.SkypeTokenHeaderValue="skypetoken=",s.SetEndpointProperty="supportsMessageProperties",s}();u.default=c},5874:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).GET="get",s.POST="post",s.PUT="put",s.DELETE="delete",c;var s})();u.default=c},6648:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(501),_=c(737),d=function(){function p(){}return p.getDefaultIC3Headers=function(){return{Accept:s.default.ContentTypeJson,BehaviorOverride:s.default.RedirectAs404,ClientInfo:s.default.ClientInfoValue,ContextId:"tcid="+(0,_.uuidv4)(),Expires:0,Pragma:s.default.NoCache,"x-ms-client-type":s.default.Web,"x-ms-user-type":s.default.User}},p.getDefaultBaseIC3Headers=function(){return{Accept:s.default.ContentTypeJson,BehaviorOverride:s.default.RedirectAs404,"content-type":s.default.ContentTypeJson}},p.getDefaultGetMessagesQueryParameters=function(){return{pageSize:20,startTime:0,view:"msnp24Equivalent|supportsMessageProperties"}},p.getDefaultAMSHeaders=function(T){return{Authorization:s.default.AMSAuthorizationSkypeTokenValue+T,"X-MS-Client-Version":s.default.ClientInfoValue}},p.getDefaultAMSViewHeaders=function(T){return{Accept:s.default.AMSAcceptHeaderValue,"Accept-Encoding":s.default.AMSAcceptEncodingHeaderValue,Authorization:s.default.AMSAuthorizationSkypeTokenValue+T,"X-MS-Client-Version":s.default.ClientInfoValue}},p}();u.default=d},6194:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.SDKProvider=void 0;var s=c(9202);u.SDKProvider=s.default},2217:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.IFrame=0,s.Page=1,s}();u.default=c},5655:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.IC3V1SDK=0,s.IC3V2SDK=1,s.MockIC3SDK=2,s}();u.default=c},3671:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).JoinConversation="JoinConversation",s.RegisterOnNewMessage="RegisterOnNewMessage",s.RegisterOnThreadUpdate="RegisterOnThreadUpdate",s.OnNewMessageFailure="OnNewMessageFailure",s.OnThreadUpdateFailure="OnThreadUpdateFailure",s.SendLiveStateFailure="SendLiveStateFailure",s.JoinConversationV1GetThreadRequestFailed="JoinConversationV1GetThreadRequestFailed",s.UpdateToken="UpdateToken",s.SyncingPollData="SyncingPollData",s.IC3InitializationBegins="IC3InitializationBegins",s.IC3StartedPolling="IC3StartedPolling",s.IC3StoppedPolling="IC3StoppedPolling",s.IC3EndpointCreationSuccess="IC3EndpointCreationSuccess",s.RedirectOnRequestCreationFailure="RedirectOnRequestCreationFailure",s.ResetOnRequestCreationFailure="ResetOnRequestCreationFailure",s.MaxRetryCountReachedForRedirect="MaxRetryCountReachedForRedirect",s.OnRequestCreationFailureRedirect="OnRequestCreationFailureRedirect",s.OnRequestCreationSuccessRedirect="OnRequestCreationSuccessRedirect",s.ErrorDuringPolling="ErrorDuringPolling",s.HTTPRequestFailed="HTTPRequestFailed",s.HTTPRequestUnusualResponse="HTTPRequestUnusualResponse",c;var s})();u.default=c},752:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR",c;var s})();u.default=c},1356:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(909),_=c(8261),d=function(){function p(T,l){this.sdk=T,this.logger=l}return p.prototype.log=function(T,l,C){if(this.isLoggingEnabled()){var P=_.default.getTelemetryEventData(this.sdk,l,C);this.logEvent(T,P)}},p.prototype.logEvent=function(T,l){this.isLoggingEnabled()&&setTimeout(this.logger.logClientSdkTelemetryEvent.bind(this.logger),0,T,l)},p.prototype.isLoggingEnabled=function(){return!s.default.isNullOrUndefined(this.logger)},p}();u.default=d},8261:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.getTelemetryEventData=function(_,d,p){return{Description:p.Description,ElapsedTimeInMilliseconds:p.ElapsedTimeInMilliseconds,EndpointUrl:p.EndpointUrl,EndpointId:p.EndpointId,ErrorCode:p.ErrorCode,Event:d,ExceptionDetails:p.ExceptionDetails,ShouldBubbleToHost:p.ShouldBubbleToHost,SubscriptionId:_.id}},s}();u.default=c},2900:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.Bridged="bridged",s.Unbridged="unbridged",s}();u.default=c},4694:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={}))[s.AmsBasedFileSharing=0]="AmsBasedFileSharing",c;var s})();u.default=c},6355:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={}))[s.Unknown=0]="Unknown",s[s.InProgress=1]="InProgress",s[s.Success=2]="Success",s[s.Error=3]="Error",c;var s})();u.default=c},5850:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.ConversationProperties="/v1/users/ME/conversations/ALL/properties",s.ConversationMessages="/v1/users/ME/conversations/ALL/messages",s.Threads="/v1/threads/ALL",s.Contacts="/v1/users/ME/contacts/ALL",s}();u.default=c},8311:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.Agent="Agent",s.MessageProperties="MessageProperties",s.InviteFree="InviteFree",s}();u.default=c},448:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.RichText="RichText",s.Text="Text",s}();u.default=c},3207:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.Text="Text",s.RichText="RichText",s.RichTextHtml="RichText/Html",s.ControlTyping="Control/Typing",s.ControlClearTyping="Control/ClearTyping",s.LiveState="Control/LiveState",s}();u.default=c},3372:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.UserMessage="UserMessage",s.SwiftCard="SwiftCard",s.Typing="Control/Typing",s.ClearTyping="Control/ClearTyping",s.LiveState="Control/LiveState",s}();u.default=c},4352:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={}))[s.Unknown=0]="Unknown",s[s.User=1]="User",s[s.Bot=2]="Bot",c;var s})();u.default=c},5785:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(){function s(){}return s.NewMessage="NewMessage",s.MessageUpdate="MessageUpdate",s.UserPresence="UserPresence",s.ConversationUpdate="ConversationUpdate",s.ThreadUpdate="ThreadUpdate",s}();u.default=c},7708:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=(()=>{return(s=c||(c={}))[s.Typing=0]="Typing",s[s.ClearTyping=1]="ClearTyping",c;var s})();u.default=c},3805:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(1927),_=c(2553),d=c(501),p=function(){function T(l,C,P,S){this.isPolling=!1,this._ic3Info=l,this._onNewData=C,this._onError=P,this.callbackOnFailure=S}return T.prototype.start=function(){return this.isPolling||(this.isPolling=!0,this.startPolling()),Promise.resolve()},T.prototype.stop=function(){return this.isPolling=!1,Promise.resolve()},Object.defineProperty(T.prototype,"onNewData",{get:function(){return this._onNewData},set:function(l){this._onNewData=l},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"onError",{get:function(){return this._onError},set:function(l){this._onError=l},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"setCallbackOnFailure",{set:function(l){this.setCallbackOnFailure=l},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"ic3Info",{get:function(){return this._ic3Info},set:function(l){this._ic3Info=l},enumerable:!1,configurable:!0}),T.prototype.startPolling=function(){var l=this;this.isPolling&&this.poll().then(function(C){l.isPolling&&l._onNewData&&l._onNewData(C)}).catch(function(C){l._onError&&l._onError(C)}).then(function(){l.startPolling()})},T.prototype.poll=function(){var l=s.default.getV1PollUrl(this._ic3Info.RegionGtms,this._ic3Info.subscriptionId);return _.default.poll(l,this._ic3Info.RegistrationToken,this.callbackOnEachRequestCompleted.bind(this))},T.prototype.callbackOnEachRequestCompleted=function(l){this.callbackOnFailure(l,d.default.pollRequestLog)},T}();u.default=p},2553:(Q,u,c)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});var s=c(501),_=c(2915),d=c(6849),p=c(5874),T=c(6648),l=c(8636),C=function(){function P(){}return P.poll=function(S,f,g){var E=T.default.getDefaultIC3Headers();E[d.default.RegistrationTokenHeader]=f,E[d.default.ContentTypeHeader]=s.default.ContentTypeJson;var b=JSON.stringify({});return _.HttpClient.MakeRequest({callbackOnFailure:g,data:b,enableExponentialBackoff:!0,headers:E,redirect404RetryCount:s.default.retryCount,retryCount:s.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:l.default.shouldRetryOnFailure,timeBetweenRetry:s.default.timeBetweenOperationRetry,type:p.default.POST,url:S})},P}();u.default=C},737:(Q,u)=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.uuidv4=void 0,u.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var _=16*Math.random()|0;return("x"===s?_:3&_|8).toString(16)})}},8686:(Q,u,c)=>{Q.exports=c(5454)},4054:(Q,u,c)=>{"use strict";var s=c(9471),_=c(5650),d=c(300),p=c(7790),T=c(4634),l=c(1929),C=c(2984),P=c(5886);Q.exports=function(f){return new Promise(function(E,b){var m=f.data,I=f.headers,x=f.responseType;s.isFormData(m)&&delete I["Content-Type"];var N=new XMLHttpRequest;if(f.auth){var F=f.auth.username||"",U=f.auth.password?unescape(encodeURIComponent(f.auth.password)):"";I.Authorization="Basic "+btoa(F+":"+U)}var k=T(f.baseURL,f.url);function D(){if(N){var j="getAllResponseHeaders"in N?l(N.getAllResponseHeaders()):null;_(E,b,{data:x&&"text"!==x&&"json"!==x?N.response:N.responseText,status:N.status,statusText:N.statusText,headers:j,config:f,request:N}),N=null}}if(N.open(f.method.toUpperCase(),p(k,f.params,f.paramsSerializer),!0),N.timeout=f.timeout,"onloadend"in N?N.onloadend=D:N.onreadystatechange=function(){!N||4!==N.readyState||0===N.status&&(!N.responseURL||0!==N.responseURL.indexOf("file:"))||setTimeout(D)},N.onabort=function(){!N||(b(P("Request aborted",f,"ECONNABORTED",N)),N=null)},N.onerror=function(){b(P("Network Error",f,null,N)),N=null},N.ontimeout=function(){var W="timeout of "+f.timeout+"ms exceeded";f.timeoutErrorMessage&&(W=f.timeoutErrorMessage),b(P(W,f,f.transitional&&f.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",N)),N=null},s.isStandardBrowserEnv()){var M=(f.withCredentials||C(k))&&f.xsrfCookieName?d.read(f.xsrfCookieName):void 0;M&&(I[f.xsrfHeaderName]=M)}"setRequestHeader"in N&&s.forEach(I,function(W,$){void 0===m&&"content-type"===$.toLowerCase()?delete I[$]:N.setRequestHeader($,W)}),s.isUndefined(f.withCredentials)||(N.withCredentials=!!f.withCredentials),x&&"json"!==x&&(N.responseType=f.responseType),"function"==typeof f.onDownloadProgress&&N.addEventListener("progress",f.onDownloadProgress),"function"==typeof f.onUploadProgress&&N.upload&&N.upload.addEventListener("progress",f.onUploadProgress),f.cancelToken&&f.cancelToken.promise.then(function(W){!N||(N.abort(),b(W),N=null)}),m||(m=null),N.send(m)})}},5454:(Q,u,c)=>{"use strict";var s=c(9471),_=c(1533),d=c(3227),p=c(4018);function l(P){var S=new d(P),f=_(d.prototype.request,S);return s.extend(f,d.prototype,S),s.extend(f,S),f}var C=l(c(2567));C.Axios=d,C.create=function(S){return l(p(C.defaults,S))},C.Cancel=c(8728),C.CancelToken=c(701),C.isCancel=c(2130),C.all=function(S){return Promise.all(S)},C.spread=c(8908),C.isAxiosError=c(9541),Q.exports=C,Q.exports.default=C},8728:Q=>{"use strict";function u(c){this.message=c}u.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},u.prototype.__CANCEL__=!0,Q.exports=u},701:(Q,u,c)=>{"use strict";var s=c(8728);function _(d){if("function"!=typeof d)throw new TypeError("executor must be a function.");var p;this.promise=new Promise(function(C){p=C});var T=this;d(function(C){T.reason||(T.reason=new s(C),p(T.reason))})}_.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},_.source=function(){var p;return{token:new _(function(C){p=C}),cancel:p}},Q.exports=_},2130:Q=>{"use strict";Q.exports=function(c){return!(!c||!c.__CANCEL__)}},3227:(Q,u,c)=>{"use strict";var s=c(9471),_=c(7790),d=c(3976),p=c(6764),T=c(4018),l=c(3558),C=l.validators;function P(S){this.defaults=S,this.interceptors={request:new d,response:new d}}P.prototype.request=function(f){"string"==typeof f?(f=arguments[1]||{}).url=arguments[0]:f=f||{},(f=T(this.defaults,f)).method=f.method?f.method.toLowerCase():this.defaults.method?this.defaults.method.toLowerCase():"get";var g=f.transitional;void 0!==g&&l.assertOptions(g,{silentJSONParsing:C.transitional(C.boolean,"1.0.0"),forcedJSONParsing:C.transitional(C.boolean,"1.0.0"),clarifyTimeoutError:C.transitional(C.boolean,"1.0.0")},!1);var E=[],b=!0;this.interceptors.request.forEach(function(D){"function"==typeof D.runWhen&&!1===D.runWhen(f)||(b=b&&D.synchronous,E.unshift(D.fulfilled,D.rejected))});var I,m=[];if(this.interceptors.response.forEach(function(D){m.push(D.fulfilled,D.rejected)}),!b){var x=[p,void 0];for(Array.prototype.unshift.apply(x,E),x=x.concat(m),I=Promise.resolve(f);x.length;)I=I.then(x.shift(),x.shift());return I}for(var N=f;E.length;){var F=E.shift(),U=E.shift();try{N=F(N)}catch(k){U(k);break}}try{I=p(N)}catch(k){return Promise.reject(k)}for(;m.length;)I=I.then(m.shift(),m.shift());return I},P.prototype.getUri=function(f){return f=T(this.defaults,f),_(f.url,f.params,f.paramsSerializer).replace(/^\?/,"")},s.forEach(["delete","get","head","options"],function(f){P.prototype[f]=function(g,E){return this.request(T(E||{},{method:f,url:g,data:(E||{}).data}))}}),s.forEach(["post","put","patch"],function(f){P.prototype[f]=function(g,E,b){return this.request(T(b||{},{method:f,url:g,data:E}))}}),Q.exports=P},3976:(Q,u,c)=>{"use strict";var s=c(9471);function _(){this.handlers=[]}_.prototype.use=function(p,T,l){return this.handlers.push({fulfilled:p,rejected:T,synchronous:!!l&&l.synchronous,runWhen:l?l.runWhen:null}),this.handlers.length-1},_.prototype.eject=function(p){this.handlers[p]&&(this.handlers[p]=null)},_.prototype.forEach=function(p){s.forEach(this.handlers,function(l){null!==l&&p(l)})},Q.exports=_},4634:(Q,u,c)=>{"use strict";var s=c(5164),_=c(1540);Q.exports=function(p,T){return p&&!s(T)?_(p,T):T}},5886:(Q,u,c)=>{"use strict";var s=c(9570);Q.exports=function(d,p,T,l,C){var P=new Error(d);return s(P,p,T,l,C)}},6764:(Q,u,c)=>{"use strict";var s=c(9471),_=c(4284),d=c(2130),p=c(2567);function T(l){l.cancelToken&&l.cancelToken.throwIfRequested()}Q.exports=function(C){return T(C),C.headers=C.headers||{},C.data=_.call(C,C.data,C.headers,C.transformRequest),C.headers=s.merge(C.headers.common||{},C.headers[C.method]||{},C.headers),s.forEach(["delete","get","head","post","put","patch","common"],function(f){delete C.headers[f]}),(C.adapter||p.adapter)(C).then(function(f){return T(C),f.data=_.call(C,f.data,f.headers,C.transformResponse),f},function(f){return d(f)||(T(C),f&&f.response&&(f.response.data=_.call(C,f.response.data,f.response.headers,C.transformResponse))),Promise.reject(f)})}},9570:Q=>{"use strict";Q.exports=function(c,s,_,d,p){return c.config=s,_&&(c.code=_),c.request=d,c.response=p,c.isAxiosError=!0,c.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},c}},4018:(Q,u,c)=>{"use strict";var s=c(9471);Q.exports=function(d,p){p=p||{};var T={},l=["url","method","data"],C=["headers","auth","proxy","params"],P=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],S=["validateStatus"];function f(m,I){return s.isPlainObject(m)&&s.isPlainObject(I)?s.merge(m,I):s.isPlainObject(I)?s.merge({},I):s.isArray(I)?I.slice():I}function g(m){s.isUndefined(p[m])?s.isUndefined(d[m])||(T[m]=f(void 0,d[m])):T[m]=f(d[m],p[m])}s.forEach(l,function(I){s.isUndefined(p[I])||(T[I]=f(void 0,p[I]))}),s.forEach(C,g),s.forEach(P,function(I){s.isUndefined(p[I])?s.isUndefined(d[I])||(T[I]=f(void 0,d[I])):T[I]=f(void 0,p[I])}),s.forEach(S,function(I){I in p?T[I]=f(d[I],p[I]):I in d&&(T[I]=f(void 0,d[I]))});var E=l.concat(C).concat(P).concat(S),b=Object.keys(d).concat(Object.keys(p)).filter(function(I){return-1===E.indexOf(I)});return s.forEach(b,g),T}},5650:(Q,u,c)=>{"use strict";var s=c(5886);Q.exports=function(d,p,T){var l=T.config.validateStatus;T.status&&l&&!l(T.status)?p(s("Request failed with status code "+T.status,T.config,null,T.request,T)):d(T)}},4284:(Q,u,c)=>{"use strict";var s=c(9471),_=c(2567);Q.exports=function(p,T,l){var C=this||_;return s.forEach(l,function(S){p=S.call(C,p,T)}),p}},2567:(Q,u,c)=>{"use strict";var s=c(9471),_=c(2196),d=c(9570),p={"Content-Type":"application/x-www-form-urlencoded"};function T(S,f){!s.isUndefined(S)&&s.isUndefined(S["Content-Type"])&&(S["Content-Type"]=f)}var S,P={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(S=c(4054)),S),transformRequest:[function(f,g){return _(g,"Accept"),_(g,"Content-Type"),s.isFormData(f)||s.isArrayBuffer(f)||s.isBuffer(f)||s.isStream(f)||s.isFile(f)||s.isBlob(f)?f:s.isArrayBufferView(f)?f.buffer:s.isURLSearchParams(f)?(T(g,"application/x-www-form-urlencoded;charset=utf-8"),f.toString()):s.isObject(f)||g&&"application/json"===g["Content-Type"]?(T(g,"application/json"),function(S,f,g){if(s.isString(S))try{return(0,JSON.parse)(S),s.trim(S)}catch(E){if("SyntaxError"!==E.name)throw E}return(0,JSON.stringify)(S)}(f)):f}],transformResponse:[function(f){var g=this.transitional,m=!(g&&g.silentJSONParsing)&&"json"===this.responseType;if(m||g&&g.forcedJSONParsing&&s.isString(f)&&f.length)try{return JSON.parse(f)}catch(I){if(m)throw"SyntaxError"===I.name?d(I,this,"E_JSON_PARSE"):I}return f}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(f){return f>=200&&f<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};s.forEach(["delete","get","head"],function(f){P.headers[f]={}}),s.forEach(["post","put","patch"],function(f){P.headers[f]=s.merge(p)}),Q.exports=P},1533:Q=>{"use strict";Q.exports=function(c,s){return function(){for(var d=new Array(arguments.length),p=0;p<d.length;p++)d[p]=arguments[p];return c.apply(s,d)}}},7790:(Q,u,c)=>{"use strict";var s=c(9471);function _(d){return encodeURIComponent(d).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}Q.exports=function(p,T,l){if(!T)return p;var C;if(l)C=l(T);else if(s.isURLSearchParams(T))C=T.toString();else{var P=[];s.forEach(T,function(g,E){null==g||(s.isArray(g)?E+="[]":g=[g],s.forEach(g,function(m){s.isDate(m)?m=m.toISOString():s.isObject(m)&&(m=JSON.stringify(m)),P.push(_(E)+"="+_(m))}))}),C=P.join("&")}if(C){var S=p.indexOf("#");-1!==S&&(p=p.slice(0,S)),p+=(-1===p.indexOf("?")?"?":"&")+C}return p}},1540:Q=>{"use strict";Q.exports=function(c,s){return s?c.replace(/\/+$/,"")+"/"+s.replace(/^\/+/,""):c}},300:(Q,u,c)=>{"use strict";var s=c(9471);Q.exports=s.isStandardBrowserEnv()?{write:function(p,T,l,C,P,S){var f=[];f.push(p+"="+encodeURIComponent(T)),s.isNumber(l)&&f.push("expires="+new Date(l).toGMTString()),s.isString(C)&&f.push("path="+C),s.isString(P)&&f.push("domain="+P),!0===S&&f.push("secure"),document.cookie=f.join("; ")},read:function(p){var T=document.cookie.match(new RegExp("(^|;\\s*)("+p+")=([^;]*)"));return T?decodeURIComponent(T[3]):null},remove:function(p){this.write(p,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},5164:Q=>{"use strict";Q.exports=function(c){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(c)}},9541:Q=>{"use strict";Q.exports=function(c){return"object"==typeof c&&!0===c.isAxiosError}},2984:(Q,u,c)=>{"use strict";var s=c(9471);Q.exports=s.isStandardBrowserEnv()?function(){var T,d=/(msie|trident)/i.test(navigator.userAgent),p=document.createElement("a");function l(C){var P=C;return d&&(p.setAttribute("href",P),P=p.href),p.setAttribute("href",P),{href:p.href,protocol:p.protocol?p.protocol.replace(/:$/,""):"",host:p.host,search:p.search?p.search.replace(/^\?/,""):"",hash:p.hash?p.hash.replace(/^#/,""):"",hostname:p.hostname,port:p.port,pathname:"/"===p.pathname.charAt(0)?p.pathname:"/"+p.pathname}}return T=l(window.location.href),function(P){var S=s.isString(P)?l(P):P;return S.protocol===T.protocol&&S.host===T.host}}():function(){return!0}},2196:(Q,u,c)=>{"use strict";var s=c(9471);Q.exports=function(d,p){s.forEach(d,function(l,C){C!==p&&C.toUpperCase()===p.toUpperCase()&&(d[p]=l,delete d[C])})}},1929:(Q,u,c)=>{"use strict";var s=c(9471),_=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];Q.exports=function(p){var l,C,P,T={};return p&&s.forEach(p.split("\n"),function(f){if(P=f.indexOf(":"),l=s.trim(f.substr(0,P)).toLowerCase(),C=s.trim(f.substr(P+1)),l){if(T[l]&&_.indexOf(l)>=0)return;T[l]="set-cookie"===l?(T[l]?T[l]:[]).concat([C]):T[l]?T[l]+", "+C:C}}),T}},8908:Q=>{"use strict";Q.exports=function(c){return function(_){return c.apply(null,_)}}},3558:(Q,u,c)=>{"use strict";var s=c(8593),_={};["object","boolean","number","function","string","symbol"].forEach(function(C,P){_[C]=function(f){return typeof f===C||"a"+(P<1?"n ":" ")+C}});var d={},p=s.version.split(".");function T(C,P){for(var S=P?P.split("."):p,f=C.split("."),g=0;g<3;g++){if(S[g]>f[g])return!0;if(S[g]<f[g])return!1}return!1}_.transitional=function(P,S,f){var g=S&&T(S);function E(b,m){return"[Axios v"+s.version+"] Transitional option '"+b+"'"+m+(f?". "+f:"")}return function(b,m,I){if(!1===P)throw new Error(E(m," has been removed in "+S));return g&&!d[m]&&(d[m]=!0,console.warn(E(m," has been deprecated since v"+S+" and will be removed in the near future"))),!P||P(b,m,I)}},Q.exports={isOlderVersion:T,assertOptions:function(C,P,S){if("object"!=typeof C)throw new TypeError("options must be an object");for(var f=Object.keys(C),g=f.length;g-- >0;){var E=f[g],b=P[E];if(b){var m=C[E],I=void 0===m||b(m,E,C);if(!0!==I)throw new TypeError("option "+E+" must be "+I)}else if(!0!==S)throw Error("Unknown option "+E)}},validators:_}},9471:(Q,u,c)=>{"use strict";var s=c(1533),_=Object.prototype.toString;function d($){return"[object Array]"===_.call($)}function p($){return void 0===$}function g($){return null!==$&&"object"==typeof $}function E($){if("[object Object]"!==_.call($))return!1;var ce=Object.getPrototypeOf($);return null===ce||ce===Object.prototype}function x($){return"[object Function]"===_.call($)}function D($,ce){if(null!=$)if("object"!=typeof $&&($=[$]),d($))for(var oe=0,Z=$.length;oe<Z;oe++)ce.call(null,$[oe],oe,$);else for(var ue in $)Object.prototype.hasOwnProperty.call($,ue)&&ce.call(null,$[ue],ue,$)}Q.exports={isArray:d,isArrayBuffer:function($){return"[object ArrayBuffer]"===_.call($)},isBuffer:function($){return null!==$&&!p($)&&null!==$.constructor&&!p($.constructor)&&"function"==typeof $.constructor.isBuffer&&$.constructor.isBuffer($)},isFormData:function($){return"undefined"!=typeof FormData&&$ instanceof FormData},isArrayBufferView:function($){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView($):$&&$.buffer&&$.buffer instanceof ArrayBuffer},isString:function($){return"string"==typeof $},isNumber:function($){return"number"==typeof $},isObject:g,isPlainObject:E,isUndefined:p,isDate:function($){return"[object Date]"===_.call($)},isFile:function($){return"[object File]"===_.call($)},isBlob:function($){return"[object Blob]"===_.call($)},isFunction:x,isStream:function($){return g($)&&x($.pipe)},isURLSearchParams:function($){return"undefined"!=typeof URLSearchParams&&$ instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:D,merge:function M(){var $={};function ce(ue,he){$[he]=E($[he])&&E(ue)?M($[he],ue):E(ue)?M({},ue):d(ue)?ue.slice():ue}for(var oe=0,Z=arguments.length;oe<Z;oe++)D(arguments[oe],ce);return $},extend:function($,ce,oe){return D(ce,function(ue,he){$[he]=oe&&"function"==typeof ue?s(ue,oe):ue}),$},trim:function($){return $.trim?$.trim():$.replace(/^\s+|\s+$/g,"")},stripBOM:function($){return 65279===$.charCodeAt(0)&&($=$.slice(1)),$}}},3105:Q=>{"use strict";var s,u="object"==typeof Reflect?Reflect:null,c=u&&"function"==typeof u.apply?u.apply:function(k,D,M){return Function.prototype.apply.call(k,D,M)};s=u&&"function"==typeof u.ownKeys?u.ownKeys:Object.getOwnPropertySymbols?function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:function(k){return Object.getOwnPropertyNames(k)};var d=Number.isNaN||function(k){return k!=k};function p(){p.init.call(this)}Q.exports=p,Q.exports.once=function(U,k){return new Promise(function(D,M){function j($){U.removeListener(k,W),M($)}function W(){"function"==typeof U.removeListener&&U.removeListener("error",j),D([].slice.call(arguments))}F(U,k,W,{once:!0}),"error"!==k&&function(U,k,D){"function"==typeof U.on&&F(U,"error",k,{once:!0})}(U,j)})},p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var T=10;function l(U){if("function"!=typeof U)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof U)}function C(U){return void 0===U._maxListeners?p.defaultMaxListeners:U._maxListeners}function P(U,k,D,M){var j,W,$;if(l(D),void 0===(W=U._events)?(W=U._events=Object.create(null),U._eventsCount=0):(void 0!==W.newListener&&(U.emit("newListener",k,D.listener?D.listener:D),W=U._events),$=W[k]),void 0===$)$=W[k]=D,++U._eventsCount;else if("function"==typeof $?$=W[k]=M?[D,$]:[$,D]:M?$.unshift(D):$.push(D),(j=C(U))>0&&$.length>j&&!$.warned){$.warned=!0;var ce=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");ce.name="MaxListenersExceededWarning",ce.emitter=U,ce.type=k,ce.count=$.length,function(U){console&&console.warn&&console.warn(U)}(ce)}return U}function S(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(U,k,D){var M={fired:!1,wrapFn:void 0,target:U,type:k,listener:D},j=S.bind(M);return j.listener=D,M.wrapFn=j,j}function g(U,k,D){var M=U._events;if(void 0===M)return[];var j=M[k];return void 0===j?[]:"function"==typeof j?D?[j.listener||j]:[j]:D?function(U){for(var k=new Array(U.length),D=0;D<k.length;++D)k[D]=U[D].listener||U[D];return k}(j):b(j,j.length)}function E(U){var k=this._events;if(void 0!==k){var D=k[U];if("function"==typeof D)return 1;if(void 0!==D)return D.length}return 0}function b(U,k){for(var D=new Array(k),M=0;M<k;++M)D[M]=U[M];return D}function F(U,k,D,M){if("function"==typeof U.on)M.once?U.once(k,D):U.on(k,D);else{if("function"!=typeof U.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof U);U.addEventListener(k,function j(W){M.once&&U.removeEventListener(k,j),D(W)})}}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return T},set:function(U){if("number"!=typeof U||U<0||d(U))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+U+".");T=U}}),p.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(k){if("number"!=typeof k||k<0||d(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},p.prototype.getMaxListeners=function(){return C(this)},p.prototype.emit=function(k){for(var D=[],M=1;M<arguments.length;M++)D.push(arguments[M]);var j="error"===k,W=this._events;if(void 0!==W)j=j&&void 0===W.error;else if(!j)return!1;if(j){var $;if(D.length>0&&($=D[0]),$ instanceof Error)throw $;var ce=new Error("Unhandled error."+($?" ("+$.message+")":""));throw ce.context=$,ce}var oe=W[k];if(void 0===oe)return!1;if("function"==typeof oe)c(oe,this,D);else{var Z=oe.length,ue=b(oe,Z);for(M=0;M<Z;++M)c(ue[M],this,D)}return!0},p.prototype.on=p.prototype.addListener=function(k,D){return P(this,k,D,!1)},p.prototype.prependListener=function(k,D){return P(this,k,D,!0)},p.prototype.once=function(k,D){return l(D),this.on(k,f(this,k,D)),this},p.prototype.prependOnceListener=function(k,D){return l(D),this.prependListener(k,f(this,k,D)),this},p.prototype.off=p.prototype.removeListener=function(k,D){var M,j,W,$,ce;if(l(D),void 0===(j=this._events))return this;if(void 0===(M=j[k]))return this;if(M===D||M.listener===D)0==--this._eventsCount?this._events=Object.create(null):(delete j[k],j.removeListener&&this.emit("removeListener",k,M.listener||D));else if("function"!=typeof M){for(W=-1,$=M.length-1;$>=0;$--)if(M[$]===D||M[$].listener===D){ce=M[$].listener,W=$;break}if(W<0)return this;0===W?M.shift():function(U,k){for(;k+1<U.length;k++)U[k]=U[k+1];U.pop()}(M,W),1===M.length&&(j[k]=M[0]),void 0!==j.removeListener&&this.emit("removeListener",k,ce||D)}return this},p.prototype.removeAllListeners=function(k){var D,M,j;if(void 0===(M=this._events))return this;if(void 0===M.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==M[k]&&(0==--this._eventsCount?this._events=Object.create(null):delete M[k]),this;if(0===arguments.length){var $,W=Object.keys(M);for(j=0;j<W.length;++j)"removeListener"!==($=W[j])&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(D=M[k]))this.removeListener(k,D);else if(void 0!==D)for(j=D.length-1;j>=0;j--)this.removeListener(k,D[j]);return this},p.prototype.listeners=function(k){return g(this,k,!0)},p.prototype.rawListeners=function(k){return g(this,k,!1)},p.listenerCount=function(U,k){return"function"==typeof U.listenerCount?U.listenerCount(k):E.call(U,k)},p.prototype.listenerCount=E,p.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]}},6099:Q=>{function c(_){this.message=_}(c.prototype=new Error).name="InvalidCharacterError",Q.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(_){var d=String(_).replace(/=+$/,"");if(d.length%4==1)throw new c("'atob' failed: The string to be decoded is not correctly encoded.");for(var T,l,p=0,C=0,P="";l=d.charAt(C++);~l&&(T=p%4?64*T+l:l,p++%4)?P+=String.fromCharCode(255&T>>(-2*p&6)):0)l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(l);return P}},4400:(Q,u,c)=>{var s=c(6099);Q.exports=function(d){var p=d.replace(/-/g,"+").replace(/_/g,"/");switch(p.length%4){case 0:break;case 2:p+="==";break;case 3:p+="=";break;default:throw"Illegal base64url string!"}try{return function(d){return decodeURIComponent(s(d).replace(/(.)/g,function(p,T){var l=T.charCodeAt(0).toString(16).toUpperCase();return l.length<2&&(l="0"+l),"%"+l}))}(p)}catch(T){return s(p)}}},4934:(Q,u,c)=>{"use strict";var s=c(4400);function _(d){this.message=d}(_.prototype=new Error).name="InvalidTokenError",Q.exports=function(d,p){if("string"!=typeof d)throw new _("Invalid token specified");var T=!0===(p=p||{}).header?0:1;try{return JSON.parse(s(d.split(".")[T]))}catch(l){throw new _("Invalid token specified: "+l.message)}},Q.exports.InvalidTokenError=_},8228:Q=>{"use strict";var u=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function _(p){if(null==p)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}Q.exports=function(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de","5"===Object.getOwnPropertyNames(p)[0])return!1;for(var T={},l=0;l<10;l++)T["_"+String.fromCharCode(l)]=l;if("0123456789"!==Object.getOwnPropertyNames(T).map(function(S){return T[S]}).join(""))return!1;var P={};return"abcdefghijklmnopqrst".split("").forEach(function(S){P[S]=S}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},P)).join("")}catch(S){return!1}}()?Object.assign:function(p,T){for(var l,P,C=_(p),S=1;S<arguments.length;S++){for(var f in l=Object(arguments[S]))c.call(l,f)&&(C[f]=l[f]);if(u){P=u(l);for(var g=0;g<P.length;g++)s.call(l,P[g])&&(C[P[g]]=l[P[g]])}}return C}},5429:(Q,u,c)=>{"use strict";var _=c(8228),d=60103;if("function"==typeof Symbol&&Symbol.for){var f=Symbol.for;d=f("react.element"),f("react.portal"),f("react.fragment"),f("react.strict_mode"),f("react.profiler"),f("react.provider"),f("react.context"),f("react.forward_ref"),f("react.suspense"),f("react.memo"),f("react.lazy")}"function"==typeof Symbol&&Symbol;function b(re){for(var J="https://reactjs.org/docs/error-decoder.html?invariant="+re,ne=1;ne<arguments.length;ne++)J+="&args[]="+encodeURIComponent(arguments[ne]);return"Minified React error #"+re+"; visit "+J+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I={};function x(re,J,ne){this.props=re,this.context=J,this.refs=I,this.updater=ne||m}function N(){}function F(re,J,ne){this.props=re,this.context=J,this.refs=I,this.updater=ne||m}x.prototype.isReactComponent={},x.prototype.setState=function(re,J){if("object"!=typeof re&&"function"!=typeof re&&null!=re)throw Error(b(85));this.updater.enqueueSetState(this,re,J,"setState")},x.prototype.forceUpdate=function(re){this.updater.enqueueForceUpdate(this,re,"forceUpdate")},N.prototype=x.prototype;var U=F.prototype=new N;U.constructor=F,_(U,x.prototype),U.isPureReactComponent=!0;var k_current=null,D=Object.prototype.hasOwnProperty,M={key:!0,ref:!0,__self:!0,__source:!0};u.createElement=function(re,J,ne){var te,ae={},ve=null,ye=null;if(null!=J)for(te in void 0!==J.ref&&(ye=J.ref),void 0!==J.key&&(ve=""+J.key),J)D.call(J,te)&&!M.hasOwnProperty(te)&&(ae[te]=J[te]);var ge=arguments.length-2;if(1===ge)ae.children=ne;else if(1<ge){for(var be=Array(ge),Ae=0;Ae<ge;Ae++)be[Ae]=arguments[Ae+2];ae.children=be}if(re&&re.defaultProps)for(te in ge=re.defaultProps)void 0===ae[te]&&(ae[te]=ge[te]);return{$$typeof:d,type:re,key:ve,ref:ye,props:ae,_owner:k_current}}},8139:(Q,u,c)=>{"use strict";Q.exports=c(5429)},7941:Q=>{var u=function(c){"use strict";var d,s=Object.prototype,_=s.hasOwnProperty,p="function"==typeof Symbol?Symbol:{},T=p.iterator||"@@iterator",l=p.asyncIterator||"@@asyncIterator",C=p.toStringTag||"@@toStringTag";function P(se,K,pe){return Object.defineProperty(se,K,{value:pe,enumerable:!0,configurable:!0,writable:!0}),se[K]}try{P({},"")}catch(se){P=function(K,pe,re){return K[pe]=re}}function S(se,K,pe,re){var ne=Object.create((K&&K.prototype instanceof x?K:x).prototype),te=new ue(re||[]);return ne._invoke=function(se,K,pe){var re=g;return function(ne,te){if(re===b)throw new Error("Generator is already running");if(re===m){if("throw"===ne)throw te;return Ee()}for(pe.method=ne,pe.arg=te;;){var ae=pe.delegate;if(ae){var ve=ce(ae,pe);if(ve){if(ve===I)continue;return ve}}if("next"===pe.method)pe.sent=pe._sent=pe.arg;else if("throw"===pe.method){if(re===g)throw re=m,pe.arg;pe.dispatchException(pe.arg)}else"return"===pe.method&&pe.abrupt("return",pe.arg);re=b;var ye=f(se,K,pe);if("normal"===ye.type){if(re=pe.done?m:E,ye.arg===I)continue;return{value:ye.arg,done:pe.done}}"throw"===ye.type&&(re=m,pe.method="throw",pe.arg=ye.arg)}}}(se,pe,te),ne}function f(se,K,pe){try{return{type:"normal",arg:se.call(K,pe)}}catch(re){return{type:"throw",arg:re}}}c.wrap=S;var g="suspendedStart",E="suspendedYield",b="executing",m="completed",I={};function x(){}function N(){}function F(){}var U={};P(U,T,function(){return this});var k=Object.getPrototypeOf,D=k&&k(k(he([])));D&&D!==s&&_.call(D,T)&&(U=D);var M=F.prototype=x.prototype=Object.create(U);function j(se){["next","throw","return"].forEach(function(K){P(se,K,function(pe){return this._invoke(K,pe)})})}function W(se,K){function pe(ne,te,ae,ve){var ye=f(se[ne],se,te);if("throw"!==ye.type){var ge=ye.arg,be=ge.value;return be&&"object"==typeof be&&_.call(be,"__await")?K.resolve(be.__await).then(function(Ae){pe("next",Ae,ae,ve)},function(Ae){pe("throw",Ae,ae,ve)}):K.resolve(be).then(function(Ae){ge.value=Ae,ae(ge)},function(Ae){return pe("throw",Ae,ae,ve)})}ve(ye.arg)}var re;this._invoke=function(ne,te){function ae(){return new K(function(ve,ye){pe(ne,te,ve,ye)})}return re=re?re.then(ae,ae):ae()}}function ce(se,K){var pe=se.iterator[K.method];if(pe===d){if(K.delegate=null,"throw"===K.method){if(se.iterator.return&&(K.method="return",K.arg=d,ce(se,K),"throw"===K.method))return I;K.method="throw",K.arg=new TypeError("The iterator does not provide a 'throw' method")}return I}var re=f(pe,se.iterator,K.arg);if("throw"===re.type)return K.method="throw",K.arg=re.arg,K.delegate=null,I;var J=re.arg;return J?J.done?(K[se.resultName]=J.value,K.next=se.nextLoc,"return"!==K.method&&(K.method="next",K.arg=d),K.delegate=null,I):J:(K.method="throw",K.arg=new TypeError("iterator result is not an object"),K.delegate=null,I)}function oe(se){var K={tryLoc:se[0]};1 in se&&(K.catchLoc=se[1]),2 in se&&(K.finallyLoc=se[2],K.afterLoc=se[3]),this.tryEntries.push(K)}function Z(se){var K=se.completion||{};K.type="normal",delete K.arg,se.completion=K}function ue(se){this.tryEntries=[{tryLoc:"root"}],se.forEach(oe,this),this.reset(!0)}function he(se){if(se){var K=se[T];if(K)return K.call(se);if("function"==typeof se.next)return se;if(!isNaN(se.length)){var pe=-1,re=function J(){for(;++pe<se.length;)if(_.call(se,pe))return J.value=se[pe],J.done=!1,J;return J.value=d,J.done=!0,J};return re.next=re}}return{next:Ee}}function Ee(){return{value:d,done:!0}}return N.prototype=F,P(M,"constructor",F),P(F,"constructor",N),N.displayName=P(F,C,"GeneratorFunction"),c.isGeneratorFunction=function(se){var K="function"==typeof se&&se.constructor;return!!K&&(K===N||"GeneratorFunction"===(K.displayName||K.name))},c.mark=function(se){return Object.setPrototypeOf?Object.setPrototypeOf(se,F):(se.__proto__=F,P(se,C,"GeneratorFunction")),se.prototype=Object.create(M),se},c.awrap=function(se){return{__await:se}},j(W.prototype),P(W.prototype,l,function(){return this}),c.AsyncIterator=W,c.async=function(se,K,pe,re,J){void 0===J&&(J=Promise);var ne=new W(S(se,K,pe,re),J);return c.isGeneratorFunction(K)?ne:ne.next().then(function(te){return te.done?te.value:ne.next()})},j(M),P(M,C,"Generator"),P(M,T,function(){return this}),P(M,"toString",function(){return"[object Generator]"}),c.keys=function(se){var K=[];for(var pe in se)K.push(pe);return K.reverse(),function re(){for(;K.length;){var J=K.pop();if(J in se)return re.value=J,re.done=!1,re}return re.done=!0,re}},c.values=he,ue.prototype={constructor:ue,reset:function(se){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.method="next",this.arg=d,this.tryEntries.forEach(Z),!se)for(var K in this)"t"===K.charAt(0)&&_.call(this,K)&&!isNaN(+K.slice(1))&&(this[K]=d)},stop:function(){this.done=!0;var K=this.tryEntries[0].completion;if("throw"===K.type)throw K.arg;return this.rval},dispatchException:function(se){if(this.done)throw se;var K=this;function pe(ve,ye){return ne.type="throw",ne.arg=se,K.next=ve,ye&&(K.method="next",K.arg=d),!!ye}for(var re=this.tryEntries.length-1;re>=0;--re){var J=this.tryEntries[re],ne=J.completion;if("root"===J.tryLoc)return pe("end");if(J.tryLoc<=this.prev){var te=_.call(J,"catchLoc"),ae=_.call(J,"finallyLoc");if(te&&ae){if(this.prev<J.catchLoc)return pe(J.catchLoc,!0);if(this.prev<J.finallyLoc)return pe(J.finallyLoc)}else if(te){if(this.prev<J.catchLoc)return pe(J.catchLoc,!0)}else{if(!ae)throw new Error("try statement without catch or finally");if(this.prev<J.finallyLoc)return pe(J.finallyLoc)}}}},abrupt:function(se,K){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var re=this.tryEntries[pe];if(re.tryLoc<=this.prev&&_.call(re,"finallyLoc")&&this.prev<re.finallyLoc){var J=re;break}}J&&("break"===se||"continue"===se)&&J.tryLoc<=K&&K<=J.finallyLoc&&(J=null);var ne=J?J.completion:{};return ne.type=se,ne.arg=K,J?(this.method="next",this.next=J.finallyLoc,I):this.complete(ne)},complete:function(se,K){if("throw"===se.type)throw se.arg;return"break"===se.type||"continue"===se.type?this.next=se.arg:"return"===se.type?(this.rval=this.arg=se.arg,this.method="return",this.next="end"):"normal"===se.type&&K&&(this.next=K),I},finish:function(se){for(var K=this.tryEntries.length-1;K>=0;--K){var pe=this.tryEntries[K];if(pe.finallyLoc===se)return this.complete(pe.completion,pe.afterLoc),Z(pe),I}},catch:function(se){for(var K=this.tryEntries.length-1;K>=0;--K){var pe=this.tryEntries[K];if(pe.tryLoc===se){var re=pe.completion;if("throw"===re.type){var J=re.arg;Z(pe)}return J}}throw new Error("illegal catch attempt")},delegateYield:function(se,K,pe){return this.delegate={iterator:he(se),resultName:K,nextLoc:pe},"next"===this.method&&(this.arg=d),I}},c}(Q.exports);try{regeneratorRuntime=u}catch(c){"object"==typeof globalThis?globalThis.regeneratorRuntime=u:Function("r","regeneratorRuntime = r")(u)}},8952:(Q,u,c)=>{"use strict";function s(t){return"function"==typeof t}let _=!1;const d={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else _&&console.log("RxJS: Back to a better error behavior. Thank you. <3");_=t},get useDeprecatedSynchronousErrorHandling(){return _}};function p(t){setTimeout(()=>{throw t},0)}const T={closed:!0,next(t){},error(t){if(d.useDeprecatedSynchronousErrorHandling)throw t;p(t)},complete(){}},l=Array.isArray||(t=>t&&"number"==typeof t.length);function C(t){return null!==t&&"object"==typeof t}const S=(()=>{function t(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return t.prototype=Object.create(Error.prototype),t})();class f{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:i,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof f)n.remove(this);else if(null!==n)for(let a=0;a<n.length;++a)n[a].remove(this);if(s(i)){r&&(this._unsubscribe=void 0);try{i.call(this)}catch(a){e=a instanceof S?g(a.errors):[a]}}if(l(o)){let a=-1,h=o.length;for(;++a<h;){const A=o[a];if(C(A))try{A.unsubscribe()}catch(V){e=e||[],V instanceof S?e=e.concat(g(V.errors)):e.push(V)}}}if(e)throw new S(e)}add(e){let n=e;if(!e)return f.EMPTY;switch(typeof e){case"function":n=new f(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof f)){const o=n;n=new f,n._subscriptions=[o]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof f){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(e){const n=this._subscriptions;if(n){const r=n.indexOf(e);-1!==r&&n.splice(r,1)}}}var t;function g(t){return t.reduce((e,n)=>e.concat(n instanceof S?n.errors:n),[])}f.EMPTY=((t=new f).closed=!0,t);const E="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class m extends f{constructor(e,n,r){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=T;break;case 1:if(!e){this.destination=T;break}if("object"==typeof e){e instanceof m?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new I(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new I(this,e,n,r)}}[E](){return this}static create(e,n,r){const i=new m(e,n,r);return i.syncErrorThrowable=!1,i}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class I extends m{constructor(e,n,r,i){super(),this._parentSubscriber=e;let o,a=this;s(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==T&&(a=Object.create(n),s(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=r,this._complete=i}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:n}=this;d.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable?this.__tryOrSetError(n,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:n}=this,{useDeprecatedSynchronousErrorHandling:r}=d;if(this._error)r&&n.syncErrorThrowable?(this.__tryOrSetError(n,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(n.syncErrorThrowable)r?(n.syncErrorValue=e,n.syncErrorThrown=!0):p(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;p(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const n=()=>this._complete.call(this._context);d.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,n){try{e.call(this._context,n)}catch(r){if(this.unsubscribe(),d.useDeprecatedSynchronousErrorHandling)throw r;p(r)}}__tryOrSetError(e,n,r){if(!d.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,r)}catch(i){return d.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=i,e.syncErrorThrown=!0,!0):(p(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const F="function"==typeof Symbol&&Symbol.observable||"@@observable";function U(t){return t}let M=(()=>{class t{constructor(n){this._isScalar=!1,n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const{operator:o}=this,a=function(t,e,n){if(t){if(t instanceof m)return t;if(t[E])return t[E]()}return t||e||n?new m(t,e,n):new m(T)}(n,r,i);if(a.add(o?o.call(a,this.source):this.source||d.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),d.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(n){try{return this._subscribe(n)}catch(r){d.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=r),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof m?n:null}return!0}(n)?n.error(r):console.warn(r)}}forEach(n,r){return new(r=j(r))((i,o)=>{let a;a=this.subscribe(h=>{try{n(h)}catch(A){o(A),a&&a.unsubscribe()}},o,i)})}_subscribe(n){const{source:r}=this;return r&&r.subscribe(n)}[F](){return this}pipe(...n){return 0===n.length?this:function(t){return 0===t.length?U:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}(n)(this)}toPromise(n){return new(n=j(n))((r,i)=>{let o;this.subscribe(a=>o=a,a=>i(a),()=>r(o))})}}return t.create=e=>new t(e),t})();function j(t){if(t||(t=d.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const $=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class ce extends f{constructor(e,n){super(),this.subject=e,this.subscriber=n,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,n=e.observers;if(this.subject=null,!n||0===n.length||e.isStopped||e.closed)return;const r=n.indexOf(this.subscriber);-1!==r&&n.splice(r,1)}}class oe extends m{constructor(e){super(e),this.destination=e}}let Z=(()=>{class t extends M{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[E](){return new oe(this)}lift(n){const r=new ue(this,this);return r.operator=n,r}next(n){if(this.closed)throw new $;if(!this.isStopped){const{observers:r}=this,i=r.length,o=r.slice();for(let a=0;a<i;a++)o[a].next(n)}}error(n){if(this.closed)throw new $;this.hasError=!0,this.thrownError=n,this.isStopped=!0;const{observers:r}=this,i=r.length,o=r.slice();for(let a=0;a<i;a++)o[a].error(n);this.observers.length=0}complete(){if(this.closed)throw new $;this.isStopped=!0;const{observers:n}=this,r=n.length,i=n.slice();for(let o=0;o<r;o++)i[o].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(n){if(this.closed)throw new $;return super._trySubscribe(n)}_subscribe(n){if(this.closed)throw new $;return this.hasError?(n.error(this.thrownError),f.EMPTY):this.isStopped?(n.complete(),f.EMPTY):(this.observers.push(n),new ce(this,n))}asObservable(){const n=new M;return n.source=this,n}}return t.create=(e,n)=>new ue(e,n),t})();class ue extends Z{constructor(e,n){super(),this.destination=e,this.source=n}next(e){const{destination:n}=this;n&&n.next&&n.next(e)}error(e){const{destination:n}=this;n&&n.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:n}=this;return n?this.source.subscribe(e):f.EMPTY}}function he(t){return t&&"function"==typeof t.schedule}function Ee(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new se(t,e))}}class se{constructor(e,n){this.project=e,this.thisArg=n}call(e,n){return n.subscribe(new K(e,this.project,this.thisArg))}}class K extends m{constructor(e,n,r){super(e),this.project=n,this.count=0,this.thisArg=r||this}_next(e){let n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(n)}}const pe=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()},ne="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",ye=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function ge(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const be=t=>{if(t&&"function"==typeof t[F])return(t=>e=>{const n=t[F]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)})(t);if(ye(t))return pe(t);if(ge(t))return(t=>e=>(t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,p),e))(t);if(t&&"function"==typeof t[ne])return(t=>e=>{const n=t[ne]();for(;;){let r;try{r=n.next()}catch(i){return e.error(i),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e})(t);{const n=`You provided ${C(t)?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(n)}};function Ie(t,e){return new M(n=>{const r=new f;let i=0;return r.add(e.schedule(function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()})),r})}function $e(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[F]}(t))return function(t,e){return new M(n=>{const r=new f;return r.add(e.schedule(()=>{const i=t[F]();r.add(i.subscribe({next(o){r.add(e.schedule(()=>n.next(o)))},error(o){r.add(e.schedule(()=>n.error(o)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(ge(t))return function(t,e){return new M(n=>{const r=new f;return r.add(e.schedule(()=>t.then(i=>{r.add(e.schedule(()=>{n.next(i),r.add(e.schedule(()=>n.complete()))}))},i=>{r.add(e.schedule(()=>n.error(i)))}))),r})}(t,e);if(ye(t))return Ie(t,e);if(function(t){return t&&"function"==typeof t[ne]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new M(n=>{const r=new f;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[ne](),r.add(e.schedule(function(){if(n.closed)return;let o,a;try{const h=i.next();o=h.value,a=h.done}catch(h){return void n.error(h)}a?n.complete():(n.next(o),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof M?t:new M(be(t))}class Ye extends m{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class qe extends m{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function Gt(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(Gt((i,o)=>$e(t(i,o)).pipe(Ee((a,h)=>e(i,a,o,h))),n)):("number"==typeof e&&(n=e),r=>r.lift(new rr(t,n)))}class rr{constructor(e,n=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=n}call(e,n){return n.subscribe(new Tn(e,this.project,this.concurrent))}}class Tn extends qe{constructor(e,n,r=Number.POSITIVE_INFINITY){super(e),this.project=n,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let n;const r=this.index++;try{n=this.project(e,r)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(n)}_innerSub(e){const n=new Ye(this),r=this.destination;r.add(n);const i=function(t,e){if(e.closed)return;if(t instanceof M)return t.subscribe(e);let n;try{n=be(t)(e)}catch(r){e.error(r)}return n}(e,n);i!==n&&r.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function ke(t=Number.POSITIVE_INFINITY){return Gt(U,t)}function ze(t,e){return e?Ie(t,e):new M(pe(t))}function bt(){return function(e){return e.lift(new Nt(e))}}class Nt{constructor(e){this.connectable=e}call(e,n){const{connectable:r}=this;r._refCount++;const i=new Pt(e,r),o=n.subscribe(i);return i.closed||(i.connection=r.connect()),o}}class Pt extends m{constructor(e,n){super(e),this.connectable=n}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const n=e._refCount;if(n<=0)return void(this.connection=null);if(e._refCount=n-1,n>1)return void(this.connection=null);const{connection:r}=this,i=e._connection;this.connection=null,i&&(!r||i===r)&&i.unsubscribe()}}class an extends M{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new f,e.add(this.source.subscribe(new si(this.getSubject(),this))),e.closed&&(this._connection=null,e=f.EMPTY)),e}refCount(){return bt()(this)}}const Ot=(()=>{const t=an.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class si extends oe{constructor(e,n){super(e),this.connectable=n}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const n=e._connection;e._refCount=0,e._subject=null,e._connection=null,n&&n.unsubscribe()}}}function Ys(){return new Z}function Ht(t){for(let e in t)if(t[e]===Ht)return e;throw Error("Could not find renamed property on target object.")}function It(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(It).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function cs(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const fu=Ht({__forward_ref__:Ht});function ls(t){return t.__forward_ref__=ls,t.toString=function(){return It(this())},t}function at(t){return function(t){return"function"==typeof t&&t.hasOwnProperty(fu)&&t.__forward_ref__===ls}(t)?t():t}class Er extends Error{constructor(e,n){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(e,n)),this.code=e}}function On(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():function(t){return"string"==typeof t?t:null==t?"":String(t)}(t)}function ai(t,e){const n=e?` in ${e}`:"";throw new Er("201",`No provider for ${On(t)} found${n}`)}function hn(t,e){null==t&&function(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function Ft(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Wr(t){return{providers:t.providers||[],imports:t.imports||[]}}function xr(t){return ps(t,Fi)||ps(t,ms)}function ps(t,e){return t.hasOwnProperty(e)?t[e]:null}function gs(t){return t&&(t.hasOwnProperty(xo)||t.hasOwnProperty(Cu))?t[xo]:null}const Fi=Ht({\u0275prov:Ht}),xo=Ht({\u0275inj:Ht}),ms=Ht({ngInjectableDef:Ht}),Cu=Ht({ngInjectorDef:Ht});var rt=(()=>((rt=rt||{})[rt.Default=0]="Default",rt[rt.Host=1]="Host",rt[rt.Self=2]="Self",rt[rt.SkipSelf=4]="SkipSelf",rt[rt.Optional=8]="Optional",rt))();let po;function _r(t){const e=po;return po=t,e}function Ui(t,e,n){const r=xr(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&rt.Optional?null:void 0!==e?e:void ai(It(t),"Injector")}function Qn(t){return{toString:t}.toString()}var Hn=(()=>((Hn=Hn||{})[Hn.OnPush=0]="OnPush",Hn[Hn.Default=1]="Default",Hn))(),rn=(()=>((rn=rn||{})[rn.Emulated=0]="Emulated",rn[rn.None=2]="None",rn[rn.ShadowDom=3]="ShadowDom",rn))();const vs="undefined"!=typeof globalThis&&globalThis,Vi="undefined"!=typeof window&&window,Lo="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Wc="undefined"!=typeof global&&global,Dt=vs||Wc||Vi||Lo,Fr={},$t=[],zr=Ht({\u0275cmp:Ht}),li=Ht({\u0275dir:Ht}),Cs=Ht({\u0275pipe:Ht}),Ts=Ht({\u0275mod:Ht}),bu=Ht({\u0275loc:Ht}),Ur=Ht({\u0275fac:Ht}),di=Ht({__NG_ELEMENT_ID__:Ht});let Bi=0;function ji(t){return Qn(()=>{const n={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Hn.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||$t,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||rn.Emulated,id:"c",styles:t.styles||$t,_:null,setInput:null,schemas:t.schemas||null,tView:null},i=t.directives,o=t.features,a=t.pipes;return r.id+=Bi++,r.inputs=hi(t.inputs,n),r.outputs=hi(t.outputs),o&&o.forEach(h=>h(r)),r.directiveDefs=i?()=>("function"==typeof i?i():i).map(Fo):null,r.pipeDefs=a?()=>("function"==typeof a?a():a).map(Uo):null,r})}function Fo(t){return pn(t)||function(t){return t[li]||null}(t)}function Uo(t){return function(t){return t[Cs]||null}(t)}const fi={};function wr(t){return Qn(()=>{const e={type:t.type,bootstrap:t.bootstrap||$t,declarations:t.declarations||$t,imports:t.imports||$t,exports:t.exports||$t,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(fi[t.id]=t.type),e})}function hi(t,e){if(null==t)return Fr;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}const Ln=ji;function pn(t){return t[zr]||null}function sr(t,e){const n=t[Ts]||null;if(!n&&!0===e)throw new Error(`Type ${It(t)} does not have '\u0275mod' property.`);return n}function pr(t){return Array.isArray(t)&&"object"==typeof t[1]}function gr(t){return Array.isArray(t)&&!0===t[1]}function bs(t){return 0!=(8&t.flags)}function mo(t){return 2==(2&t.flags)}function yo(t){return 1==(1&t.flags)}function ar(t){return null!==t.template}function oa(t){return 0!=(512&t[2])}function yi(t,e){return t.hasOwnProperty(Ur)?t[Ur]:null}class vi{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Du(t){return t.type.prototype.ngOnChanges&&(t.setInput=Ru),Ss}function Ss(){const t=un(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===Fr)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function Ru(t,e,n,r){const i=un(t)||function(t,e){return t[Au]=e}(t,{previous:Fr,current:null}),o=i.current||(i.current={}),a=i.previous,h=this.declaredInputs[n],A=a[h];o[h]=new vi(A&&A.currentValue,e,a===Fr),t[r]=e}const Au="__ngSimpleChanges__";function un(t){return t[Au]||null}let Is;function mn(t){return!!t.listen}const da={createRenderer:(t,e)=>void 0!==Is?Is:"undefined"!=typeof document?document:void 0};function yn(t){for(;Array.isArray(t);)t=t[0];return t}function Wn(t,e){return yn(e[t.index])}function Go(t,e){return t.data[e]}function Yn(t,e){const n=e[t];return pr(n)?n:n[0]}function $o(t){return 128==(128&t[2])}function Ar(t,e){return null==e?null:t[e]}function xu(t){t[18]=0}function Ci(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Ct={lFrame:Rn(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Lu(){return Ct.bindingsEnabled}function je(){return Ct.lFrame.lView}function gt(){return Ct.lFrame.tView}function jr(t){return Ct.lFrame.contextLView=t,t[8]}function vn(){let t=Os();for(;null!==t&&64===t.type;)t=t.parent;return t}function Os(){return Ct.lFrame.currentTNode}function ur(t,e){const n=Ct.lFrame;n.currentTNode=t,n.isParent=e}function ga(){return Ct.lFrame.isParent}function H(){return Ct.isInCheckNoChangesMode}function z(t){Ct.isInCheckNoChangesMode=t}function He(t,e){const n=Ct.lFrame;n.bindingIndex=n.bindingRootIndex=t,nt(e)}function nt(t){Ct.lFrame.currentDirectiveIndex=t}function it(t){Ct.lFrame.currentQueryIndex=t}function yt(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function qt(t,e,n){if(n&rt.SkipSelf){let i=e,o=t;for(;!(i=i.parent,null!==i||n&rt.Host||(i=yt(o),null===i||(o=o[15],10&i.type))););if(null===i)return!1;e=i,t=o}const r=Ct.lFrame=wn();return r.currentTNode=e,r.lView=t,!0}function cn(t){const e=wn(),n=t[1];Ct.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function wn(){const t=Ct.lFrame,e=null===t?null:t.child;return null===e?Rn(t):e}function Rn(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Sn(){const t=Ct.lFrame;return Ct.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Cn=Sn;function An(){const t=Sn();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Zt(){return Ct.lFrame.selectedIndex}function kt(t){Ct.lFrame.selectedIndex=t}function Nn(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const o=t.data[n].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:h,ngAfterViewInit:A,ngAfterViewChecked:V,ngOnDestroy:q}=o;a&&(t.contentHooks||(t.contentHooks=[])).push(-n,a),h&&((t.contentHooks||(t.contentHooks=[])).push(n,h),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,h)),A&&(t.viewHooks||(t.viewHooks=[])).push(-n,A),V&&((t.viewHooks||(t.viewHooks=[])).push(n,V),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,V)),null!=q&&(t.destroyHooks||(t.destroyHooks=[])).push(n,q)}}function To(t,e,n){zo(t,e,3,n)}function Wo(t,e,n,r){(3&t[2])===n&&zo(t,e,n,r)}function Ti(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function zo(t,e,n,r){const o=null!=r?r:-1,a=e.length-1;let h=0;for(let A=void 0!==r?65535&t[18]:0;A<a;A++)if("number"==typeof e[A+1]){if(h=e[A],null!=r&&h>=r)break}else e[A]<0&&(t[18]+=65536),(h<o||-1==o)&&(bo(t,n,e,A),t[18]=(4294901760&t[18])+A+2),A++}function bo(t,e,n,r){const i=n[r]<0,o=n[r+1],h=t[i?-n[r]:n[r]];if(i){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{o.call(h)}finally{}}}else try{o.call(h)}finally{}}class Xi{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function ma(t,e,n){const r=mn(t);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const a=n[i++],h=n[i++],A=n[i++];r?t.setAttribute(e,h,A,a):e.setAttributeNS(a,h,A)}else{const a=o,h=n[++i];Bu(a)?r&&t.setProperty(e,a,h):r?t.setAttribute(e,a,h):e.setAttribute(a,h),i++}}return i}function nl(t){return 3===t||4===t||6===t}function Bu(t){return 64===t.charCodeAt(0)}function ya(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||rl(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function rl(t,e,n,r,i){let o=0,a=t.length;if(-1===e)a=-1;else for(;o<t.length;){const h=t[o++];if("number"==typeof h){if(h===e){a=-1;break}if(h>e){a=o-1;break}}}for(;o<t.length;){const h=t[o];if("number"==typeof h)break;if(h===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(t.splice(a,0,e),o=a+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function il(t){return-1!==t}function Qo(t){return 32767&t}function Jo(t,e){let n=function(t){return t>>16}(t),r=e;for(;n>0;)r=r[15],n--;return r}let ju=!0;function va(t){const e=ju;return ju=t,e}let xd=0;function Ms(t,e){const n=Hu(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Yo(r.data,t),Yo(e,null),Yo(r.blueprint,null));const i=Ca(t,e),o=t.injectorIndex;if(il(i)){const a=Qo(i),h=Jo(i,e),A=h[1].data;for(let V=0;V<8;V++)e[o+V]=h[a+V]|A[a+V]}return e[o+8]=i,o}function Yo(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Hu(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Ca(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){const o=i[1],a=o.type;if(r=2===a?o.declTNode:1===a?i[6]:null,null===r)return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Ta(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(di)&&(r=n[di]),null==r&&(r=n[di]=xd++);const i=255&r;e.data[t+(i>>5)]|=1<<i}(t,e,n)}function al(t,e,n){if(n&rt.Optional)return t;ai(e,"NodeInjector")}function ul(t,e,n,r){if(n&rt.Optional&&void 0===r&&(r=null),0==(n&(rt.Self|rt.Host))){const i=t[9],o=_r(void 0);try{return i?i.get(e,r,n&rt.Optional):Ui(e,r,n&rt.Optional)}finally{_r(o)}}return al(r,e,n)}function cl(t,e,n,r=rt.Default,i){if(null!==t){const o=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(di)?t[di]:void 0;return"number"==typeof e?e>=0?255&e:ll:e}(n);if("function"==typeof o){if(!qt(e,t,r))return r&rt.Host?al(i,n,r):ul(e,n,r,i);try{const a=o(r);if(null!=a||r&rt.Optional)return a;ai(n)}finally{Cn()}}else if("number"==typeof o){let a=null,h=Hu(t,e),A=-1,V=r&rt.Host?e[16][6]:null;for((-1===h||r&rt.SkipSelf)&&(A=-1===h?Ca(t,e):e[h+8],-1!==A&&R(r,!1)?(a=e[1],h=Qo(A),e=Jo(A,e)):h=-1);-1!==h;){const q=e[1];if(y(o,h,q.data)){const Y=Ud(h,e,n,a,r,V);if(Y!==qu)return Y}A=e[h+8],-1!==A&&R(r,e[1].data[h+8]===V)&&y(o,h,e)?(a=q,h=Qo(A),e=Jo(A,e)):h=-1}}}return ul(e,n,r,i)}const qu={};function ll(){return new B(vn(),je())}function Ud(t,e,n,r,i,o){const a=e[1],h=a.data[t+8],q=function(t,e,n,r,i){const o=t.providerIndexes,a=e.data,h=1048575&o,A=t.directiveStart,q=o>>20,ie=i?h+q:t.directiveEnd;for(let de=r?h:h+q;de<ie;de++){const Ce=a[de];if(de<A&&n===Ce||de>=A&&Ce.type===n)return de}if(i){const de=a[A];if(de&&ar(de)&&de.type===n)return A}return null}(h,a,n,null==r?mo(h)&&ju:r!=a&&0!=(3&h.type),i&rt.Host&&o===h);return null!==q?ks(e,a,q,h):qu}function ks(t,e,n,r){let i=t[n];const o=e.data;if(function(t){return t instanceof Xi}(i)){const a=i;a.resolving&&function(t,e){throw new Er("200",`Circular dependency in DI detected for ${t}`)}(On(o[n]));const h=va(a.canSeeViewProviders);a.resolving=!0;const A=a.injectImpl?_r(a.injectImpl):null;qt(t,r,rt.Default);try{i=t[n]=a.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){const a=Du(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,a),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,a)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{null!==A&&_r(A),va(h),a.resolving=!1,Cn()}}return i}function y(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function R(t,e){return!(t&rt.Self||t&rt.Host&&e)}class B{constructor(e,n){this._tNode=e,this._lView=n}get(e,n){return cl(this._tNode,this._lView,e,void 0,n)}}const De="__parameters__";function st(t,e,n){return Qn(()=>{const r=function(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;const a=new i(...o);return h.annotation=a,h;function h(A,V,q){const Y=A.hasOwnProperty(De)?A[De]:Object.defineProperty(A,De,{value:[]})[De];for(;Y.length<=q;)Y.push(null);return(Y[q]=Y[q]||[]).push(a),A}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class ut{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ft({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Zi(t,e){t.forEach(n=>Array.isArray(n)?Zi(n,e):e(n))}function fl(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Ls(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const zu={},Hd="__NG_DI_FLAG__",_a="ngTempTokenPath",wT=/\n/gm,qd="__source",Gd=Ht({provide:String,useValue:Ht});let Ku;function wa(t){const e=Ku;return Ku=t,e}function IT(t,e=rt.Default){if(void 0===Ku)throw new Error("inject() must be called from an injection context");return null===Ku?Ui(t,void 0,e):Ku.get(t,e&rt.Optional?null:void 0,e)}function Ut(t,e=rt.Default){return(po||IT)(at(t),e)}function Fs(t){const e=[];for(let n=0;n<t.length;n++){const r=at(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let i,o=rt.Default;for(let a=0;a<r.length;a++){const h=r[a],A=DT(h);"number"==typeof A?-1===A?i=h.token:o|=A:i=h}e.push(Ut(i,o))}else e.push(Ut(r))}return e}function Qu(t,e){return t[Hd]=e,t.prototype[Hd]=e,t}function DT(t){return t[Hd]}function Bp(t,e,n,r){const i=t[_a];throw e[qd]&&i.unshift(e[qd]),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=It(e);if(Array.isArray(e))i=e.map(It).join(" -> ");else if("object"==typeof e){let o=[];for(let a in e)if(e.hasOwnProperty(a)){let h=e[a];o.push(a+":"+("string"==typeof h?JSON.stringify(h):It(h)))}i=`{${o.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(wT,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[_a]=null,t}const Ju=Qu(st("Inject",t=>({token:t})),-1),eo=Qu(st("Optional"),8),Us=Qu(st("SkipSelf"),4),sg="__ngContext__";function cr(t,e){t[sg]=e}function Zd(t){const e=function(t){return t[sg]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Cl(t){return t.ngOriginalError}function Tb(t,...e){t.error(...e)}class Bs{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e),r=this._findContext(e),i=function(t){return t&&t.ngErrorLogger||Tb}(e);i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}_findContext(e){return e?function(t){return t.ngDebugContext}(e)||this._findContext(Cl(e)):null}_findOriginalError(e){let n=e&&Cl(e);for(;n&&Cl(n);)n=Cl(n);return n||null}}const gg=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Dt))();function ro(t){return t instanceof Function?t():t}var Gr=(()=>((Gr=Gr||{})[Gr.Important=1]="Important",Gr[Gr.DashCase=2]="DashCase",Gr))();function nf(t,e){return undefined(t,e)}function nc(t){const e=t[3];return gr(e)?e[3]:e}function rf(t){return Tg(t[13])}function of(t){return Tg(t[4])}function Tg(t){for(;null!==t&&!gr(t);)t=t[4];return t}function Ra(t,e,n,r,i){if(null!=r){let o,a=!1;gr(r)?o=r:pr(r)&&(a=!0,r=r[0]);const h=yn(r);0===t&&null!==n?null==i?Ig(e,n,h):js(e,n,h,i||null,!0):1===t&&null!==n?js(e,n,h,i||null,!0):2===t?function(t,e,n){const r=bl(t,e);r&&function(t,e,n,r){mn(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,h,a):3===t&&e.destroyNode(h),null!=o&&function(t,e,n,r,i){const o=n[7];o!==yn(n)&&Ra(e,t,r,o,i);for(let h=10;h<n.length;h++){const A=n[h];rc(A[1],A,t,e,r,o)}}(e,t,o,n,i)}}function af(t,e,n){return mn(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Eg(t,e){const n=t[9],r=n.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,Ci(i,-1)),n.splice(r,1)}function uf(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&Eg(i,r),e>0&&(t[n-1][4]=r[4]);const o=Ls(t,10+e);!function(t,e){rc(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const a=o[19];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function _g(t,e){if(!(256&e[2])){const n=e[11];mn(n)&&n.destroyNode&&rc(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return cf(t[1],t);for(;e;){let n=null;if(pr(e))n=e[13];else{const r=e[10];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)pr(e)&&cf(e[1],e),e=e[3];null===e&&(e=t),pr(e)&&cf(e[1],e),n=e&&e[4]}e=n}}(e)}}function cf(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Xi)){const o=n[r+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){const h=i[o[a]],A=o[a+1];try{A.call(h)}finally{}}else try{o.call(i)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const a=n[o+1],h="function"==typeof a?a(e):yn(e[a]),A=r[i=n[o+2]],V=n[o+3];"boolean"==typeof V?h.removeEventListener(n[o],A,V):V>=0?r[i=V]():r[i=-V].unsubscribe(),o+=2}else{const a=r[i=n[o+1]];n[o].call(a)}if(null!==r){for(let o=i+1;o<r.length;o++)r[o]();e[7]=null}}(t,e),1===e[1].type&&mn(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&gr(e[3])){n!==e[3]&&Eg(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function wg(t,e,n){return function(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const i=t.data[r.directiveStart].encapsulation;if(i===rn.None||i===rn.Emulated)return null}return Wn(r,n)}(t,e.parent,n)}function js(t,e,n,r,i){mn(t)?t.insertBefore(e,n,r,i):e.insertBefore(n,r,i)}function Ig(t,e,n){mn(t)?t.appendChild(e,n):e.appendChild(n)}function Dg(t,e,n,r,i){null!==r?js(t,e,n,r,i):Ig(t,e,n)}function bl(t,e){return mn(t)?t.parentNode(e):e.parentNode}let Pg=function(t,e,n){return 40&t.type?Wn(t,n):null};function El(t,e,n,r){const i=wg(t,r,e),o=e[11],h=function(t,e,n){return Pg(t,e,n)}(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(n))for(let A=0;A<n.length;A++)Dg(o,i,n[A],h,!1);else Dg(o,i,n,h,!1)}function _l(t,e){if(null!==e){const n=e.type;if(3&n)return Wn(e,t);if(4&n)return df(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return _l(t,r);{const i=t[e.index];return gr(i)?df(-1,i):yn(i)}}if(32&n)return nf(e,t)()||yn(t[e.index]);{const r=Mg(t,e);return null!==r?Array.isArray(r)?r[0]:_l(nc(t[16]),r):_l(t,e.next)}}return null}function Mg(t,e){return null!==e?t[16][6].projection[e.projection]:null}function df(t,e){const n=10+t+1;if(n<e.length){const r=e[n],i=r[1].firstChild;if(null!==i)return _l(r,i)}return e[7]}function ff(t,e,n,r,i,o,a){for(;null!=n;){const h=r[n.index],A=n.type;if(a&&0===e&&(h&&cr(yn(h),r),n.flags|=4),64!=(64&n.flags))if(8&A)ff(t,e,n.child,r,i,o,!1),Ra(e,t,i,h,o);else if(32&A){const V=nf(n,r);let q;for(;q=V();)Ra(e,t,i,q,o);Ra(e,t,i,h,o)}else 16&A?kg(t,e,r,n,i,o):Ra(e,t,i,h,o);n=a?n.projectionNext:n.next}}function rc(t,e,n,r,i,o){ff(n,r,t.firstChild,e,i,o,!1)}function kg(t,e,n,r,i,o){const a=n[16],A=a[6].projection[r.projection];if(Array.isArray(A))for(let V=0;V<A.length;V++)Ra(e,t,i,A[V],o);else ff(t,e,A,a[3],i,o,!0)}function xg(t,e,n){mn(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function hf(t,e,n){mn(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function Lg(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const o=e.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}n=i+1}}const Fg="ng-template";function Wb(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==Lg(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function Ug(t){return 4===t.type&&t.value!==Fg}function zb(t,e,n){return e===(4!==t.type||n?t.value:Fg)}function Kb(t,e,n){let r=4;const i=t.attrs||[],o=function(t){for(let e=0;e<t.length;e++)if(nl(t[e]))return e;return t.length}(i);let a=!1;for(let h=0;h<e.length;h++){const A=e[h];if("number"!=typeof A){if(!a)if(4&r){if(r=2|1&r,""!==A&&!zb(t,A,n)||""===A&&1===e.length){if(bi(r))return!1;a=!0}}else{const V=8&r?A:e[++h];if(8&r&&null!==t.attrs){if(!Wb(t.attrs,V,n)){if(bi(r))return!1;a=!0}continue}const Y=Qb(8&r?"class":A,i,Ug(t),n);if(-1===Y){if(bi(r))return!1;a=!0;continue}if(""!==V){let ie;ie=Y>o?"":i[Y+1].toLowerCase();const de=8&r?ie:null;if(de&&-1!==Lg(de,V,0)||2&r&&V!==ie){if(bi(r))return!1;a=!0}}}}else{if(!a&&!bi(r)&&!bi(A))return!1;if(a&&bi(A))continue;a=!1,r=A|1&r}}return bi(r)||a}function bi(t){return 0==(1&t)}function Qb(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let o=!1;for(;i<e.length;){const a=e[i];if(a===t)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){let h=e[++i];for(;"string"==typeof h;)h=e[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function Vg(t,e,n=!1){for(let r=0;r<e.length;r++)if(Kb(t,e[r],n))return!0;return!1}function Bg(t,e){return t?":not("+e.trim()+")":e}function eE(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let a=t[n];if("string"==typeof a)if(2&r){const h=t[++n];i+="["+a+(h.length>0?'="'+h+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""!==i&&!bi(a)&&(e+=Bg(o,i),i=""),r=a,o=o||!bi(r);n++}return""!==i&&(e+=Bg(o,i)),e}const wt={};function wl(t){jg(gt(),je(),Zt()+t,H())}function jg(t,e,n,r){if(!r)if(3==(3&e[2])){const o=t.preOrderCheckHooks;null!==o&&To(e,o,n)}else{const o=t.preOrderHooks;null!==o&&Wo(e,o,0,n)}kt(n)}function Yg(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const a=t.data[o];it(i),a.contentQueries(2,e[o],o)}}}function ic(t,e,n,r,i,o,a,h,A,V){const q=e.blueprint.slice();return q[0]=i,q[2]=140|r,xu(q),q[3]=q[15]=t,q[8]=n,q[10]=a||t&&t[10],q[11]=h||t&&t[11],q[12]=A||t&&t[12]||null,q[9]=V||t&&t[9]||null,q[6]=o,q[16]=2==e.type?t[16]:q,q}function Aa(t,e,n,r,i){let o=t.data[e];if(null===o)o=function(t,e,n,r,i){const o=Os(),a=ga(),A=t.data[e]=function(t,e,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=A),null!==o&&(a?null==o.child&&null!==A.parent&&(o.child=A):null===o.next&&(o.next=A)),A}(t,e,n,r,i),Ct.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const a=function(){const t=Ct.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();o.injectorIndex=null===a?-1:a.injectorIndex}return ur(o,!0),o}function Pa(t,e,n,r){if(0===n)return-1;const i=e.length;for(let o=0;o<n;o++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function oc(t,e,n){cn(e);try{const r=t.viewQuery;null!==r&&Mf(1,r,n);const i=t.template;null!==i&&Xg(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Yg(t,e),t.staticViewQueries&&Mf(2,t.viewQuery,n);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)NE(t,e[n])}(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,An()}}function Oa(t,e,n,r){const i=e[2];if(256==(256&i))return;cn(e);const o=H();try{xu(e),function(t){Ct.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&Xg(t,e,n,2,r);const a=3==(3&i);if(!o)if(a){const V=t.preOrderCheckHooks;null!==V&&To(e,V,null)}else{const V=t.preOrderHooks;null!==V&&Wo(e,V,0,null),Ti(e,0)}if(function(t){for(let e=rf(t);null!==e;e=of(e)){if(!e[2])continue;const n=e[9];for(let r=0;r<n.length;r++){const i=n[r],o=i[3];0==(1024&i[2])&&Ci(o,1),i[2]|=1024}}}(e),function(t){for(let e=rf(t);null!==e;e=of(e))for(let n=10;n<e.length;n++){const r=e[n],i=r[1];$o(r)&&Oa(i,r,i.template,r[8])}}(e),null!==t.contentQueries&&Yg(t,e),!o)if(a){const V=t.contentCheckHooks;null!==V&&To(e,V)}else{const V=t.contentHooks;null!==V&&Wo(e,V,1),Ti(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)kt(~i);else{const o=i,a=n[++r],h=n[++r];He(a,o),h(2,e[o])}}}finally{kt(-1)}}(t,e);const h=t.components;null!==h&&function(t,e){for(let n=0;n<e.length;n++)ME(t,e[n])}(e,h);const A=t.viewQuery;if(null!==A&&Mf(2,A,r),!o)if(a){const V=t.viewCheckHooks;null!==V&&To(e,V)}else{const V=t.viewHooks;null!==V&&Wo(e,V,2),Ti(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Ci(e[3],-1))}finally{An()}}function hE(t,e,n,r){const i=e[10],o=!H(),a=function(t){return 4==(4&t[2])}(e);try{o&&!a&&i.begin&&i.begin(),a&&oc(t,e,r),Oa(t,e,n,r)}finally{o&&!a&&i.end&&i.end()}}function Xg(t,e,n,r,i){const o=Zt(),a=2&r;try{kt(-1),a&&e.length>20&&jg(t,e,20,H()),n(r,i)}finally{kt(o)}}function wf(t,e,n){!Lu()||(function(t,e,n,r){const i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||Ms(n,e),cr(r,e);const a=n.initialInputs;for(let h=i;h<o;h++){const A=t.data[h],V=ar(A);V&&DE(e,n,A);const q=ks(e,t,h,n);cr(q,e),null!==a&&RE(0,h-i,q,A,0,a),V&&(Yn(n.index,e)[8]=q)}}(t,e,n,Wn(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,a=n.index,h=Ct.lFrame.currentDirectiveIndex;try{kt(a);for(let A=r;A<i;A++){const V=t.data[A],q=e[A];nt(A),(null!==V.hostBindings||0!==V.hostVars||null!==V.hostAttrs)&&am(V,q)}}finally{kt(-1),nt(h)}}(t,e,n))}function Sf(t,e,n=Wn){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],h=-1===a?n(e,t):t[a];t[i++]=h}}}function em(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Rl(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Rl(t,e,n,r,i,o,a,h,A,V){const q=20+r,Y=q+i,ie=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:wt);return n}(q,Y),de="function"==typeof V?V():V;return ie[1]={type:t,blueprint:ie,template:n,queries:null,viewQuery:h,declTNode:e,data:ie.slice().fill(null,q),bindingStartIndex:q,expandoStartIndex:Y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:A,consts:de,incompleteFirstPass:!1}}function im(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function If(t,e,n,r){let i=!1;if(Lu()){const o=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const a=r[o];Vg(n,a.selectors,!1)&&(i||(i=[]),Ta(Ms(n,e),t,a.type),ar(a)?(um(t,n),i.unshift(a)):i.push(a))}return i}(t,e,n),a=null===r?null:{"":-1};if(null!==o){i=!0,cm(n,t.data.length,o.length);for(let q=0;q<o.length;q++){const Y=o[q];Y.providersResolver&&Y.providersResolver(Y)}let h=!1,A=!1,V=Pa(t,e,o.length,null);for(let q=0;q<o.length;q++){const Y=o[q];n.mergedAttrs=ya(n.mergedAttrs,Y.hostAttrs),lm(t,n,e,V,Y),IE(V,Y,a),null!==Y.contentQueries&&(n.flags|=8),(null!==Y.hostBindings||null!==Y.hostAttrs||0!==Y.hostVars)&&(n.flags|=128);const ie=Y.type.prototype;!h&&(ie.ngOnChanges||ie.ngOnInit||ie.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),h=!0),!A&&(ie.ngOnChanges||ie.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),A=!0),V++}!function(t,e){const r=e.directiveEnd,i=t.data,o=e.attrs,a=[];let h=null,A=null;for(let V=e.directiveStart;V<r;V++){const q=i[V],Y=q.inputs,ie=null===o||Ug(e)?null:AE(Y,o);a.push(ie),h=im(Y,V,h),A=im(q.outputs,V,A)}null!==h&&(h.hasOwnProperty("class")&&(e.flags|=16),h.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=a,e.inputs=h,e.outputs=A}(t,n)}a&&function(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const o=n[e[i+1]];if(null==o)throw new Er("301",`Export of name '${e[i+1]}' not found!`);r.push(e[i],o)}}}(n,r,a)}return n.mergedAttrs=ya(n.mergedAttrs,n.attrs),i}function sm(t,e,n,r,i,o){const a=o.hostBindings;if(a){let h=t.hostBindingOpCodes;null===h&&(h=t.hostBindingOpCodes=[]);const A=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(h)!=A&&h.push(A),h.push(r,i,a)}}function am(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function um(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function IE(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ar(e)&&(n[""]=t)}}function cm(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function lm(t,e,n,r,i){t.data[r]=i;const o=i.factory||(i.factory=yi(i.type)),a=new Xi(o,ar(i),null);t.blueprint[r]=a,n[r]=a,sm(t,e,0,r,Pa(t,n,i.hostVars,wt),i)}function DE(t,e,n){const r=Wn(e,t),i=em(n),o=t[10],a=Al(t,ic(t,i,null,n.onPush?64:16,r,e,o,o.createRenderer(r,n),null,null));t[e.index]=a}function RE(t,e,n,r,i,o){const a=o[e];if(null!==a){const h=r.setInput;for(let A=0;A<a.length;){const V=a[A++],q=a[A++],Y=a[A++];null!==h?r.setInput(n,Y,V,q):n[q]=Y}}}function AE(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function dm(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function ME(t,e){const n=Yn(e,t);if($o(n)){const r=n[1];80&n[2]?Oa(r,n,r.template,n[8]):n[5]>0&&Rf(n)}}function Rf(t){for(let r=rf(t);null!==r;r=of(r))for(let i=10;i<r.length;i++){const o=r[i];if(1024&o[2]){const a=o[1];Oa(a,o,a.template,o[8])}else o[5]>0&&Rf(o)}const n=t[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=Yn(n[r],t);$o(i)&&i[5]>0&&Rf(i)}}function NE(t,e){const n=Yn(e,t),r=n[1];(function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(r,n),oc(r,n,n[8])}function Al(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Af(t){for(;t;){t[2]|=64;const e=nc(t);if(oa(t)&&!e)return t;t=e}return null}function Of(t,e,n){const r=e[10];r.begin&&r.begin();try{Oa(t,e,t.template,n)}catch(i){throw mm(e,i),i}finally{r.end&&r.end()}}function fm(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=Zd(n),i=r[1];hE(i,r,i.template,n)}}(t[8])}function Mf(t,e,n){it(0),e(t,n)}const UE=(()=>Promise.resolve(null))();function hm(t){return t[7]||(t[7]=[])}function pm(t){return t.cleanup||(t.cleanup=[])}function mm(t,e){const n=t[9],r=n?n.get(Bs,null):null;r&&r.handleError(e)}function ym(t,e,n,r,i){for(let o=0;o<n.length;){const a=n[o++],h=n[o++],A=e[a],V=t.data[a];null!==V.setInput?V.setInput(A,i,r,h):A[h]=i}}function Pl(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(null!==e)for(let a=0;a<e.length;a++){const h=e[a];"number"==typeof h?o=h:1==o?i=cs(i,h):2==o&&(r=cs(r,h+": "+e[++a]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}const Ma=new ut("INJECTOR",-1);class vm{get(e,n=zu){if(n===zu){const r=new Error(`NullInjectorError: No provider for ${It(e)}!`);throw r.name="NullInjectorError",r}return n}}const sc=new ut("Set Injector scope."),ac={},jE={};let Nf;function Cm(){return void 0===Nf&&(Nf=new vm),Nf}function Tm(t,e=null,n=null,r){return new qE(t,n,e||Cm(),r)}class qE{constructor(e,n,r,i=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];n&&Zi(n,h=>this.processProvider(h,e,n)),Zi([e],h=>this.processInjectorType(h,[],o)),this.records.set(Ma,Na(void 0,this));const a=this.records.get(sc);this.scope=null!=a?a.value:null,this.source=i||("object"==typeof e?null:It(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,n=zu,r=rt.Default){this.assertNotDestroyed();const i=wa(this),o=_r(void 0);try{if(!(r&rt.SkipSelf)){let h=this.records.get(e);if(void 0===h){const A=function(t){return"function"==typeof t||"object"==typeof t&&t instanceof ut}(e)&&xr(e);h=A&&this.injectableDefInScope(A)?Na(kf(e),ac):null,this.records.set(e,h)}if(null!=h)return this.hydrate(e,h)}return(r&rt.Self?Cm():this.parent).get(e,n=r&rt.Optional&&n===zu?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[_a]=a[_a]||[]).unshift(It(e)),i)throw a;return Bp(a,e,"R3InjectorError",this.source)}throw a}finally{_r(o),wa(i)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((r,i)=>e.push(It(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,n,r){if(!(e=at(e)))return!1;let i=gs(e);const o=null==i&&e.ngModule||void 0,a=void 0===o?e:o,h=-1!==r.indexOf(a);if(void 0!==o&&(i=gs(o)),null==i)return!1;if(null!=i.imports&&!h){let q;r.push(a);try{Zi(i.imports,Y=>{this.processInjectorType(Y,n,r)&&(void 0===q&&(q=[]),q.push(Y))})}finally{}if(void 0!==q)for(let Y=0;Y<q.length;Y++){const{ngModule:ie,providers:de}=q[Y];Zi(de,Ce=>this.processProvider(Ce,ie,de||$t))}}this.injectorDefTypes.add(a);const A=yi(a)||(()=>new a);this.records.set(a,Na(A,ac));const V=i.providers;if(null!=V&&!h){const q=e;Zi(V,Y=>this.processProvider(Y,q,V))}return void 0!==o&&void 0!==e.providers}processProvider(e,n,r){let i=ka(e=at(e))?e:at(e&&e.provide);const o=function(t,e,n){return Em(t)?Na(void 0,t.useValue):Na(function(t,e,n){let r;if(ka(t)){const i=at(t);return yi(i)||kf(i)}if(Em(t))r=()=>at(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Fs(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>Ut(at(t.useExisting));else{const i=at(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return yi(i)||kf(i);r=()=>new i(...Fs(t.deps))}return r}(t),ac)}(e);if(ka(e)||!0!==e.multi)this.records.get(i);else{let a=this.records.get(i);a||(a=Na(void 0,ac,!0),a.factory=()=>Fs(a.multi),this.records.set(i,a)),i=e,a.multi.push(e)}this.records.set(i,o)}hydrate(e,n){return n.value===ac&&(n.value=jE,n.value=n.factory()),"object"==typeof n.value&&n.value&&function(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=at(e.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function kf(t){const e=xr(t),n=null!==e?e.factory:yi(t);if(null!==n)return n;if(t instanceof ut)throw new Error(`Token ${It(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const r=function(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?");throw new Error(`Can't resolve all parameters for ${It(t)}: (${r.join(", ")}).`)}const n=function(t){const e=t&&(t[Fi]||t[ms]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Na(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Em(t){return null!==t&&"object"==typeof t&&Gd in t}function ka(t){return"function"==typeof t}const _m=function(t,e,n){return function(t,e=null,n=null,r){const i=Tm(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};class tn{static create(e,n){return Array.isArray(e)?_m(e,n,""):_m(e.providers,e.parent,e.name||"")}}function l_(t,e){Nn(Zd(t)[1],vn())}tn.THROW_IF_NOT_FOUND=zu,tn.NULL=new vm,tn.\u0275prov=Ft({token:tn,providedIn:"any",factory:()=>Ut(Ma)}),tn.__NG_ELEMENT_ID__=-1;let Ol=null;function xa(){if(!Ol){const t=Dt.Symbol;if(t&&t.iterator)Ol=t.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<e.length;++n){const r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Ol=r)}}}return Ol}function cc(t){return!!jf(t)&&(Array.isArray(t)||!(t instanceof Map)&&xa()in t)}function jf(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Nl(t,e,n,r,i,o,a,h){const A=je(),V=gt(),q=t+20,Y=V.firstCreatePass?function(t,e,n,r,i,o,a,h,A){const V=e.consts,q=Aa(e,t,4,a||null,Ar(V,h));If(e,n,q,Ar(V,A)),Nn(e,q);const Y=q.tViews=Rl(2,q,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,V);return null!==e.queries&&(e.queries.template(e,q),Y.queries=e.queries.embeddedTView(q)),q}(q,V,A,e,n,r,i,o,a):V.data[q];ur(Y,!1);const ie=A[11].createComment("");El(V,A,ie,Y),cr(ie,A),Al(A,A[q]=dm(ie,A,ie,Y)),yo(Y)&&wf(V,A,Y),null!=a&&Sf(A,Y,h)}function Lt(t,e=rt.Default){const n=je();return null===n?Ut(t,e):cl(vn(),n,at(t),e)}function dc(t,e,n){const r=je();return function(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}(r,Ct.lFrame.bindingIndex++,e)&&function(t,e,n,r,i,o,a,h){const A=Wn(e,n);let q,V=e.inputs;!h&&null!=V&&(q=V[r])?(ym(t,n,q,r,i),mo(e)&&function(t,e){const n=Yn(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=a?a(i,e.value||"",r):i,mn(o)?o.setProperty(A,r,i):Bu(r)||(A.setProperty?A.setProperty(r,i):A[r]=i))}(gt(),function(){const t=Ct.lFrame;return Go(t.tView,t.selectedIndex)}(),r,t,e,r[11],n,!1),dc}function Wf(t,e,n,r,i){const a=i?"class":"style";ym(t,n,e.inputs[a],a,r)}function so(t,e,n,r){const i=je(),o=gt(),a=20+t,h=i[11],A=i[a]=af(h,e,Ct.lFrame.currentNamespace),V=o.firstCreatePass?function(t,e,n,r,i,o,a){const h=e.consts,V=Aa(e,t,2,i,Ar(h,o));return If(e,n,V,Ar(h,a)),null!==V.attrs&&Pl(V,V.attrs,!1),null!==V.mergedAttrs&&Pl(V,V.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,V),V}(a,o,i,0,e,n,r):o.data[a];ur(V,!0);const q=V.mergedAttrs;null!==q&&ma(h,A,q);const Y=V.classes;null!==Y&&hf(h,A,Y);const ie=V.styles;null!==ie&&xg(h,A,ie),64!=(64&V.flags)&&El(o,i,A,V),0===Ct.lFrame.elementDepthCount&&cr(A,i),Ct.lFrame.elementDepthCount++,yo(V)&&(wf(o,i,V),function(t,e,n){if(bs(e)){const i=e.directiveEnd;for(let o=e.directiveStart;o<i;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}}(o,V,i)),null!==r&&Sf(i,V)}function ao(){let t=vn();ga()?Ct.lFrame.isParent=!1:(t=t.parent,ur(t,!1));const e=t;Ct.lFrame.elementDepthCount--;const n=gt();n.firstCreatePass&&(Nn(n,t),bs(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Wf(n,e,je(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Wf(n,e,je(),e.stylesWithoutHost,!1)}function zf(){return je()}function Kf(t){return!!t&&"function"==typeof t.then}const hy=function(t){return!!t&&"function"==typeof t.subscribe};function xl(t,e,n,r){const i=je(),o=gt(),a=vn();return function(t,e,n,r,i,o,a,h){const A=yo(r),q=t.firstCreatePass&&pm(t),Y=e[8],ie=hm(e);let de=!0;if(3&r.type||h){const Se=Wn(r,e),Ge=h?h(Se):Se,Fe=ie.length,ot=h?mt=>h(yn(mt[r.index])):r.index;if(mn(n)){let mt=null;if(!h&&A&&(mt=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const a=i[o];if(a===n&&i[o+1]===r){const h=e[7],A=i[o+2];return h.length>A?h[A]:null}"string"==typeof a&&(o+=2)}return null}(t,e,i,r.index)),null!==mt)(mt.__ngLastListenerFn__||mt).__ngNextListenerFn__=o,mt.__ngLastListenerFn__=o,de=!1;else{o=Qf(r,e,Y,o,!1);const xt=n.listen(Ge,i,o);ie.push(o,xt),q&&q.push(i,ot,Fe,Fe+1)}}else o=Qf(r,e,Y,o,!0),Ge.addEventListener(i,o,a),ie.push(o),q&&q.push(i,ot,Fe,a)}else o=Qf(r,e,Y,o,!1);const Ce=r.outputs;let Ne;if(de&&null!==Ce&&(Ne=Ce[i])){const Se=Ne.length;if(Se)for(let Ge=0;Ge<Se;Ge+=2){const jn=e[Ne[Ge]][Ne[Ge+1]].subscribe(o),oi=ie.length;ie.push(o,jn),q&&q.push(i,r.index,oi,-(oi+1))}}}(o,i,i[11],a,t,e,!!n,r),xl}function my(t,e,n,r){try{return!1!==n(r)}catch(i){return mm(t,i),!1}}function Qf(t,e,n,r,i){return function o(a){if(a===Function)return r;const h=2&t.flags?Yn(t.index,e):e;0==(32&e[2])&&Af(h);let A=my(e,0,r,a),V=o.__ngNextListenerFn__;for(;V;)A=my(e,0,V,a)&&A,V=V.__ngNextListenerFn__;return i&&!1===A&&(a.preventDefault(),a.returnValue=!1),A}}function Ll(t=1){return function(t){return(Ct.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Ct.lFrame.contextLView))[8]}(t)}function hc(t,e=""){const n=je(),r=gt(),i=t+20,o=r.firstCreatePass?Aa(r,i,1,e,null):r.data[i],a=n[i]=function(t,e){return mn(t)?t.createText(e):t.createTextNode(e)}(n[11],e);El(r,n,a,o),ur(o,!1)}const qs=void 0;var Lw=["en",[["a","p"],["AM","PM"],qs],[["AM","PM"],qs,qs],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],qs,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],qs,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",qs,"{1} 'at' {0}",qs],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let za={};function uv(t){return t in za||(za[t]=Dt.ng&&Dt.ng.common&&Dt.ng.common.locales&&Dt.ng.common.locales[t]),za[t]}var tt=(()=>((tt=tt||{})[tt.LocaleId=0]="LocaleId",tt[tt.DayPeriodsFormat=1]="DayPeriodsFormat",tt[tt.DayPeriodsStandalone=2]="DayPeriodsStandalone",tt[tt.DaysFormat=3]="DaysFormat",tt[tt.DaysStandalone=4]="DaysStandalone",tt[tt.MonthsFormat=5]="MonthsFormat",tt[tt.MonthsStandalone=6]="MonthsStandalone",tt[tt.Eras=7]="Eras",tt[tt.FirstDayOfWeek=8]="FirstDayOfWeek",tt[tt.WeekendRange=9]="WeekendRange",tt[tt.DateFormat=10]="DateFormat",tt[tt.TimeFormat=11]="TimeFormat",tt[tt.DateTimeFormat=12]="DateTimeFormat",tt[tt.NumberSymbols=13]="NumberSymbols",tt[tt.NumberFormats=14]="NumberFormats",tt[tt.CurrencyCode=15]="CurrencyCode",tt[tt.CurrencySymbol=16]="CurrencySymbol",tt[tt.CurrencyName=17]="CurrencyName",tt[tt.Currencies=18]="Currencies",tt[tt.Directionality=19]="Directionality",tt[tt.PluralCase=20]="PluralCase",tt[tt.ExtraData=21]="ExtraData",tt))();const Ul="en-US";let cv=Ul;function Zf(t){hn(t,"Expected localeId to be defined"),"string"==typeof t&&(cv=t.toLowerCase().replace(/_/g,"-"))}class kv{}const Lv="ngComponent";class FS{resolveComponentFactory(e){throw function(t){const e=Error(`No component factory found for ${It(t)}. Did you add it to @NgModule.entryComponents?`);return e[Lv]=t,e}(e)}}class Gs{}function ql(...t){}function Qa(t,e){return new Di(Wn(t,e))}Gs.NULL=new FS;const BS=function(){return Qa(vn(),je())};let Di=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=BS,t})();class Gl{}let ah=(()=>{class t{}return t.\u0275prov=Ft({token:t,providedIn:"root",factory:()=>null}),t})();class uh{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Vv=new uh("12.2.2");class Bv{constructor(){}supports(e){return cc(e)}create(e){return new WS(e)}}const $S=(t,e)=>e;class WS{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||$S}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,o=null;for(;n||r;){const a=!r||n&&n.currentIndex<Hv(r,i,o)?n:r,h=Hv(a,i,o),A=a.currentIndex;if(a===r)i--,r=r._nextRemoved;else if(n=n._next,null==a.previousIndex)i++;else{o||(o=[]);const V=h-i,q=A-i;if(V!=q){for(let ie=0;ie<V;ie++){const de=ie<o.length?o[ie]:o[ie]=0,Ce=de+ie;q<=Ce&&Ce<V&&(o[ie]=de+1)}o[a.previousIndex]=q-V}}h!==A&&e(a,h,A)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!cc(e))throw new Error(`Error trying to diff '${It(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,o,a,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let h=0;h<this.length;h++)o=e[h],a=this._trackByFn(h,o),null!==n&&Object.is(n.trackById,a)?(r&&(n=this._verifyReinsertion(n,o,a,h)),Object.is(n.item,o)||this._addIdentityChange(n,o)):(n=this._mismatch(n,o,a,h),r=!0),n=n._next}else i=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[xa()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,h=>{a=this._trackByFn(i,h),null!==n&&Object.is(n.trackById,a)?(r&&(n=this._verifyReinsertion(n,h,a,i)),Object.is(n.item,h)||this._addIdentityChange(n,h)):(n=this._mismatch(n,h,a,i),r=!0),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,o,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,o,i)):e=this._addAfter(new zS(n,r),o,i),e}_verifyReinsertion(e,n,r,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==o?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,o=e._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const i=null===n?this._itHead:n._next;return e._next=i,e._prev=n,null===i?this._itTail=e:i._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new jv),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new jv),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class zS{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class KS{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class jv{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new KS,this.map.set(n,r)),r.add(e)}get(e,n){const i=this.map.get(e);return i?i.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Hv(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class qv{constructor(){}supports(e){return e instanceof Map||jf(e)}create(){return new QS}}class QS{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let n;for(n=this._mapHead;null!==n;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}diff(e){if(e){if(!(e instanceof Map||jf(e)))throw new Error(`Error trying to diff '${It(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(n&&n.key===i)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const o=this._getOrCreateRecordForKey(i,r);n=this._insertBeforeOrAppend(n,o)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){const r=e._prev;return n._next=e,n._prev=r,e._prev=n,r&&(r._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,n);const o=i._prev,a=i._next;return o&&(o._next=a),a&&(a._prev=o),i._next=null,i._prev=null,i}const r=new JS(e);return this._records.set(e,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(r=>n(e[r],r))}}class JS{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Gv(){return new vc([new Bv])}let vc=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(null!=r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||Gv()),deps:[[t,new Us,new eo]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(null!=r)return r;throw new Error(`Cannot find a differ supporting object '${n}' of type '${function(t){return t.name||typeof t}(n)}'`)}}return t.\u0275prov=Ft({token:t,providedIn:"root",factory:Gv}),t})();function $v(){return new Ja([new qv])}let Ja=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||$v()),deps:[[t,new Us,new eo]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(r)return r;throw new Error(`Cannot find a differ supporting object '${n}'`)}}return t.\u0275prov=Ft({token:t,providedIn:"root",factory:$v}),t})();function $l(t,e,n,r,i=!1){for(;null!==n;){const o=e[n.index];if(null!==o&&r.push(yn(o)),gr(o))for(let h=10;h<o.length;h++){const A=o[h],V=A[1].firstChild;null!==V&&$l(A[1],A,V,r)}const a=n.type;if(8&a)$l(t,e,n.child,r);else if(32&a){const h=nf(n,e);let A;for(;A=h();)r.push(A)}else if(16&a){const h=Mg(e,n);if(Array.isArray(h))r.push(...h);else{const A=nc(e[16]);$l(A[1],A,h,r,!0)}}n=i?n.projectionNext:n.next}return r}class Cc{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return $l(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(gr(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(uf(e,r),Ls(n,r))}this._attachedToViewContainer=!1}_g(this._lView[1],this._lView)}onDestroy(e){!function(t,e,n,r){const i=hm(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&pm(t).push(r,i.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){Af(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Of(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){z(!0);try{Of(t,e,n)}finally{z(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(t,e){rc(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class XS extends Cc{constructor(e){super(e),this._view=e}detectChanges(){fm(this._view)}checkNoChanges(){!function(t){z(!0);try{fm(t)}finally{z(!1)}}(this._view)}get context(){return null}}const iI=[new qv],sI=new vc([new Bv]),aI=new Ja(iI),cI=function(){return function(t,e){return 4&t.type?new dI(e,t,Qa(t,e)):null}(vn(),je())};let Ro=(()=>{class t{}return t.__NG_ELEMENT_ID__=cI,t})();const lI=Ro,dI=class extends lI{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(e){const n=this._declarationTContainer.tViews,r=ic(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(n)),oc(n,r,e),new Cc(r)}};class $s{}const gI=function(){return function(t,e){let n;const r=e[t.index];if(gr(r))n=r;else{let i;if(8&t.type)i=yn(r);else{const o=e[11];i=o.createComment("");const a=Wn(t,e);js(o,bl(o,a),i,function(t,e){return mn(t)?t.nextSibling(e):e.nextSibling}(o,a),!1)}e[t.index]=n=dm(r,e,i,t),Al(e,n)}return new Wv(n,t,e)}(vn(),je())};let lo=(()=>{class t{}return t.__NG_ELEMENT_ID__=gI,t})();const yI=lo,Wv=class extends yI{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Qa(this._hostTNode,this._hostLView)}get injector(){return new B(this._hostTNode,this._hostLView)}get parentInjector(){const e=Ca(this._hostTNode,this._hostLView);if(il(e)){const n=Jo(e,this._hostLView),r=Qo(e);return new B(n[1].data[r+8],n)}return new B(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=zv(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,r){const i=e.createEmbeddedView(n||{});return this.insert(i,r),i}createComponent(e,n,r,i,o){const a=r||this.parentInjector;if(!o&&null==e.ngModule&&a){const A=a.get($s,null);A&&(o=A)}const h=e.create(a,i,void 0,o);return this.insert(h.hostView,n),h}insert(e,n){const r=e._lView,i=r[1];if(function(t){return gr(t[3])}(r)){const q=this.indexOf(e);if(-1!==q)this.detach(q);else{const Y=r[3],ie=new Wv(Y,Y[6],Y[3]);ie.detach(ie.indexOf(e))}}const o=this._adjustIndex(n),a=this._lContainer;!function(t,e,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-10?(e[4]=n[i],fl(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const a=e[17];null!==a&&n!==a&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(a,e);const h=e[19];null!==h&&h.insertView(t),e[2]|=128}(i,r,a,o);const h=df(o,a),A=r[11],V=bl(A,a[7]);return null!==V&&function(t,e,n,r,i,o){r[0]=i,r[6]=e,rc(t,r,n,1,i,o)}(i,a[6],A,r,V,h),e.attachToViewContainerRef(),fl(ch(a),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=zv(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=uf(this._lContainer,n);r&&(Ls(ch(this._lContainer),n),_g(r[1],r))}detach(e){const n=this._adjustIndex(e,-1),r=uf(this._lContainer,n);return r&&null!=Ls(ch(this._lContainer),n)?new Cc(r):null}_adjustIndex(e,n=0){return null==e?this.length+n:e}};function zv(t){return t[8]}function ch(t){return t[8]||(t[8]=[])}const eu={};class pC extends Gs{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=pn(e);return new mC(n,this.ngModule)}}function gC(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const hD=new ut("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>gg});class mC extends kv{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function(t){return t.map(eE).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return gC(this.componentDef.inputs)}get outputs(){return gC(this.componentDef.outputs)}create(e,n,r,i){const o=(i=i||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const o=t.get(n,eu,i);return o!==eu||r===eu?o:e.get(n,r,i)}}}(e,i.injector):e,a=o.get(Gl,da),h=o.get(ah,null),A=a.createRenderer(null,this.componentDef),V=this.componentDef.selectors[0][0]||"div",q=r?function(t,e,n){if(mn(t))return t.selectRootElement(e,n===rn.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(A,r,this.componentDef.encapsulation):af(a.createRenderer(null,this.componentDef),V,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(V)),Y=this.componentDef.onPush?576:528,ie=function(t,e){return{components:[],scheduler:t||gg,clean:UE,playerHandler:e||null,flags:0}}(),de=Rl(0,null,null,1,0,null,null,null,null,null),Ce=ic(null,de,ie,Y,null,null,a,A,h,o);let Ne,Se;cn(Ce);try{const Ge=function(t,e,n,r,i,o){const a=n[1];n[20]=t;const A=Aa(a,20,2,"#host",null),V=A.mergedAttrs=e.hostAttrs;null!==V&&(Pl(A,V,!0),null!==t&&(ma(i,t,V),null!==A.classes&&hf(i,t,A.classes),null!==A.styles&&xg(i,t,A.styles)));const q=r.createRenderer(t,e),Y=ic(n,em(e),null,e.onPush?64:16,n[20],A,r,q,o||null,null);return a.firstCreatePass&&(Ta(Ms(A,n),a,e.type),um(a,A),cm(A,n.length,1)),Al(n,Y),n[20]=Y}(q,this.componentDef,Ce,a,A);if(q)if(r)ma(A,q,["ng-version",Vv.full]);else{const{attrs:Fe,classes:ot}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!bi(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);Fe&&ma(A,q,Fe),ot&&ot.length>0&&hf(A,q,ot.join(" "))}if(Se=Go(de,20),void 0!==n){const Fe=Se.projection=[];for(let ot=0;ot<this.ngContentSelectors.length;ot++){const mt=n[ot];Fe.push(null!=mt?Array.from(mt):null)}}Ne=function(t,e,n,r,i){const o=n[1],a=function(t,e,n){const r=vn();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),lm(t,r,e,Pa(t,e,1,null),n));const i=ks(e,t,r.directiveStart,r);cr(i,e);const o=Wn(r,e);return o&&cr(o,e),i}(o,n,e);if(r.components.push(a),t[8]=a,i&&i.forEach(A=>A(a,e)),e.contentQueries){const A=vn();e.contentQueries(1,a,A.directiveStart)}const h=vn();return!o.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(kt(h.index),sm(n[1],h,0,h.directiveStart,h.directiveEnd,e),am(e,a)),a}(Ge,this.componentDef,Ce,ie,[l_]),oc(de,Ce,null)}finally{An()}return new mD(this.componentType,Ne,Qa(Se,Ce),Ce,Se)}}class mD extends class{}{constructor(e,n,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=n,this.hostView=this.changeDetectorRef=new XS(i),this.componentType=e}get injector(){return new B(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const tu=new Map;class CD extends $s{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new pC(this);const r=sr(e),i=function(t){return t[bu]||null}(e);i&&Zf(i),this._bootstrapComponents=ro(r.bootstrap),this._r3Injector=Tm(e,n,[{provide:$s,useValue:this},{provide:Gs,useValue:this.componentFactoryResolver}],It(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,n=tn.THROW_IF_NOT_FOUND,r=rt.Default){return e===tn||e===$s||e===Ma?this:this._r3Injector.get(e,n,r)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Eh extends class{}{constructor(e){super(),this.moduleType=e,null!==sr(e)&&function(t){const e=new Set;!function n(r){const i=sr(r,!0),o=i.id;null!==o&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${It(e)} vs ${It(e.name)}`)}(o,tu.get(o),r),tu.set(o,r));const a=ro(i.imports);for(const h of a)e.has(h)||(e.add(h),n(h))}(t)}(e)}create(e){return new CD(this.moduleType,e)}}function _h(t){return e=>{setTimeout(t,void 0,e)}}const Ao=class extends Z{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){var i,o,a;let h=e,A=n||(()=>null),V=r;if(e&&"object"==typeof e){const Y=e;h=null===(i=Y.next)||void 0===i?void 0:i.bind(Y),A=null===(o=Y.error)||void 0===o?void 0:o.bind(Y),V=null===(a=Y.complete)||void 0===a?void 0:a.bind(Y)}this.__isAsync&&(A=_h(A),h&&(h=_h(h)),V&&(V=_h(V)));const q=super.subscribe({next:h,error:A,complete:V});return e instanceof f&&e.add(q),q}};Symbol;const ed=new ut("Application Initializer");let ru=(()=>{class t{constructor(n){this.appInits=n,this.resolve=ql,this.reject=ql,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const o=this.appInits[i]();if(Kf(o))n.push(o);else if(hy(o)){const a=new Promise((h,A)=>{o.subscribe({complete:h,error:A})});n.push(a)}}Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(Ut(ed,8))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const Oc=new ut("AppId"),wR={provide:Oc,useFactory:function(){return`${kh()}${kh()}${kh()}`},deps:[]};function kh(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const WC=new ut("Platform Initializer"),xh=new ut("Platform ID"),SR=new ut("appBootstrapListener");let Lh=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const ns=new ut("LocaleId"),zC=new ut("DefaultCurrencyCode");class DR{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}const Fh=function(t){return new Eh(t)},RR=Fh,AR=function(t){return Promise.resolve(Fh(t))},KC=function(t){const e=Fh(t),r=ro(sr(t).declarations).reduce((i,o)=>{const a=pn(o);return a&&i.push(new mC(a)),i},[]);return new DR(e,r)},PR=KC,OR=function(t){return Promise.resolve(KC(t))};let nd=(()=>{class t{constructor(){this.compileModuleSync=RR,this.compileModuleAsync=AR,this.compileModuleAndAllComponentsSync=PR,this.compileModuleAndAllComponentsAsync=OR}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const kR=(()=>Promise.resolve(0))();function Uh(t){"undefined"==typeof Zone?kR.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class tr{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ao(!1),this.onMicrotaskEmpty=new Ao(!1),this.onStable=new Ao(!1),this.onError=new Ao(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let t=Dt.requestAnimationFrame,e=Dt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Dt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Bh(t),t.isCheckStableRunning=!0,Vh(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Bh(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,o,a,h)=>{try{return QC(t),n.invokeTask(i,o,a,h)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&e(),JC(t)}},onInvoke:(n,r,i,o,a,h,A)=>{try{return QC(t),n.invoke(i,o,a,h,A)}finally{t.shouldCoalesceRunChangeDetection&&e(),JC(t)}},onHasTask:(n,r,i,o)=>{n.hasTask(i,o),r===i&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,Bh(t),Vh(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,i,o)=>(n.handleError(i,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!tr.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(tr.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+i,e,LR,ql,ql);try{return o.runTask(a,n,r)}finally{o.cancelTask(a)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const LR={};function Vh(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Bh(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function QC(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function JC(t){t._nesting--,Vh(t)}class VR{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ao,this.onMicrotaskEmpty=new Ao,this.onStable=new Ao,this.onError=new Ao}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}let jh=(()=>{class t{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{tr.assertNotInAngularZone(),Uh(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Uh(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,r,i){return[]}}return t.\u0275fac=function(n){return new(n||t)(Ut(tr))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),YC=(()=>{class t{constructor(){this._applications=new Map,Hh.addToWindow(this)}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return Hh.findTestabilityInTree(this,n,r)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();class BR{addToWindow(e){}findTestabilityInTree(e,n,r){return null}}let Hh=new BR,XC=!0,ZC=!1;let Pi;const t0=new ut("AllowMultipleToken");function n0(t,e,n=[]){const r=`Platform: ${e}`,i=new ut(r);return(o=[])=>{let a=r0();if(!a||a.injector.get(t0,!1))if(t)t(n.concat(o).concat({provide:i,useValue:!0}));else{const h=n.concat(o).concat({provide:i,useValue:!0},{provide:sc,useValue:"platform"});!function(t){if(Pi&&!Pi.destroyed&&!Pi.injector.get(t0,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Pi=t.get(i0);const e=t.get(WC,null);e&&e.forEach(n=>n())}(tn.create({providers:h,name:r}))}return function(t){const e=r0();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function r0(){return Pi&&!Pi.destroyed?Pi:null}let i0=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const h=function(t,e){let n;return n="noop"===t?new VR:("zone.js"===t?void 0:t)||new tr({enableLongStackTrace:(ZC=!0,XC),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),A=[{provide:tr,useValue:h}];return h.run(()=>{const V=tn.create({providers:A,parent:this.injector,name:n.moduleType.name}),q=n.create(V),Y=q.injector.get(Bs,null);if(!Y)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return h.runOutsideAngular(()=>{const ie=h.onError.subscribe({next:de=>{Y.handleError(de)}});q.onDestroy(()=>{qh(this._modules,q),ie.unsubscribe()})}),function(t,e,n){try{const r=n();return Kf(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(Y,h,()=>{const ie=q.injector.get(ru);return ie.runInitializers(),ie.donePromise.then(()=>(Zf(q.injector.get(ns,Ul)||Ul),this._moduleDoBootstrap(q),q))})})}bootstrapModule(n,r=[]){const i=o0({},r);return function(t,e,n){const r=new Eh(n);return Promise.resolve(r)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(n){const r=n.injector.get(Mc);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new Error(`The module ${It(n.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(Ut(tn))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function o0(t,e){return Array.isArray(e)?e.reduce(o0,t):Object.assign(Object.assign({},t),e)}let Mc=(()=>{class t{constructor(n,r,i,o,a){this._zone=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const h=new M(V=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{V.next(this._stable),V.complete()})}),A=new M(V=>{let q;this._zone.runOutsideAngular(()=>{q=this._zone.onStable.subscribe(()=>{tr.assertNotInAngularZone(),Uh(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,V.next(!0))})})});const Y=this._zone.onUnstable.subscribe(()=>{tr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{V.next(!1)}))});return()=>{q.unsubscribe(),Y.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return he(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof M?t[0]:ke(e)(ze(t,n))}(h,A.pipe(t=>bt()(function(t,e){return function(r){let i;i="function"==typeof t?t:function(){return t};const o=Object.create(r,Ot);return o.source=r,o.subjectFactory=i,o}}(Ys)(t))))}bootstrap(n,r){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=n instanceof kv?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(i.componentType);const o=function(t){return t.isBoundToModule}(i)?void 0:this._injector.get($s),h=i.create(tn.NULL,[],r||i.selector,o),A=h.location.nativeElement,V=h.injector.get(jh,null),q=V&&h.injector.get(YC);return V&&q&&q.registerApplication(A,V),h.onDestroy(()=>{this.detachView(h.hostView),qh(this.components,h),q&&q.unregisterApplication(A)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;qh(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(SR,[]).concat(this._bootstrapListeners).forEach(i=>i(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(n){return new(n||t)(Ut(tr),Ut(tn),Ut(Bs),Ut(Gs),Ut(ru))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function qh(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const hA=n0(null,"core",[{provide:xh,useValue:"unknown"},{provide:i0,deps:[tn]},{provide:YC,deps:[]},{provide:Lh,deps:[]}]),vA=[{provide:Mc,useClass:Mc,deps:[tr,tn,Bs,Gs,ru]},{provide:hD,deps:[tr],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(n){e.push(n)}}},{provide:ru,useClass:ru,deps:[[new eo,ed]]},{provide:nd,useClass:nd,deps:[]},wR,{provide:vc,useFactory:function(){return sI},deps:[]},{provide:Ja,useFactory:function(){return aI},deps:[]},{provide:ns,useFactory:function(t){return Zf(t=t||"undefined"!=typeof $localize&&$localize.locale||Ul),t},deps:[[new Ju(ns),new eo,new Us]]},{provide:zC,useValue:"USD"}];let TA=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(Ut(Mc))},t.\u0275mod=wr({type:t}),t.\u0275inj=Wr({providers:vA}),t})(),fd=null;function Fc(){return fd}const nr=new ut("DocumentToken");var kn=(()=>((kn=kn||{})[kn.Zero=0]="Zero",kn[kn.One=1]="One",kn[kn.Two=2]="Two",kn[kn.Few=3]="Few",kn[kn.Many=4]="Many",kn[kn.Other=5]="Other",kn))();const RP=function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=uv(e);if(n)return n;const r=e.split("-")[0];if(n=uv(r),n)return n;if("en"===r)return Lw;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[tt.PluralCase]};class Ed{}let rO=(()=>{class t extends Ed{constructor(n){super(),this.locale=n}getPluralCategory(n,r){switch(RP(r||this.locale)(n)){case kn.Zero:return"zero";case kn.One:return"one";case kn.Two:return"two";case kn.Few:return"few";case kn.Many:return"many";default:return"other"}}}return t.\u0275fac=function(n){return new(n||t)(Ut(ns))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),G0=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new lO,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){$0("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){$0("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(Lt(lo),Lt(Ro))},t.\u0275dir=Ln({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class lO{constructor(){this.$implicit=null,this.ngIf=null}}function $0(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${It(e)}'.`)}let LO=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=wr({type:t}),t.\u0275inj=Wr({providers:[{provide:Ed,useClass:rO}]}),t})();class mp extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(t){fd||(fd=t)}(new mp)}onAndCancel(e,n,r){return e.addEventListener(n,r,!1),()=>{e.removeEventListener(n,r,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=(Bc=Bc||document.querySelector("base"),Bc?Bc.getAttribute("href"):null);return null==n?null:function(t){_d=_d||document.createElement("a"),_d.setAttribute("href",t);const e=_d.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){Bc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,o]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}(document.cookie,e)}}let _d,Bc=null;const J0=new ut("TRANSITION_ID"),WO=[{provide:ed,useFactory:function(t,e,n){return()=>{n.get(ru).donePromise.then(()=>{const r=Fc(),i=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<i.length;o++)r.remove(i[o])})}},deps:[J0,nr,tn],multi:!0}];class yp{static init(){!function(t){Hh=t}(new yp)}addToWindow(e){Dt.getAngularTestability=(r,i=!0)=>{const o=e.findTestabilityInTree(r,i);if(null==o)throw new Error("Could not find testability for element.");return o},Dt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Dt.getAllAngularRootElements=()=>e.getAllRootElements(),Dt.frameworkStabilizers||(Dt.frameworkStabilizers=[]),Dt.frameworkStabilizers.push(r=>{const i=Dt.getAllAngularTestabilities();let o=i.length,a=!1;const h=function(A){a=a||A,o--,0==o&&r(a)};i.forEach(function(A){A.whenStable(h)})})}findTestabilityInTree(e,n,r){if(null==n)return null;const i=e.getTestability(n);return null!=i?i:r?Fc().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null}}let zO=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const jc=new ut("EventManagerPlugins");let Sd=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>i.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}addGlobalEventListener(n,r,i){return this._findPluginFor(r).addGlobalEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const i=this._plugins;for(let o=0;o<i.length;o++){const a=i[o];if(a.supports(n))return this._eventNameToPlugin.set(n,a),a}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(Ut(jc),Ut(tr))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();class vp{constructor(e){this._doc=e}addGlobalEventListener(e,n,r){const i=Fc().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${n}`);return this.addEventListener(i,n,r)}}let X0=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})(),Hc=(()=>{class t extends X0{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,i){n.forEach(o=>{const a=this._doc.createElement("style");a.textContent=o,i.push(r.appendChild(a))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(Z0),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(n,i,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(Z0))}}return t.\u0275fac=function(n){return new(n||t)(Ut(nr))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();function Z0(t){Fc().remove(t)}const Cp={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Tp=/%COMP%/g;function Id(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Id(t,i,n):(i=i.replace(Tp,t),n.push(i))}return n}function nT(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let bp=(()=>{class t{constructor(n,r,i){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Ep(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case rn.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new uM(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(n),i}case 1:case rn.ShadowDom:return new cM(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const i=Id(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(Ut(Sd),Ut(Hc),Ut(Oc))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();class Ep{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,n){return n?document.createElementNS(Cp[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){e.appendChild(n)}insertBefore(e,n,r){e&&e.insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const o=Cp[i];o?e.setAttributeNS(o,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=Cp[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Gr.DashCase|Gr.Important)?e.style.setProperty(n,r,i&Gr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Gr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,nT(r)):this.eventManager.addEventListener(e,n,nT(r))}}class uM extends Ep{constructor(e,n,r,i){super(e),this.component=r;const o=Id(i+"-"+r.id,r.styles,[]);n.addStyles(o),this.contentAttr=function(t){return"_ngcontent-%COMP%".replace(Tp,t)}(i+"-"+r.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(Tp,t)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}class cM extends Ep{constructor(e,n,r,i){super(e),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=Id(i.id,i.styles,[]);for(let a=0;a<o.length;a++){const h=document.createElement("style");h.textContent=o[a],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let lM=(()=>{class t extends vp{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}}return t.\u0275fac=function(n){return new(n||t)(Ut(nr))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const oT=["alt","control","meta","shift"],yM={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},sT={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},vM={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let CM=(()=>{class t extends vp{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const o=t.parseEventName(r),a=t.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Fc().onAndCancel(n,o.domEventName,a))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=t._normalizeKey(r.pop());let a="";if(oT.forEach(A=>{const V=r.indexOf(A);V>-1&&(r.splice(V,1),a+=A+".")}),a+=o,0!=r.length||0===o.length)return null;const h={};return h.domEventName=i,h.fullKey=a,h}static getEventFullKey(n){let r="",i=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&sT.hasOwnProperty(e)&&(e=sT[e]))}return yM[e]||e}(n);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),oT.forEach(o=>{o!=i&&vM[o](n)&&(r+=o+".")}),r+=i,r}static eventCallback(n,r,i){return o=>{t.getEventFullKey(o)===n&&i.runGuarded(()=>r(o))}}static _normalizeKey(n){switch(n){case"esc":return"escape";default:return n}}}return t.\u0275fac=function(n){return new(n||t)(Ut(nr))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac}),t})();const DM=n0(hA,"browser",[{provide:xh,useValue:"browser"},{provide:WC,useValue:function(){mp.makeCurrent(),yp.init()},multi:!0},{provide:nr,useFactory:function(){return function(t){Is=t}(document),document},deps:[]}]),RM=[[],{provide:sc,useValue:"root"},{provide:Bs,useFactory:function(){return new Bs},deps:[]},{provide:jc,useClass:lM,multi:!0,deps:[nr,tr,xh]},{provide:jc,useClass:CM,multi:!0,deps:[nr]},[],{provide:bp,useClass:bp,deps:[Sd,Hc,Oc]},{provide:Gl,useExisting:bp},{provide:X0,useExisting:Hc},{provide:Hc,useClass:Hc,deps:[nr]},{provide:jh,useClass:jh,deps:[tr]},{provide:Sd,useClass:Sd,deps:[jc,tr]},{provide:class{},useClass:zO,deps:[]},[]];let AM=(()=>{class t{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:t,providers:[{provide:Oc,useValue:n.appId},{provide:J0,useExisting:Oc},WO]}}}return t.\u0275fac=function(n){return new(n||t)(Ut(t,12))},t.\u0275mod=wr({type:t}),t.\u0275inj=Wr({providers:RM,imports:[LO,TA]}),t})();"undefined"!=typeof window&&window;var Dd=c(8239),FM=c(5436);class Dp{constructor(){this.middlewares={}}static getInstance(){return this._instance||(this._instance=new Dp),this._instance}subscribe(e,n){this.middlewares[e]=n}create(){return console.log("[CustomStore][create]"),window.WebChat.createStore({},({dispatch:n})=>r=>i=>{let o=i;if(i&&i.payload)for(const a of Object.keys(this.middlewares)){const h=this.middlewares[a];if(h.applicable(o)){const A=h.apply(o);A.dispatchAction&&n(A.dispatchAction),A.nextAction&&(o=A.nextAction)}}return r(o)})}}var su=c(8139);const uT=t=>{if(t){const e=t.split(/\s/).reduce((n,r)=>n+r.slice(0,1),"");return e.length>1?e.substring(0,2).toUpperCase():t.substring(0,2).toUpperCase()}return""};var au=(()=>(function(t){t.Sending="sending",t.SendFailed="send failed",t.Sent="sent"}(au||(au={})),au))();class $M{constructor(e){this.dataMaskingRules=e,console.log("[DataMaskingRules]"),console.log(this.dataMaskingRules)}applicable(e){const{text:n}=e.payload;return!!(Object.keys(this.dataMaskingRules).length>0&&n&&"WEB_CHAT/SEND_MESSAGE"===e.type)}apply(e){return{dispatchAction:null,nextAction:this.applyDataMasking(e)}}applyDataMasking(e){let{text:r}=e.payload;if(Object.keys(this.dataMaskingRules).length>0)for(const i of Object.values(this.dataMaskingRules)){const o=new RegExp(i,"g");let a;for(;a=o.exec(r);){const h=a[0].replace(/./g,"#");r=r.replace(a[0],h)}}return e.payload.text=r,e}}const Rd_omnichannelConfig_orgId="d367c413-e0b9-408b-ae1c-382499b369ae",Rd_omnichannelConfig_orgUrl="https://omnichannel-crm.omnichannelengagementhub.com",Rd_omnichannelConfig_widgetId="3a352b95-5d67-4e47-af28-eca029b03928";let Rp=(()=>{class t{}return t.canUploadAttachment=!1,t})();function Ad(t,e){return new M(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let o=0,a=0;for(let h=0;h<r;h++){const A=$e(t[h]);let V=!1;n.add(A.subscribe({next:q=>{V||(V=!0,a++),i[h]=q},error:q=>n.error(q),complete:()=>{o++,(o===r||!V)&&(a===r&&n.next(e?e.reduce((q,Y,ie)=>(q[Y]=i[ie],q),{}):i),n.complete())}}))}})}class XM extends f{constructor(e,n){super()}schedule(e,n=0){return this}}class ZM extends XM{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){if(this.closed)return this;this.state=e;const r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(i,this.id,n),this}requestAsyncId(e,n,r=0){return setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!==r&&this.delay===r&&!1===this.pending)return n;clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,r=!1;try{this.work(e)}catch(o){r=!0,i=!!o&&o||new Error(o)}if(r)return this.unsubscribe(),i}_unsubscribe(){const e=this.id,n=this.scheduler,r=n.actions,i=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&r.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null}}let cT=(()=>{class t{constructor(n,r=t.now){this.SchedulerAction=n,this.now=r}schedule(n,r=0,i){return new this.SchedulerAction(this,n).schedule(i,r)}}return t.now=()=>Date.now(),t})();class os extends cT{constructor(e,n=cT.now){super(e,()=>os.delegate&&os.delegate!==this?os.delegate.now():n()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,n=0,r){return os.delegate&&os.delegate!==this?os.delegate.schedule(e,n,r):super.schedule(e,n,r)}flush(e){const{actions:n}=this;if(this.active)return void n.push(e);let r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this.active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}const n1=new class extends os{}(class extends ZM{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!==r&&r>0||null===r&&this.delay>0?super.requestAsyncId(e,n,r):e.flush(this)}}),r1=new M(t=>t.complete());class ii{constructor(e,n,r){this.kind=e,this.value=n,this.error=r,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,n,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return n&&n(this.error);case"C":return r&&r()}}accept(e,n,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,n,r)}toObservable(){switch(this.kind){case"N":return function(...t){let e=t[t.length-1];return he(e)?(t.pop(),Ie(t,e)):ze(t)}(this.value);case"E":return function(t,e){return new M(n=>n.error(t))}(this.error);case"C":return function(t){return t?function(t){return new M(e=>t.schedule(()=>e.complete()))}(t):r1}()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new ii("N",e):ii.undefinedValueNotification}static createError(e){return new ii("E",void 0,e)}static createComplete(){return ii.completeNotification}}ii.completeNotification=new ii("C"),ii.undefinedValueNotification=new ii("N",void 0);class Pd extends m{constructor(e,n,r=0){super(e),this.scheduler=n,this.delay=r}static dispatch(e){const{notification:n,destination:r}=e;n.observe(r),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(Pd.dispatch,this.delay,new l1(e,this.destination)))}_next(e){this.scheduleMessage(ii.createNext(e))}_error(e){this.scheduleMessage(ii.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(ii.createComplete()),this.unsubscribe()}}class l1{constructor(e,n){this.notification=e,this.destination=n}}class lT extends Z{constructor(e=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r){super(),this.scheduler=r,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new d1(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;let a;if(this.closed)throw new $;if(this.isStopped||this.hasError?a=f.EMPTY:(this.observers.push(e),a=new ce(this,e)),i&&e.add(e=new Pd(e,i)),n)for(let h=0;h<o&&!e.closed;h++)e.next(r[h]);else for(let h=0;h<o&&!e.closed;h++)e.next(r[h].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),a}_getNow(){return(this.scheduler||n1).now()}_trimBufferThenGetEvents(){const e=this._getNow(),n=this._bufferSize,r=this._windowTime,i=this._events,o=i.length;let a=0;for(;a<o&&!(e-i[a].time<r);)a++;return o>n&&(a=Math.max(a,o-n)),a>0&&i.splice(0,a),i}}class d1{constructor(e,n){this.time=e,this.value=n}}let f1=(()=>{class t{constructor(n){this.document=n,this._loadedLibraries={}}lazyLoad(){return function(...t){if(1===t.length){const e=t[0];if(l(e))return Ad(e,null);if(C(e)&&Object.getPrototypeOf(e)===Object.prototype){const n=Object.keys(e);return Ad(n.map(r=>e[r]),n)}}if("function"==typeof t[t.length-1]){const e=t.pop();return Ad(t=1===t.length&&l(t[0])?t[0]:t,null).pipe(Ee(n=>e(...n)))}return Ad(t,null)}([this.loadScript("https://cdn.botframework.com/botframework-webchat/4.9.2/webchat.js")])}loadScript(n){if(this._loadedLibraries[n])return this._loadedLibraries[n].asObservable();this._loadedLibraries[n]=new lT;const r=this.document.createElement("script");return r.type="text/javascript",r.async=!0,r.src=n,r.onload=()=>{this._loadedLibraries[n].next(),this._loadedLibraries[n].complete()},this.document.body.appendChild(r),this._loadedLibraries[n].asObservable()}loadStyle(n){if(this._loadedLibraries[n])return this._loadedLibraries[n].asObservable();this._loadedLibraries[n]=new lT;const r=this.document.createElement("link");return r.type="text/css",r.href=n,r.rel="stylesheet",r.onload=()=>{this._loadedLibraries[n].next(),this._loadedLibraries[n].complete()},document.getElementsByTagName("head")[0].appendChild(r),this._loadedLibraries[n].asObservable()}}return t.\u0275fac=function(n){return new(n||t)(Ut(nr))},t.\u0275prov=Ft({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function h1(t,e){1&t&&(so(0,"div",8),so(1,"span",9),hc(2," \u{1f440} "),ao(),ao())}function p1(t,e){if(1&t){const n=zf();so(0,"div",3),so(1,"div",4),hc(2,"LiveChat with Omnichannel Chat SDK "),so(3,"span",5),xl("click",function(){return jr(n),Ll().endChat()}),hc(4," \u274c "),ao(),ao(),Nl(5,h1,3,0,"div",6),function(t,e,n,r){so(t,e,n,r),ao()}(6,"div",7),ao()}if(2&t){const n=Ll();wl(5),dc("ngIf",n.loading)}}function g1(t,e){if(1&t){const n=zf();so(0,"div",10),xl("click",function(){return jr(n),Ll().startChat()}),so(1,"span"),hc(2," \u{1f44b} "),ao(),ao()}}const dT=(()=>{const t={orgId:Rd_omnichannelConfig_orgId||"",orgUrl:Rd_omnichannelConfig_orgUrl||"",widgetId:Rd_omnichannelConfig_widgetId||""},e=new URLSearchParams(window.location.search);return null!==e.get("orgUrl")&&(t.orgUrl=e.get("orgUrl")),null!==e.get("orgId")&&(t.orgId=e.get("orgId")),null!==e.get("widgetId")&&(t.widgetId=e.get("widgetId")),t})(),fT=(()=>{const t={telemetry:{disable:!1,ariaTelemetryKey:""}},e=new URLSearchParams(window.location.search);return null!==e.get("telemetry")&&(t.telemetry.disable="true"!=e.get("telemetry")),null!==e.get("ariaTelemetryKey")&&(t.telemetry.ariaTelemetryKey=e.get("ariaTelemetryKey")||""),t})(),hT=(()=>{const t={disable:!0},e=new URLSearchParams(window.location.search);return null!==e.get("debug")&&(t.disable="true"!=e.get("debug")),t})();console.log("%c [OmnichannelConfig]","background-color:#001433;color:#fff"),console.log(dT),console.log("%c [debugConfig]","background-color:#001433;color:#fff"),console.log(hT),console.log("%c [telemetryConfig]","background-color:#001433;color:#fff"),console.log(fT);const m1=(console.log("[createAvatarMiddleware]"),()=>e=>n=>{console.log("[AvatarMiddleware]");const{activity:{channelData:{tags:r},from:{name:i},text:o},fromUser:a}=n;return console.log(n),r&&r.includes("system")?(console.log(`[AvatarMiddleware][Message][System] ${o}`),su.createElement("div",null,"\u2757")):null!=a&&(a?a?(console.log(`[AvatarMiddleware][Message][Customer] ${o}`),su.createElement("div",{className:"webchat__avatar"},su.createElement("p",{className:"webchat__avatar_initials"}," ",uT(i)||"CU","  "))):e(n):(console.log(`[AvatarMiddleware][Message][Agent] ${o}`),su.createElement("div",{className:"webchat__avatar"},su.createElement("p",{className:"webchat__avatar_initials"}," ",uT(i)," "))))}),y1=(console.log("[createActivityMiddleware]"),()=>e=>n=>{if(console.log("%c [ActivityMiddleware]","background: #2a9fd4; color: #fff"),console.log(n),n.activity){if(n.activity.channelData&&n.activity.channelData.tags&&n.activity.channelData.tags.includes("system"))return console.log(`%c [ActivityMiddleware][Message][System] ${n.activity.text}`,"background: #2a9fd4; color: #fff"),r=>su.createElement("div",{key:n.activity.id,className:"system-message"},e(n)(r));if(void 0===n.activity.text||null==n.activity.text)return e(n);"bot"===n.activity.from.role&&console.log(`%c [ActivityMiddleware][Message][Agent] ${n.activity.text}`,"background: #2a9fd4; color: #fff"),"user"===n.activity.from.role&&console.log(`%c [ActivityMiddleware][Message][Customer] ${n.activity.text}`,"background: #2a9fd4; color: #fff")}return e(n)}),v1=()=>e=>n=>{console.log("%c [activityStatusMiddleware]","background: #238636; color: #fff"),console.log(n);let r="";(t=>t.activity.channelData&&t.activity.channelData.tags&&t.activity.channelData.tags.includes("system"))(n)?r="System":(t=>"bot"===t.activity.from.role)(n)?r="Agent":(t=>"user"===t.activity.from.role)(n)&&(r="Customer"),console.log(`%c [activityStatusMiddleware][Message][${r}] ${n.activity.text}`,"background: #238636; color: #fff"),n.sendState===au.Sent?console.log(`%c [activityStatusMiddleware][Message][${r}][Status] Sent!`,"background: #238636; color: #fff"):n.sendState===au.Sending?console.log(`%c [activityStatusMiddleware][Message][${r}][Status] Sending...`,"background: #238636; color: #fff"):n.sendState===au.SendFailed&&console.log(`%c [activityStatusMiddleware][Message][${r}][Status] Failed :(`,"background: #238636; color: #fff")},pT={bubbleBorderRadius:10,bubbleNubSize:10,bubbleNubOffset:15,bubbleFromUserBorderRadius:10,bubbleFromUserNubSize:10,bubbleFromUserNubOffset:15,bubbleFromUserBackground:"rgb(246, 246, 246)"};let T1=(()=>{class t{constructor(n,r){this.webChatControlService=n,this.document=r,this.title="angular-botframework-webchat-control",this.webChat=null,this.chatSDK=null,this.chatAdapter=null,this.loading=!1,this.hasChatStarted=!1,this.webChatStore=null}ngOnInit(){var n=this;return(0,Dd.Z)(function*(){console.log("[ngOnInit]"),n.webChatControlService.lazyLoad().subscribe(function(){var r=(0,Dd.Z)(function*(i){n.webChat=window.WebChat;const o=Object.assign({},fT),a=new FM.Mg(dT,o);a.setDebug(!hT.disable),yield a.initialize(),n.chatSDK=a,n.webChat=window.WebChat,(t=>{Rp.canUploadAttachment="true"===t.LiveWSAndLiveChatEngJoin.msdyn_enablefileattachmentsforcustomers||!1})(yield a.getLiveChatConfig()),pT.hideUploadButton=!Rp.canUploadAttachment;const A=localStorage.getItem("liveChatContext");A&&Object.keys(JSON.parse(A)).length>0&&(console.log("[liveChatContext]"),console.log(A))});return function(i){return r.apply(this,arguments)}}())})()}startChat(){var n=this;return(0,Dd.Z)(function*(){var r,i,o,a;console.log("[startChat]");const h=yield null===(r=n.chatSDK)||void 0===r?void 0:r.getDataMaskingRules();console.log(h);const A=(console.log("[createCustomStore]"),Dp.getInstance());n.webChatStore=A.create(),A.subscribe("DataMasking",(t=>(console.log("[createDataMaskingMiddleware]"),new $M(t)))(h));const V={},q=localStorage.getItem("liveChatContext");q&&Object.keys(JSON.parse(q)).length>0&&(console.log("[liveChatContext]"),V.liveChatContext=JSON.parse(q)),n.hasChatStarted=!0,n.loading=!0,yield null===(i=n.chatSDK)||void 0===i?void 0:i.startChat(V);const Y=yield null===(o=n.chatSDK)||void 0===o?void 0:o.getCurrentLiveChatContext();Y&&Object.keys(Y).length&&localStorage.setItem("liveChatContext",JSON.stringify(Y));const ie=yield null===(a=n.chatSDK)||void 0===a?void 0:a.createChatAdapter();n.chatAdapter=ie,n.loading=!1,n.webChat.renderWebChat({directLine:ie,sendTypingIndicator:!0,styleOptions:pT,store:n.webChatStore,avatarMiddleware:m1,activityMiddleware:y1,activityStatusMiddleware:v1},n.document.getElementById("chat-container"))})()}endChat(){var n=this;return(0,Dd.Z)(function*(){var r;console.log("[endChat]"),yield null===(r=n.chatSDK)||void 0===r?void 0:r.endChat(),n.hasChatStarted=!1;const i=n.document.getElementById("chat-container");for(;i.firstChild;)i.firstChild.remove()})()}}return t.\u0275fac=function(n){return new(n||t)(Lt(f1),Lt(nr))},t.\u0275cmp=ji({type:t,selectors:[["app-root"]],decls:3,vars:2,consts:[["id","root"],["id","chat-root",4,"ngIf"],["id","chat-button",3,"click",4,"ngIf"],["id","chat-root"],[1,"chat-header"],[3,"click"],["id","loading-screen",4,"ngIf"],["id","chat-container"],["id","loading-screen"],["id","loader"],["id","chat-button",3,"click"]],template:function(n,r){1&n&&(so(0,"div",0),Nl(1,p1,7,1,"div",1),Nl(2,g1,3,0,"div",2),ao()),2&n&&(wl(1),dc("ngIf",r.hasChatStarted),wl(1),dc("ngIf",!r.hasChatStarted&&!r.loading))},directives:[G0],styles:['body[_ngcontent-%COMP%]{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}code[_ngcontent-%COMP%]{font-family:source-code-pro,Menlo,Monaco,Consolas,"Courier New",monospace}#chat-root[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:400px;max-width:400px;min-height:600px;max-height:600px;width:400px;height:600px;position:fixed;right:0;bottom:0;border-radius:4px;margin:0 20px 60px 0;box-shadow:0 0 15px 2px #161b224d;font-family:"Segoe UI",Arial,sans-serif}#chat-container[_ngcontent-%COMP%]{width:100%;height:100%}.chat-header[_ngcontent-%COMP%]{border-bottom:#E6E6E6 solid 1px;padding:10px;display:flex;justify-content:space-between;cursor:pointer}#loading-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:400px;max-width:400px;min-height:600px;max-height:600px;width:400px;height:600px;position:fixed;right:0;bottom:0;border-radius:4px;margin:0 20px 60px 0;box-shadow:0 0 15px 2px #161b224d;align-items:center;justify-content:center}@keyframes spin{to{transform:rotate(360deg)}}#loader[_ngcontent-%COMP%]{font-size:120px;animation:spin 2s linear infinite}#chat-button[_ngcontent-%COMP%]{position:fixed;right:0;bottom:0;border-radius:32px;background-color:#0078d4;box-shadow:0 0 5px 2px #0078d4;padding:10px;margin:0 20px 20px 0;color:#fff;font-size:32px;cursor:pointer}#chat-button[_ngcontent-%COMP%]:hover{box-shadow:0 0 20px 2px #0078d4;transition:all 2s}']}),t})(),b1=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=wr({type:t,bootstrap:[T1]}),t.\u0275inj=Wr({providers:[],imports:[[AM]]}),t})();(function(){if(ZC)throw new Error("Cannot enable prod mode after platform setup.");XC=!1})(),DM().bootstrapModule(b1).catch(t=>console.error(t))},1907:Q=>{function u(s,_,d,p,T,l,C){try{var P=s[l](C),S=P.value}catch(f){return void d(f)}P.done?_(S):Promise.resolve(S).then(p,T)}Q.exports=function(s){return function(){var _=this,d=arguments;return new Promise(function(p,T){var l=s.apply(_,d);function C(S){u(l,p,T,C,P,"next",S)}function P(S){u(l,p,T,C,P,"throw",S)}C(void 0)})}},Q.exports.default=Q.exports,Q.exports.__esModule=!0},8884:Q=>{Q.exports=function(c,s){if(!(c instanceof s))throw new TypeError("Cannot call a class as a function")},Q.exports.default=Q.exports,Q.exports.__esModule=!0},2805:Q=>{function u(s,_){for(var d=0;d<_.length;d++){var p=_[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(s,p.key,p)}}Q.exports=function(s,_,d){return _&&u(s.prototype,_),d&&u(s,d),s},Q.exports.default=Q.exports,Q.exports.__esModule=!0},1819:Q=>{Q.exports=function(c,s,_){return s in c?Object.defineProperty(c,s,{value:_,enumerable:!0,configurable:!0,writable:!0}):c[s]=_,c},Q.exports.default=Q.exports,Q.exports.__esModule=!0},1127:Q=>{Q.exports=function(c){return c&&c.__esModule?c:{default:c}},Q.exports.default=Q.exports,Q.exports.__esModule=!0},1298:Q=>{function u(c){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Q.exports=u=function(_){return typeof _},Q.exports.default=Q.exports,Q.exports.__esModule=!0):(Q.exports=u=function(_){return _&&"function"==typeof Symbol&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},Q.exports.default=Q.exports,Q.exports.__esModule=!0),u(c)}Q.exports=u,Q.exports.default=Q.exports,Q.exports.__esModule=!0},6533:(Q,u,c)=>{Q.exports=c(7941)},4762:(Q,u,c)=>{"use strict";c.d(u,{ZT:()=>_,_T:()=>p,qq:()=>N,FC:()=>F,V2:()=>U,KL:()=>k});var s=function(oe,Z){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ue,he){ue.__proto__=he}||function(ue,he){for(var Ee in he)Object.prototype.hasOwnProperty.call(he,Ee)&&(ue[Ee]=he[Ee])})(oe,Z)};function _(oe,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function ue(){this.constructor=oe}s(oe,Z),oe.prototype=null===Z?Object.create(Z):(ue.prototype=Z.prototype,new ue)}function p(oe,Z){var ue={};for(var he in oe)Object.prototype.hasOwnProperty.call(oe,he)&&Z.indexOf(he)<0&&(ue[he]=oe[he]);if(null!=oe&&"function"==typeof Object.getOwnPropertySymbols){var Ee=0;for(he=Object.getOwnPropertySymbols(oe);Ee<he.length;Ee++)Z.indexOf(he[Ee])<0&&Object.prototype.propertyIsEnumerable.call(oe,he[Ee])&&(ue[he[Ee]]=oe[he[Ee]])}return ue}function N(oe){return this instanceof N?(this.v=oe,this):new N(oe)}function F(oe,Z,ue){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ee,he=ue.apply(oe,Z||[]),se=[];return Ee={},K("next"),K("throw"),K("return"),Ee[Symbol.asyncIterator]=function(){return this},Ee;function K(ae){he[ae]&&(Ee[ae]=function(ve){return new Promise(function(ye,ge){se.push([ae,ve,ye,ge])>1||pe(ae,ve)})})}function pe(ae,ve){try{!function(ae){ae.value instanceof N?Promise.resolve(ae.value.v).then(J,ne):te(se[0][2],ae)}(he[ae](ve))}catch(ye){te(se[0][3],ye)}}function J(ae){pe("next",ae)}function ne(ae){pe("throw",ae)}function te(ae,ve){ae(ve),se.shift(),se.length&&pe(se[0][0],se[0][1])}}function U(oe){var Z,ue;return Z={},he("next"),he("throw",function(Ee){throw Ee}),he("return"),Z[Symbol.iterator]=function(){return this},Z;function he(Ee,se){Z[Ee]=oe[Ee]?function(K){return(ue=!ue)?{value:N(oe[Ee](K)),done:"return"===Ee}:se?se(K):K}:se}}function k(oe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ue,Z=oe[Symbol.asyncIterator];return Z?Z.call(oe):(oe=function(oe){var Z="function"==typeof Symbol&&Symbol.iterator,ue=Z&&oe[Z],he=0;if(ue)return ue.call(oe);if(oe&&"number"==typeof oe.length)return{next:function(){return oe&&he>=oe.length&&(oe=void 0),{value:oe&&oe[he++],done:!oe}}};throw new TypeError(Z?"Object is not iterable.":"Symbol.iterator is not defined.")}(oe),ue={},he("next"),he("throw"),he("return"),ue[Symbol.asyncIterator]=function(){return this},ue);function he(se){ue[se]=oe[se]&&function(K){return new Promise(function(pe,re){!function(se,K,pe,re){Promise.resolve(re).then(function(J){se({value:J,done:pe})},K)}(pe,re,(K=oe[se](K)).done,K.value)})}}}},8239:(Q,u,c)=>{"use strict";function s(d,p,T,l,C,P,S){try{var f=d[P](S),g=f.value}catch(E){return void T(E)}f.done?p(g):Promise.resolve(g).then(l,C)}function _(d){return function(){var p=this,T=arguments;return new Promise(function(l,C){var P=d.apply(p,T);function S(g){s(P,l,C,S,f,"next",g)}function f(g){s(P,l,C,S,f,"throw",g)}S(void 0)})}}c.d(u,{Z:()=>_})},2861:Q=>{"use strict";Q.exports=JSON.parse('{"i8":"1.1.0-beta.2"}')},6638:Q=>{"use strict";Q.exports={i8:"1.1.0"}},1528:Q=>{"use strict";Q.exports={i8:"0.3.0"}},5500:Q=>{"use strict";Q.exports={i8:"0.1.0"}},8464:Q=>{"use strict";Q.exports=JSON.parse('{"i8":"1.0.1-main.8af1160"}')},5233:Q=>{"use strict";Q.exports={i8:"0.1.2"}},8593:Q=>{"use strict";Q.exports=JSON.parse('{"_from":"axios@^0.21.4","_id":"axios@0.21.4","_inBundle":false,"_integrity":"sha512-ut5vewkiu8jjGBdqpM44XxjuCjq9LAKeHVmoVfHVzy8eHgxxq8SbAVQNovDA8mVi05kP0Ea/n/UzcSHcTJQfNg==","_location":"/axios","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"axios@^0.21.4","name":"axios","escapedName":"axios","rawSpec":"^0.21.4","saveSpec":null,"fetchSpec":"^0.21.4"},"_requiredBy":["/@microsoft/ocsdk","/@microsoft/omnichannel-ic3core"],"_resolved":"https://registry.npmjs.org/axios/-/axios-0.21.4.tgz","_shasum":"c67b90dc0568e5c1cf2b0b858c43ba28e2eda575","_spec":"axios@^0.21.4","_where":"/home/runner/work/omnichannel-demos/omnichannel-demos/angular-botframework-webchat-control/node_modules/@microsoft/ocsdk","author":{"name":"Matt Zabriskie"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"bugs":{"url":"https://github.com/axios/axios/issues"},"bundleDependencies":false,"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}],"dependencies":{"follow-redirects":"^1.14.0"},"deprecated":false,"description":"Promise based HTTP client for the browser and node.js","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"homepage":"https://axios-http.com","jsdelivr":"dist/axios.min.js","keywords":["xhr","http","ajax","promise","node"],"license":"MIT","main":"index.js","name":"axios","repository":{"type":"git","url":"git+https://github.com/axios/axios.git"},"scripts":{"build":"NODE_ENV=production grunt build","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","examples":"node ./examples/server.js","fix":"eslint --fix lib/**/*.js","postversion":"git push && git push --tags","preversion":"npm test","start":"node ./sandbox/server.js","test":"grunt test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},"typings":"./index.d.ts","unpkg":"dist/axios.min.js","version":"0.21.4"}')}},Q=>{Q(Q.s=8952)}]);