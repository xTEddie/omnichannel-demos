(self.webpackChunkangular_botframework_webchat_control=self.webpackChunkangular_botframework_webchat_control||[]).push([[179],{8255:Q=>{function m(u){return Promise.resolve().then(()=>{var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s})}m.keys=()=>[],m.resolve=m,m.id=8255,Q.exports=m},5283:(Q,m,u)=>{"use strict";u.d(m,{_:()=>s});class s extends Error{constructor(p){super(p),this.name="AbortError"}}},8764:(Q,m,u)=>{"use strict";u.r(m),u.d(m,{ChatClient:()=>bs,ChatThreadClient:()=>ka});var s={};u.r(s),u.d(s,{AddChatParticipantsRequest:()=>Ti,AddChatParticipantsResult:()=>ft,ChatError:()=>Tr,ChatMessage:()=>xt,ChatMessageContent:()=>Er,ChatMessageReadReceipt:()=>Nt,ChatMessageReadReceiptsCollection:()=>bt,ChatMessagesCollection:()=>Kn,ChatParticipant:()=>It,ChatParticipantsCollection:()=>Lr,ChatThreadItem:()=>Ei,ChatThreadProperties:()=>fr,ChatThreadsItemCollection:()=>bi,CommunicationErrorResponse:()=>Xe,CommunicationIdentifierModel:()=>ot,CommunicationUserIdentifierModel:()=>Xt,CreateChatThreadRequest:()=>Gi,CreateChatThreadResult:()=>Io,MicrosoftTeamsUserIdentifierModel:()=>dr,PhoneNumberIdentifierModel:()=>gn,SendChatMessageRequest:()=>Ci,SendChatMessageResult:()=>ei,SendReadReceiptRequest:()=>br,SendTypingNotificationRequest:()=>In,UpdateChatMessageRequest:()=>Lt,UpdateChatThreadRequest:()=>_t});var b=u(8239),h=u(4762),p=u(1326);const E=(0,p.YR)("communication-chat");var d=u(3105),T=u(2305),I=u(1643);const c=(0,u(1259).q)({packagePrefix:"Azure.Communication",namespace:"Microsoft.Communication"});var v=u(8199);const g=V=>{const{id:O}=V,x=(0,h._T)(V,["id"]);return Object.assign(Object.assign({},x),{communicationIdentifier:(0,v.J)(O)})},R=V=>{const{communicationIdentifier:O}=V,x=(0,h._T)(V,["communicationIdentifier"]);return Object.assign(Object.assign({},x),{id:(0,v.H)(O)})},D=V=>{const{participants:O,initiatorCommunicationIdentifier:x}=V,H=(0,h._T)(V,["participants","initiatorCommunicationIdentifier"]);let z=Object.assign({},H);if(x){const ae=(0,v.H)(x);z=Object.assign(Object.assign({},z),{initiator:ae})}return O&&(z=Object.assign(Object.assign({},z),{participants:null==O?void 0:O.map(ae=>R(ae))})),z},_=V=>{const{content:O,senderCommunicationIdentifier:x}=V,H=(0,h._T)(V,["content","senderCommunicationIdentifier"]);let z=Object.assign({},H);if(O&&(z=Object.assign(Object.assign({},z),{content:D(O)})),x){const ae=(0,v.H)(x);z=Object.assign(Object.assign({},z),{sender:ae})}return z},P=V=>{const{createdByCommunicationIdentifier:O}=V,x=(0,h._T)(V,["createdByCommunicationIdentifier"]);return O?Object.assign(Object.assign({},x),{createdBy:(0,v.H)(O)}):Object.assign({},x)},M=V=>{const{senderCommunicationIdentifier:O}=V,x=(0,h._T)(V,["senderCommunicationIdentifier"]);return Object.assign(Object.assign({},x),{sender:(0,v.H)(O)})};function $(V){let O="";for(let x=0;x<V.length;x++)O+=String.fromCharCode(V[x]);return btoa(O)}function j(V){const O=atob(V),x=new Uint8Array(O.length);for(let H=0;H<O.length;H++)x[H]=O.charCodeAt(H);return x}const Z="$",Y="_";function W(V,O){return"Composite"!==O&&"Dictionary"!==O&&("string"==typeof V||"number"==typeof V||"boolean"==typeof V||null!==(null==O?void 0:O.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||null==V)}const ce=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,ne=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function te(V,O){var x,H;const z=V.parsedHeaders;if("HEAD"===V.request.method)return Object.assign(Object.assign({},z),{body:V.parsedBody});const ae=O&&O.bodyMapper,ie=Boolean(null==ae?void 0:ae.nullable),me=null==ae?void 0:ae.type.name;if("Stream"===me)return Object.assign(Object.assign({},z),{blobBody:V.blobBody,readableStreamBody:V.readableStreamBody});const ke="Composite"===me&&ae.type.modelProperties||{},Ee=Object.keys(ke).some(Me=>""===ke[Me].serializedName);if("Sequence"===me||Ee){const Me=null!==(x=V.parsedBody)&&void 0!==x?x:[];for(const ze of Object.keys(ke))ke[ze].serializedName&&(Me[ze]=null===(H=V.parsedBody)||void 0===H?void 0:H[ze]);if(z)for(const ze of Object.keys(z))Me[ze]=z[ze];return!ie||V.parsedBody||z||0!==Object.getOwnPropertyNames(ke).length?Me:null}return function(V){const O=Object.assign(Object.assign({},V.headers),V.body);return V.hasNullableType&&0===Object.getOwnPropertyNames(O).length?V.shouldWrapBody?{body:null}:null:V.shouldWrapBody?Object.assign(Object.assign({},V.headers),{body:V.body}):O}({body:V.parsedBody,headers:z,hasNullableType:ie,shouldWrapBody:W(V.parsedBody,me)})}class K{constructor(O={},x=!1){this.modelMappers=O,this.isXML=x}validateConstraints(O,x,H){const z=(ae,ie)=>{throw new Error(`"${H}" with value "${x}" should satisfy the constraint "${ae}": ${ie}.`)};if(O.constraints&&null!=x){const{ExclusiveMaximum:ae,ExclusiveMinimum:ie,InclusiveMaximum:me,InclusiveMinimum:ke,MaxItems:Ee,MaxLength:Me,MinItems:ze,MinLength:lt,MultipleOf:kt,Pattern:ct,UniqueItems:Tt}=O.constraints;if(void 0!==ae&&x>=ae&&z("ExclusiveMaximum",ae),void 0!==ie&&x<=ie&&z("ExclusiveMinimum",ie),void 0!==me&&x>me&&z("InclusiveMaximum",me),void 0!==ke&&x<ke&&z("InclusiveMinimum",ke),void 0!==Ee&&x.length>Ee&&z("MaxItems",Ee),void 0!==Me&&x.length>Me&&z("MaxLength",Me),void 0!==ze&&x.length<ze&&z("MinItems",ze),void 0!==lt&&x.length<lt&&z("MinLength",lt),void 0!==kt&&x%kt!=0&&z("MultipleOf",kt),ct){const Bt="string"==typeof ct?new RegExp(ct):ct;("string"!=typeof x||null===x.match(Bt))&&z("Pattern",ct)}Tt&&x.some((Bt,hn,en)=>en.indexOf(Bt)!==hn)&&z("UniqueItems",Tt)}}serialize(O,x,H,z={xml:{}}){var ae,ie,me;const ke={xml:{rootName:null!==(ae=z.xml.rootName)&&void 0!==ae?ae:"",includeRoot:null!==(ie=z.xml.includeRoot)&&void 0!==ie&&ie,xmlCharKey:null!==(me=z.xml.xmlCharKey)&&void 0!==me?me:Y}};let Ee={};const Me=O.type.name;H||(H=O.serializedName),null!==Me.match(/^Sequence$/i)&&(Ee=[]),O.isConstant&&(x=O.defaultValue);const{required:ze,nullable:lt}=O;if(ze&&lt&&void 0===x)throw new Error(`${H} cannot be undefined.`);if(ze&&!lt&&null==x)throw new Error(`${H} cannot be null or undefined.`);if(!ze&&!1===lt&&null===x)throw new Error(`${H} cannot be null.`);return null==x?Ee=x:(this.validateConstraints(O,x,H),null!==Me.match(/^any$/i)?Ee=x:null!==Me.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?Ee=function(V,O,x){if(null!=x)if(null!==V.match(/^Number$/i)){if("number"!=typeof x)throw new Error(`${O} with value ${x} must be of type number.`)}else if(null!==V.match(/^String$/i)){if("string"!=typeof x.valueOf())throw new Error(`${O} with value "${x}" must be of type string.`)}else if(null!==V.match(/^Uuid$/i)){if("string"!=typeof x.valueOf()||!function(V){return ne.test(V)}(x))throw new Error(`${O} with value "${x}" must be of type string and a valid uuid.`)}else if(null!==V.match(/^Boolean$/i)){if("boolean"!=typeof x)throw new Error(`${O} with value ${x} must be of type boolean.`)}else if(!(null===V.match(/^Stream$/i)||"string"==typeof x||"function"==typeof x.pipe||x instanceof ArrayBuffer||ArrayBuffer.isView(x)||("function"==typeof Blob||"object"==typeof Blob)&&x instanceof Blob))throw new Error(`${O} must be a string, Blob, ArrayBuffer, ArrayBufferView, or NodeJS.ReadableStream.`);return x}(Me,H,x):null!==Me.match(/^Enum$/i)?Ee=function(V,O,x){if(!O)throw new Error(`Please provide a set of allowedValues to validate ${V} as an Enum Type.`);if(!O.some(z=>"string"==typeof z.valueOf()?z.toLowerCase()===x.toLowerCase():z===x))throw new Error(`${x} is not a valid value for ${V}. The valid values are: ${JSON.stringify(O)}.`);return x}(H,O.type.allowedValues,x):null!==Me.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?Ee=function(V,O,x){if(null!=O)if(null!==V.match(/^Date$/i)){if(!(O instanceof Date||"string"==typeof O.valueOf()&&!isNaN(Date.parse(O))))throw new Error(`${x} must be an instanceof Date or a string in ISO8601 format.`);O=O instanceof Date?O.toISOString().substring(0,10):new Date(O).toISOString().substring(0,10)}else if(null!==V.match(/^DateTime$/i)){if(!(O instanceof Date||"string"==typeof O.valueOf()&&!isNaN(Date.parse(O))))throw new Error(`${x} must be an instanceof Date or a string in ISO8601 format.`);O=O instanceof Date?O.toISOString():new Date(O).toISOString()}else if(null!==V.match(/^DateTimeRfc1123$/i)){if(!(O instanceof Date||"string"==typeof O.valueOf()&&!isNaN(Date.parse(O))))throw new Error(`${x} must be an instanceof Date or a string in RFC-1123 format.`);O=O instanceof Date?O.toUTCString():new Date(O).toUTCString()}else if(null!==V.match(/^UnixTime$/i)){if(!(O instanceof Date||"string"==typeof O.valueOf()&&!isNaN(Date.parse(O))))throw new Error(`${x} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);O=function(V){if(V)return"string"==typeof V.valueOf()&&(V=new Date(V)),Math.floor(V.getTime()/1e3)}(O)}else if(null!==V.match(/^TimeSpan$/i)&&!function(V){return ce.test(V)}(O))throw new Error(`${x} must be a string in ISO 8601 format. Instead was "${O}".`);return O}(Me,x,H):null!==Me.match(/^ByteArray$/i)?Ee=function(V,O){if(null!=O){if(!(O instanceof Uint8Array))throw new Error(`${V} must be of type Uint8Array.`);O=$(O)}return O}(H,x):null!==Me.match(/^Base64Url$/i)?Ee=function(V,O){if(null!=O){if(!(O instanceof Uint8Array))throw new Error(`${V} must be of type Uint8Array.`);O=function(V){if(V){if(!(V instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(V,O){let x=V.length;for(;x-1>=0&&"="===V[x-1];)--x;return V.substr(0,x)}($(V)).replace(/\+/g,"-").replace(/\//g,"_")}}(O)}return O}(H,x):null!==Me.match(/^Sequence$/i)?Ee=function(V,O,x,H,z,ae){var ie;if(!Array.isArray(x))throw new Error(`${H} must be of type Array.`);let me=O.type.element;if(!me||"object"!=typeof me)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${H}.`);"Composite"===me.type.name&&me.type.className&&(me=null!==(ie=V.modelMappers[me.type.className])&&void 0!==ie?ie:me);const ke=[];for(let Ee=0;Ee<x.length;Ee++){const Me=V.serialize(me,x[Ee],H,ae);if(z&&me.xmlNamespace){const ze=me.xmlNamespacePrefix?`xmlns:${me.xmlNamespacePrefix}`:"xmlns";"Composite"===me.type.name?(ke[Ee]=Object.assign({},Me),ke[Ee][Z]={[ze]:me.xmlNamespace}):(ke[Ee]={},ke[Ee][ae.xml.xmlCharKey]=Me,ke[Ee][Z]={[ze]:me.xmlNamespace})}else ke[Ee]=Me}return ke}(this,O,x,H,Boolean(this.isXML),ke):null!==Me.match(/^Dictionary$/i)?Ee=function(V,O,x,H,z,ae){if("object"!=typeof x)throw new Error(`${H} must be of type object.`);const ie=O.type.value;if(!ie||"object"!=typeof ie)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${H}.`);const me={};for(const ke of Object.keys(x)){const Ee=V.serialize(ie,x[ke],H,ae);me[ke]=rt(ie,Ee,z,ae)}if(z&&O.xmlNamespace){const Ee=me;return Ee[Z]={[O.xmlNamespacePrefix?`xmlns:${O.xmlNamespacePrefix}`:"xmlns"]:O.xmlNamespace},Ee}return me}(this,O,x,H,Boolean(this.isXML),ke):null!==Me.match(/^Composite$/i)&&(Ee=function(V,O,x,H,z,ae){if(De(V,O)&&(O=Qt(V,O,x,"clientName")),null!=x){const ie={},me=Qe(V,O,H);for(const Ee of Object.keys(me)){const Me=me[Ee];if(Me.readOnly)continue;let ze,lt=ie;if(V.isXML)ze=Me.xmlIsWrapped?Me.xmlName:Me.xmlElementName||Me.xmlName;else{const kt=$e(Me.serializedName);ze=kt.pop();for(const ct of kt)null==lt[ct]&&(null!=x[Ee]||void 0!==Me.defaultValue)&&(lt[ct]={}),lt=lt[ct]}if(null!=lt){if(z&&O.xmlNamespace){const hn=O.xmlNamespacePrefix?`xmlns:${O.xmlNamespacePrefix}`:"xmlns";lt[Z]=Object.assign(Object.assign({},lt[Z]),{[hn]:O.xmlNamespace})}const kt=""!==Me.serializedName?H+"."+Me.serializedName:H;let ct=x[Ee];const Tt=De(V,O);Tt&&Tt.clientName===Ee&&null==ct&&(ct=O.serializedName);const Bt=V.serialize(Me,ct,kt,ae);if(void 0!==Bt&&null!=ze){const hn=rt(Me,Bt,z,ae);z&&Me.xmlIsAttribute?(lt[Z]=lt[Z]||{},lt[Z][ze]=Bt):lt[ze]=z&&Me.xmlIsWrapped?{[Me.xmlElementName]:hn}:hn}}}const ke=function(V,O,x){const H=O.type.additionalProperties;if(!H&&O.type.className){const z=We(V,O,x);return null==z?void 0:z.type.additionalProperties}return H}(V,O,H);if(ke){const Ee=Object.keys(me);for(const Me in x)Ee.every(lt=>lt!==Me)&&(ie[Me]=V.serialize(ke,x[Me],H+'["'+Me+'"]',ae))}return ie}return x}(this,O,x,H,Boolean(this.isXML),ke))),Ee}deserialize(O,x,H,z={xml:{}}){var ae,ie,me;const ke={xml:{rootName:null!==(ae=z.xml.rootName)&&void 0!==ae?ae:"",includeRoot:null!==(ie=z.xml.includeRoot)&&void 0!==ie&&ie,xmlCharKey:null!==(me=z.xml.xmlCharKey)&&void 0!==me?me:Y}};if(null==x)return this.isXML&&"Sequence"===O.type.name&&!O.xmlIsWrapped&&(x=[]),void 0!==O.defaultValue&&(x=O.defaultValue),x;let Ee;const Me=O.type.name;if(H||(H=O.serializedName),null!==Me.match(/^Composite$/i))Ee=function(V,O,x,H,z){var ae;De(V,O)&&(O=Qt(V,O,x,"serializedName"));const ie=Qe(V,O,H);let me={};const ke=[];for(const Me of Object.keys(ie)){const ze=ie[Me],lt=$e(ie[Me].serializedName);ke.push(lt[0]);const{serializedName:kt,xmlName:ct,xmlElementName:Tt}=ze;let Bt=H;""!==kt&&void 0!==kt&&(Bt=H+"."+kt);const hn=ze.headerCollectionPrefix;if(hn){const en={};for(const mn of Object.keys(x))mn.startsWith(hn)&&(en[mn.substring(hn.length)]=V.deserialize(ze.type.value,x[mn],Bt,z)),ke.push(mn);me[Me]=en}else if(V.isXML)if(ze.xmlIsAttribute&&x[Z])me[Me]=V.deserialize(ze,x[Z][ct],Bt,z);else{const en=Tt||ct||kt;if(ze.xmlIsWrapped){const mn=x[ct],Tn=null!==(ae=null==mn?void 0:mn[Tt])&&void 0!==ae?ae:[];me[Me]=V.deserialize(ze,Tn,Bt,z)}else me[Me]=V.deserialize(ze,x[en],Bt,z)}else{let en,mn=x;for(const gr of lt){if(!mn)break;mn=mn[gr]}en=mn;const Tn=O.type.polymorphicDiscriminator;let mo;if(Tn&&Me===Tn.clientName&&null==en&&(en=O.serializedName),Array.isArray(x[Me])&&""===ie[Me].serializedName){en=x[Me];const gr=V.deserialize(ze,en,Bt,z);for(const[Xi,eo]of Object.entries(me))Object.prototype.hasOwnProperty.call(gr,Xi)||(gr[Xi]=eo);me=gr}else(void 0!==en||void 0!==ze.defaultValue)&&(mo=V.deserialize(ze,en,Bt,z),me[Me]=mo)}}const Ee=O.type.additionalProperties;if(Ee){const Me=ze=>{for(const lt in ie)if($e(ie[lt].serializedName)[0]===ze)return!1;return!0};for(const ze in x)Me(ze)&&(me[ze]=V.deserialize(Ee,x[ze],H+'["'+ze+'"]',z))}else if(x)for(const Me of Object.keys(x))void 0===me[Me]&&!ke.includes(Me)&&!Le(Me,z)&&(me[Me]=x[Me]);return me}(this,O,x,H,ke);else{if(this.isXML){const ze=ke.xml.xmlCharKey;void 0!==x[Z]&&void 0!==x[ze]&&(x=x[ze])}null!==Me.match(/^Number$/i)?(Ee=parseFloat(x),isNaN(Ee)&&(Ee=x)):null!==Me.match(/^Boolean$/i)?Ee="true"===x||"false"!==x&&x:null!==Me.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?Ee=x:null!==Me.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?Ee=new Date(x):null!==Me.match(/^UnixTime$/i)?Ee=function(V){if(V)return new Date(1e3*V)}(x):null!==Me.match(/^ByteArray$/i)?Ee=j(x):null!==Me.match(/^Base64Url$/i)?Ee=function(V){if(V){if(V&&"string"!=typeof V.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return j(V=V.replace(/-/g,"+").replace(/_/g,"/"))}}(x):null!==Me.match(/^Sequence$/i)?Ee=function(V,O,x,H,z){var ae;let ie=O.type.element;if(!ie||"object"!=typeof ie)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${H}`);if(x){Array.isArray(x)||(x=[x]),"Composite"===ie.type.name&&ie.type.className&&(ie=null!==(ae=V.modelMappers[ie.type.className])&&void 0!==ae?ae:ie);const me=[];for(let ke=0;ke<x.length;ke++)me[ke]=V.deserialize(ie,x[ke],`${H}[${ke}]`,z);return me}return x}(this,O,x,H,ke):null!==Me.match(/^Dictionary$/i)&&(Ee=function(V,O,x,H,z){const ae=O.type.value;if(!ae||"object"!=typeof ae)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${H}`);if(x){const ie={};for(const me of Object.keys(x))ie[me]=V.deserialize(ae,x[me],H,z);return ie}return x}(this,O,x,H,ke))}return O.isConstant&&(Ee=O.defaultValue),Ee}}function re(V={},O=!1){return new K(V,O)}function $e(V){const O=[];let x="";if(V){const H=V.split(".");for(const z of H)"\\"===z.charAt(z.length-1)?x+=z.substr(0,z.length-1)+".":(x+=z,O.push(x),x="")}return O}function We(V,O,x){const H=O.type.className;if(!H)throw new Error(`Class name for model "${x}" is not provided in the mapper "${JSON.stringify(O,void 0,2)}".`);return V.modelMappers[H]}function Qe(V,O,x){let H=O.type.modelProperties;if(!H){const z=We(V,O,x);if(!z)throw new Error(`mapper() cannot be null or undefined for model "${O.type.className}".`);if(H=null==z?void 0:z.type.modelProperties,!H)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(z)}" of type "${O.type.className}" for object "${x}".`)}return H}function rt(V,O,x,H){if(!x||!V.xmlNamespace)return O;const ae={[V.xmlNamespacePrefix?`xmlns:${V.xmlNamespacePrefix}`:"xmlns"]:V.xmlNamespace};if(["Composite"].includes(V.type.name)){if(O[Z])return O;{const me=Object.assign({},O);return me[Z]=ae,me}}const ie={};return ie[H.xml.xmlCharKey]=O,ie[Z]=ae,ie}function Le(V,O){return[Z,O.xml.xmlCharKey].includes(V)}function Qt(V,O,x,H){const z=De(V,O);if(z){let ae=z[H];if(ae){"serializedName"===H&&(ae=ae.replace(/\\/gi,""));const ie=x[ae];if(null!=ie){const me=O.type.uberParent||O.type.className,Ee=V.modelMappers.discriminators[ie===me?ie:me+"."+ie];Ee&&(O=Ee)}}}return O}function De(V,O){return O.type.polymorphicDiscriminator||Ke(V,O.type.uberParent)||Ke(V,O.type.className)}function Ke(V,O){return O&&V.modelMappers[O]&&V.modelMappers[O].type.polymorphicDiscriminator}const bt={type:{name:"Composite",className:"ChatMessageReadReceiptsCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatMessageReadReceipt"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Nt={type:{name:"Composite",className:"ChatMessageReadReceipt",modelProperties:{senderCommunicationIdentifier:{serializedName:"senderCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},chatMessageId:{serializedName:"chatMessageId",required:!0,type:{name:"String"}},readOn:{serializedName:"readOn",required:!0,type:{name:"DateTime"}}}}},ot={type:{name:"Composite",className:"CommunicationIdentifierModel",modelProperties:{rawId:{serializedName:"rawId",type:{name:"String"}},communicationUser:{serializedName:"communicationUser",type:{name:"Composite",className:"CommunicationUserIdentifierModel"}},phoneNumber:{serializedName:"phoneNumber",type:{name:"Composite",className:"PhoneNumberIdentifierModel"}},microsoftTeamsUser:{serializedName:"microsoftTeamsUser",type:{name:"Composite",className:"MicrosoftTeamsUserIdentifierModel"}}}}},Xt={type:{name:"Composite",className:"CommunicationUserIdentifierModel",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},gn={type:{name:"Composite",className:"PhoneNumberIdentifierModel",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"String"}}}}},dr={type:{name:"Composite",className:"MicrosoftTeamsUserIdentifierModel",modelProperties:{userId:{serializedName:"userId",required:!0,type:{name:"String"}},isAnonymous:{serializedName:"isAnonymous",type:{name:"Boolean"}},cloud:{serializedName:"cloud",type:{name:"String"}}}}},Xe={type:{name:"Composite",className:"CommunicationErrorResponse",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ChatError"}}}}},Tr={type:{name:"Composite",className:"ChatError",modelProperties:{code:{serializedName:"code",required:!0,type:{name:"String"}},message:{serializedName:"message",required:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}},innerError:{serializedName:"innererror",type:{name:"Composite",className:"ChatError"}}}}},br={type:{name:"Composite",className:"SendReadReceiptRequest",modelProperties:{chatMessageId:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}}}},Ci={type:{name:"Composite",className:"SendChatMessageRequest",modelProperties:{content:{serializedName:"content",required:!0,type:{name:"String"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}},type:{serializedName:"type",type:{name:"Enum",allowedValues:["text","html","topicUpdated","participantAdded","participantRemoved"]}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},ei={type:{name:"Composite",className:"SendChatMessageResult",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}}}}},Kn={type:{name:"Composite",className:"ChatMessagesCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatMessage"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},xt={type:{name:"Composite",className:"ChatMessage",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},type:{serializedName:"type",required:!0,type:{name:"Enum",allowedValues:["text","html","topicUpdated","participantAdded","participantRemoved"]}},sequenceId:{serializedName:"sequenceId",required:!0,type:{name:"String"}},version:{serializedName:"version",required:!0,type:{name:"String"}},content:{serializedName:"content",type:{name:"Composite",className:"ChatMessageContent"}},senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}},createdOn:{serializedName:"createdOn",required:!0,type:{name:"DateTime"}},senderCommunicationIdentifier:{serializedName:"senderCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}},editedOn:{serializedName:"editedOn",type:{name:"DateTime"}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Er={type:{name:"Composite",className:"ChatMessageContent",modelProperties:{message:{serializedName:"message",type:{name:"String"}},topic:{serializedName:"topic",type:{name:"String"}},participants:{serializedName:"participants",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}},initiatorCommunicationIdentifier:{serializedName:"initiatorCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}}}}},It={type:{name:"Composite",className:"ChatParticipant",modelProperties:{communicationIdentifier:{serializedName:"communicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},displayName:{serializedName:"displayName",type:{name:"String"}},shareHistoryTime:{serializedName:"shareHistoryTime",type:{name:"DateTime"}}}}},Lt={type:{name:"Composite",className:"UpdateChatMessageRequest",modelProperties:{content:{serializedName:"content",type:{name:"String"}},metadata:{serializedName:"metadata",type:{name:"Dictionary",value:{type:{name:"String"}}}}}}},Lr={type:{name:"Composite",className:"ChatParticipantsCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Ti={type:{name:"Composite",className:"AddChatParticipantsRequest",modelProperties:{participants:{serializedName:"participants",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}}}}},ft={type:{name:"Composite",className:"AddChatParticipantsResult",modelProperties:{invalidParticipants:{serializedName:"invalidParticipants",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}}}}},Gi={type:{name:"Composite",className:"CreateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",required:!0,type:{name:"String"}},participants:{serializedName:"participants",type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatParticipant"}}}}}}},Io={type:{name:"Composite",className:"CreateChatThreadResult",modelProperties:{chatThread:{serializedName:"chatThread",type:{name:"Composite",className:"ChatThreadProperties"}},invalidParticipants:{serializedName:"invalidParticipants",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatError"}}}}}}},fr={type:{name:"Composite",className:"ChatThreadProperties",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},topic:{serializedName:"topic",required:!0,type:{name:"String"}},createdOn:{serializedName:"createdOn",required:!0,type:{name:"DateTime"}},createdByCommunicationIdentifier:{serializedName:"createdByCommunicationIdentifier",type:{name:"Composite",className:"CommunicationIdentifierModel"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}}}}},bi={type:{name:"Composite",className:"ChatThreadsItemCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ChatThreadItem"}}}},nextLink:{serializedName:"nextLink",readOnly:!0,type:{name:"String"}}}}},Ei={type:{name:"Composite",className:"ChatThreadItem",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},topic:{serializedName:"topic",required:!0,type:{name:"String"}},deletedOn:{serializedName:"deletedOn",type:{name:"DateTime"}},lastMessageReceivedOn:{serializedName:"lastMessageReceivedOn",readOnly:!0,type:{name:"DateTime"}}}}},_t={type:{name:"Composite",className:"UpdateChatThreadRequest",modelProperties:{topic:{serializedName:"topic",type:{name:"String"}}}}},In={type:{name:"Composite",className:"SendTypingNotificationRequest",modelProperties:{senderDisplayName:{serializedName:"senderDisplayName",type:{name:"String"}}}}},he={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},_e={parameterPath:"endpoint",mapper:{serializedName:"endpoint",required:!0,type:{name:"String"}},skipEncoding:!0},Re={parameterPath:"chatThreadId",mapper:{serializedName:"chatThreadId",required:!0,type:{name:"String"}}},Ye={parameterPath:["options","maxPageSize"],mapper:{serializedName:"maxPageSize",type:{name:"Number"}}},et={parameterPath:["options","skip"],mapper:{serializedName:"skip",type:{name:"Number"}}},it={parameterPath:"apiVersion",mapper:{defaultValue:"2021-09-07",isConstant:!0,serializedName:"api-version",type:{name:"String"}}},wt={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},Rn={parameterPath:"sendReadReceiptRequest",mapper:br},Ht={parameterPath:"sendChatMessageRequest",mapper:Ci},On={parameterPath:["options","startTime"],mapper:{serializedName:"startTime",type:{name:"DateTime"}}},qn={parameterPath:"chatMessageId",mapper:{serializedName:"chatMessageId",required:!0,type:{name:"String"}}},_i={parameterPath:["options","contentType"],mapper:{defaultValue:"application/merge-patch+json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},lo={parameterPath:"updateChatMessageRequest",mapper:Lt},ga={parameterPath:"participantCommunicationIdentifier",mapper:ot},Dr={parameterPath:"addChatParticipantsRequest",mapper:Ti},wo={parameterPath:"updateChatThreadRequest",mapper:_t},Do={parameterPath:["options","sendTypingNotificationRequest"],mapper:In},kn={parameterPath:"nextLink",mapper:{serializedName:"nextLink",required:!0,type:{name:"String"}},skipEncoding:!0},rn={parameterPath:"createChatThreadRequest",mapper:Gi};class es{constructor(O){this.client=O}listChatReadReceipts(O,x){return this.client.sendOperationRequest({chatThreadId:O,options:x},Jt)}sendChatReadReceipt(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,sendReadReceiptRequest:x,options:H},Fr)}sendChatMessage(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,sendChatMessageRequest:x,options:H},Rr)}listChatMessages(O,x){return this.client.sendOperationRequest({chatThreadId:O,options:x},Mr)}getChatMessage(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,chatMessageId:x,options:H},Mo)}updateChatMessage(O,x,H,z){return this.client.sendOperationRequest({chatThreadId:O,chatMessageId:x,updateChatMessageRequest:H,options:z},ts)}deleteChatMessage(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,chatMessageId:x,options:H},ma)}listChatParticipants(O,x){return this.client.sendOperationRequest({chatThreadId:O,options:x},ns)}removeChatParticipant(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,participantCommunicationIdentifier:x,options:H},co)}addChatParticipants(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,addChatParticipantsRequest:x,options:H},Ao)}updateChatThreadProperties(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,updateChatThreadRequest:x,options:H},Wi)}getChatThreadProperties(O,x){return this.client.sendOperationRequest({chatThreadId:O,options:x},Po)}sendTypingNotification(O,x){return this.client.sendOperationRequest({chatThreadId:O,options:x},Ct)}listChatReadReceiptsNext(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,nextLink:x,options:H},rr)}listChatMessagesNext(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,nextLink:x,options:H},rs)}listChatParticipantsNext(O,x,H){return this.client.sendOperationRequest({chatThreadId:O,nextLink:x,options:H},_r)}}const Mn=re(s,!1),Jt={path:"/chat/threads/{chatThreadId}/readReceipts",httpMethod:"GET",responses:{200:{bodyMapper:bt},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,et,it],urlParameters:[_e,Re],headerParameters:[he],serializer:Mn},Fr={path:"/chat/threads/{chatThreadId}/readReceipts",httpMethod:"POST",responses:{200:{},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:Rn,queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he,wt],mediaType:"json",serializer:Mn},Rr={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"POST",responses:{201:{bodyMapper:ei},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:Ht,queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he,wt],mediaType:"json",serializer:Mn},Mr={path:"/chat/threads/{chatThreadId}/messages",httpMethod:"GET",responses:{200:{bodyMapper:Kn},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,it,On],urlParameters:[_e,Re],headerParameters:[he],serializer:Mn},Mo={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"GET",responses:{200:{bodyMapper:xt},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[it],urlParameters:[_e,Re,qn],headerParameters:[he],serializer:Mn},ts={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"PATCH",responses:{204:{},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:lo,queryParameters:[it],urlParameters:[_e,Re,qn],headerParameters:[he,_i],mediaType:"json",serializer:Mn},ma={path:"/chat/threads/{chatThreadId}/messages/{chatMessageId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[it],urlParameters:[_e,Re,qn],headerParameters:[he],serializer:Mn},ns={path:"/chat/threads/{chatThreadId}/participants",httpMethod:"GET",responses:{200:{bodyMapper:Lr},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,et,it],urlParameters:[_e,Re],headerParameters:[he],serializer:Mn},co={path:"/chat/threads/{chatThreadId}/participants/:remove",httpMethod:"POST",responses:{204:{},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:ga,queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he,wt],mediaType:"json",serializer:Mn},Ao={path:"/chat/threads/{chatThreadId}/participants/:add",httpMethod:"POST",responses:{201:{bodyMapper:ft},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:Dr,queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he,wt],mediaType:"json",serializer:Mn},Wi={path:"/chat/threads/{chatThreadId}",httpMethod:"PATCH",responses:{204:{},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:wo,queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he,_i],mediaType:"json",serializer:Mn},Po={path:"/chat/threads/{chatThreadId}",httpMethod:"GET",responses:{200:{bodyMapper:fr},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he],serializer:Mn},Ct={path:"/chat/threads/{chatThreadId}/typing",httpMethod:"POST",responses:{200:{},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:Do,queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he,wt],mediaType:"json",serializer:Mn},rr={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:bt},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,et,it],urlParameters:[_e,Re,kn],headerParameters:[he],serializer:Mn},rs={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Kn},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,it,On],urlParameters:[_e,Re,kn],headerParameters:[he],serializer:Mn},_r={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:Lr},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,et,it],urlParameters:[_e,Re,kn],headerParameters:[he],serializer:Mn};class Oo{constructor(O){this.client=O}createChatThread(O,x){return this.client.sendOperationRequest({createChatThreadRequest:O,options:x},Sr)}listChatThreads(O){return this.client.sendOperationRequest({options:O},ir)}deleteChatThread(O,x){return this.client.sendOperationRequest({chatThreadId:O,options:x},os)}listChatThreadsNext(O,x){return this.client.sendOperationRequest({nextLink:O,options:x},Fu)}}const is=re(s,!1),Sr={path:"/chat/threads",httpMethod:"POST",responses:{201:{bodyMapper:Io},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},requestBody:rn,queryParameters:[it],urlParameters:[_e],headerParameters:[he,wt,{parameterPath:["options","repeatabilityRequestId"],mapper:{serializedName:"repeatability-request-id",type:{name:"String"}}}],mediaType:"json",serializer:is},ir={path:"/chat/threads",httpMethod:"GET",responses:{200:{bodyMapper:bi},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,it,On],urlParameters:[_e],headerParameters:[he],serializer:is},os={path:"/chat/threads/{chatThreadId}",httpMethod:"DELETE",responses:{204:{},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[it],urlParameters:[_e,Re],headerParameters:[he],serializer:is},Fu={path:"{nextLink}",httpMethod:"GET",responses:{200:{bodyMapper:bi},401:{bodyMapper:Xe,isError:!0},403:{bodyMapper:Xe,isError:!0},429:{bodyMapper:Xe,isError:!0},503:{bodyMapper:Xe,isError:!0}},queryParameters:[Ye,it,On],urlParameters:[_e,kn],headerParameters:[he],serializer:is};function dn(V){return V.toLowerCase()}class ko{constructor(O){if(this._headersMap=new Map,O)for(const x of Object.keys(O))this.set(x,O[x])}set(O,x){this._headersMap.set(dn(O),{name:O,value:String(x)})}get(O){var x;return null===(x=this._headersMap.get(dn(O)))||void 0===x?void 0:x.value}has(O){return this._headersMap.has(dn(O))}delete(O){this._headersMap.delete(dn(O))}toJSON(O={}){const x={};if(O.preserveCase)for(const H of this._headersMap.values())x[H.name]=H.value;else for(const[H,z]of this._headersMap)x[H]=z.value;return x}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(V){for(const O of V.values())yield[O.name,O.value]}(this._headersMap)}}function ss(V){return new ko(V)}var Si,Yt=new Uint8Array(16);function Uu(){if(!Si&&!(Si="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Si(Yt)}const Vu=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Zt=function(V){return"string"==typeof V&&Vu.test(V)};for(var yn=[],zi=0;zi<256;++zi)yn.push((zi+256).toString(16).substr(1));const hr=function(V,O,x){var H=(V=V||{}).random||(V.rng||Uu)();if(H[6]=15&H[6]|64,H[8]=63&H[8]|128,O){x=x||0;for(var z=0;z<16;++z)O[x+z]=H[z];return O}return function(V){var O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,x=(yn[V[O+0]]+yn[V[O+1]]+yn[V[O+2]]+yn[V[O+3]]+"-"+yn[V[O+4]]+yn[V[O+5]]+"-"+yn[V[O+6]]+yn[V[O+7]]+"-"+yn[V[O+8]]+yn[V[O+9]]+"-"+yn[V[O+10]]+yn[V[O+11]]+yn[V[O+12]]+yn[V[O+13]]+yn[V[O+14]]+yn[V[O+15]]).toLowerCase();if(!Zt(x))throw TypeError("Stringified UUID is invalid");return x}(H)};class va{constructor(O){var x,H,z,ae,ie,me,ke;this.url=O.url,this.body=O.body,this.headers=null!==(x=O.headers)&&void 0!==x?x:ss(),this.method=null!==(H=O.method)&&void 0!==H?H:"GET",this.timeout=null!==(z=O.timeout)&&void 0!==z?z:0,this.formData=O.formData,this.disableKeepAlive=null!==(ae=O.disableKeepAlive)&&void 0!==ae&&ae,this.proxySettings=O.proxySettings,this.streamResponseStatusCodes=O.streamResponseStatusCodes,this.withCredentials=null!==(ie=O.withCredentials)&&void 0!==ie&&ie,this.abortSignal=O.abortSignal,this.tracingOptions=O.tracingOptions,this.onUploadProgress=O.onUploadProgress,this.onDownloadProgress=O.onDownloadProgress,this.requestId=O.requestId||hr(),this.allowInsecureConnection=null!==(me=O.allowInsecureConnection)&&void 0!==me&&me,this.enableBrowserStreams=null!==(ke=O.enableBrowserStreams)&&void 0!==ke&&ke}}function us(V){return!("object"!=typeof V||null===V||Array.isArray(V)||V instanceof RegExp||V instanceof Date)}function Qi(V){if(us(V)){const x="string"==typeof V.message;return"string"==typeof V.name&&x}return!1}function ti(V){if(Qi(V))return V.message;{let O;try{O="object"==typeof V&&V?JSON.stringify(V):String(V)}catch(x){O="[unable to stringify input]"}return`Unknown error ${O}`}}const ls={},Ur="REDACTED",xo=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],Lo=["api-version"];class Nn{constructor({additionalAllowedHeaderNames:O=[],additionalAllowedQueryParameters:x=[]}={}){O=xo.concat(O),x=Lo.concat(x),this.allowedHeaderNames=new Set(O.map(H=>H.toLowerCase())),this.allowedQueryParameters=new Set(x.map(H=>H.toLowerCase()))}sanitize(O){const x=new Set;return JSON.stringify(O,(H,z)=>{if(z instanceof Error)return Object.assign(Object.assign({},z),{name:z.name,message:z.message});if("headers"===H)return this.sanitizeHeaders(z);if("url"===H)return this.sanitizeUrl(z);if("query"===H)return this.sanitizeQuery(z);if("body"!==H&&"response"!==H&&"operationSpec"!==H){if(Array.isArray(z)||us(z)){if(x.has(z))return"[Circular]";x.add(z)}return z}},2)}sanitizeHeaders(O){const x={};for(const H of Object.keys(O))x[H]=this.allowedHeaderNames.has(H.toLowerCase())?O[H]:Ur;return x}sanitizeQuery(O){if("object"!=typeof O||null===O)return O;const x={};for(const H of Object.keys(O))x[H]=this.allowedQueryParameters.has(H.toLowerCase())?O[H]:Ur;return x}sanitizeUrl(O){if("string"!=typeof O||null===O)return O;const x=new URL(O);if(!x.search)return O;for(const[H]of x.searchParams)this.allowedQueryParameters.has(H.toLowerCase())||x.searchParams.set(H,Ur);return x.toString()}}const Fn=new Nn;let an=(()=>{class V extends Error{constructor(x,H={}){super(x),this.name="RestError",this.code=H.code,this.statusCode=H.statusCode,this.request=H.request,this.response=H.response,Object.setPrototypeOf(this,V.prototype)}[ls](){return`RestError: ${this.message} \n ${Fn.sanitize(this)}`}}return V.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",V.PARSE_ERROR="PARSE_ERROR",V})();function pr(V,O,x){let H=O.parameterPath;const z=O.mapper;let ae;if("string"==typeof H&&(H=[H]),Array.isArray(H)){if(H.length>0)if(z.isConstant)ae=z.defaultValue;else{let ie=Qn(V,H);!ie.propertyFound&&x&&(ie=Qn(x,H));let me=!1;ie.propertyFound||(me=z.required||"options"===H[0]&&2===H.length),ae=me?z.defaultValue:ie.propertyValue}}else{z.required&&(ae={});for(const ie in H){const Ee=pr(V,{parameterPath:H[ie],mapper:z.type.modelProperties[ie]},x);void 0!==Ee&&(ae||(ae={}),ae[ie]=Ee)}}return ae}function Qn(V,O){const x={propertyFound:!1};let H=0;for(;H<O.length;++H){const z=O[H];if(!V||!(z in V))break;V=V[z]}return H===O.length&&(x.propertyValue=V,x.propertyFound=!0),x}const cs=new WeakMap;function An(V){let O=cs.get(V);return O||(O={},cs.set(V,O)),O}const st=["application/json","text/json"],Ft=["application/xml","application/atom+xml"];function Vr(V){let O;const H=An(V.request),z=null==H?void 0:H.operationSpec;return z&&(O=(null==H?void 0:H.operationResponseGetter)?null==H?void 0:H.operationResponseGetter(z,V):z.responses[V.status]),O}function wn(V){const x=An(V.request),H=null==x?void 0:x.shouldDeserialize;let z;return z=void 0===H||("boolean"==typeof H?H:H(V)),z}function fn(){return(fn=(0,b.Z)(function*(V,O,x,H,z){const ae=yield Mt(V,O,x,H,z);if(!wn(ae))return ae;const ie=An(ae.request),me=null==ie?void 0:ie.operationSpec;if(!me||!me.responses)return ae;const ke=Vr(ae),{error:Ee,shouldReturnResponse:Me}=ri(ae,me,ke);if(Ee)throw Ee;if(Me)return ae;if(ke){if(ke.bodyMapper){let ze=ae.parsedBody;me.isXML&&"Sequence"===ke.bodyMapper.type.name&&(ze="object"==typeof ze?ze[ke.bodyMapper.xmlElementName]:[]);try{ae.parsedBody=me.serializer.deserialize(ke.bodyMapper,ze,"operationRes.parsedBody")}catch(lt){throw new an(`Error ${lt} occurred in deserializing the responseBody - ${ae.bodyAsText}`,{statusCode:ae.status,request:ae.request,response:ae})}}else"HEAD"===me.httpMethod&&(ae.parsedBody=x.status>=200&&x.status<300);ke.headersMapper&&(ae.parsedHeaders=me.serializer.deserialize(ke.headersMapper,ae.headers.toJSON(),"operationRes.parsedHeaders"))}return ae})).apply(this,arguments)}function ri(V,O,x){var H;const z=200<=V.status&&V.status<300;if(function(V){const O=Object.keys(V.responses);return 0===O.length||1===O.length&&"default"===O[0]}(O)?z:x){if(!x)return{error:null,shouldReturnResponse:!1};if(!x.isError)return{error:null,shouldReturnResponse:!1}}const ie=null!=x?x:O.responses.default,me=(null===(H=V.request.streamResponseStatusCodes)||void 0===H?void 0:H.has(V.status))?`Unexpected status code: ${V.status}`:V.bodyAsText,ke=new an(me,{statusCode:V.status,request:V.request,response:V});if(!ie)throw ke;const Ee=ie.bodyMapper,Me=ie.headersMapper;try{if(V.parsedBody){const ze=V.parsedBody;let lt;if(Ee){let ct=ze;if(O.isXML&&"Sequence"===Ee.type.name){ct=[];const Tt=Ee.xmlElementName;"object"==typeof ze&&Tt&&(ct=ze[Tt])}lt=O.serializer.deserialize(Ee,ct,"error.response.parsedBody")}const kt=ze.error||lt||ze;ke.code=kt.code,kt.message&&(ke.message=kt.message),Ee&&(ke.response.parsedBody=lt)}V.headers&&Me&&(ke.response.parsedHeaders=O.serializer.deserialize(Me,V.headers.toJSON(),"operationRes.parsedHeaders"))}catch(ze){ke.message=`Error "${ze.message}" occurred in deserializing the responseBody - "${V.bodyAsText}" for the default response.`}return{error:ke,shouldReturnResponse:!1}}function Mt(V,O,x,H,z){return Br.apply(this,arguments)}function Br(){return(Br=(0,b.Z)(function*(V,O,x,H,z){var ae;if(!(null===(ae=x.request.streamResponseStatusCodes)||void 0===ae?void 0:ae.has(x.status))&&x.bodyAsText){const ie=x.bodyAsText,me=x.headers.get("Content-Type")||"",ke=me?me.split(";").map(Ee=>Ee.toLowerCase()):[];try{if(0===ke.length||ke.some(Ee=>-1!==V.indexOf(Ee)))return x.parsedBody=JSON.parse(ie),x;if(ke.some(Ee=>-1!==O.indexOf(Ee))){if(!z)throw new Error("Parsing XML not supported.");const Ee=yield z(ie,H.xml);return x.parsedBody=Ee,x}}catch(Ee){throw new an(`Error "${Ee}" occurred while parsing the response body - ${x.bodyAsText}.`,{code:Ee.code||an.PARSE_ERROR,statusCode:x.status,request:x.request,response:x})}}return x})).apply(this,arguments)}const ii=new Set(["Deserialize","Serialize","Retry","Sign"]);class Di{constructor(O=[]){this._policies=[],this._policies=O,this._orderedPolicies=void 0}addPolicy(O,x={}){if(x.phase&&x.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(x.phase&&!ii.has(x.phase))throw new Error(`Invalid phase name: ${x.phase}`);if(x.afterPhase&&!ii.has(x.afterPhase))throw new Error(`Invalid afterPhase name: ${x.afterPhase}`);this._policies.push({policy:O,options:x}),this._orderedPolicies=void 0}removePolicy(O){const x=[];return this._policies=this._policies.filter(H=>!(O.name&&H.policy.name===O.name||O.phase&&H.options.phase===O.phase)||(x.push(H.policy),!1)),this._orderedPolicies=void 0,x}sendRequest(O,x){return this.getOrderedPolicies().reduceRight((ae,ie)=>me=>ie.sendRequest(me,ae),ae=>O.sendRequest(ae))(x)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new Di(this._policies)}static create(){return new Di}orderPolicies(){const O=[],x=new Map;function H(ct){return{name:ct,policies:new Set,hasRun:!1}}const z=H("Serialize"),ae=H("None"),ie=H("Deserialize"),me=H("Retry"),ke=H("Sign"),Ee=[z,ae,ie,me,ke];function Me(ct){return"Retry"===ct?me:"Serialize"===ct?z:"Deserialize"===ct?ie:"Sign"===ct?ke:ae}for(const ct of this._policies){const Tt=ct.policy,Bt=ct.options,hn=Tt.name;if(x.has(hn))throw new Error("Duplicate policy names not allowed in pipeline");const en={policy:Tt,dependsOn:new Set,dependants:new Set};Bt.afterPhase&&(en.afterPhase=Me(Bt.afterPhase)),x.set(hn,en),Me(Bt.phase).policies.add(en)}for(const ct of this._policies){const{policy:Tt,options:Bt}=ct,hn=Tt.name,en=x.get(hn);if(!en)throw new Error(`Missing node for policy ${hn}`);if(Bt.afterPolicies)for(const mn of Bt.afterPolicies){const Tn=x.get(mn);Tn&&(en.dependsOn.add(Tn),Tn.dependants.add(en))}if(Bt.beforePolicies)for(const mn of Bt.beforePolicies){const Tn=x.get(mn);Tn&&(Tn.dependsOn.add(en),en.dependants.add(Tn))}}function ze(ct){ct.hasRun=!0;for(const Tt of ct.policies)if((!Tt.afterPhase||Tt.afterPhase.hasRun&&!Tt.afterPhase.policies.size)&&0===Tt.dependsOn.size){O.push(Tt.policy);for(const Bt of Tt.dependants)Bt.dependsOn.delete(Tt);x.delete(Tt.policy.name),ct.policies.delete(Tt)}}function lt(){for(const ct of Ee)if(ze(ct),ct.policies.size>0&&ct!==ae)return void(ae.hasRun||ze(ae))}let kt=0;for(;x.size>0;){kt++;const ct=O.length;if(lt(),O.length<=ct&&kt>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return O}}new Error("decompressResponsePolicy is not supported in browser environment");const Ai=(0,p.YR)("core-rest-pipeline");new Error("proxyPolicy is not supported in browser environment");const pt={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function zt(V={}){let O=new Vt(V.parentContext);return V.span&&(O=O.setValue(pt.span,V.span)),V.namespace&&(O=O.setValue(pt.namespace,V.namespace)),O}class Vt{constructor(O){this._contextMap=O instanceof Vt?new Map(O._contextMap):new Map}setValue(O,x){const H=new Vt(this);return H._contextMap.set(O,x),H}getValue(O){return this._contextMap.get(O)}deleteValue(O){const x=new Vt(this);return x._contextMap.delete(O),x}}let Kt;function Yn(){return Kt||(Kt={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(V,O)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:zt({parentContext:O.tracingContext})}),withContext:(V,O,...x)=>O(...x)}),Kt}function wc(V){const O=new Map;O.set("core-rest-pipeline","1.8.1"),function(V){const O=self.navigator;V.set("OS",(O.oscpu||O.platform).replace(" ",""))}(O);const x=function(V){const O=[];for(const[x,H]of V)O.push(H?`${x}/${H}`:x);return O.join(" ")}(O);return V?`${V} ${x}`:x}const Dc="x-ms-useragent";var fs=u(5283);function Hu(V,O,x){return new Promise((H,z)=>{let ae,ie;const me=()=>z(new fs._((null==x?void 0:x.abortErrorMsg)?null==x?void 0:x.abortErrorMsg:"The operation was aborted.")),ke=()=>{(null==x?void 0:x.abortSignal)&&ie&&x.abortSignal.removeEventListener("abort",ie)};if(ie=()=>(ae&&clearTimeout(ae),ke(),me()),(null==x?void 0:x.abortSignal)&&x.abortSignal.aborted)return me();ae=setTimeout(()=>{ke(),H(O)},V),(null==x?void 0:x.abortSignal)&&x.abortSignal.addEventListener("abort",ie)})}function $u(V,O){const x=V.headers.get(O);if(!x)return;const H=Number(x);return Number.isNaN(H)?void 0:H}const hs="Retry-After",Mc=["retry-after-ms","x-ms-retry-after-ms",hs];function ps(V){if(V&&[429,503].includes(V.status))try{for(const z of Mc){const ae=$u(V,z);if(0===ae||ae)return ae*(z===hs?1e3:1)}const O=V.headers.get(hs);if(!O)return;const H=Date.parse(O)-Date.now();return Number.isFinite(H)?Math.max(0,H):void 0}catch(O){return}}function ba(V={}){var O,x;const H=null!==(O=V.retryDelayInMs)&&void 0!==O?O:1e3,z=null!==(x=V.maxRetryDelayInMs)&&void 0!==x?x:64e3;let ae=H;return{name:"exponentialRetryStrategy",retry({retryCount:ie,response:me,responseError:ke}){const Ee=function(V){return!!V&&("ETIMEDOUT"===V.code||"ESOCKETTIMEDOUT"===V.code||"ECONNREFUSED"===V.code||"ECONNRESET"===V.code||"ENOENT"===V.code)}(ke),Me=Ee&&V.ignoreSystemErrors,ze=function(V){return Boolean(V&&void 0!==V.status&&(V.status>=500||408===V.status)&&501!==V.status&&505!==V.status)}(me),lt=ze&&V.ignoreHttpStatusCodes;if(me&&(function(V){return Number.isFinite(ps(V))}(me)||!ze)||lt||Me)return{skipStrategy:!0};if(ke&&!Ee&&!ze)return{errorToThrow:ke};const ct=ae*Math.pow(2,ie),Tt=Math.min(z,ct);return ae=Tt/2+function(V,O){return V=Math.ceil(V),O=Math.floor(O),Math.floor(Math.random()*(O-V+1))+V}(0,Tt/2),{retryAfterInMs:ae}}}}const Oc=(0,p.YR)("core-rest-pipeline retryPolicy");function sp(V,O={maxRetries:3}){const x=O.logger||Oc;return{name:"retryPolicy",sendRequest:(H,z)=>(0,b.Z)(function*(){var ae,ie;let me,ke,Ee=-1;e:for(;;){Ee+=1,me=void 0,ke=void 0;try{x.info(`Retry ${Ee}: Attempting to send request`,H.requestId),me=yield z(H),x.info(`Retry ${Ee}: Received a response from request`,H.requestId)}catch(Me){if(x.error(`Retry ${Ee}: Received an error from request`,H.requestId),ke=Me,!Me||"RestError"!==ke.name)throw Me;me=ke.response}if(null===(ae=H.abortSignal)||void 0===ae?void 0:ae.aborted)throw x.error(`Retry ${Ee}: Request aborted.`),new fs._;if(Ee>=(null!==(ie=O.maxRetries)&&void 0!==ie?ie:3)){if(x.info(`Retry ${Ee}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),ke)throw ke;if(me)return me;throw new Error("Maximum retries reached with no response or error to throw")}x.info(`Retry ${Ee}: Processing ${V.length} retry strategies.`);t:for(const Me of V){const ze=Me.logger||Oc;ze.info(`Retry ${Ee}: Processing retry strategy ${Me.name}.`);const lt=Me.retry({retryCount:Ee,response:me,responseError:ke});if(lt.skipStrategy){ze.info(`Retry ${Ee}: Skipped.`);continue t}const{errorToThrow:kt,retryAfterInMs:ct,redirectTo:Tt}=lt;if(kt)throw ze.error(`Retry ${Ee}: Retry strategy ${Me.name} throws error:`,kt),kt;if(ct||0===ct){ze.info(`Retry ${Ee}: Retry strategy ${Me.name} retries after ${ct}`),yield Hu(ct,void 0,{abortSignal:H.abortSignal});continue e}if(Tt){ze.info(`Retry ${Ee}: Retry strategy ${Me.name} redirects to ${Tt}`),H.url=Tt;continue e}}if(ke)throw x.info("None of the retry strategies could work with the received error. Throwing it."),ke;if(me)return x.info("None of the retry strategies could work with the received response. Returning it."),me}})()}}function Nc(V){const O=Di.create();return O.addPolicy({name:"formDataPolicy",sendRequest:(V,O)=>(0,b.Z)(function*(){if(V.formData){const x=V.formData,H=new FormData;for(const ae of Object.keys(x)){const ie=x[ae];if(Array.isArray(ie))for(const me of ie)H.append(ae,me);else H.append(ae,ie)}V.body=H,V.formData=void 0;const z=V.headers.get("Content-Type");z&&-1!==z.indexOf("application/x-www-form-urlencoded")?V.body=new URLSearchParams(H).toString():z&&-1!==z.indexOf("multipart/form-data")&&V.headers.delete("Content-Type")}return O(V)})()}),O.addPolicy(function(V={}){const O=wc(V.userAgentPrefix);return{name:"userAgentPolicy",sendRequest:(x,H)=>(0,b.Z)(function*(){return x.headers.has(Dc)||x.headers.set(Dc,O),H(x)})()}}(V.userAgentOptions)),O.addPolicy(function(V="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",sendRequest:(O,x)=>(0,b.Z)(function*(){return O.headers.has(V)||O.headers.set(V,O.requestId),x(O)})()}}()),O.addPolicy(function(V={}){var O;return{name:"defaultRetryPolicy",sendRequest:sp([{name:"throttlingRetryStrategy",retry({response:V}){const O=ps(V);return Number.isFinite(O)?{retryAfterInMs:O}:{skipStrategy:!0}}},ba(V)],{maxRetries:null!==(O=V.maxRetries)&&void 0!==O?O:3}).sendRequest}}(V.retryOptions),{phase:"Retry"}),O.addPolicy(function(V={}){const O=wc(V.userAgentPrefix),x=function(){try{return function(V){const{namespace:O,packageName:x,packageVersion:H}=V;function z(Me,ze,lt){var kt;const ct=Yn().startSpan(Me,Object.assign(Object.assign({},lt),{packageName:x,packageVersion:H,tracingContext:null===(kt=null==ze?void 0:ze.tracingOptions)||void 0===kt?void 0:kt.tracingContext}));let Tt=ct.tracingContext;const Bt=ct.span;return Tt.getValue(pt.namespace)||(Tt=Tt.setValue(pt.namespace,O)),Bt.setAttribute("az.namespace",Tt.getValue(pt.namespace)),{span:Bt,updatedOptions:Object.assign({},ze,{tracingOptions:Object.assign(Object.assign({},null==ze?void 0:ze.tracingOptions),{tracingContext:Tt})})}}function ie(){return(ie=(0,b.Z)(function*(Me,ze,lt,kt){const{span:ct,updatedOptions:Tt}=z(Me,ze,kt);try{const Bt=yield me(Tt.tracingOptions.tracingContext,()=>Promise.resolve(lt(Tt,ct)));return ct.setStatus({status:"success"}),Bt}catch(Bt){throw ct.setStatus({status:"error",error:Bt}),Bt}finally{ct.end()}})).apply(this,arguments)}function me(Me,ze,...lt){return Yn().withContext(Me,ze,...lt)}return{startSpan:z,withSpan:function(Me,ze,lt,kt){return ie.apply(this,arguments)},withContext:me,parseTraceparentHeader:function(Me){return Yn().parseTraceparentHeader(Me)},createRequestHeaders:function(Me){return Yn().createRequestHeaders(Me)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:"1.8.1"})}catch(V){return void Ai.warning(`Error when creating the TracingClient: ${ti(V)}`)}}();return{name:"tracingPolicy",sendRequest:(H,z)=>(0,b.Z)(function*(){var ae,ie;if(!x||!(null===(ae=H.tracingOptions)||void 0===ae?void 0:ae.tracingContext))return z(H);const{span:me,tracingContext:ke}=null!==(ie=function(V,O,x){try{const{span:H,updatedOptions:z}=V.startSpan(`HTTP ${O.method}`,{tracingOptions:O.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":O.method,"http.url":O.url,requestId:O.requestId}});if(!H.isRecording())return void H.end();x&&H.setAttribute("http.user_agent",x);const ae=V.createRequestHeaders(z.tracingOptions.tracingContext);for(const[ie,me]of Object.entries(ae))O.headers.set(ie,me);return{span:H,tracingContext:z.tracingOptions.tracingContext}}catch(H){return void Ai.warning(`Skipping creating a tracing span due to an error: ${ti(H)}`)}}(x,H,O))&&void 0!==ie?ie:{};if(!me||!ke)return z(H);try{const Ee=yield x.withContext(ke,z,H);return function(V,O){try{V.setAttribute("http.status_code",O.status);const x=O.headers.get("x-ms-request-id");x&&V.setAttribute("serviceRequestId",x),V.setStatus({status:"success"}),V.end()}catch(x){Ai.warning(`Skipping tracing span processing due to an error: ${ti(x)}`)}}(me,Ee),Ee}catch(Ee){throw function(V,O){try{V.setStatus({status:"error",error:Qi(O)?O:void 0}),function(V){return V instanceof an||Qi(V)&&"RestError"===V.name}(O)&&O.statusCode&&V.setAttribute("http.status_code",O.statusCode),V.end()}catch(x){Ai.warning(`Skipping tracing span processing due to an error: ${ti(x)}`)}}(me,Ee),Ee}})()}}(V.userAgentOptions),{afterPhase:"Retry"}),O.addPolicy(function(V={}){var O;const x=null!==(O=V.logger)&&void 0!==O?O:Ai.info,H=new Nn({additionalAllowedHeaderNames:V.additionalAllowedHeaderNames,additionalAllowedQueryParameters:V.additionalAllowedQueryParameters});return{name:"logPolicy",sendRequest:(z,ae)=>(0,b.Z)(function*(){if(!x.enabled)return ae(z);x(`Request: ${H.sanitize(z)}`);const ie=yield ae(z);return x(`Response status code: ${ie.status}`),x(`Headers: ${H.sanitize(ie.headers)}`),ie})()}}(V.loggingOptions),{afterPhase:"Retry"}),O}const ap={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function sr(){return(sr=(0,b.Z)(function*(V,O,x){function H(){return z.apply(this,arguments)}function z(){return(z=(0,b.Z)(function*(){if(!(Date.now()<x)){const ie=yield V();if(null===ie)throw new Error("Failed to refresh access token.");return ie}try{return yield V()}catch(ie){return null}})).apply(this,arguments)}let ae=yield H();for(;null===ae;)yield Hu(O),ae=yield H();return ae})).apply(this,arguments)}function po(V){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,b.Z)(function*(V){const{scopes:O,getAccessToken:x,request:H}=V,z={abortSignal:H.abortSignal,tracingOptions:H.tracingOptions},ae=yield x(O,z);ae&&V.request.headers.set("Authorization",`Bearer ${ae.token}`)})).apply(this,arguments)}function ms(V){var O;const{credential:x,scopes:H,challengeCallbacks:z,logger:ae}=V,ie=Object.assign({authorizeRequest:null!==(O=null==z?void 0:z.authorizeRequest)&&void 0!==O?O:po,authorizeRequestOnChallenge:null==z?void 0:z.authorizeRequestOnChallenge},z),me=x?function(V,O){let z,x=null,H=null;const ae=Object.assign(Object.assign({},ap),O),ie={get isRefreshing(){return null!==x},get shouldRefresh(){var ke;return!ie.isRefreshing&&(null!==(ke=null==H?void 0:H.expiresOnTimestamp)&&void 0!==ke?ke:0)-ae.refreshWindowInMs<Date.now()},get mustRefresh(){return null===H||H.expiresOnTimestamp-ae.forcedRefreshWindowInMs<Date.now()}};function me(ke,Ee){var Me;return ie.isRefreshing||(x=function(V,O,x){return sr.apply(this,arguments)}(()=>V.getToken(ke,Ee),ae.retryIntervalInMs,null!==(Me=null==H?void 0:H.expiresOnTimestamp)&&void 0!==Me?Me:Date.now()).then(lt=>(x=null,H=lt,z=Ee.tenantId,H)).catch(lt=>{throw x=null,H=null,z=void 0,lt})),x}return function(){var ke=(0,b.Z)(function*(Ee,Me){return z!==Me.tenantId||ie.mustRefresh?me(Ee,Me):(ie.shouldRefresh&&me(Ee,Me),H)});return function(Ee,Me){return ke.apply(this,arguments)}}()}(x):()=>Promise.resolve(null);return{name:"bearerTokenAuthenticationPolicy",sendRequest:(ke,Ee)=>(0,b.Z)(function*(){if(!ke.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let Me,ze;yield ie.authorizeRequest({scopes:Array.isArray(H)?H:[H],request:ke,getAccessToken:me,logger:ae});try{Me=yield Ee(ke)}catch(lt){ze=lt,Me=lt.response}if(ie.authorizeRequestOnChallenge&&401===(null==Me?void 0:Me.status)&&function(V){const O=V.headers.get("WWW-Authenticate");if(401===V.status&&O)return O}(Me)&&(yield ie.authorizeRequestOnChallenge({scopes:Array.isArray(H)?H:[H],request:ke,response:Me,getAccessToken:me,logger:ae})))return Ee(ke);if(ze)throw ze;return Me})()}}function Xn(V){const{parameterPath:O,mapper:x}=V;let H;return H="string"==typeof O?O:Array.isArray(O)?O.join("."):x.serializedName,H}function Ju(V){return Boolean(V&&"function"==typeof V.getReader&&"function"==typeof V.tee)}class Bc{sendRequest(O){return(0,b.Z)(function*(){if("https:"!==new URL(O.url).protocol&&!O.allowInsecureConnection)throw new Error(`Cannot connect to ${O.url} while allowInsecureConnection is false.`);if(O.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return yield function(V){return $t.apply(this,arguments)}(O)}catch(z){throw function(V,O){var x;return V&&"AbortError"===(null==V?void 0:V.name)?V:new an(`Error sending request: ${V.message}`,{code:null!==(x=null==V?void 0:V.code)&&void 0!==x?x:an.REQUEST_SEND_ERROR,request:O})}(z,O)}})()}}function $t(){return($t=(0,b.Z)(function*(V){const{abortController:O,abortControllerCleanup:x}=Yu(V);try{const H=Hr(V.headers),z=Da(V);return Ia(yield fetch(V.url,{body:z,method:V.method,headers:H,signal:O.signal,credentials:V.withCredentials?"include":"same-origin",cache:"no-store"}),V)}finally{x&&x()}})).apply(this,arguments)}function Ia(V,O){return En.apply(this,arguments)}function En(){return(En=(0,b.Z)(function*(V,O){var x,H;const ae={request:O,headers:wa(V),status:V.status},ie=Ju(V.body)?jc(V.body,O.onDownloadProgress):V.body;if((null===(x=O.streamResponseStatusCodes)||void 0===x?void 0:x.has(Number.POSITIVE_INFINITY))||(null===(H=O.streamResponseStatusCodes)||void 0===H?void 0:H.has(ae.status)))if(O.enableBrowserStreams)ae.browserStreamBody=null!=ie?ie:void 0;else{const me=new Response(ie);ae.blobBody=me.blob()}else{const me=new Response(ie);ae.bodyAsText=yield me.text()}return ae})).apply(this,arguments)}function Yu(V){const O=new AbortController;let x,H;if(V.abortSignal){if(V.abortSignal.aborted)throw new fs._("The operation was aborted.");H=z=>{"abort"===z.type&&O.abort()},V.abortSignal.addEventListener("abort",H),x=()=>{var z;H&&(null===(z=V.abortSignal)||void 0===z||z.removeEventListener("abort",H))}}return V.timeout>0&&setTimeout(()=>{O.abort()},V.timeout),{abortController:O,abortControllerCleanup:x}}function Hr(V){const O=new Headers;for(const[x,H]of V)O.append(x,H);return O}function wa(V){const O=ss();for(const[x,H]of V.headers)O.set(x,H);return O}function Da(V){const O="function"==typeof V.body?V.body():V.body;if(function(V){return V&&"function"==typeof V.pipe}(O))throw new Error("Node streams are not supported in browser environment.");return Ju(O)?jc(O,V.onUploadProgress):O}function jc(V,O){let x=0;if(function(V){return void 0!==V.pipeThrough&&void 0!==self.TransformStream}(V))return V.pipeThrough(new TransformStream({transform(H,z){null!==H?(z.enqueue(H),x+=H.length,O&&O({loadedBytes:x})):z.terminate()}}));{const H=V.getReader();return new ReadableStream({pull:z=>(0,b.Z)(function*(){var ae;const{done:ie,value:me}=yield H.read();if(ie||!me)return z.close(),void H.releaseLock();x+=null!==(ae=null==me?void 0:me.length)&&void 0!==ae?ae:0,z.enqueue(me),O&&O({loadedBytes:x})})()})}}let Un;const Zu={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function qr(V,O){let x=V;for(const[H,z]of O)x=x.split(H).join(z);return x}const el=(0,p.YR)("core-client");class Pa extends class extends class{constructor(O={}){var x,H;if(this._requestContentType=O.requestContentType,this._endpoint=null!==(x=O.endpoint)&&void 0!==x?x:O.baseUri,O.baseUri&&el.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=O.allowInsecureConnection,this._httpClient=O.httpClient||(Un||(Un=new Bc),Un),this.pipeline=O.pipeline||function(V){const O=function(V){if(V.credentialScopes){const O=V.credentialScopes;return Array.isArray(O)?O.map(x=>new URL(x).toString()):new URL(O).toString()}if(V.endpoint)return`${V.endpoint}/.default`;if(V.baseUri)return`${V.baseUri}/.default`;if(V.credential&&!V.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}(V),x=V.credential&&O?{credentialScopes:O,credential:V.credential}:void 0;return function(V={}){const O=Nc(null!=V?V:{});return V.credentialOptions&&O.addPolicy(ms({credential:V.credentialOptions.credential,scopes:V.credentialOptions.credentialScopes})),O.addPolicy(function(V={}){const O=V.stringifyXML;return{name:"serializationPolicy",sendRequest:(x,H)=>(0,b.Z)(function*(){const z=An(x),ae=null==z?void 0:z.operationSpec,ie=null==z?void 0:z.operationArguments;return ae&&ie&&(function(V,O,x){var H,z;if(x.headerParameters)for(const ie of x.headerParameters){let me=pr(O,ie);if(null!=me||ie.mapper.required){me=x.serializer.serialize(ie.mapper,me,Xn(ie));const ke=ie.mapper.headerCollectionPrefix;if(ke)for(const Ee of Object.keys(me))V.headers.set(ke+Ee,me[Ee]);else V.headers.set(ie.mapper.serializedName||Xn(ie),me)}}const ae=null===(z=null===(H=O.options)||void 0===H?void 0:H.requestOptions)||void 0===z?void 0:z.customHeaders;if(ae)for(const ie of Object.keys(ae))V.headers.set(ie,ae[ie])}(x,ie,ae),function(V,O,x,H=function(){throw new Error("XML serialization unsupported!")}){var z,ae,ie,me,ke;const Ee=null===(z=O.options)||void 0===z?void 0:z.serializerOptions,Me={xml:{rootName:null!==(ae=null==Ee?void 0:Ee.xml.rootName)&&void 0!==ae?ae:"",includeRoot:null!==(ie=null==Ee?void 0:Ee.xml.includeRoot)&&void 0!==ie&&ie,xmlCharKey:null!==(me=null==Ee?void 0:Ee.xml.xmlCharKey)&&void 0!==me?me:Y}},ze=Me.xml.xmlCharKey;if(x.requestBody&&x.requestBody.mapper){V.body=pr(O,x.requestBody);const lt=x.requestBody.mapper,{required:kt,serializedName:ct,xmlName:Tt,xmlElementName:Bt,xmlNamespace:hn,xmlNamespacePrefix:en,nullable:mn}=lt,Tn=lt.type.name;try{if(null!=V.body||mn&&null===V.body||kt){const mo=Xn(x.requestBody);V.body=x.serializer.serialize(lt,V.body,mo,Me);const gr="Stream"===Tn;if(x.isXML){const Xi=en?`xmlns:${en}`:"xmlns",eo=function(V,O,x,H,z){if(V&&!["Composite","Sequence","Dictionary"].includes(x)){const ae={};return ae[z.xml.xmlCharKey]=H,ae[Z]={[O]:V},ae}return H}(hn,Xi,Tn,V.body,Me);"Sequence"===Tn?V.body=H(function(V,O,x,H){if(Array.isArray(V)||(V=[V]),!x||!H)return{[O]:V};const z={[O]:V};return z[Z]={[x]:H},z}(eo,Bt||Tt||ct,Xi,hn),{rootName:Tt||ct,xmlCharKey:ze}):gr||(V.body=H(eo,{rootName:Tt||ct,xmlCharKey:ze}))}else{if("String"===Tn&&((null===(ke=x.contentType)||void 0===ke?void 0:ke.match("text/plain"))||"text"===x.mediaType))return;gr||(V.body=JSON.stringify(V.body))}}}catch(mo){throw new Error(`Error "${mo.message}" occurred in serializing the payload - ${JSON.stringify(ct,void 0,"  ")}.`)}}else if(x.formDataParameters&&x.formDataParameters.length>0){V.formData={};for(const lt of x.formDataParameters){const kt=pr(O,lt);if(null!=kt){const ct=lt.mapper.serializedName||Xn(lt);V.formData[ct]=x.serializer.serialize(lt.mapper,kt,Xn(lt),Me)}}}}(x,ie,ae,O)),H(x)})()}}(V.serializationOptions),{phase:"Serialize"}),O.addPolicy(function(V={}){var O,x,H,z,ae,ie,me;const ke=null!==(x=null===(O=V.expectedContentTypes)||void 0===O?void 0:O.json)&&void 0!==x?x:st,Ee=null!==(z=null===(H=V.expectedContentTypes)||void 0===H?void 0:H.xml)&&void 0!==z?z:Ft,Me=V.parseXML,ze=V.serializerOptions,lt={xml:{rootName:null!==(ae=null==ze?void 0:ze.xml.rootName)&&void 0!==ae?ae:"",includeRoot:null!==(ie=null==ze?void 0:ze.xml.includeRoot)&&void 0!==ie&&ie,xmlCharKey:null!==(me=null==ze?void 0:ze.xml.xmlCharKey)&&void 0!==me?me:Y}};return{name:"deserializationPolicy",sendRequest:(kt,ct)=>(0,b.Z)(function*(){const Tt=yield ct(kt);return function(V,O,x,H,z){return fn.apply(this,arguments)}(ke,Ee,Tt,lt,Me)})()}}(V.deserializationOptions),{phase:"Deserialize"}),O}(Object.assign(Object.assign({},V),{credentialOptions:x}))}(O),null===(H=O.additionalPolicies)||void 0===H?void 0:H.length)for(const{policy:z,position:ae}of O.additionalPolicies)this.pipeline.addPolicy(z,{afterPhase:"perRetry"===ae?"Sign":void 0})}sendRequest(O){var x=this;return(0,b.Z)(function*(){return x.pipeline.sendRequest(x._httpClient,O)})()}sendOperationRequest(O,x){var H=this;return(0,b.Z)(function*(){const z=x.baseUrl||H._endpoint;if(!z)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const ae=function(V,O,x,H){const z=function(V,O,x){var H;const z=new Map;if(null===(H=V.urlParameters)||void 0===H?void 0:H.length)for(const ae of V.urlParameters){let ie=pr(O,ae,x);const me=Xn(ae);ie=V.serializer.serialize(ae.mapper,ie,me),ae.skipEncoding||(ie=encodeURIComponent(ie)),z.set(`{${ae.mapper.serializedName||me}}`,ie)}return z}(O,x,H);let ae=!1,ie=qr(V,z);if(O.path){let Ee=qr(O.path,z);"/{nextLink}"===O.path&&Ee.startsWith("/")&&(Ee=Ee.substring(1)),function(V){return V.includes("://")}(Ee)?(ie=Ee,ae=!0):ie=function(V,O){if(!O)return V;const x=new URL(V);let H=x.pathname;H.endsWith("/")||(H=`${H}/`),O.startsWith("/")&&(O=O.substring(1));const z=O.indexOf("?");if(-1!==z){const ae=O.substring(0,z),ie=O.substring(z+1);H+=ae,ie&&(x.search=x.search?`${x.search}&${ie}`:ie)}else H+=O;return x.pathname=H,x.toString()}(ie,Ee)}const{queryParams:me,sequenceParams:ke}=function(V,O,x){var H;const z=new Map,ae=new Set;if(null===(H=V.queryParameters)||void 0===H?void 0:H.length)for(const ie of V.queryParameters){"Sequence"===ie.mapper.type.name&&ie.mapper.serializedName&&ae.add(ie.mapper.serializedName);let me=pr(O,ie,x);if(null!=me||ie.mapper.required){me=V.serializer.serialize(ie.mapper,me,Xn(ie));const ke=ie.collectionFormat?Zu[ie.collectionFormat]:"";if(Array.isArray(me)&&(me=me.map(Ee=>null==Ee?"":Ee)),"Multi"===ie.collectionFormat&&0===me.length)continue;Array.isArray(me)&&("SSV"===ie.collectionFormat||"TSV"===ie.collectionFormat)&&(me=me.join(ke)),ie.skipEncoding||(me=Array.isArray(me)?me.map(Ee=>encodeURIComponent(Ee)):encodeURIComponent(me)),Array.isArray(me)&&("CSV"===ie.collectionFormat||"Pipes"===ie.collectionFormat)&&(me=me.join(ke)),z.set(ie.mapper.serializedName||Xn(ie),me)}}return{queryParams:z,sequenceParams:ae}}(O,x,H);return ie=function(V,O,x,H=!1){if(0===O.size)return V;const z=new URL(V),ae=function(V){const O=new Map;if(!V||"?"!==V[0])return O;const x=(V=V.slice(1)).split("&");for(const H of x){const[z,ae]=H.split("=",2),ie=O.get(z);ie?Array.isArray(ie)?ie.push(ae):O.set(z,[ie,ae]):O.set(z,ae)}return O}(z.search);for(const[me,ke]of O){const Ee=ae.get(me);if(Array.isArray(Ee))if(Array.isArray(ke)){Ee.push(...ke);const Me=new Set(Ee);ae.set(me,Array.from(Me))}else Ee.push(ke);else Ee?(Array.isArray(ke)?ke.unshift(Ee):x.has(me)&&ae.set(me,[Ee,ke]),H||ae.set(me,ke)):ae.set(me,ke)}const ie=[];for(const[me,ke]of ae)if("string"==typeof ke)ie.push(`${me}=${ke}`);else if(Array.isArray(ke))for(const Ee of ke)ie.push(`${me}=${Ee}`);else ie.push(`${me}=${ke}`);return z.search=ie.length?`?${ie.join("&")}`:"",z.toString()}(ie,me,ke,ae),ie}(z,x,O,H),ie=new va({url:ae});ie.method=x.httpMethod;const me=An(ie);me.operationSpec=x,me.operationArguments=O;const ke=x.contentType||H._requestContentType;ke&&x.requestBody&&ie.headers.set("Content-Type",ke);const Ee=O.options;if(Ee){const Me=Ee.requestOptions;Me&&(Me.timeout&&(ie.timeout=Me.timeout),Me.onUploadProgress&&(ie.onUploadProgress=Me.onUploadProgress),Me.onDownloadProgress&&(ie.onDownloadProgress=Me.onDownloadProgress),void 0!==Me.shouldDeserialize&&(me.shouldDeserialize=Me.shouldDeserialize),Me.allowInsecureConnection&&(ie.allowInsecureConnection=!0)),Ee.abortSignal&&(ie.abortSignal=Ee.abortSignal),Ee.tracingOptions&&(ie.tracingOptions=Ee.tracingOptions)}H._allowInsecureConnection&&(ie.allowInsecureConnection=!0),void 0===ie.streamResponseStatusCodes&&(ie.streamResponseStatusCodes=function(V){const O=new Set;for(const x in V.responses){const H=V.responses[x];H.bodyMapper&&"Stream"===H.bodyMapper.type.name&&O.add(Number(x))}return O}(x));try{const Me=yield H.sendRequest(ie),ze=te(Me,x.responses[Me.status]);return(null==Ee?void 0:Ee.onResponse)&&Ee.onResponse(Me,ze),ze}catch(Me){if("object"==typeof Me&&(null==Me?void 0:Me.response)){const ze=Me.response,lt=te(ze,x.responses[Me.statusCode]||x.responses.default);Me.details=lt,(null==Ee?void 0:Ee.onResponse)&&Ee.onResponse(ze,lt,Me)}throw Me}})()}}{constructor(O,x){if(void 0===O)throw new Error("'endpoint' cannot be null");x||(x={});const z="azsdk-js-azure-communication-chat/1.1.0",ae=x.userAgentOptions&&x.userAgentOptions.userAgentPrefix?`${x.userAgentOptions.userAgentPrefix} ${z}`:`${z}`;super(Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),x),{userAgentOptions:{userAgentPrefix:ae},baseUri:x.endpoint||"{endpoint}"})),this.endpoint=O,this.apiVersion=x.apiVersion||"2021-09-07"}}{constructor(O,x){super(O,x),this.chatThread=new es(this),this.chat=new Oo(this)}}const Oa=V=>ms({credential:{getToken:(x,H)=>V.getToken({abortSignal:null==H?void 0:H.abortSignal})},scopes:[]});class ka{constructor(O,x,H,z={}){this.endpoint=O,this.timeOfLastTypingRequest=void 0,this.threadId=x,this.tokenCredential=H;const ae=Object.assign(Object.assign({},z),{loggingOptions:{logger:E.info}});this.client=new Pa(this.endpoint,Object.assign({endpoint:this.endpoint},ae));const ie=Oa(this.tokenCredential);this.client.pipeline.addPolicy(ie)}getProperties(O={}){var x=this;return(0,b.Z)(function*(){const{span:H,updatedOptions:z}=c("ChatClient-GetProperties",O);try{const ae=yield x.client.chatThread.getChatThreadProperties(x.threadId,z);return P(ae)}catch(ae){throw H.setStatus({code:I.Qn.ERROR,message:ae.message}),ae}finally{H.end()}})()}updateTopic(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-UpdateTopic",x);try{yield H.client.chatThread.updateChatThreadProperties(H.threadId,{topic:O},ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}sendMessage(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-SendMessage",x);try{return H.timeOfLastTypingRequest=void 0,yield H.client.chatThread.sendChatMessage(H.threadId,Object.assign(Object.assign({},O),x),ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}getMessage(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-GetMessage",x);try{const ie=yield H.client.chatThread.getChatMessage(H.threadId,O,ae);return _(ie)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}listMessagesPage(O,x={}){return(0,h.FC)(this,arguments,function*(){if(!O.continuationToken){const z=yield(0,h.qq)(this.client.chatThread.listChatMessages(this.threadId,x));O.continuationToken=z.nextLink,z.value&&(yield yield(0,h.qq)(z.value.map(_,this)))}for(;O.continuationToken;){const z=yield(0,h.qq)(this.client.chatThread.listChatMessagesNext(this.threadId,O.continuationToken,x));if(O.continuationToken=z.nextLink,!z.value)break;yield yield(0,h.qq)(z.value.map(_,this))}})}listMessagesAll(O){return(0,h.FC)(this,arguments,function*(){var H,z;try{for(var ie,ae=(0,h.KL)(this.listMessagesPage({},O));!(ie=yield(0,h.qq)(ae.next())).done;){const me=ie.value;yield(0,h.qq)(yield*(0,h.V2)((0,h.KL)(me)))}}catch(me){H={error:me}}finally{try{ie&&!ie.done&&(z=ae.return)&&(yield(0,h.qq)(z.call(ae)))}finally{if(H)throw H.error}}})}listMessages(O={}){const{span:x,updatedOptions:H}=c("ChatThreadClient-ListMessages",O);try{const z=this.listMessagesAll(H);return{next:()=>z.next(),[Symbol.asyncIterator](){return this},byPage:(ae={})=>this.listMessagesPage(ae,H)}}catch(z){throw x.setStatus({code:I.Qn.ERROR,message:z.message}),z}finally{x.end()}}deleteMessage(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-DeleteMessage",x);try{yield H.client.chatThread.deleteChatMessage(H.threadId,O,ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}updateMessage(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-UpdateMessage",x);try{yield H.client.chatThread.updateChatMessage(H.threadId,O,x,ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}addParticipants(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-AddParticipants",x);try{return yield H.client.chatThread.addChatParticipants(H.threadId,(V=>{var O;return{participants:null===(O=V.participants)||void 0===O?void 0:O.map(x=>g(x))}})(O),ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}listParticipantsPage(O,x={}){return(0,h.FC)(this,arguments,function*(){if(!O.continuationToken){const z=yield(0,h.qq)(this.client.chatThread.listChatParticipants(this.threadId,x));O.continuationToken=z.nextLink,z.value&&(yield yield(0,h.qq)(z.value.map(R,this)))}for(;O.continuationToken;){const z=yield(0,h.qq)(this.client.chatThread.listChatParticipantsNext(this.threadId,O.continuationToken,x));if(O.continuationToken=z.nextLink,!z.value)break;yield yield(0,h.qq)(z.value.map(R,this))}})}listParticipantsAll(O){return(0,h.FC)(this,arguments,function*(){var H,z;try{for(var ie,ae=(0,h.KL)(this.listParticipantsPage({},O));!(ie=yield(0,h.qq)(ae.next())).done;){const me=ie.value;yield(0,h.qq)(yield*(0,h.V2)((0,h.KL)(me)))}}catch(me){H={error:me}}finally{try{ie&&!ie.done&&(z=ae.return)&&(yield(0,h.qq)(z.call(ae)))}finally{if(H)throw H.error}}})}listParticipants(O={}){const{span:x,updatedOptions:H}=c("ChatThreadClient-ListParticipants",O);try{const z=this.listParticipantsAll(H);return{next:()=>z.next(),[Symbol.asyncIterator](){return this},byPage:(ae={})=>this.listParticipantsPage(ae,H)}}catch(z){throw x.setStatus({code:I.Qn.ERROR,message:z.message}),z}finally{x.end()}}removeParticipant(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-RemoveParticipant",x);try{yield H.client.chatThread.removeChatParticipant(H.threadId,(0,v.J)(O),ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}sendTypingNotification(O={}){var x=this;return(0,b.Z)(function*(){const{span:H,updatedOptions:z}=c("ChatThreadClient-SendTypingNotification",O);try{const ae=new Date,{senderDisplayName:ie}=z,me=(0,h._T)(z,["senderDisplayName"]);return x.canPostTypingNotification(ae)?(yield x.client.chatThread.sendTypingNotification(x.threadId,Object.assign({sendTypingNotificationRequest:{senderDisplayName:ie}},me)),x.timeOfLastTypingRequest=ae,!0):(E.info(`Typing Notification NOT Send. [thread_id=${x.threadId}]`),!1)}catch(ae){throw H.setStatus({code:I.Qn.ERROR,message:ae.message}),ae}finally{H.end()}})()}sendReadReceipt(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatThreadClient-SendReadReceipt",x);try{yield H.client.chatThread.sendChatReadReceipt(H.threadId,O,ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}listReadReceiptsPage(O,x={}){return(0,h.FC)(this,arguments,function*(){if(!O.continuationToken){const z=yield(0,h.qq)(this.client.chatThread.listChatReadReceipts(this.threadId,x));O.continuationToken=z.nextLink,z.value&&(yield yield(0,h.qq)(z.value.map(M,this)))}for(;O.continuationToken;){const z=yield(0,h.qq)(this.client.chatThread.listChatReadReceiptsNext(this.threadId,O.continuationToken,x));if(O.continuationToken=z.nextLink,!z.value)break;yield yield(0,h.qq)(z.value.map(M,this))}})}listReadReceiptsAll(O){return(0,h.FC)(this,arguments,function*(){var H,z;try{for(var ie,ae=(0,h.KL)(this.listReadReceiptsPage({},O));!(ie=yield(0,h.qq)(ae.next())).done;){const me=ie.value;yield(0,h.qq)(yield*(0,h.V2)((0,h.KL)(me)))}}catch(me){H={error:me}}finally{try{ie&&!ie.done&&(z=ae.return)&&(yield(0,h.qq)(z.call(ae)))}finally{if(H)throw H.error}}})}listReadReceipts(O={}){const{span:x,updatedOptions:H}=c("ChatThreadClient-ListChatReadReceipts",O);try{const z=this.listReadReceiptsAll(H);return{next:()=>z.next(),[Symbol.asyncIterator](){return this},byPage:(ae={})=>this.listReadReceiptsPage(ae,H)}}catch(z){throw x.setStatus({code:I.Qn.ERROR,message:z.message}),z}finally{x.end()}}canPostTypingNotification(O){return!(this.timeOfLastTypingRequest&&O.getTime()-this.timeOfLastTypingRequest.getTime()<8e3&&(E.info(`Typing interval check failed. [last_request=${this.timeOfLastTypingRequest}]`),1))}}var Zi,zc=new Uint8Array(16);function Kc(){if(!Zi&&!(Zi="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Zi(zc)}const er=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Cn=function(V){return"string"==typeof V&&er.test(V)};for(var Vn=[],Na=0;Na<256;++Na)Vn.push((Na+256).toString(16).substr(1));const Zc=function(V,O,x){var H=(V=V||{}).random||(V.rng||Kc)();if(H[6]=15&H[6]|64,H[8]=63&H[8]|128,O){x=x||0;for(var z=0;z<16;++z)O[x+z]=H[z];return O}return function(V){var O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,x=(Vn[V[O+0]]+Vn[V[O+1]]+Vn[V[O+2]]+Vn[V[O+3]]+"-"+Vn[V[O+4]]+Vn[V[O+5]]+"-"+Vn[V[O+6]]+Vn[V[O+7]]+"-"+Vn[V[O+8]]+Vn[V[O+9]]+"-"+Vn[V[O+10]]+Vn[V[O+11]]+Vn[V[O+12]]+Vn[V[O+13]]+Vn[V[O+14]]+Vn[V[O+15]]).toLowerCase();if(!Cn(x))throw TypeError("Stringified UUID is invalid");return x}(H)};class bs{constructor(O,x,H={}){this.endpoint=O,this.signalingClient=void 0,this.emitter=new d.EventEmitter,this.isRealtimeNotificationsStarted=!1,this.tokenCredential=x,this.clientOptions=Object.assign({},H);const z=Object.assign(Object.assign({},H),{loggingOptions:{logger:E.info}});this.client=new Pa(this.endpoint,Object.assign({endpoint:this.endpoint},z));const ae=Oa(this.tokenCredential);this.client.pipeline.addPolicy(ae),this.signalingClient=((V,O,x)=>{var H;return new T.CommunicationSignalingClient(V,O,{environment:null!==(H=null==x?void 0:x.environment)&&void 0!==H?H:void 0})})(x,E,H.signalingClientOptions)}getChatThreadClient(O){return new ka(this.endpoint,O,this.tokenCredential,this.clientOptions)}createChatThread(O,x={}){var H=this;return(0,b.Z)(function*(){var z,ae;const{span:ie,updatedOptions:me}=c("ChatClient-CreateChatThread",x);try{me.idempotencyToken=null!==(z=me.idempotencyToken)&&void 0!==z?z:Zc();const ke=(V=>{const{idempotencyToken:x}=V,H=(0,h._T)(V,["participants","idempotencyToken"]);return Object.assign({repeatabilityRequestId:x},H)})(me);return(V=>{const{chatThread:O}=V,x=(0,h._T)(V,["chatThread"]);return O?Object.assign(Object.assign({},x),{chatThread:P(O)}):Object.assign({},x)})(yield H.client.chat.createChatThread({topic:O.topic,participants:null===(ae=x.participants)||void 0===ae?void 0:ae.map(Me=>g(Me))},ke))}catch(ke){throw ie.setStatus({code:I.Qn.ERROR,message:ke.message}),ke}finally{ie.end()}})()}listChatThreadsPage(O,x={}){return(0,h.FC)(this,arguments,function*(){if(!O.continuationToken){const z=yield(0,h.qq)(this.client.chat.listChatThreads(x));O.continuationToken=z.nextLink,z.value&&(yield yield(0,h.qq)(z.value))}for(;O.continuationToken;){const z=yield(0,h.qq)(this.client.chat.listChatThreadsNext(O.continuationToken,x));if(O.continuationToken=z.nextLink,!z.value)break;yield yield(0,h.qq)(z.value)}})}listChatThreadsAll(O){return(0,h.FC)(this,arguments,function*(){var H,z;try{for(var ie,ae=(0,h.KL)(this.listChatThreadsPage({},O));!(ie=yield(0,h.qq)(ae.next())).done;){const me=ie.value;yield(0,h.qq)(yield*(0,h.V2)((0,h.KL)(me)))}}catch(me){H={error:me}}finally{try{ie&&!ie.done&&(z=ae.return)&&(yield(0,h.qq)(z.call(ae)))}finally{if(H)throw H.error}}})}listChatThreads(O={}){const{span:x,updatedOptions:H}=c("ChatClient-ListChatThreads",O);try{const z=this.listChatThreadsAll(H);return{next:()=>z.next(),[Symbol.asyncIterator](){return this},byPage:(ae={})=>this.listChatThreadsPage(ae,H)}}catch(z){throw x.setStatus({code:I.Qn.ERROR,message:z.message}),z}finally{x.end()}}deleteChatThread(O,x={}){var H=this;return(0,b.Z)(function*(){const{span:z,updatedOptions:ae}=c("ChatClient-DeleteChatThread",x);try{yield H.client.chat.deleteChatThread(O,ae)}catch(ie){throw z.setStatus({code:I.Qn.ERROR,message:ie.message}),ie}finally{z.end()}})()}startRealtimeNotifications(){var O=this;return(0,b.Z)(function*(){if(void 0===O.signalingClient)throw new Error("Realtime notifications are not supported in node js.");O.isRealtimeNotificationsStarted||(O.isRealtimeNotificationsStarted=!0,yield O.signalingClient.start(),O.subscribeToSignalingEvents())})()}stopRealtimeNotifications(){var O=this;return(0,b.Z)(function*(){if(void 0===O.signalingClient)throw new Error("Realtime notifications are not supported in node js.");O.isRealtimeNotificationsStarted=!1,yield O.signalingClient.stop(),O.emitter.removeAllListeners()})()}on(O,x){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");if(!this.isRealtimeNotificationsStarted)throw new Error("You must call startRealtimeNotifications before you can subscribe to events.");this.emitter.on(O,x)}off(O,x){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.emitter.removeListener(O,x)}subscribeToSignalingEvents(){if(void 0===this.signalingClient)throw new Error("Realtime notifications are only supported in the browser.");this.signalingClient.on("chatMessageReceived",O=>{this.emitter.emit("chatMessageReceived",O)}),this.signalingClient.on("chatMessageEdited",O=>{this.emitter.emit("chatMessageEdited",O)}),this.signalingClient.on("chatMessageDeleted",O=>{this.emitter.emit("chatMessageDeleted",O)}),this.signalingClient.on("typingIndicatorReceived",O=>{this.emitter.emit("typingIndicatorReceived",O)}),this.signalingClient.on("readReceiptReceived",O=>{this.emitter.emit("readReceiptReceived",O)}),this.signalingClient.on("chatThreadCreated",O=>{this.emitter.emit("chatThreadCreated",O)}),this.signalingClient.on("chatThreadDeleted",O=>{this.emitter.emit("chatThreadDeleted",O)}),this.signalingClient.on("chatThreadPropertiesUpdated",O=>{this.emitter.emit("chatThreadPropertiesUpdated",O)}),this.signalingClient.on("participantsAdded",O=>{this.emitter.emit("participantsAdded",O)}),this.signalingClient.on("participantsRemoved",O=>{this.emitter.emit("participantsRemoved",O)})}}},8199:(Q,m,u)=>{"use strict";u.d(m,{J:()=>d,H:()=>T});var s=u(4762),b=u(6361);const h=(A,I)=>void 0===I?A:Object.assign(Object.assign({},A),{rawId:I}),p=(A,I)=>{const f=Object.keys(A)[0],c=A[f];if(I in c)return c[I];throw new Error(`Property ${I} is required for identifier of type ${f}.`)},d=A=>{var I,f;const c=(0,b.n9)(A);switch(c.kind){case"communicationUser":return{communicationUser:{id:c.communicationUserId}};case"phoneNumber":return h({phoneNumber:{value:c.phoneNumber}},c.rawId);case"microsoftTeamsUser":return h({microsoftTeamsUser:{userId:c.microsoftTeamsUserId,isAnonymous:null!==(I=c.isAnonymous)&&void 0!==I&&I,cloud:null!==(f=c.cloud)&&void 0!==f?f:"public"}},c.rawId);case"unknown":return{rawId:c.id};default:throw new Error(`Can't serialize an identifier with kind ${c.kind}`)}},T=A=>{(A=>{const f=(0,s._T)(A,["rawId"]),c=Object.keys(f);if(c.length>1)throw new Error(`Only one of the properties in ${JSON.stringify(c)} should be present.`)})(A);const{communicationUser:I,microsoftTeamsUser:f,phoneNumber:c}=A;return I?{kind:"communicationUser",communicationUserId:p({communicationUser:I},"id")}:c?{kind:"phoneNumber",phoneNumber:p({phoneNumber:c},"value"),rawId:p({phoneNumber:A},"rawId")}:f?{kind:"microsoftTeamsUser",microsoftTeamsUserId:p({microsoftTeamsUser:f},"userId"),isAnonymous:p({microsoftTeamsUser:f},"isAnonymous"),cloud:p({microsoftTeamsUser:f},"cloud"),rawId:p({microsoftTeamsUser:A},"rawId")}:{kind:"unknown",id:p({unknown:A},"rawId")}}},6361:(Q,m,u)=>{"use strict";u.d(m,{sE:()=>s,Nc:()=>b,OU:()=>h,vJ:()=>p,n9:()=>E});const s=d=>"string"==typeof d.communicationUserId,b=d=>"string"==typeof d.phoneNumber,h=d=>"string"==typeof d.microsoftTeamsUserId,p=d=>"string"==typeof d.id,E=d=>s(d)?Object.assign(Object.assign({},d),{kind:"communicationUser"}):b(d)?Object.assign(Object.assign({},d),{kind:"phoneNumber"}):h(d)?Object.assign(Object.assign({},d),{kind:"microsoftTeamsUser"}):Object.assign(Object.assign({},d),{kind:"unknown"})},9116:(Q,m,u)=>{"use strict";u.r(m),u.d(m,{AzureCommunicationTokenCredential:()=>f,createCommunicationAccessKeyCredentialPolicy:()=>y,createCommunicationAuthPolicy:()=>j,deserializeCommunicationIdentifier:()=>te.H,getIdentifierKind:()=>de.n9,isCommunicationUserIdentifier:()=>de.sE,isKeyCredential:()=>ne,isMicrosoftTeamsUserIdentifier:()=>de.OU,isPhoneNumberIdentifier:()=>de.Nc,isUnknownIdentifier:()=>de.vJ,parseClientArguments:()=>X,parseConnectionString:()=>W,serializeCommunicationIdentifier:()=>te.J});var s=u(8239),b=u(4934),h=u.n(b);const p=K=>{const{exp:re}=h()(K);return{token:K,expiresOnTimestamp:1e3*re}};class E{constructor(re){this.token=re}getToken(){var re=this;return(0,s.Z)(function*(){return re.token})()}dispose(){}}const d={token:"",expiresOnTimestamp:-10};class I{constructor(re){this.refreshingIntervalInMs=6e5,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.disposed=!1;const{tokenRefresher:ve,token:be,refreshProactively:Be}=re;this.refresh=ve,this.currentToken=be?p(be):d,this.refreshProactively=null!=Be&&Be,this.refreshProactively&&this.scheduleRefresh()}getToken(re){var ve=this;return(0,s.Z)(function*(){if(!ve.isCurrentTokenExpiringSoon)return ve.currentToken;const be=ve.updateTokenAndReschedule(null==re?void 0:re.abortSignal);return ve.isCurrentTokenValid||(yield be),ve.currentToken})()}dispose(){this.disposed=!0,this.activeTokenFetching=null,this.activeTokenUpdating=null,this.currentToken=d,this.activeTimeout&&clearTimeout(this.activeTimeout)}updateTokenAndReschedule(re){var ve=this;return(0,s.Z)(function*(){if(ve.activeTokenUpdating)return ve.activeTokenUpdating;ve.activeTokenUpdating=ve.refreshTokenAndReschedule(re);try{yield ve.activeTokenUpdating}finally{ve.activeTokenUpdating=null}})()}refreshTokenAndReschedule(re){var ve=this;return(0,s.Z)(function*(){ve.currentToken=yield ve.refreshToken(re),ve.refreshProactively&&ve.scheduleRefresh()})()}refreshToken(re){var ve=this;return(0,s.Z)(function*(){try{return ve.activeTokenFetching||(ve.activeTokenFetching=ve.refresh(re)),p(yield ve.activeTokenFetching)}finally{ve.activeTokenFetching=null}})()}scheduleRefresh(){if(this.disposed)return;this.activeTimeout&&clearTimeout(this.activeTimeout);const re=this.currentToken.expiresOnTimestamp-Date.now()-this.refreshingIntervalInMs;this.activeTimeout=setTimeout(()=>this.updateTokenAndReschedule(),re)}get isCurrentTokenValid(){return this.currentToken&&Date.now()<this.currentToken.expiresOnTimestamp}get isCurrentTokenExpiringSoon(){return!this.currentToken||Date.now()>=this.currentToken.expiresOnTimestamp-this.refreshingIntervalInMs}}class f{constructor(re){this.disposed=!1,this.tokenCredential="string"==typeof re?new E(p(re)):new I(re)}getToken(re){var ve=this;return(0,s.Z)(function*(){ve.throwIfDisposed();const be=yield ve.tokenCredential.getToken(re);return ve.throwIfDisposed(),be})()}dispose(){this.disposed=!0,this.tokenCredential.dispose()}throwIfDisposed(){if(this.disposed)throw new Error("User credential is disposed")}}var c=u(2462),v=u(369),S=u(7694);const g=K=>(new TextEncoder).encode(K);function R(K){if("function"!=typeof btoa)throw new Error("Your browser environment is missing the global `btoa` function");const re=new Uint8Array(K);let ve="";for(const be of re)ve+=String.fromCharCode(be);return btoa(ve)}const D=globalThis,_=()=>{if(!D)throw new Error("Could not find global");if(!D.crypto||!D.crypto.subtle)throw new Error("Browser does not support cryptography functions");return D.crypto.subtle},N=function(){var K=(0,s.Z)(function*(re){const ve=g(re);return R(yield _().digest("SHA-256",ve))});return function(ve){return K.apply(this,arguments)}}(),P=function(){var K=(0,s.Z)(function*(re,ve){const be={name:"HMAC",hash:{name:"SHA-256"}},Be=g(ve),$e=function(K){if("function"!=typeof atob)throw new Error("Your browser environment is missing the global `atob` function");const re=atob(K),ve=new Uint8Array(re.length);for(let be=0;be<re.length;be++)ve[be]=re.charCodeAt(be);return ve}(re),Oe=_(),se=yield Oe.importKey("raw",$e,be,!1,["sign"]);return R(yield Oe.sign(be,se,Be))});return function(ve,be){return K.apply(this,arguments)}}(),y=K=>({create:(re,ve)=>new M(K,re,ve)});class M extends c.U{constructor(re,ve,be){super(ve,be),this.accessKey=re}signRequest(re){var ve=this;return(0,s.Z)(function*(){const be=re.method.toUpperCase(),Be=(new Date).toUTCString(),$e=yield N(re.body||""),Oe="x-ms-date",se=`${Oe};host;x-ms-content-sha256`,fe=v.UK.parse(re.url),we=fe.getQuery(),Te=we?`${fe.getPath()}?${we}`:fe.getPath(),ye=fe.getPort(),Pe=ye?`${fe.getHost()}:${ye}`:fe.getHost(),Ve=`${be}\n${Te}\n${Be};${Pe};${$e}`,Ue=yield P(ve.accessKey.key,Ve);return S.UG&&re.headers.set("Host",Pe||""),re.headers.set(Oe,Be),re.headers.set("x-ms-content-sha256",$e),re.headers.set("Authorization",`HMAC-SHA256 SignedHeaders=${se}&Signature=${Ue}`),re})()}sendRequest(re){var ve=this;return(0,s.Z)(function*(){if(!re)throw new Error("webResource cannot be null or undefined");return ve._nextPolicy.sendRequest(yield ve.signRequest(re))})()}}var U=u(434),$=u(6354);const j=K=>(0,U.c)(K)?(0,$.v)(K,"https://communication.azure.com//.default"):y(K);class ue{constructor(re){if(!re)throw new Error("key must be a non-empty string");this._key=re}get key(){return this._key}update(re){this._key=re}}const Z=/endpoint=(.*);accesskey=(.*)/i,W=K=>{const re=(K=>{const re=K.match(Z);if((null==re?void 0:re[1])&&re[2])return{endpoint:re[1],credential:new ue(re[2])}})(K);if(re)return re;throw new Error(`Invalid connection string ${K}`)},Ce=K=>{if(!(K=>{var re;const ve=v.UK.parse(K);return!!(null===(re=ve.getScheme())||void 0===re?void 0:re.match(/^http[s]?/))&&void 0!==ve.getHost()&&""!==ve.getHost()&&(void 0===ve.getPath()||""===ve.getPath()||"/"===ve.getPath())})(K))throw new Error(`Invalid endpoint url ${K}`)},ne=K=>K&&"string"==typeof K.key&&void 0===K.getToken,X=(K,re)=>{if(ne(re)||(0,U.c)(re))return Ce(K),{url:K,credential:re};{const{endpoint:ve,credential:be}=W(K);return Ce(ve),{url:ve,credential:be}}};var de=u(6361),te=u(8199)},2305:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";function _interopDefault(Q){return Q&&"object"==typeof Q&&"default"in Q?Q.default:Q}var coreHttp=_interopDefault(__webpack_require__(50)),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(Q){return Q&&Q.__esModule&&Object.prototype.hasOwnProperty.call(Q,"default")?Q.default:Q}function createCommonjsModule(Q,m){return Q(m={exports:{}},m.exports),m.exports}var tsregistrar=createCommonjsModule(function(Q,m){Q.exports=function(u){function s(h){if(b[h])return b[h].exports;var p=b[h]={i:h,l:!1,exports:{}};return u[h].call(p.exports,p,p.exports,s),p.l=!0,p.exports}var b={};return s.m=u,s.c=b,s.i=function(h){return h},s.d=function(h,p,E){s.o(h,p)||Object.defineProperty(h,p,{configurable:!1,enumerable:!0,get:E})},s.n=function(h){var p=h&&h.__esModule?function(){return h.default}:function(){return h};return s.d(p,"a",p),p},s.o=function(h,p){return Object.prototype.hasOwnProperty.call(h,p)},s.p="",s(s.s=1)}([function(u,s,b){Object.defineProperty(s,"__esModule",{value:!0}),s.toJson=function(E){try{return JSON.stringify(E)}catch(d){return"Unable to serialize object of type "+typeof E}};var p=function(){function E(){this.start=Date.now()}return Object.defineProperty(E.prototype,"duration",{get:function(){return Date.now()-this.start},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"startTime",{get:function(){return this.start},enumerable:!0,configurable:!0}),E.prototype.reset=function(){this.start=Date.now()},E}();s.Timespan=p},function(u,s,b){var c,p=this&&this.__extends||(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,S){v.__proto__=S}||function(v,S){for(var g in S)S.hasOwnProperty(g)&&(v[g]=S[g])},function(v,S){function g(){this.constructor=v}c(v,S),v.prototype=null===S?Object.create(S):(g.prototype=S.prototype,new g)}),E=this&&this.__awaiter||function(c,v,S,g){return new(S||(S=Promise))(function(C,R){function D(P){try{N(g.next(P))}catch(y){R(y)}}function _(P){try{N(g.throw(P))}catch(y){R(y)}}function N(P){P.done?C(P.value):new S(function(y){y(P.value)}).then(D,_)}N((g=g.apply(c,v||[])).next())})},d=this&&this.__generator||function(c,v){function S(P){return function(y){return function(P){if(C)throw new TypeError("Generator is already executing.");for(;N;)try{if(C=1,R&&(D=2&P[0]?R.return:P[0]?R.throw||((D=R.return)&&D.call(R),0):R.next)&&!(D=D.call(R,P[1])).done)return D;switch(R=0,D&&(P=[2&P[0],D.value]),P[0]){case 0:case 1:D=P;break;case 4:return N.label++,{value:P[1],done:!1};case 5:N.label++,R=P[1],P=[0];continue;case 7:P=N.ops.pop(),N.trys.pop();continue;default:if(!(D=(D=N.trys).length>0&&D[D.length-1])&&(6===P[0]||2===P[0])){N=0;continue}if(3===P[0]&&(!D||P[1]>D[0]&&P[1]<D[3])){N.label=P[1];break}if(6===P[0]&&N.label<D[1]){N.label=D[1],D=P;break}if(D&&N.label<D[2]){N.label=D[2],N.ops.push(P);break}D[2]&&N.ops.pop(),N.trys.pop();continue}P=v.call(c,N)}catch(y){P=[6,y],R=0}finally{C=D=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}([P,y])}}var C,R,D,_,N={label:0,sent:function(){if(1&D[0])throw D[1];return D[1]},trys:[],ops:[]};return _={next:S(0),throw:S(1),return:S(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_};Object.defineProperty(s,"__esModule",{value:!0});var T=b(0),A=function(c){function v(S){var g=c.call(this,S)||this;return g.name="CancelationError",g}return p(v,c),v}(Error),I=function(){function c(v,S,g){this.logger=v,this.maxBackoffInMs=S,this.initialDelay=g,this.backoffCount=0,this.id=++c.idCounter}return c.prototype.delay=function(v){var S=this;if(void 0!==this.timerHandle)throw new Error("Retry sequence logical failure");if(-1===this.backoffCount)return new Promise(function(C,R){R(new A("Cancelled"))});var g=this.calculateNextBackoffMs();return this.backoffCount++,this.logger.info("[RegistrarClient] Backing off "+v+" for "+g+" milliseconds with ID "+this.id),new Promise(function(C,R){S.cancelFunc=R,S.timerHandle=setTimeout(function(){S.logger.info("[RegistrarClient] Back off for "+v+" with ID "+S.id+" complete"),S.timerHandle=void 0,C()},g)})},c.prototype.cancel=function(){void 0!==this.timerHandle&&(this.logger.debug("Resetting back off"),clearTimeout(this.timerHandle),void 0!==this.cancelFunc&&this.cancelFunc(new A("Cancelled"))),this.backoffCount=-1},c.prototype.calculateNextBackoffMs=function(){var v=1+.4*(Math.random()-.5),S=this.initialDelay*Math.pow(2,this.backoffCount)*v;return S=Math.round(S),Math.min(this.maxBackoffInMs,S)},c.idCounter=0,c}(),f=function(){function c(v,S,g){this.logger=v,this.skypeTokenProvider=S,this.options=g,this.backoffs={}}return c.prototype.setTelemetryLogger=function(v){this.eventLogger=v},c.prototype.register=function(v,S){return E(this,void 0,void 0,function(){return d(this,function(g){switch(g.label){case 0:return[4,this.performRegistration(v,S,"pr_set_registration")];case 1:return g.sent(),this.cachedRegistrationParams=[v,S],[2]}})})},c.prototype.unregister=function(){return E(this,void 0,void 0,function(){var v;return d(this,function(S){switch(S.label){case 0:return this.logger.info("[RegistrarClient] sending unregister request"),v=new Request(this.options.registrarUrl+"/"+this.options.registrationId,{method:"DELETE",mode:"cors",headers:new Headers({accept:"application/json, text/javascript"})}),[4,this.callRegistrar(v,"pr_delete_registration")];case 1:return S.sent(),[2]}})})},c.prototype.cancelPendingRequests=function(){var v=this;Object.keys(this.backoffs).forEach(function(S){v.backoffs[S].cancel()}),this.backoffs={}},c.prototype.resendRegistration=function(){return E(this,void 0,void 0,function(){return d(this,function(v){switch(v.label){case 0:if(!this.cachedRegistrationParams)throw new Error("Re-registration failed because there is no registration parameters cached");return[4,this.performRegistration(this.cachedRegistrationParams[0],this.cachedRegistrationParams[1],"pr_resend_registration")];case 1:return v.sent(),[2]}})})},c.prototype.performRegistration=function(v,S,g){return E(this,void 0,void 0,function(){var C,R;return d(this,function(D){switch(D.label){case 0:return this.logger.info("[RegistrarClient] Sending register request"),C={clientDescription:v,registrationId:this.options.registrationId,nodeId:"",transports:S},R=new Request(this.options.registrarUrl,{method:"POST",mode:"cors",headers:new Headers({"content-type":"application/json",accept:"application/json, text/javascript"}),body:T.toJson(C)}),[4,this.callRegistrar(R,g)];case 1:return D.sent(),[2]}})})},c.prototype.startBackoff=function(){var v=new I(this.logger,this.options.maxRetryDelayMs,this.options.initialRetryDelayMs);return this.backoffs[v.id]=v,v},c.prototype.stopBackoff=function(v){v.cancel(),delete this.backoffs[v.id]},c.prototype.getSkypeToken=function(){return E(this,void 0,void 0,function(){var v,S,C;return d(this,function(R){switch(R.label){case 0:v=this.startBackoff(),R.label=1;case 1:return R.trys.push([1,3,,8]),this.logger.info("[RegistrarClient] Asking for a new skypetoken"),[4,this.skypeTokenProvider(!0)];case 2:return S=R.sent(),this.stopBackoff(v),[2,S];case 3:R.sent(),R.label=4;case 4:return R.trys.push([4,6,,7]),[4,v.delay("Fetching a new skypetoken")];case 5:return R.sent(),[3,8];case 6:throw C=R.sent(),this.stopBackoff(v),C;case 7:return[3,8];case 8:return[3,1];case 9:return[2]}})})},c.prototype.callRegistrar=function(v,S){return E(this,void 0,void 0,function(){var g,C,R,D,_,N,P,y,M,U,$,j,Z;return d(this,function(Y){switch(Y.label){case 0:return g=this.startBackoff(),[4,this.skypeTokenProvider(!1)];case 1:C=Y.sent(),this.setSkypeTokenHeader(v,C),R=new T.Timespan,Y.label=2;case 2:D=void 0,Y.label=3;case 3:return Y.trys.push([3,8,13,14]),_=v.clone(),[4,this.fetchWithTimeout(_)];case 4:return 401!==(D=Y.sent()).status?[3,6]:(N=this.setSkypeTokenHeader,P=[v],[4,this.getSkypeToken()]);case 5:return N.apply(this,P.concat([Y.sent()])),[3,20];case 6:if(D.status>=500&&D.status<600)throw new Error("Fetch for '"+v.url+"' failed with "+D.status+" "+D.statusText);Y.label=7;case 7:return[3,14];case 8:y=Y.sent(),this.logger.error("[RegistrarClient] Request failed with "+y),Y.label=9;case 9:return Y.trys.push([9,11,,12]),[4,g.delay("Registrar call retry")];case 10:return Y.sent(),[3,20];case 11:throw M=Y.sent(),this.logger.error("[RegistrarClient] Request cancelled"),this.stopBackoff(g),M;case 12:return[3,14];case 13:return this.sendTelemetryEvent(S,v,D,R),[7];case 14:return this.stopBackoff(g),D.ok?[2,D]:[3,15];case 15:U=void 0,Y.label=16;case 16:return Y.trys.push([16,18,,19]),j=($=JSON).stringify,[4,D.json()];case 17:return U=j.apply($,[Y.sent()]),[3,19];case 18:return Y.sent(),U="no details",[3,19];case 19:throw Z="Fetch for '"+v.url+"' failed with "+D.status+" "+D.statusText+" ("+U+", MS-CV: "+D.headers.get("MS-CV")+")",this.logger.error("[RegistrarClient] "+Z),new Error(Z);case 20:return[3,2];case 21:return[2]}})})},c.prototype.setSkypeTokenHeader=function(v,S){v.headers.set("X-Skypetoken",S)},c.prototype.fetchWithTimeout=function(v){var S=this;return new Promise(function(g,C){fetch(v).then(g).catch(C),0!==S.options.requestTimeoutMs&&setTimeout(C,S.options.requestTimeoutMs,new Error("Fetch for '"+v.url+"' timed out"))})},c.prototype.sendTelemetryEvent=function(v,S,g,C){void 0!==this.eventLogger&&this.eventLogger.logEvent({name:v,properties:{url:{value:S.url},result_code:{value:void 0!==g?g.status:0},begin_timestamp:{value:C.startTime},elapsed:{value:C.duration}}})},c}();s.RegistrarClient=f,s.createRegistrarClient=function(c,v,S){return new f(c,v,S)}}])});unwrapExports(tsregistrar);var tstrouter=createCommonjsModule(function(module,exports){var m;m=function(__WEBPACK_EXTERNAL_MODULE_20__){return function(Q){function m(s){if(u[s])return u[s].exports;var b=u[s]={i:s,l:!1,exports:{}};return Q[s].call(b.exports,b,b.exports,m),b.l=!0,b.exports}var u={};return m.m=Q,m.c=u,m.i=function(s){return s},m.d=function(s,b,h){m.o(s,b)||Object.defineProperty(s,b,{configurable:!1,enumerable:!0,get:h})},m.n=function(s){var b=s&&s.__esModule?function(){return s.default}:function(){return s};return m.d(b,"a",b),b},m.o=function(s,b){return Object.prototype.hasOwnProperty.call(s,b)},m.p="",m(m.s=19)}([function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var s=function(){function b(h,p){this.name=h,this.logger=p}return b.prototype.debug=function(h){this.logger.debug("["+this.name+"] "+h)},b.prototype.info=function(h){this.logger.info("["+this.name+"] "+h)},b.prototype.warn=function(h){this.logger.warn("["+this.name+"] "+h)},b.prototype.error=function(h){this.logger.error("["+this.name+"] "+h)},b}();m.Logger=s},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0}),m.constants={TROUTER_INIT:"trouterinit",TROUTER_READY_EVENT:"trouterReadyEvent",TROUTER_READY_TIMEOUT:"trouterReadyTimeout",TROUTER_TOKEN_REQUEST:"trouterTokenRequest",TROUTER_TOKEN_GET_SUCCEEDED:"trouterTokenGetSucceeded",TROUTER_TOKEN_GET_FAILED:"trouterTokenGetFailed",TROUTER_RECONNECTING:"trouterReconnecting",RENEWAL:"renewal",NEW_CONNECTION:"newConnection",ENDPOINT_REGISTRATION_FAILED:"endpointRegistrationFailed"},m.CLIENT_VERSION="2021.32.00.1",m.HANDLED_MESSAGE_ACK=200,m.UNHANDLED_MESSAGE_ACK=404,m.FAILED_MESSAGE_ACK=500},function(Q,m,u){var b;Object.defineProperty(m,"__esModule",{value:!0}),(b=m.UserActivityState||(m.UserActivityState={}))[b.Unknown=0]="Unknown",b[b.Active=1]="Active",b[b.Inactive=2]="Inactive",m.HttpHeaders=function(){},function(b){b[b.Unknown=0]="Unknown",b[b.Connected=2]="Connected",b[b.Disconnected=3]="Disconnected",b[b.Switching=9]="Switching"}(m.TrouterState||(m.TrouterState={}))},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0}),m.toJson=function(d){try{return JSON.stringify(d)}catch(T){return"Unable to serialize object of type "+typeof d}},m.calculateTtlInSec=function(d){var T=Math.round((new Date).getTime()/1e3);return void 0!==d&&d>T?d-T:0},m.calculateExpireTsInSec=function(d){return Math.round((new Date).getTime()/1e3)+d};var p=function(){function d(T){this.base=void 0!==T?T:this.createCorrelationVectorBase(),this.extension=0}return d.extend=function(T){return new d(T)},d.prototype.increase=function(){this.extension++},d.prototype.value=function(){return this.base+"."+this.extension},d.prototype.createCorrelationVectorBase=function(){for(var T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0987654321/+",A="AQgw",I="",f=0;f<21;f++)I+=T.charAt(Math.floor(Math.random()*T.length));return I+A.charAt(Math.floor(Math.random()*A.length))},d}();m.CorrelationVector=p;var E=function(){function d(){this.start=Date.now()}return Object.defineProperty(d.prototype,"duration",{get:function(){return Date.now()-this.start},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"startTime",{get:function(){return this.start},enumerable:!0,configurable:!0}),d.prototype.reset=function(){this.start=Date.now()},d}();m.Timespan=E},function(Q,m){var u;u=function(){return this}();try{u=u||Function("return this")()||(0,eval)("this")}catch(s){"object"==typeof window&&(u=window)}Q.exports=u},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var h,s=u(3),b=function(){function h(p,E,d,T,A,I,f){this.connectionId=p,this.connectedClientId=E,this.domId=d,this.unsecureUrl=T,this.url=A,this.c2cUrlBase=I,this.expirationTsSec=f}return h.prototype.getRemainingTtlInSec=function(){return s.calculateTtlInSec(this.expirationTsSec)},h}();m.ServerState=b,(h=m.UserActivityEventReason||(m.UserActivityEventReason={}))[h.Unknown=0]="Unknown",h[h.Modified=1]="Modified",h[h.Snapshot=2]="Snapshot",h[h.Connected=3]="Connected"},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var s=u(1),b=function(){function h(p){this.logger=p,this.messageHandlers=[]}return h.prototype.register=function(p){if(this.messageHandlers.some(function(E){return E===p}))throw new Error("Registering the same handler twice is not allowed");this.messageHandlers.push(p)},h.prototype.clear=function(){this.logger.debug("Clearing message handlers"),this.messageHandlers=[]},h.prototype.active=function(){return this.messageHandlers.length>0},h.prototype.handleMessage=function(p){for(var E={resultCode:s.UNHANDLED_MESSAGE_ACK,isHandled:!1},d=0,T=this.messageHandlers;d<T.length;d++){var I=this.safeExecuteHandle(T[d],p);if(void 0!==I&&(void 0===I.isHandled||I.isHandled))return void 0===I.resultCode&&(I.resultCode=s.HANDLED_MESSAGE_ACK),I}return E},h.prototype.safeExecuteHandle=function(p,E){try{return p.handleMessage(E)}catch(d){return void this.logger.warn("A trouter message handler is throwing exceptions. exception: "+d)}},h}();m.MessageHandlerRegistry=b},function(Q,m,u){var b=this&&this.__awaiter||function(p,E,d,T){return new(d||(d=Promise))(function(A,I){function f(S){try{v(T.next(S))}catch(g){I(g)}}function c(S){try{v(T.throw(S))}catch(g){I(g)}}function v(S){S.done?A(S.value):new d(function(g){g(S.value)}).then(f,c)}v((T=T.apply(p,E||[])).next())})},h=this&&this.__generator||function(p,E){function d(S){return function(g){return function(S){if(A)throw new TypeError("Generator is already executing.");for(;v;)try{if(A=1,I&&(f=2&S[0]?I.return:S[0]?I.throw||((f=I.return)&&f.call(I),0):I.next)&&!(f=f.call(I,S[1])).done)return f;switch(I=0,f&&(S=[2&S[0],f.value]),S[0]){case 0:case 1:f=S;break;case 4:return v.label++,{value:S[1],done:!1};case 5:v.label++,I=S[1],S=[0];continue;case 7:S=v.ops.pop(),v.trys.pop();continue;default:if(!(f=(f=v.trys).length>0&&f[f.length-1])&&(6===S[0]||2===S[0])){v=0;continue}if(3===S[0]&&(!f||S[1]>f[0]&&S[1]<f[3])){v.label=S[1];break}if(6===S[0]&&v.label<f[1]){v.label=f[1],f=S;break}if(f&&v.label<f[2]){v.label=f[2],v.ops.push(S);break}f[2]&&v.ops.pop(),v.trys.pop();continue}S=E.call(p,v)}catch(g){S=[6,g],I=0}finally{A=f=0}if(5&S[0])throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}([S,g])}}var A,I,f,c,v={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return c={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(m,"__esModule",{value:!0}),m.addCacheAsBackupTo=function(p){var E,d=this;return function(T){return b(d,void 0,void 0,function(){return h(this,function(A){return T&&(E=void 0),[2,new Promise(function(I,f){p(T).then(function(c){E=c,I(c)}).catch(function(c){void 0!==E&&E.length>0&&I(E),f(c)})})]})})}}},function(Q,m,u){var s=this&&this.__awaiter||function(f,c,v,S){return new(v||(v=Promise))(function(g,C){function R(N){try{_(S.next(N))}catch(P){C(P)}}function D(N){try{_(S.throw(N))}catch(P){C(P)}}function _(N){N.done?g(N.value):new v(function(P){P(N.value)}).then(R,D)}_((S=S.apply(f,c||[])).next())})},b=this&&this.__generator||function(f,c){function v(N){return function(P){return function(N){if(g)throw new TypeError("Generator is already executing.");for(;_;)try{if(g=1,C&&(R=2&N[0]?C.return:N[0]?C.throw||((R=C.return)&&R.call(C),0):C.next)&&!(R=R.call(C,N[1])).done)return R;switch(C=0,R&&(N=[2&N[0],R.value]),N[0]){case 0:case 1:R=N;break;case 4:return _.label++,{value:N[1],done:!1};case 5:_.label++,C=N[1],N=[0];continue;case 7:N=_.ops.pop(),_.trys.pop();continue;default:if(!(R=(R=_.trys).length>0&&R[R.length-1])&&(6===N[0]||2===N[0])){_=0;continue}if(3===N[0]&&(!R||N[1]>R[0]&&N[1]<R[3])){_.label=N[1];break}if(6===N[0]&&_.label<R[1]){_.label=R[1],R=N;break}if(R&&_.label<R[2]){_.label=R[2],_.ops.push(N);break}R[2]&&_.ops.pop(),_.trys.pop();continue}N=c.call(f,_)}catch(P){N=[6,P],C=0}finally{g=R=0}if(5&N[0])throw N[1];return{value:N[0]?N[1]:void 0,done:!0}}([N,P])}}var g,C,R,D,_={label:0,sent:function(){if(1&R[0])throw R[1];return R[1]},trys:[],ops:[]};return D={next:v(0),throw:v(1),return:v(2)},"function"==typeof Symbol&&(D[Symbol.iterator]=function(){return this}),D};Object.defineProperty(m,"__esModule",{value:!0});var h=u(3),p=u(2),E=u(0),d=u(16),T=u(18),A=function(){function f(c,v){this.state=c,this.correlationVector=void 0!==v?v:h.CorrelationVector.extend()}return f.prototype.getStateString=function(){switch(this.state){case p.UserActivityState.Active:return"active";case p.UserActivityState.Inactive:return"inactive";case p.UserActivityState.Unknown:return"unknown";default:return"undefined"}},f.prototype.toEventObject=function(){return{state:this.getStateString(),cv:this.correlationVector.value()}},f.prototype.toEventJSON=function(){return h.toJson(this.toEventObject())},f}();m.UserActivityObject=A;var I=function(){function f(c,v,S,g){this.logFunc=c,this.options=v,this.tokenProvider=S,this.listener=g,this.logger=new E.Logger("Manager",c),this.logger.info("Created TrouterManager with options "+h.toJson(this.options)),this.fsm=new T.TrouterManagerFsm(c,this),this.baseEndpointUrl="",this.processedMessageLoss={},this.userActivityObject=new A(p.UserActivityState.Unknown)}return f.prototype.start=function(){this.fsm.start()},f.prototype.stop=function(c){this.fsm.stop(c)},f.prototype.configure=function(c){this.options=c,void 0!==this.firstConnection&&this.firstConnection.configure(c),void 0!==this.secondConnection&&this.secondConnection.configure(c),this.logger.info("Reconfigured TrouterManager with options "+h.toJson(this.options))},f.prototype.checkConnection=function(c){void 0!==this.firstConnection&&this.firstConnection.checkConnection(c),void 0!==this.secondConnection&&this.secondConnection.checkConnection(c)},f.prototype.resendRegistration=function(){return s(this,void 0,void 0,function(){return b(this,function(c){return void 0!==this.secondConnection?(this.logger.info("Resending registration on the second/new connection"),[2,this.secondConnection.resendRegistration()]):void 0!==this.firstConnection?(this.logger.info("Resending registration on the first/current connection"),[2,this.firstConnection.resendRegistration()]):(this.logger.info("No connection to resend registration on, will be done upon (re)connect"),[2])})})},f.prototype.getServerState=function(){if(void 0!==this.firstConnection)return this.firstConnection.getServerState()},f.prototype.getState=function(){return this.fsm.getState()},f.prototype.startFirstConnection=function(){var c=new d.TrouterConnection(this.logFunc,this.options,this,this.tokenProvider,this.userActivityObject);this.firstConnection=c,this.getConnectionCache().then(function(v){c.start(v)}).catch()},f.prototype.startSecondConnection=function(){this.secondConnection=new d.TrouterConnection(this.logFunc,this.options,this,this.tokenProvider,this.userActivityObject),this.secondConnection.start()},f.prototype.stopFirstConnection=function(c){void 0!==this.firstConnection&&(this.firstConnection.stop(c),this.storedFirstConnection=this.firstConnection,this.firstConnection=void 0)},f.prototype.stopSecondConnection=function(c){void 0!==this.secondConnection&&(this.secondConnection.stop(c),this.secondConnection=void 0)},f.prototype.stopSecondConnectionDelayed=function(){if(void 0!==this.secondConnection){var c=this.secondConnection;this.secondConnection=void 0,this.logger.info("Closing an inactive connection in "+Math.round(this.options.lingeringConnectionDelayMs/1e3)+"s"),setTimeout(function(){c.stop(!0)},this.options.lingeringConnectionDelayMs)}},f.prototype.forceStopLingeringConnection=function(){this.storedFirstConnection&&(this.storedFirstConnection.stop(!1),this.storedFirstConnection=void 0)},f.prototype.switchConnections=function(){var c=this.firstConnection;this.firstConnection=this.secondConnection,this.secondConnection=c},f.prototype.doesSecondConnectionExist=function(){return void 0!==this.secondConnection},f.prototype.dispatchConnected=function(){if(void 0!==this.firstConnection){var c=this.firstConnection.getServerState(),v="/"===c.url.slice(-1)?c.url.slice(0,-1):c.url,S={baseEndpointUrl:v,newEndpointUrl:v!==this.baseEndpointUrl,c2cUrlBase:c.c2cUrlBase,clientId:c.connectedClientId,connectionId:c.connectionId,connectionTtlSec:c.getRemainingTtlInSec()};this.baseEndpointUrl=v,this.listener.onTrouterConnected(c.url,S)}},f.prototype.dispatchReconnecting=function(){this.listener.onTrouterDisconnected&&this.listener.onTrouterDisconnected()},f.prototype.dispatchStopped=function(){this.listener.onTrouterDisconnected&&this.listener.onTrouterDisconnected()},f.prototype.dispatchRegistrationState=function(c){this.options.registrationStateCallback&&this.options.registrationStateCallback(c)},f.prototype.onDownstreamRequest=function(c,v,S){var C={id:v.id,status:0,headers:{},body:"",send:function(){return C.status<=100||C.status>=999?3:(S.writeHead(C.status,C.headers),S.end(C.body))}};this.listener.onTrouterRequest({id:v.id,method:v.method,path:"/"+v.shortUrl,body:v.body,headers:v.headers},C)},f.prototype.onConnected=function(c){this.fsm.onConnected(c===this.firstConnection)},f.prototype.onRegistered=function(c){this.fsm.onRegistered(c===this.firstConnection)},f.prototype.onUnregistered=function(c){this.fsm.onUnregistered(c===this.firstConnection||c===this.storedFirstConnection)},f.prototype.onReconnecting=function(c){this.fsm.onReconnecting(c===this.firstConnection)},f.prototype.onReconnectIsRequired=function(c){this.fsm.onReconnectionRequired(c===this.firstConnection)},f.prototype.onDisconnected=function(c){this.fsm.onDisconnected(c===this.storedFirstConnection),this.storedFirstConnection=void 0},f.prototype.onUserActivityStateAccepted=function(c){this.listener.onTrouterUserActivityStateAccepted&&this.listener.onTrouterUserActivityStateAccepted(c)},f.prototype.onConnectionParametersUpdated=function(c){this.setConnectionCache(c)},f.prototype.setUserActivityState=function(c,v){return this.userActivityObject=new A(c,h.CorrelationVector.extend(v)),void 0!==this.secondConnection?(this.logger.info("Setting user activity "+this.userActivityObject.toEventJSON()+" on the second/new connection"),void this.secondConnection.setUserActivityState(this.userActivityObject)):void 0!==this.firstConnection?(this.logger.info("Setting user activity "+this.userActivityObject.toEventJSON()+" on the first/current connection"),void this.firstConnection.setUserActivityState(this.userActivityObject)):void 0},f.prototype.onTrouterMessageLost=function(c){var v=this;if(this.listener.onTrouterMessageLoss)if(c&&c.length){var S=c.filter(function(C){return void 0!==v.processedMessageLoss[C.tag+"-"+C.etag]});if(S.length&&(this.logger.warn("onTrouterMessageLoss - removing duplicates and sending event to server"),this.sendProcessedDroppedIndicators(S),!(c=c.filter(function(C){return void 0===v.processedMessageLoss[C.tag+"-"+C.etag]})).length))return void this.logger.warn("onTrouterMessageLoss - All the data are duplicated");if(!this.listener.onTrouterMessageLoss(c.map(function(C){return C.tag})))return void this.logger.warn("onTrouterMessageLoss - flow tags have not been processed by listeners");c.forEach(function(C){v.processedMessageLoss[C.tag+"-"+C.etag]=""}),this.sendProcessedDroppedIndicators(c)}else this.logger.warn("onTrouterMessageLoss - no flow tags have been provided")},f.prototype.getConnectionCache=function(){var c=this;return this.options.connectionCache?(this.logger.debug("Querying host's connection cache"),this.options.connectionCache.onGetTrouterConnectionCache().then(function(v){return v?JSON.parse(v):void 0}).catch(function(v){return c.logger.warn("Invalid connection cache content provided: "+v),c.connectionCache})):Promise.resolve(this.connectionCache)},f.prototype.setConnectionCache=function(c){if(this.connectionCache=c,this.options.connectionCache)try{this.options.connectionCache.onSetTrouterConnectionCache(JSON.stringify(c))}catch(v){this.logger.warn("Error setting external connection cache: "+v)}},f.prototype.sendProcessedDroppedIndicators=function(c){return void 0!==this.firstConnection?void this.firstConnection.sendProcessedDroppedIndicators(c):void 0!==this.secondConnection?void this.secondConnection.sendProcessedDroppedIndicators(c):void 0},f}();m.TrouterManager=I},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var s=function(){function b(h){this.logger=h}return b.prototype.getPromise=function(){var h=this;return void 0!==this.url?(this.logger.debug("[TrouterUrlPromise] returning previously resolved url: "+this.url),Promise.resolve(this.url)):(void 0===this.pendingPromise?(this.logger.debug("[TrouterUrlPromise] creating and returning promise"),this.pendingPromise=new Promise(function(p,E){h.pendingPromiseResolveRef=p,h.pendingPromiseRejectRef=E})):this.logger.debug("[TrouterUrlPromise] returning existing promise"),this.pendingPromise)},b.prototype.resolveUrl=function(h){this.url=h,this.logger.debug("[TrouterUrlPromise] got url: "+this.url);var p=this.pendingPromiseResolveRef;this.pendingPromise=void 0,this.pendingPromiseResolveRef=void 0,this.pendingPromiseRejectRef=void 0,void 0!==p&&(this.logger.debug("[TrouterUrlPromise] resolving promise"),p(h))},b.prototype.rejectUrl=function(h){this.logger.debug("[TrouterUrlPromise] aborting");var p=this.pendingPromiseRejectRef;this.url=void 0,this.pendingPromise=void 0,this.pendingPromiseResolveRef=void 0,this.pendingPromiseRejectRef=void 0,void 0!==p&&(this.logger.debug("[TrouterUrlPromise] rejecting promise"),p(h))},b.prototype.resetUrl=function(){this.logger.debug("[TrouterUrlPromise] resetting url"),this.url=void 0},b}();m.TrouterUrlPromise=s},function(module,exports,__nested_webpack_require_43418__){(function(global,module){var Q,m,u;Q=module.exports,m=void 0===global?window:global,u=Q,u.version="0.9.6",u.protocol=1,u.transports=[],u.j=[],u.sockets={},u.connect=function(s,b){var h,p,E=u.util.parseUri(s);m&&m.location&&(E.protocol=E.protocol||m.location.protocol.slice(0,-1),E.host=E.host||(m.document?m.document.domain:m.location.hostname),E.port=E.port||m.location.port),h=u.util.uniqueUri(E);var d={host:E.host,secure:"https"==E.protocol,port:E.port||("https"==E.protocol?443:80),query:E.query||""};return u.util.merge(d,b),!d["force new connection"]&&u.sockets[h]||(p=new u.Socket(d)),!d["force new connection"]&&p&&(u.sockets[h]=p),(p=p||u.sockets[h]).of(E.path.length>1?E.path:"")};var io=module.exports;(function(Q,m){var u=Q.util={},s=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,b=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];u.parseUri=function(p){for(var E=s.exec(p||""),d={},T=14;T--;)d[b[T]]=E[T]||"";return d},u.uniqueUri=function(p){var E=p.protocol,d=p.host,T=p.port;return"document"in m?(d=d||document.domain,T=T||("https"==E&&"https:"!==document.location.protocol?443:document.location.port)):(d=d||"localhost",T||"https"!=E||(T=443)),(E||"http")+"://"+d+":"+(T||80)},u.query=function(p,E){var d=u.chunkQuery(p||""),T=[];for(var A in u.merge(d,u.chunkQuery(E||"")),d)d.hasOwnProperty(A)&&T.push(A+"="+d[A]);return T.length?"?"+T.join("&"):""},u.chunkQuery=function(p){for(var E,d={},T=p.split("&"),A=0,I=T.length;A<I;++A)(E=T[A].split("="))[0]&&(d[E[0]]=E[1]);return d};var h=!1;u.load=function(p){if("document"in m&&"complete"===document.readyState||h)return p();u.on(m,"load",p,!1)},u.on=function(p,E,d,T){p.attachEvent?p.attachEvent("on"+E,d):p.addEventListener&&p.addEventListener(E,d,T)},u.request=function(p){if(p&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!p||u.ua.hasCORS))return new XMLHttpRequest;if(!p)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(E){}return null},"undefined"!=typeof window&&u.load(function(){h=!0}),u.defer=function(p){if(!u.ua.webkit||"undefined"!=typeof importScripts)return p();u.load(function(){setTimeout(p,100)})},u.merge=function(p,E,d,T){var A,I=T||[],f=void 0===d?2:d;for(A in E)E.hasOwnProperty(A)&&u.indexOf(I,A)<0&&("object"==typeof p[A]&&f?u.merge(p[A],E[A],f-1,I):(p[A]=E[A],I.push(E[A])));return p},u.mixin=function(p,E){u.merge(p.prototype,E.prototype)},u.inherit=function(p,E){function d(){}d.prototype=E.prototype,p.prototype=new d},u.isArray=Array.isArray||function(p){return"[object Array]"===Object.prototype.toString.call(p)},u.intersect=function(p,E){for(var d=[],T=p.length>E.length?p:E,A=p.length>E.length?E:p,I=0,f=A.length;I<f;I++)~u.indexOf(T,A[I])&&d.push(A[I]);return d},u.indexOf=function(p,E,d){var T=p.length;for(d=d<0?d+T<0?0:d+T:d||0;d<T&&p[d]!==E;d++);return T<=d?-1:d},u.toArray=function(p){for(var E=[],d=0,T=p.length;d<T;d++)E.push(p[d]);return E},u.ua={},u.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var p=new XMLHttpRequest}catch(E){return!1}return null!=p.withCredentials}(),u.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)})(void 0!==io?io:module.exports,void 0===global?window:global),function(Q,m){function u(){}Q.EventEmitter=u,u.prototype.addListener=u.prototype.on=function(s,b){return this.$events||(this.$events={}),this.$events[s]?m.util.isArray(this.$events[s])?this.$events[s].push(b):this.$events[s]=[this.$events[s],b]:this.$events[s]=b,this},u.prototype.once=function(s,b){function h(){p.removeListener(s,h),b.apply(this,arguments)}var p=this;return h.listener=b,this.on(s,h),this},u.prototype.removeListener=function(s,b){if(this.$events&&this.$events[s]){var h=this.$events[s];if(m.util.isArray(h)){for(var p=-1,E=0,d=h.length;E<d;E++)if(h[E]===b||h[E].listener&&h[E].listener===b){p=E;break}if(p<0)return this;h.splice(p,1),h.length||delete this.$events[s]}else(h===b||h.listener&&h.listener===b)&&delete this.$events[s]}return this},u.prototype.removeAllListeners=function(s){return this.$events&&this.$events[s]&&(this.$events[s]=null),this},u.prototype.listeners=function(s){return this.$events||(this.$events={}),this.$events[s]||(this.$events[s]=[]),m.util.isArray(this.$events[s])||(this.$events[s]=[this.$events[s]]),this.$events[s]},u.prototype.emit=function(s){if(!this.$events)return!1;var b=this.$events[s];if(!b)return!1;var h=Array.prototype.slice.call(arguments,1);if("function"==typeof b)b.apply(this,h);else{if(!m.util.isArray(b))return!1;for(var p=b.slice(),E=0,d=p.length;E<d;E++)p[E].apply(this,h)}return!0}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(exports,nativeJSON){function f(Q){return Q<10?"0"+Q:Q}function date(Q,m){return isFinite(Q.valueOf())?Q.getUTCFullYear()+"-"+f(Q.getUTCMonth()+1)+"-"+f(Q.getUTCDate())+"T"+f(Q.getUTCHours())+":"+f(Q.getUTCMinutes())+":"+f(Q.getUTCSeconds())+"Z":null}function quote(Q){return escapable.lastIndex=0,escapable.test(Q)?'"'+Q.replace(escapable,function(m){var u=meta[m];return"string"==typeof u?u:"\\u"+("0000"+m.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+Q+'"'}function str(Q,m){var u,s,b,h,p,E=gap,d=m[Q];switch(d instanceof Date&&(d=date(Q)),"function"==typeof rep&&(d=rep.call(m,Q,d)),typeof d){case"string":return quote(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(gap+=indent,p=[],"[object Array]"===Object.prototype.toString.apply(d)){for(h=d.length,u=0;u<h;u+=1)p[u]=str(u,d)||"null";return b=0===p.length?"[]":gap?"[\n"+gap+p.join(",\n"+gap)+"\n"+E+"]":"["+p.join(",")+"]",gap=E,b}if(rep&&"object"==typeof rep)for(h=rep.length,u=0;u<h;u+=1)"string"==typeof rep[u]&&(b=str(s=rep[u],d))&&p.push(quote(s)+(gap?": ":":")+b);else for(s in d)Object.prototype.hasOwnProperty.call(d,s)&&(b=str(s,d))&&p.push(quote(s)+(gap?": ":":")+b);return b=0===p.length?"{}":gap?"{\n"+gap+p.join(",\n"+gap)+"\n"+E+"}":"{"+p.join(",")+"}",gap=E,b}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(Q,m,u){var s;if(gap="",indent="","number"==typeof u)for(s=0;s<u;s+=1)indent+=" ";else"string"==typeof u&&(indent=u);if(rep=m,m&&"function"!=typeof m&&("object"!=typeof m||"number"!=typeof m.length))throw new Error("JSON.stringify");return str("",{"":Q})},JSON.parse=function(text,reviver){function walk(Q,m){var u,s,b=Q[m];if(b&&"object"==typeof b)for(u in b)Object.prototype.hasOwnProperty.call(b,u)&&(void 0!==(s=walk(b,u))?b[u]=s:delete b[u]);return reviver.call(Q,m,b)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(Q){return"\\u"+("0000"+Q.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}(void 0!==io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(Q,m){var u=Q.parser={},s=u.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],b=u.reasons=["transport not supported","client not handshaken","unauthorized"],h=u.advice=["reconnect"],p=m.JSON,E=m.util.indexOf;u.encodePacket=function(T){var A=E(s,T.type),I=T.id||"",f=T.endpoint||"",c=T.ack,v=null;switch(T.type){case"error":var S=T.reason?E(b,T.reason):"",g=T.advice?E(h,T.advice):"";""===S&&""===g||(v=S+(""!==g?"+"+g:""));break;case"message":""!==T.data&&(v=T.data);break;case"event":var C={name:T.name};T.args&&T.args.length&&(C.args=T.args),v=p.stringify(C);break;case"json":v=p.stringify(T.data);break;case"connect":T.qs&&(v=T.qs);break;case"ack":v=T.ackId+(T.args&&T.args.length?"+"+p.stringify(T.args):"")}var R=[A,I+("data"==c?"+":""),f];return null!=v&&R.push(v),R.join(":")},u.encodePayload=function(T){var A="";if(1==T.length)return T[0];for(var I=0,f=T.length;I<f;I++)A+="\ufffd"+T[I].length+"\ufffd"+T[I];return A};var d=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;u.decodePacket=function(T){if(!(A=T.match(d)))return{};var I=A[2]||"",f=(T=A[5]||"",{type:s[A[1]],endpoint:A[4]||""});switch(I&&(f.id=I,f.ack=!A[3]||"data"),f.type){case"error":var A=T.split("+");f.reason=b[A[0]]||"",f.advice=h[A[1]]||"";break;case"message":f.data=T||"";break;case"event":try{var c=p.parse(T);f.name=c.name,f.args=c.args}catch(S){}f.args=f.args||[];break;case"json":try{f.data=p.parse(T)}catch(S){}break;case"connect":f.qs=T||"";break;case"ack":if((A=T.match(/^([0-9]+)(\+)?(.*)/))&&(f.ackId=A[1],f.args=[],A[3]))try{f.args=A[3]?p.parse(A[3]):[]}catch(S){}break;case"disconnect":f.reason=T}return f},u.decodePayload=function(T){if("\ufffd"==T.charAt(0)){for(var A=[],I=1,f="";I<T.length;I++)"\ufffd"==T.charAt(I)?(A.push(u.decodePacket(T.substr(I+1).substr(0,f))),I+=Number(f)+1,f=""):f+=T.charAt(I);return A}return[u.decodePacket(T)]}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(Q,m){function u(s,b){this.socket=s,this.sessid=b,this.connectErrorCallback=void 0,this.isOpened=!1}Q.Transport=u,m.util.mixin(u,m.EventEmitter),u.prototype.onData=function(s){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==s){var b=m.parser.decodePayload(s);if(b&&b.length)for(var h=0,p=b.length;h<p;h++)this.onPacket(b[h])}return this},u.prototype.onPacket=function(s){return this.socket.setHeartbeatTimeout(),"heartbeat"==s.type?this.onHeartbeat():("connect"==s.type&&""==s.endpoint&&this.onConnect(),"error"==s.type&&"reconnect"==s.advice&&(this.isOpened=!1),this.socket.onPacket(s),this)},u.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var s=this;this.closeTimeout=setTimeout(function(){s.onDisconnect()},this.socket.closeTimeout)}},u.prototype.onDisconnect=function(){return this.close&&this.isOpened&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},u.prototype.onConnect=function(){return this.socket.onConnect(),this.connectErrorCallback=void 0,this},u.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},u.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},u.prototype.packet=function(s){this.send(m.parser.encodePacket(s))},u.prototype.onHeartbeat=function(s){this.packet({type:"heartbeat"})},u.prototype.onOpen=function(){this.isOpened=!0,this.clearCloseTimeout(),this.socket.onOpen()},u.prototype.onClose=function(){this.isOpened=!1,this.socket.onClose(),this.onDisconnect()},u.prototype.prepareUrl=function(){var s=this.socket.options;return this.scheme()+"://"+s.host+":"+s.port+"/"+s.resource+"/"+m.protocol+"/"+this.name+"/"+this.sessid},u.prototype.ready=function(s,b){b.call(this)},u.prototype.clearEventHandlers=function(){return this}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(Q,m,u){function s(h){if(this.options={port:80,secure:!1,document:"document"in u&&document,resource:"socket.io",transports:m.transports.slice(),"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},m.util.merge(this.options,h),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.disconnected=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||m.util.ua.hasCORS)){var p=this;m.util.on(u,"unload",function(){p.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function b(){}Q.Socket=s,m.util.mixin(s,m.EventEmitter),s.prototype.of=function(h){return this.namespaces[h]||(this.namespaces[h]=new m.SocketNamespace(this,h),""!==h&&this.namespaces[h].packet({type:"connect"})),this.namespaces[h]},s.prototype.publish=function(){var h;for(var p in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(p)&&(h=this.of(p)).$emit.apply(h,arguments)},s.prototype.handshake=function(h){function p(c){c instanceof Error?E.onError(c.message):h.apply(null,c.split(":"))}var E=this,d=this.options;if(!E.disconnected){var T=["http"+(d.secure?"s":"")+":/",d.host+":"+d.port,d.resource,m.protocol,m.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!m.util.ua.hasCORS){var A=document.getElementsByTagName("script")[0],I=document.createElement("script");I.src=T+"&jsonp="+m.j.length,A.parentNode.insertBefore(I,A),m.j.push(function(c){p(c),I.parentNode.removeChild(I)})}else{var f=m.util.request();f.open("GET",T,!0),f.withCredentials=!0,f.onreadystatechange=function(){4==f.readyState&&(f.onreadystatechange=b,200==f.status?p(f.responseText):!E.reconnecting&&E.onError(f.responseText))},f.send(null)}}},s.prototype.getTransport=function(h){for(var p,E=h||this.transports,d=0;p=E[d];d++)if(m.Transport[p]&&m.Transport[p].check(this)&&(!this.isXDomain()||m.Transport[p].xdomainCheck()))return new m.Transport[p](this,this.sessionid);return null},s.prototype.connect=function(h){if(this.connecting||this.disconnected)return this;var p=this;return this.handshake(function(E,d,T,A){function I(){if(!p.connected&&!p.disconnected)if(p.connecting=!1,clearTimeout(p.connectTimeoutTimer),p.options["try multiple transports"]){for(;p.remainingTransports.length>0&&p.remainingTransports.splice(0,1)[0]!=p.transport.name;);p.remainingTransports.length?f(p.remainingTransports):p.publish("connect_failed")}else p.publish("connect_failed")}function f(c){if(p.transport&&(p.transport.clearTimeouts(),p.transport.clearEventHandlers()),p.transport=p.getTransport(c),!p.transport||p.disconnected)return p.publish("connect_failed");p.transport.ready(p,function(){p.connecting=!0,p.publish("connecting",p.transport.name),p.transport.open(I),p.options["connect timeout"]&&(p.connectTimeoutTimer=setTimeout(function(){I()},p.options["connect timeout"]))})}p.sessionid=E,p.closeTimeout=1e3*T+2e3,p.heartbeatTimeout=1e3*d+2e3,p.transports=A?m.util.intersect(A.split(","),p.options.transports):p.options.transports,p.setHeartbeatTimeout(),p.remainingTransports=p.transports.slice(0),f(p.transports),p.once("connect",function(){clearTimeout(p.connectTimeoutTimer),h&&"function"==typeof h&&h()})}),this},s.prototype.setHeartbeatTimeout=function(){clearTimeout(this.heartbeatTimeoutTimer);var h=this;this.heartbeatTimeoutTimer=setTimeout(function(){h.transport.onClose()},this.heartbeatTimeout)},s.prototype.packet=function(h){return this.connected&&!this.doBuffer?this.transport.packet(h):this.buffer.push(h),this},s.prototype.setBuffer=function(h){this.doBuffer=h,!h&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},s.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this.disconnected=!0,this},s.prototype.disconnectSync=function(){m.util.request().open("GET",this.resource+"/"+m.protocol+"/"+this.sessionid,!0),this.onDisconnect("booted")},s.prototype.isXDomain=function(){return this.options.host!==u.location.hostname||this.options.port!=(u.location.port||("https:"==u.location.protocol?443:80))},s.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},s.prototype.onOpen=function(){this.open=!0},s.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},s.prototype.onPacket=function(h){this.of(h.endpoint).onPacket(h)},s.prototype.onError=function(h){h&&h.advice&&"reconnect"===h.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",h&&h.reason?h.reason:h)},s.prototype.onDisconnect=function(h){var p=this.connected,E=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(p||E)&&(this.transport.close(),this.transport.clearTimeouts(),p&&(this.publish("disconnect",h),"booted"!=h&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},s.prototype.reconnect=function(){function h(){if(E.connected){for(var I in E.namespaces)E.namespaces.hasOwnProperty(I)&&""!==I&&E.namespaces[I].packet({type:"connect"});E.publish("reconnect",E.transport.name,E.reconnectionAttempts)}clearTimeout(E.reconnectionTimer),E.removeListener("connect_failed",p),E.removeListener("connect",p),E.reconnecting=!1,delete E.reconnectionAttempts,delete E.reconnectionDelay,delete E.reconnectionTimer,delete E.redoTransports,E.options["try multiple transports"]=T}function p(){if(E.reconnecting)return E.connected?h():E.connecting&&E.reconnecting?E.reconnectionTimer=setTimeout(p,1e3):void(E.reconnectionAttempts++>=d?E.redoTransports?(E.publish("reconnect_failed"),h()):(E.on("connect_failed",p),E.options["try multiple transports"]=!0,E.transport=E.getTransport(),E.redoTransports=!0,E.connect()):(E.reconnectionDelay<A&&(E.reconnectionDelay*=2),E.connect(),E.publish("reconnecting",E.reconnectionDelay,E.reconnectionAttempts),E.reconnectionTimer=setTimeout(p,E.reconnectionDelay)))}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var E=this,d=this.options["max reconnection attempts"],T=this.options["try multiple transports"],A=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(p,this.reconnectionDelay),this.on("connect",p)}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(Q,m){function u(b,h){this.socket=b,this.name=h||"",this.flags={},this.json=new s(this,"json"),this.ackPackets=0,this.acks={}}function s(b,h){this.namespace=b,this.name=h}Q.SocketNamespace=u,m.util.mixin(u,m.EventEmitter),u.prototype.$emit=m.EventEmitter.prototype.emit,u.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},u.prototype.packet=function(b){return b.endpoint=this.name,this.socket.packet(b),this.flags={},this},u.prototype.send=function(b,h){var p={type:this.flags.json?"json":"message",data:b};return"function"==typeof h&&(p.id=++this.ackPackets,p.ack=!0,this.acks[p.id]=h),this.packet(p)},u.prototype.emit=function(b){var h=Array.prototype.slice.call(arguments,1),p=h[h.length-1],E={type:"event",name:b};return"function"==typeof p&&(E.id=++this.ackPackets,E.ack="data",this.acks[E.id]=p,h=h.slice(0,h.length-1)),E.args=h,this.packet(E)},u.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},u.prototype.onPacket=function(b){function h(){p.packet({type:"ack",args:m.util.toArray(arguments),ackId:b.id})}var p=this;switch(b.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(b.reason||"booted"):this.$emit("disconnect",b.reason||"");break;case"message":case"json":var E=["message",b.data];"data"==b.ack?E.push(h):b.ack&&this.packet({type:"ack",ackId:b.id}),this.$emit.apply(this,E);break;case"event":E=[b.name].concat(b.args),"data"==b.ack&&E.push(h),this.$emit.apply(this,E);break;case"ack":this.acks[b.ackId]&&(this.acks[b.ackId].apply(this,b.args),delete this.acks[b.ackId]);break;case"error":b.advice?this.socket.onError(b):this.$emit("unauthorized"==b.reason?"connect_failed":"error",b.reason)}},s.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},s.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(void 0!==io?io:module.exports,void 0!==io?io:module.parent.exports),function(Q,m,u){function s(h){m.Transport.apply(this,arguments)}function b(){}Q.websocket=s,m.util.inherit(s,m.Transport),s.prototype.name="websocket",s.prototype.open=function(h){var p,E=m.util.query(this.socket.options.query),d=this;return this.connectErrorCallback=h,p||(p=u.MozWebSocket||u.WebSocket),this.websocket=new p(this.prepareUrl()+E),this.websocket.onopen=function(){d.onOpen(),d.socket.setBuffer(!1)},this.websocket.onmessage=function(T){d.onData(T.data)},this.websocket.onclose=function(){d.onClose(),d.socket.setBuffer(!0)},this.websocket.onerror=function(T){d.onError(T)},this},s.prototype.send=function(h){return this.websocket.send(h),this},s.prototype.payload=function(h){for(var p=0,E=h.length;p<E;p++)this.packet(h[p]);return this},s.prototype.close=function(){return this.websocket.close(),this},s.prototype.onError=function(h){void 0!==this.connectErrorCallback&&(this.connectErrorCallback(),this.connectErrorCallback=void 0),this.socket.onError(h)},s.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},s.check=function(){return"WebSocket"in u&&!("__addTask"in WebSocket)||"MozWebSocket"in u},s.xdomainCheck=function(){return!0},s.prototype.clearEventHandlers=function(){return this.websocket&&(this.websocket.onopen=this.websocket.onmessage=this.websocket.onclose=this.websocket.onerror=b),this},m.transports.push("websocket")}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(Q,m,u){function s(h){h&&(m.Transport.apply(this,arguments),this.sendBuffer=[])}function b(){}Q.XHR=s,m.util.inherit(s,m.Transport),s.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},s.prototype.payload=function(h){for(var p=[],E=0,d=h.length;E<d;E++)p.push(m.parser.encodePacket(h[E]));this.send(m.parser.encodePayload(p))},s.prototype.send=function(h){return this.post(h),this},s.prototype.post=function(h){var d=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),u.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=b,d.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=b,d.posting=!1,200==this.status?(d.socket.setBuffer(!1),clearTimeout(d.sendXHR.ackTimeoutTimer)):d.onClose())},this.sendXHR.send(h),d.sendXHR.ackTimeoutTimer=setTimeout(function(){d.onClose()},d.socket.options.ackTimeoutMs)},s.prototype.close=function(){return this.onClose(),this},s.prototype.request=function(h){var p=m.util.request(this.socket.isXDomain()),E=m.util.query(this.socket.options.query,"t="+ +new Date);if(p.open(h||"GET",this.prepareUrl()+E,!0),"POST"==h)try{p.setRequestHeader?p.setRequestHeader("Content-type","text/plain;charset=UTF-8"):p.contentType="text/plain"}catch(d){}return p},s.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},s.check=function(h,p){try{var E=m.util.request(p),d=u.XDomainRequest&&E instanceof XDomainRequest;if(E&&(!d||(h&&h.options&&h.options.secure?"https:":"http:")==u.location.protocol))return!0}catch(I){}return!1},s.xdomainCheck=function(){return s.check(null,!0)},s.prototype.clearEventHandlers=function(){return this.sendXHR&&(this.sendXHR.onreadystatechange=this.sendXHR.onload=b),this}}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),function(Q,m,u){function s(){m.Transport.XHR.apply(this,arguments)}function b(){}Q["xhr-polling"]=s,m.util.inherit(s,m.Transport.XHR),m.util.merge(s,m.Transport.XHR),s.prototype.name="xhr-polling",s.prototype.open=function(h){return this.connectErrorCallback=h,m.Transport.XHR.prototype.open.call(this),!1},s.prototype.get=function(){if(this.isOpened){var d=this;this.xhr=this.request(),u.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){d.connectErrorCallback=void 0,this.onload=b,this.onerror=b,d.onData(this.responseText),d.get()},this.xhr.onerror=function(){d.onClose(),void 0!==d.connectErrorCallback&&(d.connectErrorCallback(),d.connectErrorCallback=void 0)}):this.xhr.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=b,200==this.status?(d.connectErrorCallback=void 0,d.onData(this.responseText),d.get()):(d.onClose(),void 0!==d.connectErrorCallback&&(d.connectErrorCallback(),d.connectErrorCallback=void 0)))},this.xhr.send(null)}},s.prototype.onClose=function(){if(m.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=b;try{this.xhr.abort()}catch(h){}this.xhr=null}},s.prototype.ready=function(h,p){var E=this;m.util.defer(function(){p.call(E)})},s.prototype.clearEventHandlers=function(){return m.Transport.XHR.prototype.clearEventHandlers.call(this),this.xhr&&(this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=b),this},m.transports.push("xhr-polling")}(void 0!==io?io.Transport:module.exports,void 0!==io?io:module.parent.exports,void 0===global?window:global),exports.io=io}).call(exports,__nested_webpack_require_43418__(4),__nested_webpack_require_43418__(13)(module))},function(Q,m,u){(function(s,b){Q.exports=function(){function p(De){return"function"==typeof De}function A(){var De=setTimeout;return function(){return De(I,1)}}function I(){for(var De=0;De<se;De+=2)(0,We[De])(We[De+1]),We[De]=void 0,We[De+1]=void 0;se=0}function f(De,Ke){var nt=arguments,bt=this,Nt=new this.constructor(v);void 0===Nt[Ge]&&Ce(Nt);var Xt,ot=bt._state;return ot?(Xt=nt[ot-1],Te(function(){return Y(ot,Nt,Xt,bt._result)})):$(bt,Nt,De,Ke),Nt}function c(De){if(De&&"object"==typeof De&&De.constructor===this)return De;var nt=new this(v);return P(nt,De),nt}function v(){}function C(De){try{return De.then}catch(Ke){return tt.error=Ke,tt}}function N(De,Ke,nt){Ke.constructor===De.constructor&&nt===f&&Ke.constructor.resolve===c?function(De,Ke){Ke._state===Le?M(De,Ke._result):Ke._state===at?U(De,Ke._result):$(Ke,void 0,function(nt){return P(De,nt)},function(nt){return U(De,nt)})}(De,Ke):nt===tt?U(De,tt.error):void 0===nt?M(De,Ke):p(nt)?function(De,Ke,nt){Te(function(bt){var Nt=!1,ot=function(De,Ke,nt,bt){try{De.call(Ke,nt,bt)}catch(Nt){return Nt}}(nt,Ke,function(Xt){Nt||(Nt=!0,Ke!==Xt?P(bt,Xt):M(bt,Xt))},function(Xt){Nt||(Nt=!0,U(bt,Xt))});!Nt&&ot&&(Nt=!0,U(bt,ot))},De)}(De,Ke,nt):M(De,Ke)}function P(De,Ke){De===Ke?U(De,new TypeError("You cannot resolve a promise with itself")):function(De){return"function"==typeof De||"object"==typeof De&&null!==De}(Ke)?N(De,Ke,C(Ke)):M(De,Ke)}function y(De){De._onerror&&De._onerror(De._result),j(De)}function M(De,Ke){De._state===rt&&(De._result=Ke,De._state=Le,0!==De._subscribers.length&&Te(j,De))}function U(De,Ke){De._state===rt&&(De._state=at,De._result=Ke,Te(y,De))}function $(De,Ke,nt,bt){var Nt=De._subscribers,ot=Nt.length;De._onerror=null,Nt[ot]=Ke,Nt[ot+Le]=nt,Nt[ot+at]=bt,0===ot&&De._state&&Te(j,De)}function j(De){var Ke=De._subscribers,nt=De._state;if(0!==Ke.length){for(var bt=void 0,Nt=void 0,ot=De._result,Xt=0;Xt<Ke.length;Xt+=3)Nt=Ke[Xt+nt],(bt=Ke[Xt])?Y(nt,bt,Nt,ot):Nt(ot);De._subscribers.length=0}}function ue(){this.error=null}function Y(De,Ke,nt,bt){var Nt=p(nt),ot=void 0,Xt=void 0,gn=void 0,dr=void 0;if(Nt){if((ot=function(De,Ke){try{return De(Ke)}catch(nt){return vt.error=nt,vt}}(nt,bt))===vt?(dr=!0,Xt=ot.error,ot=null):gn=!0,Ke===ot)return void U(Ke,new TypeError("A promises callback cannot return that same promise."))}else ot=bt,gn=!0;Ke._state!==rt||(Nt&&gn?P(Ke,ot):dr?U(Ke,Xt):De===Le?M(Ke,ot):De===at&&U(Ke,ot))}function Ce(De){De[Ge]=Qt++,De._state=void 0,De._result=void 0,De._subscribers=[]}function ne(De,Ke){this._instanceConstructor=De,this.promise=new De(v),this.promise[Ge]||Ce(this.promise),Oe(Ke)?(this._input=Ke,this.length=Ke.length,this._remaining=Ke.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&M(this.promise,this._result))):U(this.promise,new Error("Array Methods must be provided an Array"))}function be(De){this[Ge]=Qt++,this._result=this._state=void 0,this._subscribers=[],v!==De&&("function"!=typeof De&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof be?function(De,Ke){try{Ke(function(nt){P(De,nt)},function(nt){U(De,nt)})}catch(nt){U(De,nt)}}(this,De):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var De,Ke,nt,Oe=Array.isArray?Array.isArray:function(De){return"[object Array]"===Object.prototype.toString.call(De)},se=0,fe=void 0,we=void 0,Te=function(De,Ke){We[se]=De,We[se+1]=Ke,2===(se+=2)&&(we?we(I):Qe())},ye="undefined"!=typeof window?window:void 0,Pe=ye||{},Ve=Pe.MutationObserver||Pe.WebKitMutationObserver,Ue="undefined"==typeof self&&void 0!==s&&"[object process]"==={}.toString.call(s),Ie="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,We=new Array(1e3),Qe=void 0;Qe=Ue?function(){return s.nextTick(I)}:Ve?(De=0,Ke=new Ve(I),nt=document.createTextNode(""),Ke.observe(nt,{characterData:!0}),function(){nt.data=De=++De%2}):Ie?function(){var De=new MessageChannel;return De.port1.onmessage=I,function(){return De.port2.postMessage(0)}}():void 0===ye?function(){try{var De=u(21);return void 0!==(fe=De.runOnLoop||De.runOnContext)?function(){fe(I)}:A()}catch(Ke){return A()}}():A();var Ge=Math.random().toString(36).substring(16),rt=void 0,Le=1,at=2,tt=new ue,vt=new ue,Qt=0;return ne.prototype._enumerate=function(){for(var De=this.length,Ke=this._input,nt=0;this._state===rt&&nt<De;nt++)this._eachEntry(Ke[nt],nt)},ne.prototype._eachEntry=function(De,Ke){var nt=this._instanceConstructor,bt=nt.resolve;if(bt===c){var Nt=C(De);if(Nt===f&&De._state!==rt)this._settledAt(De._state,Ke,De._result);else if("function"!=typeof Nt)this._remaining--,this._result[Ke]=De;else if(nt===be){var ot=new nt(v);N(ot,De,Nt),this._willSettleAt(ot,Ke)}else this._willSettleAt(new nt(function(Xt){return Xt(De)}),Ke)}else this._willSettleAt(bt(De),Ke)},ne.prototype._settledAt=function(De,Ke,nt){var bt=this.promise;bt._state===rt&&(this._remaining--,De===at?U(bt,nt):this._result[Ke]=nt),0===this._remaining&&M(bt,this._result)},ne.prototype._willSettleAt=function(De,Ke){var nt=this;$(De,void 0,function(bt){return nt._settledAt(Le,Ke,bt)},function(bt){return nt._settledAt(at,Ke,bt)})},be.all=function(De){return new ne(this,De).promise},be.race=function(De){var Ke=this;return new Ke(Oe(De)?function(nt,bt){for(var Nt=De.length,ot=0;ot<Nt;ot++)Ke.resolve(De[ot]).then(nt,bt)}:function(nt,bt){return bt(new TypeError("You must pass an array to race."))})},be.resolve=c,be.reject=function(De){var nt=new this(v);return U(nt,De),nt},be._setScheduler=function(De){we=De},be._setAsap=function(De){Te=De},be._asap=Te,be.prototype={constructor:be,then:f,catch:function(De){return this.then(null,De)}},be.polyfill=function(){var De=void 0;if(void 0!==b)De=b;else if("undefined"!=typeof self)De=self;else try{De=Function("return this")()}catch(bt){throw new Error("polyfill failed because global object is unavailable in this environment")}var Ke=De.Promise;if(Ke){var nt=null;try{nt=Object.prototype.toString.call(Ke.resolve())}catch(bt){}if("[object Promise]"===nt&&!Ke.cast)return}De.Promise=be},be.Promise=be,be}()}).call(m,u(12),u(4))},function(Q,m){function u(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function b(C){if(A===setTimeout)return setTimeout(C,0);if((A===u||!A)&&setTimeout)return A=setTimeout,setTimeout(C,0);try{return A(C,0)}catch(R){try{return A.call(null,C,0)}catch(D){return A.call(this,C,0)}}}function p(){S&&c&&(S=!1,c.length?v=c.concat(v):g=-1,v.length&&E())}function E(){if(!S){var C=b(p);S=!0;for(var R=v.length;R;){for(c=v,v=[];++g<R;)c&&c[g].run();g=-1,R=v.length}c=null,S=!1,function(C){if(I===clearTimeout)return clearTimeout(C);if((I===s||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(C);try{I(C)}catch(R){try{return I.call(null,C)}catch(D){return I.call(this,C)}}}(C)}}function d(C,R){this.fun=C,this.array=R}function T(){}var A,I,f=Q.exports={};!function(){try{A="function"==typeof setTimeout?setTimeout:u}catch(C){A=u}try{I="function"==typeof clearTimeout?clearTimeout:s}catch(C){I=s}}();var c,v=[],S=!1,g=-1;f.nextTick=function(C){var R=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)R[D-1]=arguments[D];v.push(new d(C,R)),1!==v.length||S||b(E)},d.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=T,f.addListener=T,f.once=T,f.off=T,f.removeListener=T,f.removeAllListeners=T,f.emit=T,f.prependListener=T,f.prependOnceListener=T,f.listeners=function(C){return[]},f.binding=function(C){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(C){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(Q,m){Q.exports=function(u){return u.webpackPolyfill||(u.deprecate=function(){},u.paths=[],u.children||(u.children=[]),Object.defineProperty(u,"loaded",{enumerable:!0,get:function(){return u.l}}),Object.defineProperty(u,"id",{enumerable:!0,get:function(){return u.i}}),u.webpackPolyfill=1),u}},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var E,c,s=u(3),b=u(1),h=u(0);m.ResponseData=function(v){this.id=v,this.status=200,this.headers={},this.body=""},(c=E=m.ClientEventName||(m.ClientEventName={})).Connected="trouter_js_client_connected",c.Disconnected="trouter_js_client_disconnected",c.Error="trouter_js_client_error",c.Progress="trouter_js_client_progress",c.Response="trouter_js_client_response",c.Request="trouter_js_client_request",c.CheckConnection="trouter_js_client_check_connection",c.Registration="trouter_js_client_registration",c.Unregistration="trouter_js_client_unregistration";var d=function(v,S,g,C,R){this.stepName=v,this.operation=S,this.delta=g,this.ts=C,this.error=R};m.TrackerStep=d,m.Properties=function(){};var A=function(){this.numberOfPingReplies=0,this.connectedTimestamp=0,this.isNewUrl=!1,this.transportType="",this.connectionNumber=0},I=function(){this.enabled=!1,this.numberOfStepsToMaintain=40,this.logHealthCheckError=!1,this.sendProgressTimeoutSecs=55,this.logSendPingError=!1,this.maxBackoffInMs=12e4,this.trouter_js_client_connected=!1,this.trouter_js_client_disconnected=!1,this.trouter_js_client_error=!1,this.trouter_js_client_progress=!1,this.trouter_js_client_response=!1,this.trouter_js_client_request=!1,this.trouter_js_client_registration=!1,this.trouter_js_client_unregistration=!1,this.trouter_js_client_check_connection=!0},f=function(){function c(v,S,g,C,R,D,_){this.clientId=S,this.clientInfo=g,this.getServerState=C,this.endpointId=R,this.clientCorrelationID=D,this.environment=_,this.logger=new h.Logger("ConnectionTracker",v),this.clientCorrelationID=void 0!==D?D:"",this.steps=[],this.connectionAttempt=0,this.totalStepCount=0,this.beginTimestamp=new s.Timespan,this.eventLogSettings=new I,this.connectedInfo=new A}return c.prototype.enable=function(v){this.eventLogSettings.enabled=!0,this.eventLogger=v},c.prototype.disable=function(){this.eventLogSettings.enabled=!1},c.prototype.sendProgress=function(v){this.steps.length>0&&this.sendTelemetry(E.Progress,v,this.steps)},c.prototype.cancelProgressTimer=function(){void 0!==this.progressTimeout&&(clearTimeout(this.progressTimeout),this.progressTimeout=void 0)},c.prototype.resetProgressSendTimer=function(){var v=this;this.cancelProgressTimer(),void 0!==this.eventLogSettings.sendProgressTimeoutSecs&&this.eventLogSettings.sendProgressTimeoutSecs>0&&(this.progressTimeout=setTimeout(function(){v.sendProgress({reason:"timeout",timeoutSecs:v.eventLogSettings.sendProgressTimeoutSecs})},1e3*this.eventLogSettings.sendProgressTimeoutSecs))},c.prototype.setConnectedInfo=function(v,S){this.connectedInfo.numberOfPingReplies=0,this.connectedInfo.connectedTimestamp=Date.now(),this.connectedInfo.isNewUrl=v,this.connectedInfo.transportType=S,++this.connectedInfo.connectionNumber},c.prototype.clearConnectedInfo=function(){this.connectedInfo.numberOfPingReplies=0,this.connectedInfo.connectedTimestamp=0,this.connectedInfo.isNewUrl=!0,this.connectedInfo.transportType=""},c.prototype.copyProperties=function(v,S){for(var g=0,C=Object.keys(S);g<C.length;g++){var R=C[g];S.hasOwnProperty(R)&&void 0!==S[R]&&(v[R.replace(/-/g,"_")]={value:S[R]})}},c.prototype.increasePingResponseCount=function(){++this.connectedInfo.numberOfPingReplies},c.prototype.sendTelemetry=function(v,S,g){try{if(!0===this.eventLogSettings.enabled&&!0===this.eventLogSettings[v]&&void 0!==this.eventLogger){var C=this.getServerState(),R={name:v,properties:{connectionAttempt:{value:this.connectionAttempt},epid:{value:this.endpointId},clientCorrelationID:{value:this.clientCorrelationID},steps:{value:s.toJson(g)},clientID:{value:this.clientId},eventVersion:{value:3},environment:{value:this.environment},cv:{value:b.CLIENT_VERSION},ua:{value:this.clientInfo.ua},connectionId:{value:C.connectionId},connectedClientId:{value:C.connectedClientId},domId:{value:C.domId},url:{value:C.unsecureUrl},surl:{value:C.url},ttlInSecs:{value:C.getRemainingTtlInSec()},numberOfPingReplies:{value:this.connectedInfo.numberOfPingReplies},connectedTimestamp:{value:this.connectedInfo.connectedTimestamp},isNewUrl:{value:this.connectedInfo.isNewUrl},transportType:{value:this.connectedInfo.transportType},connectionNumber:{value:this.connectedInfo.connectionNumber}}};this.copyProperties(R.properties,S),this.eventLogger.logEvent(R)}}catch(D){this.logger.warn("error in sending event "+v+": "+s.toJson(D))}},c.prototype.createStep=function(v,S,g){return new d(v,S,this.beginTimestamp.duration,Date.now(),g)},c.prototype.addStep=function(v,S,g){if(!1!==this.eventLogSettings.enabled&&(0===this.steps.length&&this.beginTimestamp.reset(),this.steps.push(this.createStep(v,S,g)),++this.totalStepCount,void 0!==this.eventLogSettings.numberOfStepsToMaintain&&this.steps.length>this.eventLogSettings.numberOfStepsToMaintain)){var C=this.steps.slice(0);this.steps.length=0,this.sendTelemetry(E.Progress,{reason:"flush"},C)}},c.prototype.trackStart=function(v){this.addStep(v,"start")},c.prototype.trackEnd=function(v){this.addStep(v,"end")},c.prototype.trackError=function(v,S,g,C){void 0===g&&(g=!0),"health"===v&&!0!==this.eventLogSettings.logHealthCheckError||"ping"===v&&!1===this.eventLogSettings.logSendPingError||(void 0===C&&(C="error"),!0===g&&this.addStep(v,C,S),this.sendTelemetry(E.Error,{},[this.createStep(v,C,S)]))},c.prototype.trackProgress=function(v,S){this.addStep(v,S)},c.prototype.trackConnected=function(v,S){this.setConnectedInfo(v,S);var g=this.steps.slice(0),C=this.totalStepCount,R=this.beginTimestamp.duration;this.steps.length=0,this.totalStepCount=0,this.sendTelemetry(E.Connected,{stepCount:g.length,totalStepCount:C,connectionEstablishmentMs_Total:R},g),this.cancelProgressTimer()},c.prototype.trackDisconnected=function(v){v.sessionLengthMS=Date.now()-this.connectedInfo.connectedTimestamp,this.sendTelemetry(E.Disconnected,v,[]),this.resetProgressSendTimer()},c.prototype.trackNewConnection=function(){++this.connectionAttempt},c.prototype.trackRequest=function(v,S){var g={};void 0!==S&&(g.hasError=!0,g.error=S);try{if(v){g.requestID=v.id,g.httpMethod=v.method,g.url=v.url,g.bodyLength=v.body.length,g.shortUrl=v.shortUrl,g.requestTimeStamp=v.startTS,g.correlationVector=v.correlationVector;for(var C=v.headers,R=0,D=Object.keys(C);R<D.length;R++){var _=D[R];C.hasOwnProperty(_)&&(g[_]=C[_])}}}catch(N){g.hasError=!0,g.error=g.error+" error creating request context "+s.toJson(N)}this.sendTelemetry(E.Request,g,[])},c.prototype.trackResponse=function(v,S,g,C){var R={};void 0!==C&&(R.hasError=!0,R.error=C);try{if(R.responseTimestamp=void 0!==g?g.sentTS:Date.now(),v){R.requestID=v.id,R.httpMethod=v.method,R.shortUrl=v.shortUrl,R.correlationVector=v.correlationVector;for(var D=v.headers,_=0,N=Object.keys(D);_<N.length;_++){var P=N[_];D.hasOwnProperty(P)&&(R[P]=D[P])}}g&&(R.latencyMS=S,R.responseCode=g.status,R.responseLength=g.body.length)}catch(y){R.hasError=!0,R.error=R.error+" error creating response context "+s.toJson(y)}this.sendTelemetry(E.Response,R,[])},c.prototype.sendResponseError=function(v,S,g){this.trackResponse(S,void 0,g,v)},c.prototype.close=function(){this.sendProgress({reason:"closed"}),this.steps.length=0,this.cancelProgressTimer()},c.prototype.mergeSettings=function(v){if(v){this.eventLogSettings.numberOfStepsToMaintain=Math.min(40,Math.max(10,void 0!==v.numberOfStepsToMaintain?v.numberOfStepsToMaintain:0));var S=Math.min(3600,Math.max(55,void 0!==v.sendProgressTimeoutSecs?v.sendProgressTimeoutSecs:0));this.eventLogSettings.logHealthCheckError=v.logHealthCheckError,this.eventLogSettings.logSendPingError=v.logSendPingError;for(var g=0,C=Object.keys(E).map(function(D){return E[D]});g<C.length;g++){var R=C[g];v.hasOwnProperty(R)&&void 0!==v[R]&&(this.eventLogSettings[R]=v[R])}this.eventLogSettings.sendProgressTimeoutSecs!==S&&(this.eventLogSettings.sendProgressTimeoutSecs=S,this.resetProgressSendTimer())}},c}();m.ConnectionTracker=f},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var s=function(){function b(h,p){this.logger=h,this.maxBackoffInMs=p,this.backoffId=0,this.backoffCount=0}return b.calculateNextBackoffMs=function(h,p){var E=1+.4*(Math.random()-.5),d=1e3*Math.pow(2,h)*E;return d=Math.round(d),Math.min(p,d)},b.prototype.setMaxBackoffMs=function(h){this.maxBackoffInMs=h},b.prototype.backoff=function(h,p){var E=this;void 0!==this.timerHandle&&(this.logger.debug("Clearing current back off"),clearTimeout(this.timerHandle),this.timerHandle=void 0);var d=b.calculateNextBackoffMs(this.backoffCount,this.maxBackoffInMs);this.backoffId++,this.backoffCount++,this.logger.info("Backing off "+h+" for "+d+" milliseconds with ID "+this.backoffId),this.timerHandle=setTimeout(function(){E.logger.info("Back off for "+h+" with ID "+E.backoffId+" complete, invoking handler"),E.timerHandle=void 0,p()},d)},b.prototype.reset=function(){void 0!==this.timerHandle&&(this.logger.debug("Resetting back off"),clearTimeout(this.timerHandle),this.timerHandle=void 0),this.backoffCount=0},b}();m.ExponentialBackoff=s},function(Q,m,u){var s=this&&this.__assign||Object.assign||function(P){for(var y,M=1,U=arguments.length;M<U;M++)for(var $ in y=arguments[M])Object.prototype.hasOwnProperty.call(y,$)&&(P[$]=y[$]);return P};Object.defineProperty(m,"__esModule",{value:!0});var b=u(20),h=u(11),p=u(3),E=u(14),d=u(1),T=u(15),A=u(2),I=u(5),f=u(0),c=u(17),v=u(10),S=function(){this.cv=d.CLIENT_VERSION,this.ua="",this.hr="",this.v=""},g=function(){this["force new connection"]=!0,this.reconnect=!1,this.query="",this.ackTimeoutMs=5e3},C="MS-CV",R=function(){function P(y){this.cvCounter=0;var M=JSON.parse(y);this.startTS=M.hasOwnProperty("startTS")?M.startTS:0,this.url=M.hasOwnProperty("url")?M.url:"",this.shortUrl=M.hasOwnProperty("shortUrl")?M.shortUrl:"",this.body=M.hasOwnProperty("body")?M.body:"",this.headers=M.hasOwnProperty("headers")?M.headers:{},this.id=M.hasOwnProperty("id")&&"number"==typeof M.id?M.id:-1,this.method=M.hasOwnProperty("method")?M.method:"",this.replied=!1,this.timedout=!1,this.timeoutTimerId=0,this.receivedCv=this.headers[C],this.updateCvHeader()}return Object.defineProperty(P.prototype,"correlationVector",{get:function(){return this.receivedCv?this.receivedCv+"."+this.cvCounter:""},enumerable:!0,configurable:!0}),P.prototype.on=function(y,M){"data"===y?this.dataCallback=M:"end"===y&&("function"==typeof this.dataCallback&&this.dataCallback(this.body),M())},P.prototype.incrementCorrelationVector=function(){++this.cvCounter,this.updateCvHeader()},P.prototype.updateCvHeader=function(){var y=this.correlationVector;y&&(this.headers[C]=y)},P}(),D=function(){function P(y,M,U){this.request=y,this.responseData=M,this.sendResponse=U}return P.prototype.writeHead=function(y,M){this.responseData.status=y,this.responseData.headers=M},P.prototype.write=function(y){this.responseData.body+=y},P.prototype.end=function(y){return y&&(this.responseData.body+=y),this.sendResponse(this.request,this.responseData)},P}(),_=function(y){this.name=y,this.args={},this.timeoutTimerId=0},N=function(){function P(y,M,U,$,j){var ue=this;this.options=M,this.manager=U,this.tokenProvider=$,this.connectionId="",this.inIncallMode=!1,this.connectionAttempt=0,this.connectedClientId="",this.c2cUrlBase="",this.pendingTimers={},this.lastDisconnectReason="",this.UNKNOWN_TRANSPORT="unknown_transport",this.logger=new f.Logger("Connection",y),this.timeoutOptions=this.options.timeoutOptions,this.healthBackoff=new T.ExponentialBackoff(this.logger,this.timeoutOptions.maxBackoffMs),this.tokenBackoff=new T.ExponentialBackoff(this.logger,this.timeoutOptions.maxBackoffMs),this.clientID=Date.now(),"undefined"!=typeof window&&window.location&&(this.domId=window.location.hostname),this.clientInfo=new S,this.clientInfo.cv=d.CLIENT_VERSION,this.clientInfo.ua="",this.options&&this.options.clientInfo&&(this.clientInfo.ua=this.safeString(this.options.clientInfo.ua),this.clientInfo.v=this.safeString(this.options.clientInfo.v)),this.connectionTracker=new E.ConnectionTracker(y,this.clientID,this.clientInfo,function(){return ue.getServerState()},this.options.endpointId,this.options.clientCorrelationID,this.options.environment),this.applyConnectionTrackerOptions(M),this.fsm=new c.TrouterFsm(y,this,this.options.incallModeTimeoutMs>0),M.registration&&(this.registrarClient=b.createRegistrarClient(y,this.tokenProvider,{registrarUrl:M.registration.registrarUrl,registrationId:M.registration.registrationId,requestTimeoutMs:M.timeoutOptions.fetchTimeoutMs,initialRetryDelayMs:1e3,maxRetryDelayMs:M.timeoutOptions.maxBackoffMs})),this.userActivityState=j}return P.prototype.start=function(y){this.logger.info("Starting"),this.externalConnectParams=y,this.fsm.start()},P.prototype.stop=function(y){this.logger.info("Stopping"),this.connectionTracker.close(),this.fsm.stop(y)},P.prototype.configure=function(y){var M=this.options.trouterUrl!==y.trouterUrl;this.options=y,this.applyConnectionTrackerOptions(y),M&&this.onTrouterReconnect()},P.prototype.checkConnection=function(y){this.logger.info("checkConnection called with "+y),this.fsm.checkConnection(y),y&&this.connectionTracker.sendTelemetry(E.ClientEventName.CheckConnection,{disconnectDetected:y},[])},P.prototype.getServerState=function(){return new I.ServerState(this.connectionId,this.connectedClientId,this.domId?this.domId:"",this.allocateResult?this.allocateResult.url:"",this.allocateResult?this.allocateResult.surl:"",this.c2cUrlBase,this.connectionExpireTimestampInSecs)},P.prototype.getToken=function(y,M){var U=this;this.logger.info("Getting token "+(M?"with backoff":"without backoff"));var $=function(){U.connectionTracker.trackStart("token"),U.tokenProvider(!y).then(function(j){U.logger.debug("token is received"),U.connectionTracker.trackEnd("token"),U.fsm.onTokenReceived(j)}).catch(function(j){var ue=p.toJson(j.stack);U.logger.error("Getting token failed, will retry after timeout. Error: "+ue),U.connectionTracker.trackError("token",ue),U.getToken(y,!0)})};M?this.tokenBackoff.backoff("getting token",$):(this.tokenBackoff.reset(),$())},P.prototype.startConnectionTimer=function(){var y=this;this.stopConnectionTimer(),this.logger.debug("Starting connection timeout for "+this.timeoutOptions.connectionTimeoutMs+" ms"),this.connectionTimeoutId=setTimeout(function(){y.logger.info("Connection timeout is fired"),y.fsm.onConnectingTimeout()},this.timeoutOptions.connectionTimeoutMs)},P.prototype.stopConnectionTimer=function(){this.connectionTimeoutId&&(this.logger.debug("Stopping connection timeout"),clearTimeout(this.connectionTimeoutId),this.connectionTimeoutId=void 0)},P.prototype.startPingTimer=function(){var y=this;"websocket"===this.transportTypeName?(this.logger.debug("Starting ping timeout for "+this.timeoutOptions.pingTimeoutMs+" ms"),this.pingTimerId=setInterval(function(){y.logger.info("Ping interval fired"),y.fsm.onPingInterval()},this.timeoutOptions.pingTimeoutMs)):this.logger.debug("Not starting ping for transport "+this.transportTypeName)},P.prototype.stopPingTimer=function(){this.pingTimerId&&(this.logger.debug("Stopping ping timeout"),this.clearPingResponseTimer(),clearInterval(this.pingTimerId),this.pingTimerId=void 0)},P.prototype.shouldSkipRegistration=function(){return void 0===this.options.registration},P.prototype.hasCustomRegisterTtl=function(){return this.options.registration&&this.options.registration.registrarTtlSec},P.prototype.startRegisterTimer=function(){var y=this;void 0!==this.registrationTimerId&&this.stopRegisterTimer();var M=this.getRegistrationTtl()-30;this.logger.debug("Starting registration timeout for "+M+" sec"),this.registrationTimerId=setTimeout(function(){y.logger.info("Registration timeout is fired"),y.registrationTimerId=setTimeout(function(){y.registrationTimerId=void 0,y.logger.debug("Re-registration did not happen in time"),y.dispatchUnregistered()},3e4),y.fsm.onRegistrationTimeout()},1e3*M)},P.prototype.stopRegisterTimer=function(){this.registrationTimerId&&(this.logger.debug("Stopping registration timeout"),clearTimeout(this.registrationTimerId),this.registrationTimerId=void 0)},P.prototype.resendRegistration=function(){if(!this.registrarClient)throw new Error("Trouter Client not configured to handle registrations");return this.registrarClient.resendRegistration()},P.prototype.buildSocketIoUrlParams=function(){if(!this.allocateResult)throw new Error("Allocate result is undefined in buildSocketIoUrlParams()");var y={};if(this.allocateResult.connectparams)for(var M=this.allocateResult.connectparams,U=0,$=Object.keys(M);U<$.length;U++){var j=$[U];M.hasOwnProperty(j)&&void 0!==M[j]&&(y[j]=M[j])}return y.v="v4",y.tc=encodeURI(p.toJson(this.clientInfo)),y.timeout=this.timeoutOptions.pingTimeoutMs/1e3,y.auth="true",this.options.endpointId&&(y.epid=this.options.endpointId),this.userActivityState.state!==A.UserActivityState.Unknown&&(y.userActivity=encodeURI(p.toJson(this.userActivityState.toEventObject()))),this.appendConnectedClientIds(this.buildQuery(y),!0)},P.prototype.startSocketIo=function(){var y=this;if(this.logger.info("Starting socket io"),this.connectionTracker.trackStart("connectSocket"),!this.allocateResult)throw new Error("Allocate result is undefined in startSocketIo()");var M=this.options.ioOptions||new g;if(M["force new connection"]=!0,M.reconnect=!1,M.query=this.buildSocketIoUrlParams(),this.logger.info("connecting to "+this.allocateResult.socketio+"?"+M.query),this.stopSocketIo(),this.socket=(this.options.io||v).connect(this.allocateResult.socketio,M),void 0===this.socket)throw new Error("Can't create Socket.io object");this.socket.on("connecting",function(U){y.onSocketConnecting(U)}),this.socket.on("connect",function(){y.onSocketConnect()}),this.socket.on("connect_failed",function(U){y.onSocketConnectFailed(U)}),this.socket.on("disconnect",function(U){y.onSocketDisconnect(U)}),this.socket.on("reconnect",function(){y.onSocketReconnect()}),this.socket.on("reconnect_failed",function(U){y.onSocketReconnectFailed(U)}),this.socket.on("reconnecting",function(){y.onSocketReconnecting()}),this.socket.on("error",function(U){y.onSocketError(U)}),this.socket.on("message",function(U){y.onSocketMessage(U)}),this.socket.on("trouter.connected",function(U){y.onTrouterConnected(U)}),this.socket.on("trouter.reconnect",function(){y.onTrouterReconnect()}),this.socket.on("trouter.message_loss",function(U){y.onTrouterMessageLoss(U)})},P.prototype.stopSocketIo=function(){if(this.socket){this.logger.info("clearing socket.io");try{for(var y=0,M=["connecting","connect","connect_failed","disconnect","reconnect","reconnect_failed","reconnecting","error","message","trouter.connected","trouter.reconnect","trouter.message_loss"];y<M.length;y++)this.socket.removeAllListeners(M[y]);this.socket.disconnect(),this.logger.debug("cleared socket"),this.socket=void 0}catch($){this.logger.error("exception in disconnecting previous socket. Error: "+p.toJson($.stack))}}},P.prototype.dispatchConnected=function(){this.logger.info("dispatching connected"),this.manager.onConnected(this)},P.prototype.dispatchRegistered=function(){this.logger.info("dispatching registered"),this.manager.onRegistered(this)},P.prototype.dispatchUnregistered=function(){this.logger.info("dispatching unregistered"),this.manager.onUnregistered(this)},P.prototype.dispatchDownstreamRequest=function(y){var M=this;this.logger.info("dispatching downstream request");try{var U=new D(y,new E.ResponseData(y.id),function($,j){return M.logger.info("sending response to downstream"),M.sendResponse($,j)});this.manager.onDownstreamRequest(this,y,U)}catch($){this.logger.error("exception in socket.on message. Error : "+p.toJson($.stack))}},P.prototype.dispatchReconnecting=function(){this.logger.info("dispatching reconnecting"),this.manager.onReconnecting(this)},P.prototype.dispatchReconnectIsRequired=function(){this.logger.info("dispatching reconnect is required by server"),this.manager.onReconnectIsRequired(this)},P.prototype.dispatchDisconnected=function(){this.logger.info("dispatching disconnected"),this.manager.onDisconnected(this)},P.prototype.dispatchTrouterMessageLost=function(y){this.logger.info("dispatching trouter lost message"),this.manager.onTrouterMessageLost(y)},P.prototype.sendProcessedDroppedIndicators=function(y){var M=this;try{this.logger.info("emitting processed flow tags to the server");var U=new _("trouter.processed_message_loss");U.args={droppedIndicators:y},this.sendDownstreamEvent(U,function(){M.logger.info("emitted processed flow tags to the server")})}catch(j){var $=p.toJson(j.stack);this.logger.error("unable to send processed message loss event. Error: "+$),this.connectionTracker.trackError("trouter.processed_message_loss",$,!1)}},P.prototype.resetAllocationConnectionParams=function(){this.allocateResult&&(this.logger.info("Resetting allocation connection parameters"),this.allocateResult.connectparams=void 0)},P.prototype.sendAllocateRequest=function(y){var M=this;this.connectionAttempt++,this.connectionTracker.trackNewConnection();var U=this.options.trouterUrl,$=U,j=this.allocateResult&&this.allocateResult.connectparams;if(!j){var ue=this.externalConnectParams;ue&&ue.se&&parseInt(ue.se,10)<=Date.now()+36e5&&(this.logger.warn("Dropping expired cached connection parameters: "+new Date(parseInt(ue.se,10))),this.externalConnectParams=ue=void 0),ue&&ue.serviceUrl!==$&&(this.logger.warn("Dropping cached connection parameters for a different environment ("+ue.serviceUrl+", now "+$+")"),this.externalConnectParams=ue=void 0),ue&&ue.reconnectUrl?($=ue.reconnectUrl,j=s({},ue,{reconnectUrl:void 0})):j=ue}$=this.appendCorrelationIds($,!1),$=this.appendEndpointId($,!1),j&&($+="&"+this.buildQuery(j),j.v||($+="&v=v4"));var Z=new Request($,{method:"POST",mode:"cors",headers:new Headers({"X-Skypetoken":y,"Content-Type":"text/plain"})});this.logger.info("sendAllocateRequest: POST "+$),this.connectionTracker.trackStart("allocation");var Y=-1;this.fetchWithTimeout(Z,this.timeoutOptions.fetchTimeoutMs).then(function(W){if(Y=W.status,!W.ok)throw new Error(W.statusText);var ce=W.headers.get("content-type");if(!ce||"application/json"!==ce&&"application/json;"!==ce.substring(0,17))throw new Error("Content-type '"+ce+"' is unexpected");return M.connectionTracker.trackEnd("allocation"),W.json()}).then(function(W){M.onAllocationResponse(W,U)}).catch(function(W){var ce=W+", status code "+Y;M.logger.error("Allocation request failed. Error: "+ce),M.connectionTracker.trackError("allocation",ce),M.externalConnectParams&&M.connectionAttempt>2&&(Y>=400&&Y<=599?(M.logger.warn(M.connectionAttempt+" connection attempts, server-side failure: erasing external connection parameters"),M.externalConnectParams=void 0):M.externalConnectParams.reconnectUrl&&(M.logger.warn(M.connectionAttempt+" connection attempts, erasing reconnect URL"),delete M.externalConnectParams.reconnectUrl)),M.fsm.onAllocationFailed(401===Y)})},P.prototype.sendPingRequest=function(){var y=this;if(this.socket&&void 0===this.pingResponseTimerId)try{this.logger.info("emitting ping event"),this.socket.emit("ping",function(){y.onPingResponse()}),this.pingResponseTimerId=setTimeout(function(){y.logger.error("Ping response timeout is fired"),y.clearPingResponseTimer(),y.fsm.onPingResponseTimeout()},this.timeoutOptions.pongTimeoutMs)}catch(U){var M=p.toJson(U.stack);this.logger.error("unable to send ping. Error: "+M),this.connectionTracker.trackError("ping",M,!1)}},P.prototype.setUserActivityState=function(y){var M=y.state!==this.userActivityState.state;this.userActivityState=y,this.fsm.onSetUserActivityState(y,M)},P.prototype.sendUserActivityState=function(y,M){this.userActivityState.state!==A.UserActivityState.Unknown&&("websocket"===this.transportTypeName&&M?this.sendUserActivityStateMultiple(y===I.UserActivityEventReason.Connected?2:1):"xhr-polling"===this.transportTypeName&&y===I.UserActivityEventReason.Modified&&this.fsm.forceReconnect())},P.prototype.sendRegisterRequest=function(){var y=this;if(!this.options.registration||!this.registrarClient)throw new Error("Internal error - options.registration is undefined");if(!this.allocateResult)throw new Error("Allocate result is undefined in sendRegisterRequest()");this.logger.info("sending register request");var M=new p.Timespan;this.connectionTracker.trackStart("registration"),this.registrarClient.register({appId:this.options.registration.pnhAppId,aesKey:"",languageId:"en-US",platform:this.options.registration.platform,templateKey:this.options.registration.pnhTemplateKey,platformUIVersion:this.options.registration.platformUIVersion,productContext:this.options.registration.productContext},{TROUTER:[{context:this.options.registration.context,path:this.allocateResult.surl,ttl:this.getRegistrationTtl()}]}).then(function(){y.logger.info("Register request successful"),y.connectionTracker.trackEnd("registration"),y.fsm.onRegistrationSucceed(),y.connectionTracker.sendTelemetry(E.ClientEventName.Registration,{duration:M.duration},[])}).catch(function(U){y.logger.error("Register request failed. Error: "+U),y.connectionTracker.trackError("registration",U.message),y.fsm.onRegistrationFailed(!1),y.connectionTracker.sendTelemetry(E.ClientEventName.Registration,{duration:M.duration},[])})},P.prototype.sendUnregisterRequest=function(){var y=this;this.logger.info("sending unregister request");var M=new p.Timespan;if(!this.options.registration||!this.registrarClient)throw new Error("Internal error - options.registration is undefined");this.connectionTracker.trackStart("unregistration"),this.registrarClient.unregister().then(function(){y.logger.info("Unregister request successful"),y.connectionTracker.trackEnd("unregistration"),y.fsm.onUnregistrationSucceed(),y.connectionTracker.sendTelemetry(E.ClientEventName.Unregistration,{duration:M.duration},[])}).catch(function(U){y.logger.error("Unregister request failed. Error: "+U),y.connectionTracker.trackError("unregistration",U.message),y.fsm.onUnregistrationFailed(!1),y.connectionTracker.sendTelemetry(E.ClientEventName.Unregistration,{duration:M.duration},[])})},P.prototype.fetchWithTimeout=function(y,M){return new h.Promise(function(U,$){fetch(y).then(U).catch($),0!==M&&setTimeout($,M,new Error("Fetch for '"+y.url+"' timed out"))})},P.prototype.resetTokenBackoff=function(){this.tokenBackoff.reset()},P.prototype.resetRegisterBackoff=function(){this.registrarClient&&this.registrarClient.cancelPendingRequests()},P.prototype.clearTimers=function(){this.logger.debug("Clearing all pending downstream events related timers");for(var y=0,M=Object.keys(this.pendingTimers);y<M.length;y++)this.clearTimer(Number(M[y]))},P.prototype.restartIncallModeTimer=function(){var y=this;this.clearIncallModeTimerId(),this.logger.debug("Restarting incall mode timer"),this.incallModeTimerId=setTimeout(function(){y.logger.info("Call mode timer fired"),y.fsm.onIncallModeTimer()},this.options.incallModeTimeoutMs)},P.prototype.enterIncallMode=function(){this.logger.info("Entering incall mode"),this.timeoutOptions=this.options.incallTimeoutOptions,this.healthBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.tokenBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.inIncallMode=!0},P.prototype.exitIncallMode=function(){this.logger.info("Exiting incall mode"),this.clearIncallModeTimerId(),this.timeoutOptions=this.options.timeoutOptions,this.healthBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.tokenBackoff.setMaxBackoffMs(this.timeoutOptions.maxBackoffMs),this.inIncallMode=!1},P.prototype.isIncallMode=function(){return this.inIncallMode},P.prototype.onSocketConnecting=function(y){this.logger.info("onSocketConnecting("+y+")"),this.transportTypeName=y,this.connectionTracker.trackProgress("connecting",this.transportTypeName),this.fsm.onConnecting()},P.prototype.onSocketConnect=function(){this.logger.info("onSocketConnect")},P.prototype.onSocketConnectFailed=function(y){this.logger.error("onSocketConnectFailed"),this.connectionTracker.trackError("connect_failed",y,!0,this.transportTypeName?this.transportTypeName:this.UNKNOWN_TRANSPORT),this.fsm.onConnectingFailed()},P.prototype.onSocketDisconnect=function(y){this.logger.error("onSocketDisconnect, reason: "+y);var M={reason:y,serverClosed:!this.fsm.isActive()};this.connectionTracker.trackDisconnected(M),this.connectionTracker.clearConnectedInfo();var U=M.sessionLengthMS||0;"dup"===y&&"dup"===this.lastDisconnectReason&&U<this.options.duplicateDisconnectThresholdMs&&(this.logger.warn("Socket was closed by server as Duplicate for the second time in a row after "+U+" ms which is below the threshold of "+this.options.duplicateDisconnectThresholdMs+" ms. Resetting cached connection parameters and making a new allocation."),this.resetAllocationConnectionParams()),this.lastDisconnectReason=y,this.fsm.onSocketError(void 0),this.connectionExpireTimestampInSecs=void 0},P.prototype.onSocketReconnect=function(){this.logger.error("onSocketReconnect"),this.fsm.onTrouterConnected()},P.prototype.onSocketReconnectFailed=function(y){this.logger.error("onSocketReconnectFailed with '"+y+"'"),this.fsm.onSocketError("string"==typeof y?y:void 0)},P.prototype.onSocketReconnecting=function(){this.logger.error("onSocketReconnecting")},P.prototype.onSocketError=function(y){this.logger.error("onSocketError with '"+p.toJson(y)+"'"),this.connectionTracker.trackError("connectSocket",y),this.fsm.onSocketError("string"==typeof y?y:void 0)},P.prototype.onSocketMessage=function(y){var U,M=this;this.logger.info("onSocketMessage");try{var $=(U=new R(y)).headers&&U.headers["X-Microsoft-Skype-Chain-ID"];this.logger.info("Received request N "+U.id+($?" Chain-Id "+$:"")+" CV "+U.correlationVector+" to '"+U.url+"'"),U.startTS=Date.now(),U.url&&this.urlPath&&0===U.url.indexOf(this.urlPath)&&(U.shortUrl=U.url.substring(this.urlPath.length))}catch(Z){var ue=p.toJson(Z.stack);return this.logger.error("unable to parse request. Error: "+ue),this.connectionTracker.trackRequest(void 0,ue),void this.connectionTracker.sendResponseError("unable to parse request, error: "+Z)}U.timeoutTimerId=setTimeout(function(){if(!U.replied){M.logger.error("Request "+U.id+" timed out");var Z=new E.ResponseData(U.id);Z.status=504,Z.headers={"Trouter-Responder":"ClientLib"},M.sendResponse(U,Z),U.timedout=!0}},this.timeoutOptions.requestTimeoutMs);try{this.connectionTracker.trackRequest(U),this.fsm.onDownstreamRequest(U)}catch(Z){this.logger.error("exception in socket.on message. Error: "+p.toJson(Z.stack)),this.connectionTracker.sendResponseError(Z.message,U,void 0)}},P.prototype.onTrouterConnected=function(y){if(this.allocateResult){this.logger.info("onTrouterConnected: "+this.allocateResult.url),this.socket&&this.socket.socket&&this.socket.socket.options&&this.socket.socket.options.query&&(this.socket.socket.options.query+="&connected=true"),this.urlPath=this.allocateResult.url.replace(/https?:\/\/([A-z0-9\:\$\-\_\.\+\!\*\"\(\)\,]*)\//,"/");var M=this.connectedUrl!==this.allocateResult.url;this.connectedUrl=this.allocateResult.url,this.connectionExpireTimestampInSecs=p.calculateExpireTsInSec(y.ttl),this.connectionTracker.trackEnd("connectSocket"),this.connectionTracker.trackConnected(M,this.transportTypeName?this.transportTypeName:this.UNKNOWN_TRANSPORT),this.fsm.onTrouterConnected()}else this.logger.error("Invalid internal state - received onTrouterConnected while allocateResult is not set")},P.prototype.onTrouterReconnect=function(){this.logger.info("onTrouterReconnect"),this.fsm.onReconnectRequired()},P.prototype.onTrouterMessageLoss=function(y){this.logger.info("onTrouterMessageLoss"),this.fsm.onTrouterMessageLost(y.droppedIndicators)},P.prototype.onAllocationResponse=function(y,M){if(this.logger.info("Received allocation response "+JSON.stringify(y)),this.allocateResult=y,this.externalConnectParams=void 0,this.connectionExpireTimestampInSecs=p.calculateExpireTsInSec(+y.ttl),this.connectionId=this.allocateResult.id||"",this.connectedClientId=this.allocateResult.ccid,this.logger.info("connected client id set {connectedClientId:"+this.connectedClientId+"}"),this.c2cUrlBase=y.curlb||"",""===this.c2cUrlBase){var $=y.surl.indexOf("://");$>=0&&($=y.surl.indexOf("/",$+3))>=5&&":3443"===y.surl.substr($-5,5)&&(this.c2cUrlBase=y.surl.substr(0,$-5))}var j=s({serviceUrl:M,reconnectUrl:y.socketio+"v4/a"},y.connectparams);this.manager.onConnectionParametersUpdated(j),this.fsm.onAllocationSucceed()},P.prototype.onPingResponse=function(){this.logger.info("onPingResponse"),this.connectionTracker.increasePingResponseCount(),this.clearPingResponseTimer(),this.fsm.onPingResponse()},P.prototype.clearPingResponseTimer=function(){void 0!==this.pingResponseTimerId&&(clearTimeout(this.pingResponseTimerId),this.pingResponseTimerId=void 0)},P.prototype.buildQuery=function(y){for(var M=[],U=0,$=Object.keys(y);U<$.length;U++){var j=$[U];y.hasOwnProperty(j)&&void 0!==y[j]&&M.push(j+"="+y[j])}return M.join("&")},P.prototype.appendConnectedClientIds=function(y,M){var U="";y.indexOf("ccid=")<0&&(U="ccid="+this.connectedClientId+"&"),this.domId&&(U+="dom="+this.domId+"&"),U.length>0&&(U=U.slice(0,-1));var $=M||-1!==y.indexOf("?")?"&":"?";return this.appendCorrelationIds(y+$+U,M)},P.prototype.appendEndpointId=function(y,M){var U=M||-1!==y.indexOf("?")?"&":"?";return y.indexOf("epid")<0&&this.options.endpointId?""+y+U+"epid="+this.options.endpointId:y},P.prototype.appendCorrelationIds=function(y,M){var U=M||-1!==y.indexOf("?")?"&":"?";return y.indexOf("cor_id")<0?""+y+U+"cor_id="+this.options.clientCorrelationID+"&con_num="+this.clientID+"_"+this.connectionAttempt:y},P.prototype.getHealthUrl=function(y){return y.substring(0,y.lastIndexOf("/a"))+"/h"},P.prototype.safeString=function(y){return"string"==typeof y?y:""},P.prototype.sendResponse=function(y,M){if(y.timedout)return this.logger.error("Request "+y.id+" already timed out"),1;if(y.replied)return this.logger.error("Response for request "+y.id+" already sent"),2;clearTimeout(y.timeoutTimerId),y.timeoutTimerId=0,y.replied=!0,M.headers=M.headers||{};var U=y.correlationVector;this.logger.info("Sending response for request N "+y.id+" CV "+U+" with status "+M.status),U&&(M.headers[C]=U),y.headers&&y.headers["trouter-request"]&&!M.headers["trouter-request"]&&(M.headers["trouter-request"]=y.headers["trouter-request"]);var $=Date.now()-y.startTS;if(M.headers["trouter-client"]=p.toJson({cd:$}),this.logger.debug("response: "+p.toJson(M)),!this.socket)return this.connectionTracker.sendResponseError("no socket",y,M),4;try{return this.socket.send(p.toJson(M)),M.sentTS=Date.now(),y.incrementCorrelationVector(),this.connectionTracker.trackResponse(y,$,M),"websocket"===this.transportTypeName&&this.sendPingRequest(),0}catch(ue){var j="unable to send data on response.end. Error: "+p.toJson(ue.stack);return this.logger.error(j),this.connectionTracker.sendResponseError(j,y,M),4}},P.prototype.sendUserActivityStateMultiple=function(y){var M=this,U=new _("user.activity"),$=this.userActivityState.toEventObject();U.args=$,this.userActivityState.correlationVector.increase(),this.logger.debug("Sending user activity '"+this.userActivityState.toEventJSON()+"', remaining "+(y-1)),this.sendDownstreamEvent(U,function(){if(M.logger.info("User activity state: "+$.state+", cv: "+$.cv+" accepted"),M.manager.onUserActivityStateAccepted&&M.manager.onUserActivityStateAccepted($.cv),M.clearTimer(U.timeoutTimerId),y>1){var j=setTimeout(function(){M.clearTimer(j),M.sendUserActivityStateMultiple(y-1)},M.options.userActivitySecondResendDelayMs);M.registerTimer(j,"user.activity/resend")}}),U.timeoutTimerId=setTimeout(function(){M.logger.error("Activity state response timeout is fired"),M.fsm.onActivityStateResponseTimeout(),M.clearTimer(U.timeoutTimerId)},this.timeoutOptions.userActivityResponseTimeoutMs),this.registerTimer(U.timeoutTimerId,"user.activity/response")},P.prototype.sendDownstreamEvent=function(y,M){this.logger.info("Sending downstream event "+y.name),this.socket&&this.socket.emit(y.name,y.args,M)},P.prototype.registerTimer=function(y,M){this.logger.debug("registering timer "+y+" -> "+M),this.pendingTimers[y]=M},P.prototype.clearTimer=function(y){this.logger.debug("clearing timer "+y+" -> "+this.pendingTimers[y]),delete this.pendingTimers[y],clearTimeout(y)},P.prototype.getRegistrationTtl=function(){var y=p.calculateTtlInSec(this.connectionExpireTimestampInSecs);return this.logger.debug("Current connectionID will expire in "+y+" seconds"),this.options.registration&&this.options.registration.registrarTtlSec&&y>0?Math.min(this.options.registration.registrarTtlSec,y):this.options.registration&&this.options.registration.registrarTtlSec?this.options.registration.registrarTtlSec:y>0?y:3600},P.prototype.clearIncallModeTimerId=function(){void 0!==this.incallModeTimerId&&(this.logger.debug("Clearing in-call mode timer"),clearTimeout(this.incallModeTimerId),this.incallModeTimerId=void 0)},P.prototype.applyConnectionTrackerOptions=function(y){try{y.eventLogger&&"function"==typeof y.eventLogger.logEvent?(this.connectionTracker.mergeSettings(y.telemetrySettings),this.connectionTracker.enable(y.eventLogger)):this.logger.warn("Trouter client event logging disabled due to invalid configuration.")}catch(M){this.logger.warn("Trouter client event logging disabled. Error: "+p.toJson(M.stack)),this.connectionTracker.disable()}},P}();m.TrouterConnection=N},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var s,d,p,b=u(5),h=u(0);(d=s=m.State||(m.State={}))[d.Initial=0]="Initial",d[d.RetrievingToken=1]="RetrievingToken",d[d.Allocating=2]="Allocating",d[d.Handshaking=3]="Handshaking",d[d.Connecting=4]="Connecting",d[d.Connected=5]="Connected",d[d.UnregisteringRetrievingToken=6]="UnregisteringRetrievingToken",d[d.Unregistering=7]="Unregistering",function(d){d[d.Initial=0]="Initial",d[d.RetrievingToken=1]="RetrievingToken",d[d.Registering=2]="Registering",d[d.Registered=3]="Registered",d[d.NotRegistered=4]="NotRegistered"}(p||(p={}));var E=function(){function d(T,A,I){this.worker=A,this.incallModeEnabled=I,this.state=s.Initial,this.connectionErrors=0,this.logger=new h.Logger("ConnectionFsm",T),this.connectedSubstate=p.Initial}return d.prototype.getState=function(){return this.state},d.prototype.isActive=function(){return this.state===s.Allocating||this.state===s.Connected||this.state===s.Handshaking||this.state===s.Connecting||this.state===s.RetrievingToken},d.prototype.start=function(){return this.state===s.Initial?(this.setState(s.RetrievingToken),this.worker.getToken(!0,!1),!0):(this.showIgnored("start"),!1)},d.prototype.stop=function(T){T&&(this.connectedSubstate=p.Initial),this.worker.isIncallMode()&&this.worker.exitIncallMode(),this.worker.resetTokenBackoff(),this.worker.resetRegisterBackoff(),this.worker.stopConnectionTimer(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.state!==s.Connecting&&this.state!==s.Handshaking&&this.state!==s.Connected||this.worker.stopSocketIo(),this.isRegistered()&&this.state!==s.UnregisteringRetrievingToken&&this.state!==s.Unregistering?(this.setState(s.UnregisteringRetrievingToken),this.worker.stopRegisterTimer(),this.worker.getToken(!0,!1)):(this.setState(s.Initial),this.worker.dispatchDisconnected())},d.prototype.onTokenReceived=function(T){this.state===s.RetrievingToken?(this.setState(s.Allocating),this.worker.startConnectionTimer(),this.worker.sendAllocateRequest(T)):this.state===s.Connected&&this.connectedSubstate===p.RetrievingToken?(this.connectedSubstate=p.Registering,this.worker.sendRegisterRequest()):this.state===s.UnregisteringRetrievingToken?(this.setState(s.Unregistering),this.worker.sendUnregisterRequest()):this.showIgnored("onTokenReceived")},d.prototype.checkConnection=function(T){T&&this.onPingInterval()},d.prototype.onAllocationSucceed=function(){return this.state===s.Allocating?(this.setState(s.Handshaking),this.connectedSubstate===p.Registered&&this.worker.dispatchUnregistered(),this.connectedSubstate=p.Initial,this.worker.startSocketIo(),!0):(this.showIgnored("onAllocationSucceed"),!1)},d.prototype.onAllocationFailed=function(T){this.state===s.Allocating?(this.setState(s.RetrievingToken),this.worker.stopConnectionTimer(),this.worker.getToken(!T,!0)):this.showIgnored("onAllocationFailed")},d.prototype.onConnectingTimeout=function(){this.state===s.Allocating||this.state===s.Connecting||this.state===s.Handshaking?(this.setState(s.RetrievingToken),this.resetAllocationIfNecessary(void 0),this.worker.stopSocketIo(),this.worker.getToken(!0,!1)):this.showIgnored("onConnectingTimeout")},d.prototype.onConnecting=function(){this.state===s.Handshaking?this.setState(s.Connecting):this.showIgnored("onConnecting")},d.prototype.onConnectingFailed=function(){this.state===s.Connecting?this.onConnectingTimeout():this.state===s.Handshaking?(this.logger.error("Unexpected error in Socket.io - no valid transports"),this.onConnectingTimeout()):this.showIgnored("onConnectingFailed")},d.prototype.onSocketError=function(T){this.state===s.Handshaking||this.state===s.Connected?(this.worker.stopSocketIo(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopConnectionTimer(),this.state!==s.Connected&&this.worker.resetAllocationConnectionParams(),this.setState(s.RetrievingToken),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)):this.showIgnored("onSocketError")},d.prototype.onTrouterConnected=function(){this.state===s.Connecting?(this.setState(s.Connected),this.worker.resetTokenBackoff(),this.worker.stopConnectionTimer(),this.worker.sendUserActivityState(b.UserActivityEventReason.Connected,!0),this.worker.startPingTimer(),this.worker.dispatchConnected(),this.connectionErrors=0,this.worker.shouldSkipRegistration()?(this.connectedSubstate=p.NotRegistered,this.worker.dispatchRegistered()):(this.connectedSubstate=p.RetrievingToken,this.worker.getToken(!0,!1))):this.showIgnored("onTrouterConnected")},d.prototype.onReconnectRequired=function(){this.worker.dispatchReconnectIsRequired()},d.prototype.onDownstreamRequest=function(T){this.state===s.Connected?(this.switchToIncallModeIfEnabled(),this.worker.dispatchDownstreamRequest(T)):this.showIgnored("onDownstreamRequest")},d.prototype.onTrouterMessageLost=function(T){this.state===s.Connected?this.worker.dispatchTrouterMessageLost(T):this.showIgnored("onTrouterMessageLost")},d.prototype.onPingInterval=function(){this.state===s.Connected?this.worker.sendPingRequest():this.showIgnored("onPingInterval")},d.prototype.onPingResponseTimeout=function(){this.onMissedResponse("onPingResponseTimeout")},d.prototype.onPingResponse=function(){this.state===s.Connected||this.showIgnored("onPingResponse")},d.prototype.onRegistrationFailed=function(T){this.state===s.Connected&&this.connectedSubstate===p.Registering?(this.connectedSubstate=p.RetrievingToken,this.worker.getToken(!T,!0)):this.showIgnored("onRegistrationFailed")},d.prototype.onRegistrationSucceed=function(){this.state===s.Connected?(this.connectedSubstate===p.Registering&&(this.connectedSubstate=p.Registered,this.worker.dispatchRegistered()),this.worker.hasCustomRegisterTtl()&&this.worker.startRegisterTimer()):this.showIgnored("onRegistrationSucceed")},d.prototype.onRegistrationTimeout=function(){this.state===s.Connected&&this.connectedSubstate!==p.NotRegistered?(this.connectedSubstate=p.RetrievingToken,this.worker.getToken(!0,!1)):this.showIgnored("onRegistrationTimeout")},d.prototype.onUnregistrationFailed=function(T){this.state===s.Unregistering?(this.setState(s.UnregisteringRetrievingToken),this.worker.getToken(!T,!T)):this.showIgnored("onUnregistrationFailed")},d.prototype.onUnregistrationSucceed=function(){this.state===s.Unregistering?(this.setState(s.Initial),this.worker.dispatchUnregistered(),this.worker.dispatchDisconnected()):this.showIgnored("onUnregistrationSucceed")},d.prototype.onIncallModeTimer=function(){this.worker.exitIncallMode(),this.state===s.Connected?(this.worker.stopPingTimer(),this.worker.startPingTimer()):this.showIgnored("onIncallModeTimer")},d.prototype.onSetUserActivityState=function(T,A){A?(this.logger.info("Changing user activity state to '"+T.toEventJSON()+"'"),this.worker.sendUserActivityState(b.UserActivityEventReason.Modified,this.state===s.Connected)):this.logger.debug("Not changing the same user activity state '"+T.toEventJSON()+"'")},d.prototype.onActivityStateResponseTimeout=function(){this.onMissedResponse("onActivityStateResponseTimeout")},d.prototype.forceReconnect=function(){this.setState(s.RetrievingToken),this.worker.resetTokenBackoff(),this.worker.stopConnectionTimer(),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopSocketIo(),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)},d.prototype.onMissedResponse=function(T){this.state===s.Connected?(this.setState(s.RetrievingToken),this.worker.stopPingTimer(),this.worker.clearTimers(),this.worker.stopSocketIo(),this.worker.dispatchReconnecting(),this.worker.getToken(!0,!1)):this.showIgnored(T)},d.prototype.showIgnored=function(T){this.logger.debug("Ignoring event '"+T+"' in state '"+s[this.state]+"'")},d.prototype.setState=function(T){this.logger.info("Switching from state '"+s[this.state]+"' to state '"+s[T]+"'"),this.state!==T?this.state=T:this.logger.error("Attempt to switching into the current state '"+s[T]+"'")},d.prototype.resetAllocationIfNecessary=function(T){this.connectionErrors++,this.connectionErrors>=2||void 0!==T&&/^4\d\d /.test(T)?(this.logger.error("Connection error count is "+this.connectionErrors+" - will reset allocation"),this.connectionErrors=0):this.logger.info("Connection error count is "+this.connectionErrors+" - will NOT reset allocation")},d.prototype.isRegistered=function(){return this.connectedSubstate===p.Registered||this.connectedSubstate===p.Registering},d.prototype.switchToIncallModeIfEnabled=function(){this.incallModeEnabled&&(this.worker.isIncallMode()||(this.worker.enterIncallMode(),this.worker.stopPingTimer(),this.worker.startPingTimer()),this.worker.restartIncallModeTimer())},d}();m.TrouterFsm=E},function(Q,m,u){Object.defineProperty(m,"__esModule",{value:!0});var s=u(2),b=u(0),h=function(){function p(E,d){this.worker=d,this.state=s.TrouterState.Unknown,this.logger=new b.Logger("ManagerFsm",E)}return p.prototype.start=function(){this.state===s.TrouterState.Unknown?(this.setState(s.TrouterState.Disconnected),this.worker.forceStopLingeringConnection(),this.worker.startFirstConnection()):this.showIgnored("start")},p.prototype.stop=function(E){this.state!==s.TrouterState.Unknown?(this.setState(s.TrouterState.Unknown),this.worker.stopFirstConnection(!0===E),this.worker.stopSecondConnection(!0===E)):this.showIgnored("stop")},p.prototype.getState=function(){return this.state},p.prototype.onConnected=function(E){this.state===s.TrouterState.Disconnected&&E?this.worker.doesSecondConnectionExist()?this.setState(s.TrouterState.Switching):(this.setState(s.TrouterState.Connected),this.worker.dispatchConnected()):this.showIgnored("onConnected("+E+")")},p.prototype.onRegistered=function(E){this.state!==s.TrouterState.Disconnected||E?this.state!==s.TrouterState.Switching||E||(this.setState(s.TrouterState.Connected),this.worker.switchConnections(),this.worker.stopSecondConnectionDelayed(),this.worker.dispatchConnected()):(this.setState(s.TrouterState.Connected),this.worker.switchConnections(),this.worker.stopSecondConnection(!0),this.worker.dispatchConnected()),this.worker.dispatchRegistrationState(!0)},p.prototype.onUnregistered=function(E){E&&this.worker.dispatchRegistrationState(!1)},p.prototype.onReconnecting=function(E){this.state===s.TrouterState.Connected&&E||this.state===s.TrouterState.Switching&&E?(this.setState(s.TrouterState.Disconnected),this.worker.dispatchReconnecting()):this.showIgnored("onReconnecting("+E+")")},p.prototype.onReconnectionRequired=function(E){this.state===s.TrouterState.Connected&&E?(this.setState(s.TrouterState.Switching),this.worker.startSecondConnection()):this.state===s.TrouterState.Disconnected&&E?this.worker.startSecondConnection():this.showIgnored("onReconnectionRequired("+E+")")},p.prototype.onDisconnected=function(E){this.state===s.TrouterState.Unknown&&E?this.worker.dispatchStopped():this.showIgnored("onDisconnected("+E+")")},p.prototype.showIgnored=function(E){this.logger.info("Ignoring event '"+E+"' in state '"+s.TrouterState[this.state]+"'")},p.prototype.setState=function(E){this.logger.info("Switching from state '"+s.TrouterState[this.state]+"' to state '"+s.TrouterState[E]+"'"),this.state!==E?this.state=E:this.logger.error("Attempt to switching into the current state '"+s.TrouterState[E]+"'")},p}();m.TrouterManagerFsm=h},function(Q,m,u){function s(D,_){if(!_)return D;var N=d({},D,{enabled:_.TelemetryEnabled});return void 0!==_.ClientTelemetryEventEnabled&&(N=d({},N,_.ClientTelemetryEventEnabled)),N}function b(D,_){return{clientInfo:{ua:D.trouterSettings.productName,v:D.trouterSettings.version},ioOptions:{ackTimeoutMs:5e3},clientCorrelationID:D.trouterSettings.sessionId,environment:D.trouterSettings.environment,telemetrySettings:s(D.telemetryConfig.settings,_),eventLogger:D.telemetryConfig.eventLogger,endpointId:D.trouterSettings.registrationId,trouterUrl:_&&_.TrouterConnectionUrl||D.trouterSettings.trouterServiceUrl,registration:D.trouterSettings.registrarServiceUrl?{registrarUrl:D.trouterSettings.registrarServiceUrl,registrationId:D.trouterSettings.registrationId||"",pnhAppId:D.trouterSettings.pnhAppId||"",platform:D.trouterSettings.platform||"",pnhTemplateKey:D.trouterSettings.pnhTemplate||"",platformUIVersion:D.trouterSettings.platformUIVersion||"",productContext:D.trouterSettings.pnhProductContext||void 0,context:D.trouterSettings.pnhContext||"",registrarTtlSec:(D.trouterSettings.maxRegistrationTimeInMs||0)/1e3}:void 0,timeoutOptions:d({connectionTimeoutMs:D.trouterSettings.trouterConnectTimeoutInMs||3e4,fetchTimeoutMs:1e4,pingTimeoutMs:4e4,pongTimeoutMs:5e3,maxBackoffMs:3e4,requestTimeoutMs:5e3,userActivityResponseTimeoutMs:1e4},D.trouterSettings.timeoutOptions),incallTimeoutOptions:d({connectionTimeoutMs:1e4,fetchTimeoutMs:5e3,pingTimeoutMs:5e3,pongTimeoutMs:2e3,maxBackoffMs:1e4,requestTimeoutMs:5e3,userActivityResponseTimeoutMs:1e4},D.trouterSettings.incallTimeoutOptions),incallModeTimeoutMs:D.trouterSettings.incallModeTimeoutMs||0,lingeringConnectionDelayMs:6e4,userActivitySecondResendDelayMs:D.trouterSettings.userActivitySecondResendDelayMs||1e4,duplicateDisconnectThresholdMs:1e4,connectionCache:D.connectionCache,registrationStateCallback:D.registrationStateCallbackForAcsDoNotUse}}var d=this&&this.__assign||Object.assign||function(D){for(var _,N=1,P=arguments.length;N<P;N++)for(var y in _=arguments[N])Object.prototype.hasOwnProperty.call(_,y)&&(D[y]=_[y]);return D},T=this&&this.__awaiter||function(D,_,N,P){return new(N||(N=Promise))(function(y,M){function U(ue){try{j(P.next(ue))}catch(Z){M(Z)}}function $(ue){try{j(P.throw(ue))}catch(Z){M(Z)}}function j(ue){ue.done?y(ue.value):new N(function(Z){Z(ue.value)}).then(U,$)}j((P=P.apply(D,_||[])).next())})},A=this&&this.__generator||function(D,_){function N(ue){return function(Z){return function(ue){if(y)throw new TypeError("Generator is already executing.");for(;j;)try{if(y=1,M&&(U=2&ue[0]?M.return:ue[0]?M.throw||((U=M.return)&&U.call(M),0):M.next)&&!(U=U.call(M,ue[1])).done)return U;switch(M=0,U&&(ue=[2&ue[0],U.value]),ue[0]){case 0:case 1:U=ue;break;case 4:return j.label++,{value:ue[1],done:!1};case 5:j.label++,M=ue[1],ue=[0];continue;case 7:ue=j.ops.pop(),j.trys.pop();continue;default:if(!(U=(U=j.trys).length>0&&U[U.length-1])&&(6===ue[0]||2===ue[0])){j=0;continue}if(3===ue[0]&&(!U||ue[1]>U[0]&&ue[1]<U[3])){j.label=ue[1];break}if(6===ue[0]&&j.label<U[1]){j.label=U[1],U=ue;break}if(U&&j.label<U[2]){j.label=U[2],j.ops.push(ue);break}U[2]&&j.ops.pop(),j.trys.pop();continue}ue=_.call(D,j)}catch(Z){ue=[6,Z],M=0}finally{y=U=0}if(5&ue[0])throw ue[1];return{value:ue[0]?ue[1]:void 0,done:!0}}([ue,Z])}}var y,M,U,$,j={label:0,sent:function(){if(1&U[0])throw U[1];return U[1]},trys:[],ops:[]};return $={next:N(0),throw:N(1),return:N(2)},"function"==typeof Symbol&&($[Symbol.iterator]=function(){return this}),$};Object.defineProperty(m,"__esModule",{value:!0});var I=u(1),f=u(2);m.TrouterState=f.TrouterState,m.UserActivityState=f.UserActivityState;var c=u(0),v=u(6),S=u(7),g=u(8),C=u(9),R=function(){function D(_){this.logProvider=_,this.stateChangedListeners=[],this.logger=new c.Logger("Trouter",_),this.trouterUrlPromise=new C.TrouterUrlPromise(_),this.messageHandlers=new v.MessageHandlerRegistry(_),this.listeners={},this.connectionInfo=null,this.logger.info("Created TrouterService version "+I.CLIENT_VERSION)}return D.prototype.start=function(_){this.logger.info("Start"),_.trouterSettings.disableInternalSkypeTokenCache||(_.skypeTokenProvider=S.addCacheAsBackupTo(_.skypeTokenProvider)),this.trouterCfg=_;var P=b(_,this.ecsCfg);void 0===this.trouterServer&&(this.trouterServer=new g.TrouterManager(this.logProvider,P,_.skypeTokenProvider,this)),this.trouterServer.start()},D.prototype.stop=function(_){this.logger.info("close connection"),this.trouterUrlPromise.rejectUrl(new Error("TrouterService is stopped")),void 0!==this.trouterServer&&this.trouterServer.stop(_)},D.prototype.setEcsConfig=function(_){return T(this,void 0,void 0,function(){var N=this;return A(this,function(P){return[2,new Promise(function(y,M){if(N.ecsCfg=_.TrouterJScriptClient,N.logger.info("Setting ECS configuration to "+JSON.stringify(N.ecsCfg)),void 0!==N.trouterServer&&void 0!==N.trouterCfg){var U=b(N.trouterCfg,N.ecsCfg);N.trouterServer.configure(U)}y()})]})})},D.prototype.checkConnection=function(_){void 0!==this.trouterServer&&this.trouterServer.checkConnection(_||!1)},D.prototype.resendRegistration=function(){return T(this,void 0,void 0,function(){return A(this,function(_){if(!this.trouterServer)throw new Error("resendRegistration called too early");return[2,this.trouterServer.resendRegistration()]})})},D.prototype.registerListener=function(_,N){return""===N||"/"!==N[0]||N.indexOf("?")>=0||N.indexOf("#")>=0?(this.logger.error("Listener path '"+N+"' is not valid"),!1):this.listeners[N]?(this.logger.error("Another listener is already registered for path '"+N+"'"),!1):(this.listeners[N]=_,this.logger.debug("Listener for path '"+N+"' registered"),this.connectionInfo&&_.onTrouterConnected(this.connectionInfo.baseEndpointUrl+N,this.connectionInfo),!0)},D.prototype.unregisterListener=function(_){for(var N=[],P=0,y=Object.keys(this.listeners);P<y.length;P++)this.listeners[M=y[P]]===_&&N.push(M);if(0===N.length)return!1;for(var U=0,$=N;U<$.length;U++){var M;delete this.listeners[M=$[U]]}return this.logger.debug("Listener for path(s) '"+N.join("', '")+"' unregistered"),!0},D.prototype.onTrouterConnected=function(_,N){this.logger.debug("Trouter is now connected");for(var P=0,y=Object.keys(this.listeners);P<y.length;P++){var M=y[P];try{this.listeners[M].onTrouterConnected(N.baseEndpointUrl+M,N)}catch(U){this.logger.error("Listener '"+M+"' threw an exception from onTrouterConnected(): "+U)}}this.connectionInfo=N,this.trouterUrlPromise.resolveUrl(_),this.notifyStateChanged(f.TrouterState.Connected,{url:_,getRemainingTtlInSec:function(){return N.connectionTtlSec}})},D.prototype.onTrouterDisconnected=function(){this.logger.debug("Trouter is now disconnected"),this.connectionInfo=null;for(var _=0,N=Object.keys(this.listeners);_<N.length;_++){var P=N[_],y=this.listeners[P];if(y.onTrouterDisconnected)try{y.onTrouterDisconnected()}catch(M){this.logger.error("Listener '"+P+"' threw an exception from onTrouterDisconnected(): "+M)}}this.notifyStateChanged(f.TrouterState.Disconnected)},D.prototype.onTrouterRequest=function(_,N){for(var P="",y=0,M=Object.keys(this.listeners);y<M.length;y++){var U=M[y];_.path.substring(0,U.length)===U&&U.length>P.length&&(P=U)}if(""===P)this.tryMessageHandlers(_,N)||(N.status=404,N.headers={"Trouter-Responder":"ClientLib"},N.send());else try{this.listeners[P].onTrouterRequest(_,N)}catch($){this.logger.error("Listener '"+P+"' threw an exception from onTrouterRequest(): "+$),N.status=500,N.headers={"Trouter-Responder":"ClientLib"},N.send()}},D.prototype.onTrouterMessageLoss=function(_){this.logger.info("onTrouterMessageLoss called with value "+_);for(var N=!0,P=0,y=Object.keys(this.listeners);P<y.length;P++){var M=y[P],U=this.listeners[M];if(U.onTrouterMessageLoss)try{void 0===(N=U.onTrouterMessageLoss(_)&&N)&&(this.logger.error("Listener '"+M+"' did not response with boolean value onTrouterMessageLoss()"),N=!1)}catch($){this.logger.error("Listener '"+M+"' threw an exception from onTrouterMessageLoss(): "+$),N=!1}}return N},D.prototype.onTrouterUserActivityStateAccepted=function(_){this.logger.debug("onTrouterUserActivityStateAccepted cv: "+_);for(var N=0,P=Object.keys(this.listeners);N<P.length;N++){var y=P[N],M=this.listeners[y];if(M.onTrouterUserActivityStateAccepted)try{M.onTrouterUserActivityStateAccepted(_)}catch(U){this.logger.error("Listener '"+y+"' threw an exception from onTrouterUserActivityStateAccepted(): "+U)}}},D.prototype.setUserActivityState=function(_,N){if(_!==f.UserActivityState.Active&&_!==f.UserActivityState.Inactive)throw new Error("setUserActivityState called with unsupported value "+_);if(this.logger.info("setUserActivityState called with value "+f.UserActivityState[_]),!this.trouterServer||this.state()===f.TrouterState.Unknown)throw new Error("setUserActivityState called too early");this.trouterServer.setUserActivityState(_,N)},D.prototype.state=function(){return void 0!==this.trouterServer?this.trouterServer.getState():f.TrouterState.Unknown},D.prototype.getServerState=function(){if(void 0!==this.trouterServer)return this.trouterServer.getServerState()},D.prototype.getTrouterUrlAsync=function(){return void 0!==this.trouterServer?this.trouterUrlPromise.getPromise():Promise.reject(new Error("TrouterService has not been started"))},D.prototype.onStateChanged=function(_){if(this.logger.info("onStateChanged called"),void 0===_)this.stateChangedListeners=this.stateChangedListeners.filter(function(P){return void 0===P.wrappedCallback});else{this.offStateChanged(_);var N=function(P,y){_(P,y?y.url:"")};N.wrappedCallback=_,this.stateChangedListeners.push(N)}},D.prototype.offStateChanged=function(_){this.logger.info("offStateChanged called");var N=this.stateChangedListeners.length;return this.stateChangedListeners=this.stateChangedListeners.filter(function(P){return P.wrappedCallback!==_}),N>this.stateChangedListeners.length},D.prototype.addCallback=function(_){this.logger.info("addListener called"),-1===this.stateChangedListeners.indexOf(_,0)&&void 0!==_&&this.stateChangedListeners.push(_)},D.prototype.removeCallback=function(_){this.logger.info("removeListener called");var N=this.stateChangedListeners.indexOf(_,0);return N>-1&&(this.stateChangedListeners.splice(N,1),!0)},D.prototype.registerMessageHandler=function(_){this.logger.info("registerMessageHandler is called"),this.messageHandlers.register(_)},D.prototype.clearMessageHandlers=function(){this.logger.info("clearMessageHandlers is called"),this.messageHandlers.clear()},D.prototype.notifyStateChanged=function(_,N){var P=this;this.logger.info("notifyStateChanged called, will forward to "+this.stateChangedListeners.length+" listeners"),this.stateChangedListeners.forEach(function(y){try{y(_,N)}catch(M){P.logger.error("Error in callback "+M)}})},D.prototype.tryMessageHandlers=function(_,N){if(!this.messageHandlers.active())return!1;var P,y=null;try{y=(P=JSON.parse(_.body))&&(P.evt||P.eventId)||null}catch($){}var U=this.messageHandlers.handleMessage({eventId:y,url:(this.connectionInfo?this.connectionInfo.baseEndpointUrl:"")+_.path,body:P,rawBody:_.body,headers:_.headers});return!!U.isHandled&&(N.status=U.resultCode,U.responseHeaders&&(N.headers=U.responseHeaders),U.responseBody&&(N.body=U.responseBody),N.send(),!0)},D}();m.TrouterService=R,m.createTrouterService=function(D){return new R(D)},m.getTrouterServiceVersion=function(){return I.CLIENT_VERSION},m.replaceTrouterUrlBase=function(D,_){var N=D.indexOf("://");if(N>=0){var P=D.indexOf("/",N+3);if(P>=0)return _+D.substr(P)}return""}},function(Q,m){Q.exports=__WEBPACK_EXTERNAL_MODULE_20__},function(Q,m){}])},module.exports=m(tsregistrar)});unwrapExports(tstrouter);var constants=createCommonjsModule(function(Q,m){var b;m.__esModule=!0,m.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES=3,m.GCCHIGH_TROUTER_SERVICE_URL="https://go.trouter.gov.teams.microsoft.us/v4/a",m.GCCHIGH_REGISTRAR_SERVICE_URL="https://registrar.gov.teams.microsoft.us/V3/registrations",m.DOD_TROUTER_SERVICE_URL="https://go.trouter.dod.teams.microsoft.us/v4/a",m.DOD_REGISTRAR_SERVICE_URL="https://registrar.dod.teams.microsoft.us/V3/registrations",m.INT_TROUTER_SERVICE_URL="https://go.trouter-int.skype.net/v4/a",m.INT_REGISTRAR_SERVICE_URL="https://edge.skype.net/registrar/testenv/v3/registrations",m.PUBLIC_TROUTER_SERVICE_URL="https://go.trouter.skype.com/v4/a",m.PUBLIC_REGISTRAR_SERVICE_URL="https://edge.skype.com/registrar/prod/v3/registrations",(b=m.CloudType||(m.CloudType={})).Public="Public",b.GccHigh="GCC High",b.Dod="DoD",function(b){b.OrgId="orgid",b.Acs="acs",b.Spool="spool",b.GccHigh="gcch",b.GccHighAcs="gcch-acs",b.Dod="dod",b.DodAcs="dod-acs"}(m.CloudPrefix||(m.CloudPrefix={}))});unwrapExports(constants);var constants_1=constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES,constants_2=constants.GCCHIGH_TROUTER_SERVICE_URL,constants_3=constants.GCCHIGH_REGISTRAR_SERVICE_URL,constants_4=constants.DOD_TROUTER_SERVICE_URL,constants_5=constants.DOD_REGISTRAR_SERVICE_URL,constants_6=constants.INT_TROUTER_SERVICE_URL,constants_7=constants.INT_REGISTRAR_SERVICE_URL,constants_8=constants.PUBLIC_TROUTER_SERVICE_URL,constants_9=constants.PUBLIC_REGISTRAR_SERVICE_URL,constants_10=constants.CloudType,constants_11=constants.CloudPrefix,TrouterUtils=createCommonjsModule(function(Q,m){var u=commonjsGlobal&&commonjsGlobal.__awaiter||function(R,D,_,N){return new(_||(_=Promise))(function(y,M){function U(ue){try{j(N.next(ue))}catch(Z){M(Z)}}function $(ue){try{j(N.throw(ue))}catch(Z){M(Z)}}function j(ue){ue.done?y(ue.value):function(y){return y instanceof _?y:new _(function(M){M(y)})}(ue.value).then(U,$)}j((N=N.apply(R,D||[])).next())})},s=commonjsGlobal&&commonjsGlobal.__generator||function(R,D){var N,P,y,M,_={label:0,sent:function(){if(1&y[0])throw y[1];return y[1]},trys:[],ops:[]};return M={next:U(0),throw:U(1),return:U(2)},"function"==typeof Symbol&&(M[Symbol.iterator]=function(){return this}),M;function U(j){return function(ue){return function(j){if(N)throw new TypeError("Generator is already executing.");for(;_;)try{if(N=1,P&&(y=2&j[0]?P.return:j[0]?P.throw||((y=P.return)&&y.call(P),0):P.next)&&!(y=y.call(P,j[1])).done)return y;switch(P=0,y&&(j=[2&j[0],y.value]),j[0]){case 0:case 1:y=j;break;case 4:return _.label++,{value:j[1],done:!1};case 5:_.label++,P=j[1],j=[0];continue;case 7:j=_.ops.pop(),_.trys.pop();continue;default:if(!(y=(y=_.trys).length>0&&y[y.length-1])&&(6===j[0]||2===j[0])){_=0;continue}if(3===j[0]&&(!y||j[1]>y[0]&&j[1]<y[3])){_.label=j[1];break}if(6===j[0]&&_.label<y[1]){_.label=y[1],y=j;break}if(y&&_.label<y[2]){_.label=y[2],_.ops.push(j);break}y[2]&&_.ops.pop(),_.trys.pop();continue}j=D.call(R,_)}catch(ue){j=[6,ue],P=0}finally{N=y=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}([j,ue])}}};m.__esModule=!0;var b=new Map([["chatMessageReceived",200],["typingIndicatorReceived",245],["readReceiptReceived",246],["chatMessageEdited",247],["chatMessageDeleted",248],["chatThreadCreated",257],["chatThreadPropertiesUpdated",258],["chatThreadDeleted",259],["participantsAdded",260],["participantsRemoved",261]]),h="8:orgid:",p="8:dod:",E="8:gcch:",d="8:teamsvisitor:";m.toMessageHandler=function(R,D){var _=b.get(R);return{handleMessage:function(N){var P=null;if((null==N?void 0:N.rawBody)&&(P=JSON.parse(N.rawBody)),null!==P&&P.eventId===_){var y=f(R,P);if(null!==y)return D(y),{isHandled:!0,resultCode:200}}}}};var f=function(R,D){if("chatMessageReceived"===R)return{threadId:(_=D).groupId,sender:c(_.senderId),senderDisplayName:_.senderDisplayName,recipient:c(_.recipientMri),id:_.messageId,createdOn:new Date(_.originalArrivalTime),version:_.version,type:_.messageType,message:_.messageBody,metadata:v(_.acsChatMessageMetadata)};if("chatMessageEdited"===R)return{threadId:(_=D).groupId,sender:c(_.senderId),senderDisplayName:_.senderDisplayName,recipient:c(_.recipientMri),id:_.messageId,createdOn:new Date(_.originalArrivalTime),version:_.version,message:_.messageBody,editedOn:new Date(_.edittime),type:_.messageType,metadata:v(_.acsChatMessageMetadata)};if("chatMessageDeleted"===R)return{threadId:(_=D).groupId,sender:c(_.senderId),senderDisplayName:_.senderDisplayName,recipient:c(_.recipientMri),id:_.messageId,createdOn:new Date(_.originalArrivalTime),version:_.version,deletedOn:new Date(_.deletetime),type:_.messageType};if("typingIndicatorReceived"===R)return{threadId:(_=D).groupId,sender:c(_.senderId),senderDisplayName:_.senderDisplayName,recipient:c(_.recipientMri),version:_.version,receivedOn:new Date(_.originalArrivalTime)};if("readReceiptReceived"===R){var _=D,y=JSON.parse(_.messageBody).consumptionhorizon.split(";");return{threadId:_.groupId,sender:c(_.senderId),senderDisplayName:"",recipient:c(_.recipientMri),chatMessageId:_.messageId,readOn:new Date(+y[1])}}if("chatThreadCreated"===R){_=D;var M=JSON.parse(unescape(_.createdBy)),U=JSON.parse(unescape(_.members)),$=JSON.parse(unescape(_.properties)),j={id:c(M.participantId),displayName:M.displayName},ue=U.map(function(be){return{id:c(be.participantId),displayName:be.displayName}});return{threadId:_.threadId,createdOn:new Date(_.createTime),createdBy:j,version:_.version,participants:ue,properties:$}}if("chatThreadPropertiesUpdated"===R){_=D;var Z=JSON.parse(unescape(_.editedBy)),Y=($=JSON.parse(unescape(_.properties)),{id:c(Z.participantId),displayName:Z.displayName});return{threadId:_.threadId,updatedOn:new Date(_.editTime),updatedBy:Y,version:_.version,properties:$}}if("chatThreadDeleted"===R){_=D;var W=JSON.parse(unescape(_.deletedBy)),ce={id:c(W.participantId),displayName:W.displayName};return{threadId:_.threadId,deletedOn:new Date(_.deleteTime),deletedBy:ce,version:_.version}}if("participantsAdded"===R){_=D;var Ce=JSON.parse(unescape(_.addedBy)),ne=JSON.parse(unescape(_.participantsAdded)),X={id:c(Ce.participantId),displayName:Ce.displayName};return ue=ne.map(function(Be){return{id:c(Be.participantId),displayName:Be.displayName,shareHistoryTime:new Date(Be.shareHistoryTime)}}),{threadId:_.threadId,addedOn:new Date(_.time),addedBy:X,version:_.version,participantsAdded:ue}}if("participantsRemoved"===R){_=D;var de=JSON.parse(unescape(_.removedBy)),te=JSON.parse(unescape(_.participantsRemoved)),K={id:c(de.participantId),displayName:de.displayName};return ue=te.map(function(Be){return{id:c(Be.participantId),displayName:Be.displayName,shareHistoryTime:new Date(Be.shareHistoryTime)}}),{threadId:_.threadId,removedOn:new Date(_.time),removedBy:K,version:_.version,participantsRemoved:ue}}return null};m.toLogProvider=function(R){return{log:function(){for(var D=[],_=0;_<arguments.length;_++)D[_]=arguments[_];return R.info(D)},warn:function(){for(var D=[],_=0;_<arguments.length;_++)D[_]=arguments[_];return R.warning(D)},error:function(){for(var D=[],_=0;_<arguments.length;_++)D[_]=arguments[_];return R.error(D)},debug:function(){for(var D=[],_=0;_<arguments.length;_++)D[_]=arguments[_];return R.verbose(D)},info:function(){for(var D=[],_=0;_<arguments.length;_++)D[_]=arguments[_];return R.verbose(D)}}},m.toTelemetrySender=function(R){return{logEvent:function(D){return R.info(D)}}};var c=function(R){return R.startsWith(h)?{kind:"microsoftTeamsUser",rawId:R,microsoftTeamsUserId:R.substring(h.length),isAnonymous:!1,cloud:"public"}:R.startsWith(p)?{kind:"microsoftTeamsUser",rawId:R,microsoftTeamsUserId:R.substring(p.length),isAnonymous:!1,cloud:"dod"}:R.startsWith(E)?{kind:"microsoftTeamsUser",rawId:R,microsoftTeamsUserId:R.substring(E.length),isAnonymous:!1,cloud:"gcch"}:R.startsWith(d)?{kind:"microsoftTeamsUser",rawId:R,microsoftTeamsUserId:R.substring(d.length),isAnonymous:!0}:R.startsWith("4:")?{kind:"phoneNumber",rawId:R,phoneNumber:R.substring("4:".length)}:R.startsWith("8:acs:")||R.startsWith("8:spool:")?{kind:"communicationUser",communicationUserId:R}:{kind:"unknown",id:R}},v=function(R){return null==R||""===R||"null"===R?{}:JSON.parse(R)};function S(R){return coreHttp.isNode?Buffer.from(R,"base64").toString():atob(R)}function C(R){switch(R.substring(0,R.indexOf(":"))){case constants.CloudPrefix.OrgId:case constants.CloudPrefix.Acs:case constants.CloudPrefix.Spool:return constants.CloudType.Public;case constants.CloudPrefix.GccHigh:case constants.CloudPrefix.GccHighAcs:return constants.CloudType.GccHigh;case constants.CloudPrefix.Dod:case constants.CloudPrefix.DodAcs:return constants.CloudType.Dod;default:return constants.CloudType.Public}}m.base64decode=S,m.getCloudTypeFromCredential=function(R){return u(void 0,void 0,void 0,function(){var D;return s(this,function(y){switch(y.label){case 0:return[4,R.getToken()];case 1:return D=y.sent(),[2,C(function(R){var _=(null==R?void 0:R.split("."))[1];if(void 0===_)throw new Error("Invalid token");return _=_.replace(/-/g,"+").replace(/_/g,"/"),JSON.parse(decodeURIComponent(escape(S(_))))}(null==D?void 0:D.token).skypeid)]}})})}});unwrapExports(TrouterUtils);var TrouterUtils_1=TrouterUtils.toMessageHandler,TrouterUtils_2=TrouterUtils.toLogProvider,TrouterUtils_3=TrouterUtils.toTelemetrySender,TrouterUtils_4=TrouterUtils.base64decode,TrouterUtils_5=TrouterUtils.getCloudTypeFromCredential,TrouterSettings=createCommonjsModule(function(Q,m){var u=commonjsGlobal&&commonjsGlobal.__awaiter||function(T,A,I,f){return new(I||(I=Promise))(function(v,S){function g(D){try{R(f.next(D))}catch(_){S(_)}}function C(D){try{R(f.throw(D))}catch(_){S(_)}}function R(D){D.done?v(D.value):function(v){return v instanceof I?v:new I(function(S){S(v)})}(D.value).then(g,C)}R((f=f.apply(T,A||[])).next())})},s=commonjsGlobal&&commonjsGlobal.__generator||function(T,A){var f,c,v,S,I={label:0,sent:function(){if(1&v[0])throw v[1];return v[1]},trys:[],ops:[]};return S={next:g(0),throw:g(1),return:g(2)},"function"==typeof Symbol&&(S[Symbol.iterator]=function(){return this}),S;function g(R){return function(D){return function(R){if(f)throw new TypeError("Generator is already executing.");for(;I;)try{if(f=1,c&&(v=2&R[0]?c.return:R[0]?c.throw||((v=c.return)&&v.call(c),0):c.next)&&!(v=v.call(c,R[1])).done)return v;switch(c=0,v&&(R=[2&R[0],v.value]),R[0]){case 0:case 1:v=R;break;case 4:return I.label++,{value:R[1],done:!1};case 5:I.label++,c=R[1],R=[0];continue;case 7:R=I.ops.pop(),I.trys.pop();continue;default:if(!(v=(v=I.trys).length>0&&v[v.length-1])&&(6===R[0]||2===R[0])){I=0;continue}if(3===R[0]&&(!v||R[1]>v[0]&&R[1]<v[3])){I.label=R[1];break}if(6===R[0]&&I.label<v[1]){I.label=v[1],v=R;break}if(v&&I.label<v[2]){I.label=v[2],I.ops.push(R);break}v[2]&&I.ops.pop(),I.trys.pop();continue}R=A.call(T,I)}catch(D){R=[6,D],c=0}finally{f=v=0}if(5&R[0])throw R[1];return{value:R[0]?R[1]:void 0,done:!0}}([R,D])}}};m.__esModule=!0;var b={version:"1.0.0",registrationId:"",sessionId:"",pnhAppId:"AcsWeb",pnhTemplate:"AcsWeb_Chat_1.2",platform:"SPOOL",platformUIVersion:"0.0.0",environment:"",productName:"acs-chat-web",trouterServiceUrl:constants.PUBLIC_TROUTER_SERVICE_URL,registrarServiceUrl:constants.PUBLIC_REGISTRAR_SERVICE_URL,registrarRefreshTimeoutInMs:35e4,timeoutOptions:{connectionTimeoutMs:2e4,fetchTimeoutMs:1e4,pingTimeoutMs:4e4,pongTimeoutMs:5e3,maxBackoffMs:5e4,requestTimeoutMs:5e3},maxRegistrationTimeInMs:72e5},h=function(){var T=b;return T.registrationId=coreHttp.generateUuid(),T.sessionId=coreHttp.generateUuid(),T};m.createSettings=function(T,A){return u(void 0,void 0,void 0,function(){var I,f,c;return s(this,function(v){switch(v.label){case 0:return"INT"!==(null==A?void 0:A.environment)?[3,1]:(I=function(){var T=h();return T.pnhAppId="cns-e2e-test",T.pnhTemplate="cns-e2e-test:1.2",T.registrarServiceUrl=constants.INT_REGISTRAR_SERVICE_URL,T.trouterServiceUrl=constants.INT_TROUTER_SERVICE_URL,T}(),[3,3]);case 1:return[4,TrouterUtils.getCloudTypeFromCredential(T)];case 2:f=v.sent(),I=f===constants.CloudType.GccHigh?function(){var T=h();return T.registrarServiceUrl=constants.GCCHIGH_REGISTRAR_SERVICE_URL,T.trouterServiceUrl=constants.GCCHIGH_TROUTER_SERVICE_URL,T}():f===constants.CloudType.Dod?function(){var T=h();return T.registrarServiceUrl=constants.DOD_REGISTRAR_SERVICE_URL,T.trouterServiceUrl=constants.DOD_TROUTER_SERVICE_URL,T}():h(),v.label=3;case 3:return I.maxRegistrationTimeInMs=null!==(c=null==A?void 0:A.registrationTimeInMs)&&void 0!==c?c:b.maxRegistrationTimeInMs,[2,I]}})})},m.defaultTelemetrySettings={enabled:!1}});unwrapExports(TrouterSettings);var TrouterSettings_1=TrouterSettings.createSettings,TrouterSettings_2=TrouterSettings.defaultTelemetrySettings,SignalingClient=createCommonjsModule(function(Q,m){var p,u=commonjsGlobal&&commonjsGlobal.__awaiter||function(p,E,d,T){return new(d||(d=Promise))(function(I,f){function c(g){try{S(T.next(g))}catch(C){f(C)}}function v(g){try{S(T.throw(g))}catch(C){f(C)}}function S(g){g.done?I(g.value):function(I){return I instanceof d?I:new d(function(f){f(I)})}(g.value).then(c,v)}S((T=T.apply(p,E||[])).next())})},s=commonjsGlobal&&commonjsGlobal.__generator||function(p,E){var T,A,I,f,d={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]};return f={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function c(S){return function(g){return function(S){if(T)throw new TypeError("Generator is already executing.");for(;d;)try{if(T=1,A&&(I=2&S[0]?A.return:S[0]?A.throw||((I=A.return)&&I.call(A),0):A.next)&&!(I=I.call(A,S[1])).done)return I;switch(A=0,I&&(S=[2&S[0],I.value]),S[0]){case 0:case 1:I=S;break;case 4:return d.label++,{value:S[1],done:!1};case 5:d.label++,A=S[1],S=[0];continue;case 7:S=d.ops.pop(),d.trys.pop();continue;default:if(!(I=(I=d.trys).length>0&&I[I.length-1])&&(6===S[0]||2===S[0])){d=0;continue}if(3===S[0]&&(!I||S[1]>I[0]&&S[1]<I[3])){d.label=S[1];break}if(6===S[0]&&d.label<I[1]){d.label=I[1],I=S;break}if(I&&d.label<I[2]){d.label=I[2],d.ops.push(S);break}I[2]&&d.ops.pop(),d.trys.pop();continue}S=E.call(p,d)}catch(g){S=[6,g],A=0}finally{T=I=0}if(5&S[0])throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}([S,g])}}};m.__esModule=!0,(p=m.ConnectionState||(m.ConnectionState={}))[p.Unknown=0]="Unknown",p[p.Connected=2]="Connected",p[p.Disconnected=3]="Disconnected",p[p.Switching=9]="Switching";var h=function(){function p(E,d,T){this.credential=E,this.logger=d,this.options=T,this.stateChangedListener=null,this.tokenFetchRetries=0,this.trouter=tstrouter.createTrouterService(TrouterUtils.toLogProvider(d))}return p.prototype.start=function(){return u(this,void 0,void 0,function(){var E,d,T=this;return s(this,function(A){switch(A.label){case 0:return void 0!==this.config?[3,2]:(E=this,d={},[4,TrouterSettings.createSettings(this.credential,this.options)]);case 1:E.config=(d.trouterSettings=A.sent(),d.skypeTokenProvider=function(I){return u(T,void 0,void 0,function(){var f,c;return s(this,function(v){switch(v.label){case 0:return I?(this.tokenFetchRetries+=1,this.tokenFetchRetries>constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES?[4,this.stop(!0)]:[3,2]):[3,3];case 1:throw v.sent(),new Error("Access token is expired and failed to fetch a valid one after "+constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES+" retries");case 2:return[3,4];case 3:this.tokenFetchRetries=0,v.label=4;case 4:return c=(f=Promise).resolve,[4,this.credential.getToken()];case 5:return[2,c.apply(f,[v.sent().token])]}})})},d.telemetryConfig={eventLogger:TrouterUtils.toTelemetrySender(this.logger),settings:TrouterSettings.defaultTelemetrySettings},d),A.label=2;case 2:return this.trouter.start(this.config),this.trouter.setUserActivityState(tstrouter.UserActivityState.Active),[2]}})})},p.prototype.stop=function(E){return u(this,void 0,void 0,function(){return s(this,function(d){return this.trouter.offStateChanged(this.stateChangedListener),this.trouter.clearMessageHandlers(),this.trouter.stop(null!=E?E:this.tokenFetchRetries>constants.MAX_NUMBER_OF_TOKEN_FETCH_RETRIES),[2]})})},p.prototype.on=function(E,d){if("connectionChanged"===E)return this.trouter.offStateChanged(this.stateChangedListener),this.stateChangedListener=function(T,A){return d(T)},void this.trouter.onStateChanged(this.stateChangedListener);this.trouter.registerMessageHandler(TrouterUtils.toMessageHandler(E,d))},p}();m.CommunicationSignalingClient=h});unwrapExports(SignalingClient);var SignalingClient_1=SignalingClient.ConnectionState,SignalingClient_2=SignalingClient.CommunicationSignalingClient,src=createCommonjsModule(function(Q,m){m.__esModule=!0,function(s){for(var b in s)m.hasOwnProperty(b)||(m[b]=s[b])}(SignalingClient)}),index=unwrapExports(src);module.exports=index},434:(Q,m,u)=>{"use strict";function s(b){return b&&"function"==typeof b.getToken&&(void 0===b.signRequest||b.getToken.length>0)}u.d(m,{c:()=>s})},50:(Q,m,u)=>{"use strict";function s(q){return q.toLowerCase()}function b(q){if(q&&"object"==typeof q){const k=q;if("function"==typeof k.rawHeaders&&"function"==typeof k.clone&&"function"==typeof k.get&&"function"==typeof k.set&&"function"==typeof k.contains&&"function"==typeof k.remove&&"function"==typeof k.headersArray&&"function"==typeof k.headerValues&&"function"==typeof k.headerNames&&"function"==typeof k.toJson)return!0}return!1}u.r(m),u.d(m,{AccessTokenRefresher:()=>ho,ApiKeyCredentials:()=>Ai,BaseRequestPolicy:()=>tt.U,BasicAuthenticationCredentials:()=>tn,Constants:()=>_i.g,DefaultHttpClient:()=>Ve,ExpiringAccessTokenCache:()=>Gn,HttpHeaders:()=>h,HttpPipelineLogLevel:()=>Ge.M,MapperType:()=>re,QueryCollectionFormat:()=>rr,RequestPolicyOptions:()=>tt._,RestError:()=>Pe,RetryMode:()=>Do,Serializer:()=>I,ServiceClient:()=>Ft,TopicCredentials:()=>Ca,URLBuilder:()=>$e.UK,URLQuery:()=>$e.$4,WebResource:()=>be,XML_ATTRKEY:()=>A.c,XML_CHARKEY:()=>A.I,applyMixins:()=>T.ef,bearerTokenAuthenticationPolicy:()=>rs.v,createPipelineFromOptions:()=>ni,createSpanFunction:()=>Di,delay:()=>lo.g,deserializationPolicy:()=>Kn,deserializeResponseBody:()=>ft,disableResponseDecompressionPolicy:()=>Oo,encodeUri:()=>T.Hh,executePromisesSequentially:()=>T.Zf,exponentialRetryPolicy:()=>wo,flattenResponse:()=>Br,generateClientRequestIdPolicy:()=>Sr,generateUuid:()=>T.Rl,getDefaultProxySettings:()=>ss,getDefaultUserAgentValue:()=>Wi,isDuration:()=>T._9,isNode:()=>T.UG,isTokenCredential:()=>Mo.c,isValidUuid:()=>T.TP,keepAlivePolicy:()=>Ei,logPolicy:()=>Mn,operationOptionsToRequestOptionsBase:()=>Le,parseXML:()=>Nt,promiseToCallback:()=>T._Q,promiseToServiceCallback:()=>T.yj,proxyPolicy:()=>Si,redirectPolicy:()=>_e,serializeObject:()=>te,signingPolicy:()=>wi,stringifyXML:()=>br,stripRequest:()=>T.Fl,stripResponse:()=>T.eg,systemErrorRetryPolicy:()=>Ki,throttlingRetryPolicy:()=>xo,tracingPolicy:()=>An,userAgentPolicy:()=>Po});class h{constructor(k){if(this._headersMap={},k)for(const L in k)this.set(L,k[L])}set(k,L){this._headersMap[s(k)]={name:k,value:L.toString()}}get(k){const L=this._headersMap[s(k)];return L?L.value:void 0}contains(k){return!!this._headersMap[s(k)]}remove(k){const L=this.contains(k);return delete this._headersMap[s(k)],L}rawHeaders(){return this.toJson({preserveCase:!0})}headersArray(){const k=[];for(const L in this._headersMap)k.push(this._headersMap[L]);return k}headerNames(){const k=[],L=this.headersArray();for(let G=0;G<L.length;++G)k.push(L[G].name);return k}headerValues(){const k=[],L=this.headersArray();for(let G=0;G<L.length;++G)k.push(L[G].value);return k}toJson(k={}){const L={};if(k.preserveCase)for(const G in this._headersMap){const oe=this._headersMap[G];L[oe.name]=oe.value}else for(const G in this._headersMap){const oe=this._headersMap[G];L[s(oe.name)]=oe.value}return L}toString(){return JSON.stringify(this.toJson({preserveCase:!0}))}clone(){const k={};for(const L in this._headersMap){const G=this._headersMap[L];k[G.name]=G.value}return new h(k)}}function E(q){let k="";for(let L=0;L<q.length;L++)k+=String.fromCharCode(q[L]);return btoa(k)}function d(q){const k=atob(q),L=new Uint8Array(k.length);for(let G=0;G<k.length;G++)L[G]=k.charCodeAt(G);return L}var T=u(7694),A=u(4510);class I{constructor(k={},L){this.modelMappers=k,this.isXML=L}validateConstraints(k,L,G){const oe=(ge,Ne)=>{throw new Error(`"${G}" with value "${L}" should satisfy the constraint "${ge}": ${Ne}.`)};if(k.constraints&&null!=L){const ge=L,{ExclusiveMaximum:Ne,ExclusiveMinimum:Ae,InclusiveMaximum:He,InclusiveMinimum:je,MaxItems:Fe,MaxLength:ut,MinItems:ht,MinLength:pt,MultipleOf:zt,Pattern:Vt,UniqueItems:mt}=k.constraints;null!=Ne&&ge>=Ne&&oe("ExclusiveMaximum",Ne),null!=Ae&&ge<=Ae&&oe("ExclusiveMinimum",Ae),null!=He&&ge>He&&oe("InclusiveMaximum",He),null!=je&&ge<je&&oe("InclusiveMinimum",je);const yt=L;if(null!=Fe&&yt.length>Fe&&oe("MaxItems",Fe),null!=ut&&yt.length>ut&&oe("MaxLength",ut),null!=ht&&yt.length<ht&&oe("MinItems",ht),null!=pt&&yt.length<pt&&oe("MinLength",pt),null!=zt&&ge%zt!=0&&oe("MultipleOf",zt),Vt){const Kt="string"==typeof Vt?new RegExp(Vt):Vt;("string"!=typeof L||null===L.match(Kt))&&oe("Pattern",Vt)}mt&&yt.some((Kt,on,Yn)=>Yn.indexOf(Kt)!==on)&&oe("UniqueItems",mt)}}serialize(k,L,G,oe={}){var ge,Ne,Ae;const He={rootName:null!==(ge=oe.rootName)&&void 0!==ge?ge:"",includeRoot:null!==(Ne=oe.includeRoot)&&void 0!==Ne&&Ne,xmlCharKey:null!==(Ae=oe.xmlCharKey)&&void 0!==Ae?Ae:A.I};let je={};const Fe=k.type.name;G||(G=k.serializedName),null!==Fe.match(/^Sequence$/i)&&(je=[]),k.isConstant&&(L=k.defaultValue);const{required:ut,nullable:ht}=k;if(ut&&ht&&void 0===L)throw new Error(`${G} cannot be undefined.`);if(ut&&!ht&&null==L)throw new Error(`${G} cannot be null or undefined.`);if(!ut&&!1===ht&&null===L)throw new Error(`${G} cannot be null.`);return null==L?je=L:(this.validateConstraints(k,L,G),null!==Fe.match(/^any$/i)?je=L:null!==Fe.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?je=function(q,k,L){if(null!=L)if(null!==q.match(/^Number$/i)){if("number"!=typeof L)throw new Error(`${k} with value ${L} must be of type number.`)}else if(null!==q.match(/^String$/i)){if("string"!=typeof L.valueOf())throw new Error(`${k} with value "${L}" must be of type string.`)}else if(null!==q.match(/^Uuid$/i)){if("string"!=typeof L.valueOf()||!T.TP(L))throw new Error(`${k} with value "${L}" must be of type string and a valid uuid.`)}else if(null!==q.match(/^Boolean$/i)){if("boolean"!=typeof L)throw new Error(`${k} with value ${L} must be of type boolean.`)}else if(null!==q.match(/^Stream$/i)){const G=typeof L;if(!("string"===G||"function"===G||L instanceof ArrayBuffer||ArrayBuffer.isView(L)||("function"==typeof Blob||"object"==typeof Blob)&&L instanceof Blob))throw new Error(`${k} must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.`)}return L}(Fe,G,L):null!==Fe.match(/^Enum$/i)?je=function(q,k,L){if(!k)throw new Error(`Please provide a set of allowedValues to validate ${q} as an Enum Type.`);if(!k.some(oe=>"string"==typeof oe.valueOf()?oe.toLowerCase()===L.toLowerCase():oe===L))throw new Error(`${L} is not a valid value for ${q}. The valid values are: ${JSON.stringify(k)}.`);return L}(G,k.type.allowedValues,L):null!==Fe.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?je=function(q,k,L){if(null!=k)if(null!==q.match(/^Date$/i)){if(!(k instanceof Date||"string"==typeof k.valueOf()&&!isNaN(Date.parse(k))))throw new Error(`${L} must be an instanceof Date or a string in ISO8601 format.`);k=k instanceof Date?k.toISOString().substring(0,10):new Date(k).toISOString().substring(0,10)}else if(null!==q.match(/^DateTime$/i)){if(!(k instanceof Date||"string"==typeof k.valueOf()&&!isNaN(Date.parse(k))))throw new Error(`${L} must be an instanceof Date or a string in ISO8601 format.`);k=k instanceof Date?k.toISOString():new Date(k).toISOString()}else if(null!==q.match(/^DateTimeRfc1123$/i)){if(!(k instanceof Date||"string"==typeof k.valueOf()&&!isNaN(Date.parse(k))))throw new Error(`${L} must be an instanceof Date or a string in RFC-1123 format.`);k=k instanceof Date?k.toUTCString():new Date(k).toUTCString()}else if(null!==q.match(/^UnixTime$/i)){if(!(k instanceof Date||"string"==typeof k.valueOf()&&!isNaN(Date.parse(k))))throw new Error(`${L} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);k=function(q){if(q)return"string"==typeof q.valueOf()&&(q=new Date(q)),Math.floor(q.getTime()/1e3)}(k)}else if(null!==q.match(/^TimeSpan$/i)&&!T._9(k))throw new Error(`${L} must be a string in ISO 8601 format. Instead was "${k}".`);return k}(Fe,L,G):null!==Fe.match(/^ByteArray$/i)?je=function(q,k){let L="";if(null!=k){if(!(k instanceof Uint8Array))throw new Error(`${q} must be of type Uint8Array.`);L=E(k)}return L}(G,L):null!==Fe.match(/^Base64Url$/i)?je=function(q,k){let L="";if(null!=k){if(!(k instanceof Uint8Array))throw new Error(`${q} must be of type Uint8Array.`);L=function(q){if(q){if(!(q instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(q,k){let L=q.length;for(;L-1>=0&&"="===q[L-1];)--L;return q.substr(0,L)}(E(q)).replace(/\+/g,"-").replace(/\//g,"_")}}(k)||""}return L}(G,L):null!==Fe.match(/^Sequence$/i)?je=function(q,k,L,G,oe,ge){if(!Array.isArray(L))throw new Error(`${G} must be of type Array.`);const Ne=k.type.element;if(!Ne||"object"!=typeof Ne)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${G}.`);const Ae=[];for(let He=0;He<L.length;He++){const je=q.serialize(Ne,L[He],G,ge);if(oe&&Ne.xmlNamespace){const Fe=Ne.xmlNamespacePrefix?`xmlns:${Ne.xmlNamespacePrefix}`:"xmlns";"Composite"===Ne.type.name?(Ae[He]=Object.assign({},je),Ae[He][A.c]={[Fe]:Ne.xmlNamespace}):(Ae[He]={},Ae[He][ge.xmlCharKey]=je,Ae[He][A.c]={[Fe]:Ne.xmlNamespace})}else Ae[He]=je}return Ae}(this,k,L,G,Boolean(this.isXML),He):null!==Fe.match(/^Dictionary$/i)?je=function(q,k,L,G,oe,ge){if("object"!=typeof L)throw new Error(`${G} must be of type object.`);const Ne=k.type.value;if(!Ne||"object"!=typeof Ne)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${G}.`);const Ae={};for(const He of Object.keys(L)){const je=q.serialize(Ne,L[He],G,ge);Ae[He]=Z(Ne,je,oe,ge)}if(oe&&k.xmlNamespace){const je=Ae;return je[A.c]={[k.xmlNamespacePrefix?`xmlns:${k.xmlNamespacePrefix}`:"xmlns"]:k.xmlNamespace},je}return Ae}(this,k,L,G,Boolean(this.isXML),He):null!==Fe.match(/^Composite$/i)&&(je=function(q,k,L,G,oe,ge){if(X(q,k)&&(k=ne(q,k,L,"clientName")),null!=L){const Ne={},Ae=j(q,k,G);for(const je of Object.keys(Ae)){const Fe=Ae[je];if(Fe.readOnly)continue;let ut,ht=Ne;if(q.isXML)ut=Fe.xmlIsWrapped?Fe.xmlName:Fe.xmlElementName||Fe.xmlName;else{const pt=S(Fe.serializedName);ut=pt.pop();for(const zt of pt)null==ht[zt]&&(null!=L[je]||void 0!==Fe.defaultValue)&&(ht[zt]={}),ht=ht[zt]}if(null!=ht){if(oe&&k.xmlNamespace){const yt=k.xmlNamespacePrefix?`xmlns:${k.xmlNamespacePrefix}`:"xmlns";ht[A.c]=Object.assign(Object.assign({},ht[A.c]),{[yt]:k.xmlNamespace})}const pt=""!==Fe.serializedName?G+"."+Fe.serializedName:G;let zt=L[je];const Vt=X(q,k);Vt&&Vt.clientName===je&&null==zt&&(zt=k.serializedName);const mt=q.serialize(Fe,zt,pt,ge);if(void 0!==mt&&null!=ut){const yt=Z(Fe,mt,oe,ge);oe&&Fe.xmlIsAttribute?(ht[A.c]=ht[A.c]||{},ht[A.c][ut]=mt):ht[ut]=oe&&Fe.xmlIsWrapped?{[Fe.xmlElementName]:yt}:yt}}}const He=function(q,k,L){const G=k.type.additionalProperties;if(!G&&k.type.className){const oe=$(q,k,L);return null==oe?void 0:oe.type.additionalProperties}return G}(q,k,G);if(He){const je=Object.keys(Ae);for(const Fe in L)je.every(ht=>ht!==Fe)&&(Ne[Fe]=q.serialize(He,L[Fe],G+'["'+Fe+'"]',ge))}return Ne}return L}(this,k,L,G,Boolean(this.isXML),He))),je}deserialize(k,L,G,oe={}){var ge,Ne,Ae;const He={rootName:null!==(ge=oe.rootName)&&void 0!==ge?ge:"",includeRoot:null!==(Ne=oe.includeRoot)&&void 0!==Ne&&Ne,xmlCharKey:null!==(Ae=oe.xmlCharKey)&&void 0!==Ae?Ae:A.I};if(null==L)return this.isXML&&"Sequence"===k.type.name&&!k.xmlIsWrapped&&(L=[]),void 0!==k.defaultValue&&(L=k.defaultValue),L;let je;const Fe=k.type.name;if(G||(G=k.serializedName),null!==Fe.match(/^Composite$/i))je=function(q,k,L,G,oe){var ge;X(q,k)&&(k=ne(q,k,L,"serializedName"));const Ne=j(q,k,G);let Ae={};const He=[];for(const Fe of Object.keys(Ne)){const ut=Ne[Fe],ht=S(Ne[Fe].serializedName);He.push(ht[0]);const{serializedName:pt,xmlName:zt,xmlElementName:Vt}=ut;let mt=G;""!==pt&&void 0!==pt&&(mt=G+"."+pt);const yt=ut.headerCollectionPrefix;if(yt){const Kt={};for(const on of Object.keys(L))on.startsWith(yt)&&(Kt[on.substring(yt.length)]=q.deserialize(ut.type.value,L[on],mt,oe)),He.push(on);Ae[Fe]=Kt}else if(q.isXML)if(ut.xmlIsAttribute&&L[A.c])Ae[Fe]=q.deserialize(ut,L[A.c][zt],mt,oe);else{const Kt=Vt||zt||pt;if(ut.xmlIsWrapped){const on=L[zt],Yn=null!==(ge=null==on?void 0:on[Vt])&&void 0!==ge?ge:[];Ae[Fe]=q.deserialize(ut,Yn,mt,oe)}else Ae[Fe]=q.deserialize(ut,L[Kt],mt,oe)}else{let Kt,on=L;for(const jr of ht){if(!on)break;on=on[jr]}Kt=on;const Yn=k.type.polymorphicDiscriminator;let Ji;if(Yn&&Fe===Yn.clientName&&null==Kt&&(Kt=k.serializedName),Array.isArray(L[Fe])&&""===Ne[Fe].serializedName){Kt=L[Fe];const jr=q.deserialize(ut,Kt,mt,oe);for(const[Pi,Fo]of Object.entries(Ae))Object.prototype.hasOwnProperty.call(jr,Pi)||(jr[Pi]=Fo);Ae=jr}else(void 0!==Kt||void 0!==ut.defaultValue)&&(Ji=q.deserialize(ut,Kt,mt,oe),Ae[Fe]=Ji)}}const je=k.type.additionalProperties;if(je){const Fe=ut=>{for(const ht in Ne)if(S(Ne[ht].serializedName)[0]===ut)return!1;return!0};for(const ut in L)Fe(ut)&&(Ae[ut]=q.deserialize(je,L[ut],G+'["'+ut+'"]',oe))}else if(L)for(const Fe of Object.keys(L))void 0===Ae[Fe]&&!He.includes(Fe)&&!Y(Fe,oe)&&(Ae[Fe]=L[Fe]);return Ae}(this,k,L,G,He);else{if(this.isXML){const ut=He.xmlCharKey,ht=L;null!=ht[A.c]&&null!=ht[ut]&&(L=ht[ut])}null!==Fe.match(/^Number$/i)?(je=parseFloat(L),isNaN(je)&&(je=L)):null!==Fe.match(/^Boolean$/i)?je="true"===L||"false"!==L&&L:null!==Fe.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?je=L:null!==Fe.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?je=new Date(L):null!==Fe.match(/^UnixTime$/i)?je=function(q){if(q)return new Date(1e3*q)}(L):null!==Fe.match(/^ByteArray$/i)?je=d(L):null!==Fe.match(/^Base64Url$/i)?je=function(q){if(q){if(q&&"string"!=typeof q.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return d(q=q.replace(/-/g,"+").replace(/_/g,"/"))}}(L):null!==Fe.match(/^Sequence$/i)?je=function(q,k,L,G,oe){const ge=k.type.element;if(!ge||"object"!=typeof ge)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${G}`);if(L){Array.isArray(L)||(L=[L]);const Ne=[];for(let Ae=0;Ae<L.length;Ae++)Ne[Ae]=q.deserialize(ge,L[Ae],`${G}[${Ae}]`,oe);return Ne}return L}(this,k,L,G,He):null!==Fe.match(/^Dictionary$/i)&&(je=function(q,k,L,G,oe){const ge=k.type.value;if(!ge||"object"!=typeof ge)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${G}`);if(L){const Ne={};for(const Ae of Object.keys(L))Ne[Ae]=q.deserialize(ge,L[Ae],G,oe);return Ne}return L}(this,k,L,G,He))}return k.isConstant&&(je=k.defaultValue),je}}function S(q){const k=[];let L="";if(q){const G=q.split(".");for(const oe of G)"\\"===oe.charAt(oe.length-1)?L+=oe.substr(0,oe.length-1)+".":(L+=oe,k.push(L),L="")}return k}function $(q,k,L){const G=k.type.className;if(!G)throw new Error(`Class name for model "${L}" is not provided in the mapper "${JSON.stringify(k,void 0,2)}".`);return q.modelMappers[G]}function j(q,k,L){let G=k.type.modelProperties;if(!G){const oe=$(q,k,L);if(!oe)throw new Error(`mapper() cannot be null or undefined for model "${k.type.className}".`);if(G=null==oe?void 0:oe.type.modelProperties,!G)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(oe)}" of type "${k.type.className}" for object "${L}".`)}return G}function Z(q,k,L,G){if(!L||!q.xmlNamespace)return k;const ge={[q.xmlNamespacePrefix?`xmlns:${q.xmlNamespacePrefix}`:"xmlns"]:q.xmlNamespace};if(["Composite"].includes(q.type.name)){if(k[A.c])return k;{const Ae=Object.assign({},k);return Ae[A.c]=ge,Ae}}const Ne={};return Ne[G.xmlCharKey]=k,Ne[A.c]=ge,Ne}function Y(q,k){return[A.c,k.xmlCharKey].includes(q)}function ne(q,k,L,G){const oe=X(q,k);if(oe){const ge=oe[G];if(null!=ge){const Ne=L[ge];if(null!=Ne){const Ae=k.type.uberParent||k.type.className,je=q.modelMappers.discriminators[Ne===Ae?Ne:Ae+"."+Ne];je&&(k=je)}}}return k}function X(q,k){return k.type.polymorphicDiscriminator||de(q,k.type.uberParent)||de(q,k.type.className)}function de(q,k){return k&&q.modelMappers[k]&&q.modelMappers[k].type.polymorphicDiscriminator}function te(q){const k=q;if(null!=q){if(q instanceof Uint8Array)return E(q);if(q instanceof Date)return q.toISOString();if(Array.isArray(q)){const L=[];for(let G=0;G<q.length;G++)L.push(te(q[G]));return L}if("object"==typeof q){const L={};for(const G in q)L[G]=te(k[G]);return L}return q}}const re=function(q){const k={};for(const L of["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"])k[L]=L;return k}();class be{constructor(k,L,G,oe,ge,Ne,Ae,He,je,Fe,ut,ht,pt,zt,Vt){this.streamResponseBody=Ne,this.streamResponseStatusCodes=Vt,this.url=k||"",this.method=L||"GET",this.headers=b(ge)?ge:new h(ge),this.body=G,this.query=oe,this.formData=void 0,this.withCredentials=Ae||!1,this.abortSignal=He,this.timeout=je||0,this.onUploadProgress=Fe,this.onDownloadProgress=ut,this.proxySettings=ht,this.keepAlive=pt,this.decompressResponse=zt,this.requestId=this.headers.get("x-ms-client-request-id")||(0,T.Rl)()}validateRequestProperties(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")}prepare(k){if(!k)throw new Error("options object is required");if(null==k.method||"string"!=typeof k.method.valueOf())throw new Error("options.method must be a string.");if(k.url&&k.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=k.pathTemplate&&"string"==typeof k.pathTemplate.valueOf()||null!=k.url&&"string"==typeof k.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(k.url){if("string"!=typeof k.url)throw new Error('options.url must be of type "string".');this.url=k.url}if(k.method){const L=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===L.indexOf(k.method.toUpperCase()))throw new Error('The provided method "'+k.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(L))}if(this.method=k.method.toUpperCase(),k.pathTemplate){const{pathTemplate:L,pathParameters:G}=k;if("string"!=typeof L)throw new Error('options.pathTemplate must be of type "string".');k.baseUrl||(k.baseUrl="https://management.azure.com");const oe=k.baseUrl;let ge=oe+(oe.endsWith("/")?"":"/")+(L.startsWith("/")?L.slice(1):L);const Ne=ge.match(/({[\w-]*\s*[\w-]*})/gi);if(Ne&&Ne.length){if(!G)throw new Error(`pathTemplate: ${L} has been provided. Hence, options.pathParameters must also be provided.`);Ne.forEach(function(Ae){const He=Ae.slice(1,-1),je=G[He];if(null==je||"string"!=typeof je&&"object"!=typeof je){const Fe=JSON.stringify(G,void 0,2);throw new Error(`pathTemplate: ${L} contains the path parameter ${He} however, it is not present in parameters: ${Fe}.The value of the path parameter can either be a "string" of the form { ${He}: "some sample value" } or it can be an "object" of the form { "${He}": { value: "some sample value", skipUrlEncoding: true } }.`)}if("string"==typeof je.valueOf()&&(ge=ge.replace(Ae,encodeURIComponent(je))),"object"==typeof je.valueOf()){if(!je.value)throw new Error(`options.pathParameters[${He}] is of type "object" but it does not contain a "value" property.`);ge=ge.replace(Ae,je.skipUrlEncoding?je.value:encodeURIComponent(je.value))}})}this.url=ge}if(k.queryParameters){const L=k.queryParameters;if("object"!=typeof L)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");const G=[];this.query={};for(const oe in L){const ge=L[oe];if(ge)if("string"==typeof ge)G.push(oe+"="+encodeURIComponent(ge)),this.query[oe]=encodeURIComponent(ge);else if("object"==typeof ge){if(!ge.value)throw new Error(`options.queryParameters[${oe}] is of type "object" but it does not contain a "value" property.`);ge.skipUrlEncoding?(G.push(oe+"="+ge.value),this.query[oe]=ge.value):(G.push(oe+"="+encodeURIComponent(ge.value)),this.query[oe]=encodeURIComponent(ge.value))}}this.url+=G.join("&")}if(k.headers){const L=k.headers;for(const G of Object.keys(k.headers))this.headers.set(G,L[G])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),!this.headers.get("x-ms-client-request-id")&&!k.disableClientRequestId&&this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=k.body,null!=k.body&&(k.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(k.serializationMapper&&(this.body=new I(k.mappers).serialize(k.serializationMapper,k.body,"requestBody")),k.disableJsonStringifyOnBody||(this.body=JSON.stringify(k.body)))),k.spanOptions&&(this.spanOptions=k.spanOptions),k.tracingContext&&(this.tracingContext=k.tracingContext),this.abortSignal=k.abortSignal,this.onDownloadProgress=k.onDownloadProgress,this.onUploadProgress=k.onUploadProgress,this}clone(){const k=new be(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse,this.streamResponseStatusCodes);return this.formData&&(k.formData=this.formData),this.operationSpec&&(k.operationSpec=this.operationSpec),this.shouldDeserialize&&(k.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(k.operationResponseGetter=this.operationResponseGetter),k}}var Be=u(5283),$e=u(369);const Oe="REDACTED",se=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],fe=["api-version"];class we{constructor({allowedHeaderNames:k=[],allowedQueryParameters:L=[]}={}){k=Array.isArray(k)?se.concat(k):se,L=Array.isArray(L)?fe.concat(L):fe,this.allowedHeaderNames=new Set(k.map(G=>G.toLowerCase())),this.allowedQueryParameters=new Set(L.map(G=>G.toLowerCase()))}sanitize(k){const L=new Set;return JSON.stringify(k,(G,oe)=>{if(oe instanceof Error)return Object.assign(Object.assign({},oe),{name:oe.name,message:oe.message});if("_headersMap"===G)return this.sanitizeHeaders(oe);if("url"===G)return this.sanitizeUrl(oe);if("query"===G)return this.sanitizeQuery(oe);if("body"!==G&&"response"!==G&&"operationSpec"!==G){if(Array.isArray(oe)||(0,T.Kn)(oe)){if(L.has(oe))return"[Circular]";L.add(oe)}return oe}},2)}sanitizeHeaders(k){return this.sanitizeObject(k,this.allowedHeaderNames,(L,G)=>L[G].value)}sanitizeQuery(k){return this.sanitizeObject(k,this.allowedQueryParameters,(L,G)=>L[G])}sanitizeObject(k,L,G){if("object"!=typeof k||null===k)return k;const oe={};for(const ge of Object.keys(k))oe[ge]=L.has(ge.toLowerCase())?G(k,ge):Oe;return oe}sanitizeUrl(k){if("string"!=typeof k||null===k)return k;const L=$e.UK.parse(k),G=L.getQuery();if(!G)return k;const oe=$e.$4.parse(G);for(const ge of oe.keys())this.allowedQueryParameters.has(ge.toLowerCase())||oe.set(ge,Oe);return L.setQuery(oe.toString()),L.toString()}}const Te={},ye=new we;let Pe=(()=>{class q extends Error{constructor(L,G,oe,ge,Ne){super(L),this.name="RestError",this.code=G,this.statusCode=oe,this.request=ge,this.response=Ne,Object.setPrototypeOf(this,q.prototype)}[Te](){return`RestError: ${this.message} \n ${ye.sanitize(this)}`}}return q.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",q.PARSE_ERROR="PARSE_ERROR",q})();class Ve{sendRequest(k){var L;const G=new XMLHttpRequest;if(k.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");const oe=k.abortSignal;if(oe){if(oe.aborted)return Promise.reject(new Be._("The operation was aborted."));const ge=()=>{G.abort()};oe.addEventListener("abort",ge),G.addEventListener("readystatechange",()=>{G.readyState===XMLHttpRequest.DONE&&oe.removeEventListener("abort",ge)})}if(Ie(G.upload,k.onUploadProgress),Ie(G,k.onDownloadProgress),k.formData){const ge=k.formData,Ne=new FormData,Ae=(je,Fe)=>{Fe&&Object.prototype.hasOwnProperty.call(Fe,"value")&&Object.prototype.hasOwnProperty.call(Fe,"options")?Ne.append(je,Fe.value,Fe.options):Ne.append(je,Fe)};for(const je of Object.keys(ge)){const Fe=ge[je];if(Array.isArray(Fe))for(let ut=0;ut<Fe.length;ut++)Ae(je,Fe[ut]);else Ae(je,Fe)}k.body=Ne,k.formData=void 0;const He=k.headers.get("Content-Type");He&&-1!==He.indexOf("multipart/form-data")&&k.headers.remove("Content-Type")}G.open(k.method,k.url),G.timeout=k.timeout,G.withCredentials=k.withCredentials;for(const ge of k.headers.headersArray())G.setRequestHeader(ge.name,ge.value);return G.responseType=(null===(L=k.streamResponseStatusCodes)||void 0===L?void 0:L.size)||k.streamResponseBody?"blob":"text",G.send(void 0===k.body?null:k.body),new Promise("blob"===G.responseType?(ge,Ne)=>{(function(q,k,L,G){q.addEventListener("readystatechange",()=>{var oe;if(q.readyState===XMLHttpRequest.HEADERS_RECEIVED)if(k.streamResponseBody||(null===(oe=k.streamResponseStatusCodes)||void 0===oe?void 0:oe.has(q.status))){const ge=new Promise((Ne,Ae)=>{q.addEventListener("load",()=>{Ne(q.response)}),Qe(k,q,Ae)});L({request:k,status:q.status,headers:We(q),blobBody:ge})}else q.addEventListener("load",()=>{if(q.response){const ge=new FileReader;ge.onload=function(Ne){var Ae;const He=null===(Ae=Ne.target)||void 0===Ae?void 0:Ae.result;L({request:k,status:q.status,headers:We(q),bodyAsText:He})},ge.onerror=function(Ne){G(ge.error)},ge.readAsText(q.response,"UTF-8")}else L({request:k,status:q.status,headers:We(q)})})})})(G,k,ge,Ne),Qe(k,G,Ne)}:function(ge,Ne){G.addEventListener("load",()=>ge({request:k,status:G.status,headers:We(G),bodyAsText:G.responseText})),Qe(k,G,Ne)})}}function Ie(q,k){k&&q.addEventListener("progress",L=>k({loadedBytes:L.loaded}))}function We(q){const k=new h,L=q.getAllResponseHeaders().trim().split(/[\r\n]+/);for(const G of L){const oe=G.indexOf(":"),ge=G.slice(0,oe),Ne=G.slice(oe+2);k.set(ge,Ne)}return k}function Qe(q,k,L){k.addEventListener("error",()=>L(new Pe(`Failed to send request to ${q.url}`,Pe.REQUEST_SEND_ERROR,void 0,q)));const G=new Be._("The operation was aborted.");k.addEventListener("abort",()=>L(G)),k.addEventListener("timeout",()=>L(G))}var Ge=u(1138),rt=u(4762);function Le(q){const{requestOptions:k,tracingOptions:L}=q;let oe=(0,rt._T)(q,["requestOptions","tracingOptions"]);return k&&(oe=Object.assign(Object.assign({},oe),k)),L&&(oe.tracingContext=L.tracingContext,oe.spanOptions=null==L?void 0:L.spanOptions),oe}var at=u(8239),tt=u(2462);if(!(self.document&&self.DOMParser&&self.Node&&self.XMLSerializer))throw new Error('This library depends on the following DOM objects: ["document", "DOMParser", "Node", "XMLSerializer"] to parse XML, but some of these are undefined. You may provide a polyfill to make these globally available in order to support your environment. For more information, please refer to https://aka.ms/azsdk/js/web-workers. ');let vt,De,nt,ot;function Qt(){return vt||(vt=document.implementation.createDocument(null,null,null)),vt}function Ke(){return De||(De=new DOMParser),De}function Nt(q,k={}){var L,G,oe;try{const ge={rootName:null!==(L=k.rootName)&&void 0!==L?L:"",includeRoot:null!==(G=k.includeRoot)&&void 0!==G&&G,xmlCharKey:null!==(oe=k.xmlCharKey)&&void 0!==oe?oe:A.I},Ne=Ke().parseFromString(q,"application/xml");let Ae;return function(q){const k=q.getElementsByTagName("parsererror");if(k.length>0&&function(){var q;if(void 0===ot)try{ot=null!==(q=Ke().parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==q?q:""}catch(k){ot=""}return ot}())for(let L=0;L<k.length;L++)if(k[L].namespaceURI===ot)throw new Error(k[L].innerHTML)}(Ne),Ae=Tr(ge.includeRoot?Ne:Ne.childNodes[0],ge),Promise.resolve(Ae)}catch(ge){return Promise.reject(ge)}}function Tr(q,k){let L={};const G=q.childNodes.length,oe=q.childNodes[0],ge=oe&&1===G&&oe.nodeType===Node.TEXT_NODE&&oe.nodeValue||void 0,Ne=function(q){return function(q){return!!q.attributes}(q)&&q.hasAttributes()?q:void 0}(q);if(Ne){L[A.c]={};for(let Ae=0;Ae<Ne.attributes.length;Ae++){const He=Ne.attributes[Ae];L[A.c][He.nodeName]=He.nodeValue}ge&&(L[k.xmlCharKey]=ge)}else 0===G?L="":ge&&(L=ge);if(!ge)for(let Ae=0;Ae<G;Ae++){const He=q.childNodes[Ae];if(He.nodeType!==Node.TEXT_NODE){const je=Tr(He,k);L[He.nodeName]?Array.isArray(L[He.nodeName])?L[He.nodeName].push(je):L[He.nodeName]=[L[He.nodeName],je]:L[He.nodeName]=je}}return L}function br(q,k={}){var L,G,oe;const ge={rootName:null!==(L=k.rootName)&&void 0!==L?L:"root",includeRoot:null!==(G=k.includeRoot)&&void 0!==G&&G,xmlCharKey:null!==(oe=k.xmlCharKey)&&void 0!==oe?oe:A.I},Ne=ei(q,ge.rootName,ge)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(nt||(nt=new XMLSerializer),nt).serializeToString(Ne)}function Ci(q){const k=[];for(const L of Object.keys(q)){const G=Qt().createAttribute(L);G.value=q[L].toString(),k.push(G)}return k}function ei(q,k,L){if(null==q||"string"==typeof q||"number"==typeof q||"boolean"==typeof q){const G=Qt().createElement(k);return G.textContent=null==q?"":q.toString(),[G]}if(Array.isArray(q)){const G=[];for(const oe of q)for(const ge of ei(oe,k,L))G.push(ge);return G}if("object"==typeof q){const G=Qt().createElement(k);for(const oe of Object.keys(q))if(oe===A.c)for(const ge of Ci(q[oe]))G.attributes.setNamedItem(ge);else if(oe===L.xmlCharKey)G.textContent=q[oe].toString();else for(const ge of ei(q[oe],oe,L))G.appendChild(ge);return[G]}throw new Error(`Illegal value passed to buildObject: ${q}`)}function Kn(q,k){return{create:(L,G)=>new Lt(L,G,q,k)}}const xt=["application/json","text/json"],Er=["application/xml","application/atom+xml"],It={expectedContentTypes:{json:xt,xml:Er}};class Lt extends tt.U{constructor(k,L,G,oe={}){var ge;super(k,L),this.jsonContentTypes=G&&G.json||xt,this.xmlContentTypes=G&&G.xml||Er,this.xmlCharKey=null!==(ge=oe.xmlCharKey)&&void 0!==ge?ge:A.I}sendRequest(k){var L=this;return(0,at.Z)(function*(){return L._nextPolicy.sendRequest(k).then(G=>ft(L.jsonContentTypes,L.xmlContentTypes,G,{xmlCharKey:L.xmlCharKey}))})()}}function ft(q,k,L,G={}){var oe,ge,Ne;const Ae={rootName:null!==(oe=G.rootName)&&void 0!==oe?oe:"",includeRoot:null!==(ge=G.includeRoot)&&void 0!==ge&&ge,xmlCharKey:null!==(Ne=G.xmlCharKey)&&void 0!==Ne?Ne:A.I};return function(q,k,L,G){var oe;const ge=Ae=>{const Fe=new Pe(`Error "${Ae}" occurred while parsing the response body - ${L.bodyAsText}.`,Ae.code||Pe.PARSE_ERROR,L.status,L.request,L);return Promise.reject(Fe)};if(!(null===(oe=L.request.streamResponseStatusCodes)||void 0===oe?void 0:oe.has(L.status))&&!L.request.streamResponseBody&&L.bodyAsText){const Ae=L.bodyAsText,He=L.headers.get("Content-Type")||"",je=He?He.split(";").map(Fe=>Fe.toLowerCase()):[];if(0===je.length||je.some(Fe=>-1!==q.indexOf(Fe)))return new Promise(Fe=>{L.parsedBody=JSON.parse(Ae),Fe(L)}).catch(ge);if(je.some(Fe=>-1!==k.indexOf(Fe)))return Nt(Ae,G).then(Fe=>(L.parsedBody=Fe,L)).catch(ge)}return Promise.resolve(L)}(q,k,L,Ae).then(He=>{if(!function(q){const k=q.request.shouldDeserialize;let L;return L=void 0===k||("boolean"==typeof k?k:k(q)),L}(He))return He;const je=He.request.operationSpec;if(!je||!je.responses)return He;const Fe=function(q){let k;const L=q.request,G=L.operationSpec;if(G){const oe=L.operationResponseGetter;k=oe?oe(G,q):G.responses[q.status]}return k}(He),{error:ut,shouldReturnResponse:ht}=function(q,k,L){var G;const oe=200<=q.status&&q.status<300;if(function(q){const k=Object.keys(q.responses);return 0===k.length||1===k.length&&"default"===k[0]}(k)?oe:L){if(!L)return{error:null,shouldReturnResponse:!1};if(!L.isError)return{error:null,shouldReturnResponse:!1}}const Ne=null!=L?L:k.responses.default,He=(null===(G=q.request.streamResponseStatusCodes)||void 0===G?void 0:G.has(q.status))||q.request.streamResponseBody?`Unexpected status code: ${q.status}`:q.bodyAsText,je=new Pe(He,void 0,q.status,q.request,q);if(!Ne)throw je;const Fe=Ne.bodyMapper,ut=Ne.headersMapper;try{if(q.parsedBody){const ht=q.parsedBody;let pt;if(Fe){let Vt=ht;k.isXML&&Fe.type.name===re.Sequence&&(Vt="object"==typeof ht?ht[Fe.xmlElementName]:[]),pt=k.serializer.deserialize(Fe,Vt,"error.response.parsedBody")}const zt=ht.error||pt||ht;je.code=zt.code,zt.message&&(je.message=zt.message),Fe&&(je.response.parsedBody=pt)}q.headers&&ut&&(je.response.parsedHeaders=k.serializer.deserialize(ut,q.headers.rawHeaders(),"operationRes.parsedHeaders"))}catch(ht){je.message=`Error "${ht.message}" occurred in deserializing the responseBody - "${q.bodyAsText}" for the default response.`}return{error:je,shouldReturnResponse:!1}}(He,je,Fe);if(ut)throw ut;if(ht)return He;if(Fe){if(Fe.bodyMapper){let pt=He.parsedBody;je.isXML&&Fe.bodyMapper.type.name===re.Sequence&&(pt="object"==typeof pt?pt[Fe.bodyMapper.xmlElementName]:[]);try{He.parsedBody=je.serializer.deserialize(Fe.bodyMapper,pt,"operationRes.parsedBody",G)}catch(zt){throw new Pe(`Error ${zt} occurred in deserializing the responseBody - ${He.bodyAsText}`,void 0,He.status,He.request,He)}}else"HEAD"===je.httpMethod&&(He.parsedBody=L.status>=200&&L.status<300);Fe.headersMapper&&(He.parsedHeaders=je.serializer.deserialize(Fe.headersMapper,He.headers.rawHeaders(),"operationRes.parsedHeaders",G))}return He})}const bi={enable:!0};function Ei(q){return{create:(k,L)=>new _t(k,L,q||bi)}}class _t extends tt.U{constructor(k,L,G){super(k,L),this.keepAliveOptions=G}sendRequest(k){var L=this;return(0,at.Z)(function*(){return k.keepAlive=L.keepAliveOptions.enable,L._nextPolicy.sendRequest(k)})()}}const In=["GET","HEAD"],he={handleRedirects:!0,maxRetries:20};function _e(q=20){return{create:(k,L)=>new Re(k,L,q)}}class Re extends tt.U{constructor(k,L,G=20){super(k,L),this.maxRetries=G}sendRequest(k){return this._nextPolicy.sendRequest(k).then(L=>Ye(this,L,0))}}function Ye(q,k,L){const{request:G,status:oe}=k,ge=k.headers.get("location");if(ge&&(300===oe||301===oe&&In.includes(G.method)||302===oe&&In.includes(G.method)||303===oe&&"POST"===G.method||307===oe)&&(!q.maxRetries||L<q.maxRetries)){const Ne=$e.UK.parse(G.url);return Ne.setPath(ge),G.url=Ne.toString(),303===oe&&(G.method="GET",delete G.body),q._nextPolicy.sendRequest(G).then(Ae=>Ye(q,Ae,L+1))}return Promise.resolve(k)}function Ht(q){return"number"==typeof q}function On(q,k,L,G,oe){return!!k(G,oe)&&L.retryCount<q}function qn(q,k={retryCount:0,retryInterval:0},L){L&&(k.error&&(L.innerError=k.error),k.error=L),k.retryCount++;let G=Math.pow(2,k.retryCount-1)-1;return G*=.8*q.retryInterval+Math.floor(Math.random()*(.4*q.retryInterval)),k.retryInterval=Math.min(q.minRetryInterval+G,q.maxRetryInterval),k}var _i=u(8006),lo=u(969);const Dr=(0,u(1326).YR)("core-http");function wo(q,k,L){return{create:(G,oe)=>new rn(G,oe,q,k,L)}}var Do=(()=>{return(q=Do||(Do={}))[q.Exponential=0]="Exponential",Do;var q})();const kn={maxRetries:3,retryDelayInMs:3e4,maxRetryDelayInMs:9e4};class rn extends tt.U{constructor(k,L,G,oe,ge){super(k,L),this.retryCount=Ht(G)?G:3,this.retryInterval=Ht(oe)?oe:3e4,this.maxRetryInterval=Ht(ge)?ge:9e4}sendRequest(k){return this._nextPolicy.sendRequest(k.clone()).then(L=>Ro(this,k,L)).catch(L=>Ro(this,k,L.response,void 0,L))}}function Ro(q,k,L,G,oe){return es.apply(this,arguments)}function es(){return(es=(0,at.Z)(function*(q,k,L,G,oe){G=qn({retryInterval:q.retryInterval,minRetryInterval:0,maxRetryInterval:q.maxRetryInterval},G,oe);const Ne=k.abortSignal&&k.abortSignal.aborted;if(Ne||!On(q.retryCount,function(Ae){const He=null==Ae?void 0:Ae.status;return!(503===He&&(null==L?void 0:L.headers.get(_i.g.HeaderConstants.RETRY_AFTER))||void 0===He||He<500&&408!==He||501===He||505===He)},G,L)){if(Ne||oe||!L)throw G.error||new Pe("Failed to send the request.",Pe.REQUEST_SEND_ERROR,L&&L.status,L&&L.request,L);return L}Dr.info(`Retrying request in ${G.retryInterval}`);try{yield(0,lo.g)(G.retryInterval);const Ae=yield q._nextPolicy.sendRequest(k.clone());return Ro(q,k,Ae,G)}catch(Ae){return Ro(q,k,L,G,Ae)}})).apply(this,arguments)}function Mn(q={}){return{create:(k,L)=>new Jt(k,L,q)}}class Jt extends tt.U{constructor(k,L,{logger:G=Dr.info,allowedHeaderNames:oe=[],allowedQueryParameters:ge=[]}={}){super(k,L),this.logger=G,this.sanitizer=new we({allowedHeaderNames:oe,allowedQueryParameters:ge})}get allowedHeaderNames(){return this.sanitizer.allowedHeaderNames}set allowedHeaderNames(k){this.sanitizer.allowedHeaderNames=k}get allowedQueryParameters(){return this.sanitizer.allowedQueryParameters}set allowedQueryParameters(k){this.sanitizer.allowedQueryParameters=k}sendRequest(k){return this.logger.enabled?(this.logRequest(k),this._nextPolicy.sendRequest(k).then(L=>this.logResponse(L))):this._nextPolicy.sendRequest(k)}logRequest(k){this.logger(`Request: ${this.sanitizer.sanitize(k)}`)}logResponse(k){return this.logger(`Response status code: ${k.status}`),this.logger(`Headers: ${this.sanitizer.sanitize(k.headers)}`),k}}function Fr(q){return Rr(q.parameterPath,q.mapper)}function Rr(q,k){let L;return L="string"==typeof q?q:Array.isArray(q)?q.join("."):k.serializedName,L}var Mo=u(434);const Ao=function(){return"x-ms-useragent"};function Wi(){const q=[{key:"core-http",value:_i.g.coreHttpVersion}],k=function(){const q=self.navigator;return[{key:"OS",value:(q.oscpu||q.platform).replace(" ","")}]}();return function(q,k=" ",L="/"){return q.map(G=>`${G.key}${G.value?`${L}${G.value}`:""}`).join(k)}(q.concat(k))}function Po(q){const k=q&&null!=q.key?q.key:"x-ms-useragent",L=q&&null!=q.value?q.value:Wi();return{create:(G,oe)=>new Ct(G,oe,k,L)}}class Ct extends tt.U{constructor(k,L,G,oe){super(k,L),this._nextPolicy=k,this._options=L,this.headerKey=G,this.headerValue=oe}sendRequest(k){return this.addUserAgentHeader(k),this._nextPolicy.sendRequest(k)}addUserAgentHeader(k){k.headers||(k.headers=new h),!k.headers.get(this.headerKey)&&this.headerValue&&k.headers.set(this.headerKey,this.headerValue)}}var rr=(()=>{return(q=rr||(rr={})).Csv=",",q.Ssv=" ",q.Tsv="\t",q.Pipes="|",q.Multi="Multi",rr;var q})(),rs=u(6354);const _r=new Error("DisableResponseDecompressionPolicy is not supported in browser environment");function Oo(){return{create:(q,k)=>{throw _r}}}function Sr(q="x-ms-client-request-id"){return{create:(k,L)=>new ir(k,L,q)}}class ir extends tt.U{constructor(k,L,G){super(k,L),this._requestIdHeaderName=G}sendRequest(k){return k.headers.contains(this._requestIdHeaderName)||k.headers.set(this._requestIdHeaderName,k.requestId),this._nextPolicy.sendRequest(k)}}let os;class ya extends tt.U{constructor(k,L){super(k,L)}sendRequest(k){var L=this;return(0,at.Z)(function*(){if("string"==typeof k.body&&k.body.startsWith("[")){const G=JSON.parse(k.body);Array.isArray(G)&&(k.body=G.map(oe=>JSON.stringify(oe)+"\n").join(""))}return L._nextPolicy.sendRequest(k)})()}}const ko=new Error("ProxyPolicy is not supported in browser environment");function ss(q){}function Si(q){return{create:(k,L)=>{throw ko}}}class Vu extends tt.U{constructor(k,L,G=30){super(k,L),this._retryTimeout=G}sendRequest(k){return this._nextPolicy.sendRequest(k.clone()).then(L=>function(q,k,L){if(409===L.status){const G=function(q){let k,L;if(q){try{L=JSON.parse(q)}catch(G){}if(L&&L.error&&L.error.message&&L.error.code&&"MissingSubscriptionRegistration"===L.error.code){const G=L.error.message.match(/.*'(.*)'/i);G&&(k=G.pop())}}return k}(L.bodyAsText);if(G){const oe=function(q){let k;const L=q.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!L||!L[0])throw new Error(`Unable to extract subscriptionId from the given url - ${q}.`);return k=L[0],k}(k.url);return function(q,k,L,G){return fo.apply(this,arguments)}(q,oe,G,k).catch(()=>!1).then(ge=>ge?(k.headers.set("x-ms-client-request-id",T.Rl()),q._nextPolicy.sendRequest(k.clone())):L)}}return Promise.resolve(L)}(this,k,L))}}function Zt(q,k=!1){const L=q.clone();return k&&(L.url=q.url),L.headers.set("x-ms-client-request-id",T.Rl()),L.headers.set("Content-Type","application/json; charset=utf-8"),L}function fo(){return(fo=(0,at.Z)(function*(q,k,L,G){const oe=`${k}providers/${L}/register?api-version=2016-02-01`,ge=`${k}providers/${L}?api-version=2016-02-01`,Ne=Zt(G);if(Ne.method="POST",Ne.url=oe,200!==(yield q._nextPolicy.sendRequest(Ne)).status)throw new Error(`Autoregistration of ${L} failed. Please try registering manually.`);return as(q,ge,G)})).apply(this,arguments)}function as(q,k,L){return hr.apply(this,arguments)}function hr(){return(hr=(0,at.Z)(function*(q,k,L){const G=Zt(L);G.url=k,G.method="GET";const oe=yield q._nextPolicy.sendRequest(G),ge=oe.parsedBody;return!(!oe.parsedBody||!ge.registrationState||"Registered"!==ge.registrationState)||(yield(0,lo.g)(1e3*q._retryTimeout),as(q,k,L))})).apply(this,arguments)}function wi(q){return{create:(k,L)=>new va(k,L,q)}}class va extends tt.U{constructor(k,L,G){super(k,L),this.authenticationProvider=G}signRequest(k){return this.authenticationProvider.signRequest(k)}sendRequest(k){return this.signRequest(k).then(L=>this._nextPolicy.sendRequest(L))}}function Ki(q,k,L,G){return{create:(oe,ge)=>new us(oe,ge,q,k,L,G)}}class us extends tt.U{constructor(k,L,G,oe,ge,Ne){super(k,L),this.retryCount=Ht(G)?G:3,this.retryInterval=Ht(oe)?oe:3e4,this.minRetryInterval=Ht(ge)?ge:3e3,this.maxRetryInterval=Ht(Ne)?Ne:9e4}sendRequest(k){return this._nextPolicy.sendRequest(k.clone()).catch(L=>Qi(this,k,L.response,L))}}function Qi(q,k,L,G,oe){return ti.apply(this,arguments)}function ti(){return(ti=(0,at.Z)(function*(q,k,L,G,oe){if(oe=qn(q,oe,G),!On(q.retryCount,function(Ne,Ae){return!(!Ae||!Ae.code||"ETIMEDOUT"!==Ae.code&&"ESOCKETTIMEDOUT"!==Ae.code&&"ECONNREFUSED"!==Ae.code&&"ECONNRESET"!==Ae.code&&"ENOENT"!==Ae.code)},oe,L,G))return G?Promise.reject(oe.error):L;try{return yield(0,lo.g)(oe.retryInterval),q._nextPolicy.sendRequest(k.clone())}catch(Ne){return Qi(q,k,L,Ne,oe)}})).apply(this,arguments)}const Ur=_i.g.HttpConstants.StatusCodes;function xo(){return{create:(q,k)=>new Nn(q,k)}}const Lo="The operation was aborted.";class Nn extends tt.U{constructor(k,L,G){super(k,L),this.numberOfRetries=0,this._handleResponse=G||this._defaultResponseHandler}sendRequest(k){var L=this;return(0,at.Z)(function*(){const G=yield L._nextPolicy.sendRequest(k.clone());return G.status!==Ur.TooManyRequests&&G.status!==Ur.ServiceUnavailable?G:L._handleResponse(k,G)})()}_defaultResponseHandler(k,L){var G=this;return(0,at.Z)(function*(){var oe;const ge=L.headers.get(_i.g.HeaderConstants.RETRY_AFTER);if(ge){const Ne=Nn.parseRetryAfterHeader(ge);if(Ne){if(G.numberOfRetries+=1,yield(0,lo.g)(Ne,void 0,{abortSignal:k.abortSignal,abortErrorMsg:Lo}),null===(oe=k.abortSignal)||void 0===oe?void 0:oe.aborted)throw new Be._(Lo);return G.numberOfRetries<3?G.sendRequest(k):G._nextPolicy.sendRequest(k)}}return L})()}static parseRetryAfterHeader(k){const L=Number(k);return Number.isNaN(L)?Nn.parseDateRetryAfterHeader(k):1e3*L}static parseDateRetryAfterHeader(k){try{const L=Date.now(),oe=Date.parse(k)-L;return Number.isNaN(oe)?void 0:oe}catch(L){return}}}var Fn=u(1259),an=u(1643);const cs=(0,Fn.q)({packagePrefix:"",namespace:""});function An(q={}){return{create:(k,L)=>new st(k,L,q)}}class st extends tt.U{constructor(k,L,G){super(k,L),this.userAgent=G.userAgent}sendRequest(k){var L=this;return(0,at.Z)(function*(){if(!k.tracingContext)return L._nextPolicy.sendRequest(k);const G=L.tryCreateSpan(k);if(!G)return L._nextPolicy.sendRequest(k);try{const oe=yield L._nextPolicy.sendRequest(k);return L.tryProcessResponse(G,oe),oe}catch(oe){throw L.tryProcessError(G,oe),oe}})()}tryCreateSpan(k){var L;try{const{span:G}=cs(`HTTP ${k.method}`,{tracingOptions:{spanOptions:Object.assign(Object.assign({},k.spanOptions),{kind:an.MU.CLIENT}),tracingContext:k.tracingContext}});if(!G.isRecording())return void G.end();const oe=null===(L=k.tracingContext)||void 0===L?void 0:L.getValue(Symbol.for("az.namespace"));"string"==typeof oe&&G.setAttribute("az.namespace",oe),G.setAttributes({"http.method":k.method,"http.url":k.url,requestId:k.requestId}),this.userAgent&&G.setAttribute("http.user_agent",this.userAgent);const ge=G.spanContext(),Ne=function(q){const k=[];if(q.traceId||k.push("traceId"),q.spanId||k.push("spanId"),k.length)return;const G=(q.traceFlags||0).toString(16);return`00-${q.traceId}-${q.spanId}-${1===G.length?`0${G}`:G}`}(ge);if(Ne&&(0,an.BM)(ge)){k.headers.set("traceparent",Ne);const Ae=ge.traceState&&ge.traceState.serialize();Ae&&k.headers.set("tracestate",Ae)}return G}catch(G){return void Dr.warning(`Skipping creating a tracing span due to an error: ${G.message}`)}}tryProcessError(k,L){try{k.setStatus({code:an.Qn.ERROR,message:L.message}),L.statusCode&&k.setAttribute("http.status_code",L.statusCode),k.end()}catch(G){Dr.warning(`Skipping tracing span processing due to an error: ${G.message}`)}}tryProcessResponse(k,L){try{k.setAttribute("http.status_code",L.status);const G=L.headers.get("x-ms-request-id");G&&k.setAttribute("serviceRequestId",G),k.setStatus({code:an.Qn.OK}),k.end()}catch(G){Dr.warning(`Skipping tracing span processing due to an error: ${G.message}`)}}}class Ft{constructor(k,L){let G;if(L||(L={}),this._withCredentials=L.withCredentials||!1,this._httpClient=L.httpClient||(os||(os=new Ve),os),this._requestPolicyOptions=new tt._(L.httpPipelineLogger),Array.isArray(L.requestPolicyFactories))Dr.info("ServiceClient: using custom request policies"),G=L.requestPolicyFactories;else{let oe;if((0,Mo.c)(k))Dr.info("ServiceClient: creating bearer token authentication policy from provided credentials"),oe=(()=>{let Ne;const Ae=this,He=L;return{create(je,Fe){const ut=function(q,k){if(null==q?void 0:q.credentialScopes){const L=q.credentialScopes;return Array.isArray(L)?L.map(G=>new URL(G).toString()):new URL(L).toString()}if(k)return`${k}/.default`}(He,Ae.baseUri);if(!ut)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return null==Ne&&(Ne=(0,rs.v)(k,ut)),Ne.create(je,Fe)}}})();else if(k&&"function"==typeof k.signRequest)Dr.info("ServiceClient: creating signing policy from provided credentials"),oe=wi(k);else if(null!=k)throw new Error("The credentials argument must implement the TokenCredential interface");if(Dr.info("ServiceClient: using default request policies"),G=function(q,k){const L=[];k.generateClientRequestIdHeader&&L.push(Sr(k.clientRequestIdHeaderName)),q&&L.push(q);const G=Vr(k.userAgentHeaderName,Ao),oe=Vr(k.userAgent,Wi);return G&&oe&&L.push(Po({key:G,value:oe})),L.push(_e()),L.push(function(q=30){return{create:(k,L)=>new Vu(k,L,q)}}(k.rpRegistrationRetryTimeout)),k.noRetryPolicy||(L.push(wo()),L.push(Ki()),L.push(xo())),L.push(Kn(k.deserializationContentTypes)),T.UG&&L.push(Si()),L.push(Mn({logger:Dr.info})),L}(oe,L),L.requestPolicyFactories){const ge=L.requestPolicyFactories(G);ge&&(G=ge)}}this._requestPolicyFactories=G}sendRequest(k){if(null==k||"object"!=typeof k)throw new Error("options cannot be null or undefined and it must be of type object.");let L;try{!function(q){if(q&&"object"==typeof q){const k=q;if("string"==typeof k.url&&"string"==typeof k.method&&"object"==typeof k.headers&&b(k.headers)&&"function"==typeof k.validateRequestProperties&&"function"==typeof k.prepare&&"function"==typeof k.clone)return!0}return!1}(k)?(L=new be,L=L.prepare(k)):(k.validateRequestProperties(),L=k)}catch(oe){return Promise.reject(oe)}let G=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(let oe=this._requestPolicyFactories.length-1;oe>=0;--oe)G=this._requestPolicyFactories[oe].create(G,this._requestPolicyOptions);return G.sendRequest(L)}sendOperationRequest(k,L,G){var oe=this;return(0,at.Z)(function*(){var ge;"function"==typeof k.options&&(G=k.options,k.options=void 0);const Ne=null===(ge=k.options)||void 0===ge?void 0:ge.serializerOptions,Ae=new be;let He;try{const Fe=L.baseUrl||oe.baseUri;if(!Fe)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");Ae.method=L.httpMethod,Ae.operationSpec=L;const ut=$e.UK.parse(Fe);if(L.path&&ut.appendPath(L.path),L.urlParameters&&L.urlParameters.length>0)for(const mt of L.urlParameters){let yt=Pr(oe,k,mt,L.serializer);yt=L.serializer.serialize(mt.mapper,yt,Fr(mt),Ne),mt.skipEncoding||(yt=encodeURIComponent(yt)),ut.replaceAll(`{${mt.mapper.serializedName||Fr(mt)}}`,yt)}if(L.queryParameters&&L.queryParameters.length>0)for(const mt of L.queryParameters){let yt=Pr(oe,k,mt,L.serializer);if(null!=yt){if(yt=L.serializer.serialize(mt.mapper,yt,Fr(mt),Ne),null!=mt.collectionFormat)if(mt.collectionFormat===rr.Multi){if(0===yt.length)continue;for(const Kt in yt){const on=yt[Kt];yt[Kt]=null==on?"":on.toString()}}else(mt.collectionFormat===rr.Ssv||mt.collectionFormat===rr.Tsv)&&(yt=yt.join(mt.collectionFormat));if(!mt.skipEncoding)if(Array.isArray(yt))for(const Kt in yt)null!=yt[Kt]&&(yt[Kt]=encodeURIComponent(yt[Kt]));else yt=encodeURIComponent(yt);null!=mt.collectionFormat&&mt.collectionFormat!==rr.Multi&&mt.collectionFormat!==rr.Ssv&&mt.collectionFormat!==rr.Tsv&&(yt=yt.join(mt.collectionFormat)),ut.setQueryParameter(mt.mapper.serializedName||Fr(mt),yt)}}Ae.url=ut.toString();const ht=L.contentType||oe.requestContentType;if(ht&&L.requestBody&&Ae.headers.set("Content-Type",ht),L.headerParameters)for(const mt of L.headerParameters){let yt=Pr(oe,k,mt,L.serializer);if(null!=yt){yt=L.serializer.serialize(mt.mapper,yt,Fr(mt),Ne);const Kt=mt.mapper.headerCollectionPrefix;if(Kt)for(const on of Object.keys(yt))Ae.headers.set(Kt+on,yt[on]);else Ae.headers.set(mt.mapper.serializedName||Fr(mt),yt)}}const pt=k.options;if(pt){if(pt.customHeaders)for(const mt in pt.customHeaders)Ae.headers.set(mt,pt.customHeaders[mt]);pt.abortSignal&&(Ae.abortSignal=pt.abortSignal),pt.timeout&&(Ae.timeout=pt.timeout),pt.onUploadProgress&&(Ae.onUploadProgress=pt.onUploadProgress),pt.onDownloadProgress&&(Ae.onDownloadProgress=pt.onDownloadProgress),pt.spanOptions&&(Ae.spanOptions=pt.spanOptions),pt.tracingContext&&(Ae.tracingContext=pt.tracingContext),null!=pt.shouldDeserialize&&(Ae.shouldDeserialize=pt.shouldDeserialize)}let zt,Vt;Ae.withCredentials=oe._withCredentials,function(q,k,L,G){var oe,ge,Ne,Ae,He,je;const Fe=null!==(ge=null===(oe=L.options)||void 0===oe?void 0:oe.serializerOptions)&&void 0!==ge?ge:{},ut={rootName:null!==(Ne=Fe.rootName)&&void 0!==Ne?Ne:"",includeRoot:null!==(Ae=Fe.includeRoot)&&void 0!==Ae&&Ae,xmlCharKey:null!==(He=Fe.xmlCharKey)&&void 0!==He?He:A.I},ht=Fe.xmlCharKey;if(G.requestBody&&G.requestBody.mapper){k.body=Pr(q,L,G.requestBody,G.serializer);const pt=G.requestBody.mapper,{required:zt,xmlName:Vt,xmlElementName:mt,serializedName:yt,xmlNamespace:Kt,xmlNamespacePrefix:on}=pt,Yn=pt.type.name;try{if(null!=k.body||zt){const Ji=Fr(G.requestBody);k.body=G.serializer.serialize(pt,k.body,Ji,ut);const jr=Yn===re.Stream;if(G.isXML){const Pi=on?`xmlns:${on}`:"xmlns",Fo=function(q,k,L,G,oe){if(q&&!["Composite","Sequence","Dictionary"].includes(L)){const ge={};return ge[oe.xmlCharKey]=G,ge[A.c]={[k]:q},ge}return G}(Kt,Pi,Yn,k.body,ut);Yn===re.Sequence?k.body=br(T.WQ(Fo,mt||Vt||yt,Pi,Kt),{rootName:Vt||yt,xmlCharKey:ht}):jr||(k.body=br(Fo,{rootName:Vt||yt,xmlCharKey:ht}))}else{if(Yn===re.String&&((null===(je=G.contentType)||void 0===je?void 0:je.match("text/plain"))||"text"===G.mediaType))return;jr||(k.body=JSON.stringify(k.body))}}}catch(Ji){throw new Error(`Error "${Ji.message}" occurred in serializing the payload - ${JSON.stringify(yt,void 0,"  ")}.`)}}else if(G.formDataParameters&&G.formDataParameters.length>0){k.formData={};for(const pt of G.formDataParameters){const zt=Pr(q,L,pt,G.serializer);if(null!=zt){const Vt=pt.mapper.serializedName||Fr(pt);k.formData[Vt]=G.serializer.serialize(pt.mapper,zt,Fr(pt),ut)}}}}(oe,Ae,k,L),void 0===Ae.streamResponseStatusCodes&&(Ae.streamResponseStatusCodes=function(q){const k=new Set;for(const L in q.responses){const G=q.responses[L];G.bodyMapper&&G.bodyMapper.type.name===re.Stream&&k.add(Number(L))}return k}(L));try{zt=yield oe.sendRequest(Ae)}catch(mt){Vt=mt}Vt?(Vt.response&&(Vt.details=Br(Vt.response,L.responses[Vt.statusCode]||L.responses.default)),He=Promise.reject(Vt)):He=Promise.resolve(Br(zt,L.responses[zt.status]))}catch(Fe){He=Promise.reject(Fe)}const je=G;return je&&He.then(Fe=>je(null,Fe._response.parsedBody,Fe._response.request,Fe._response)).catch(Fe=>je(Fe)),He})()}}function Vr(q,k){let L;return"string"==typeof q?L=q:(L=k(),"function"==typeof q&&(L=q(L))),L}function ni(q,k){const L=[];let G;if(q.sendStreamingJson&&L.push({create:(q,k)=>new ya(q,k)}),q.userAgentOptions&&q.userAgentOptions.userAgentPrefix){const je=[];je.push(q.userAgentOptions.userAgentPrefix);const Fe=Wi();-1===je.indexOf(Fe)&&je.push(Fe),G=je.join(" ")}const oe=Object.assign(Object.assign({},bi),q.keepAliveOptions),ge=Object.assign(Object.assign({},kn),q.retryOptions),Ne=Object.assign(Object.assign({},he),q.redirectOptions);T.UG&&L.push(Si());const Ae=Object.assign(Object.assign({},It),q.deserializationOptions),He=Object.assign({},q.loggingOptions);return L.push(An({userAgent:G}),Ei(oe),Po({value:G}),Sr(),Kn(Ae.expectedContentTypes),xo(),Ki(),wo(ge.maxRetries,ge.retryDelayInMs,ge.maxRetryDelayInMs)),Ne.handleRedirects&&L.push(_e(Ne.maxRetries)),k&&L.push(k),L.push(Mn(He)),T.UG&&!1===q.decompressResponse&&L.push(Oo()),{httpClient:q.httpClient,requestPolicyFactories:L}}function Pr(q,k,L,G){return ri(q,k,L.parameterPath,L.mapper,G)}function ri(q,k,L,G,oe){var ge;let Ne;"string"==typeof L&&(L=[L]);const Ae=null===(ge=k.options)||void 0===ge?void 0:ge.serializerOptions;if(Array.isArray(L)){if(L.length>0){if(G.isConstant)Ne=G.defaultValue;else{let je=Mt(k,L);je.propertyFound||(je=Mt(q,L));let Fe=!1;je.propertyFound||(Fe=G.required||"options"===L[0]&&2===L.length),Ne=Fe?G.defaultValue:je.propertyValue}const He=Rr(L,G);oe.serialize(G,Ne,He,Ae)}}else{G.required&&(Ne={});for(const He in L){const je=G.type.modelProperties[He],Fe=L[He],ut=ri(q,k,Fe,je,oe),ht=Rr(Fe,je);oe.serialize(je,ut,ht,Ae),null!=ut&&(Ne||(Ne={}),Ne[He]=ut)}}return Ne}function Mt(q,k){const L={propertyFound:!1};let G=0;for(;G<k.length;++G){const oe=k[G];if(null==q||!(oe in q))break;q=q[oe]}return G===k.length&&(L.propertyValue=q,L.propertyFound=!0),L}function Br(q,k){const L=q.parsedHeaders,G=k&&k.bodyMapper,oe=ge=>Object.defineProperty(ge,"_response",{value:q});if(G){const ge=G.type.name;if("Stream"===ge)return oe(Object.assign(Object.assign({},L),{blobBody:q.blobBody,readableStreamBody:q.readableStreamBody}));const Ne="Composite"===ge&&G.type.modelProperties||{},Ae=Object.keys(Ne).some(He=>""===Ne[He].serializedName);if("Sequence"===ge||Ae){const He=[...q.parsedBody||[]];for(const je of Object.keys(Ne))Ne[je].serializedName&&(He[je]=q.parsedBody[je]);if(L)for(const je of Object.keys(L))He[je]=L[je];return oe(He),He}if("Composite"===ge||"Dictionary"===ge)return oe(Object.assign(Object.assign({},L),q.parsedBody))}return G||"HEAD"===q.request.method||T.ty(q.parsedBody)?oe(Object.assign(Object.assign({},L),{body:q.parsedBody})):oe(Object.assign(Object.assign({},L),q.parsedBody))}function Di(q){return(0,Fn.q)(q)}class Gn{constructor(k=12e4){this.cachedToken=void 0,this.tokenRefreshBufferMs=k}setCachedToken(k){this.cachedToken=k}getCachedToken(){return this.cachedToken&&Date.now()+this.tokenRefreshBufferMs>=this.cachedToken.expiresOnTimestamp&&(this.cachedToken=void 0),this.cachedToken}}class ho{constructor(k,L,G=3e4){this.credential=k,this.scopes=L,this.requiredMillisecondsBeforeNewRefresh=G,this.lastCalled=0}isReady(){return!this.lastCalled||Date.now()-this.lastCalled>this.requiredMillisecondsBeforeNewRefresh}getToken(k){var L=this;return(0,at.Z)(function*(){L.lastCalled=Date.now();const G=yield L.credential.getToken(L.scopes,k);return L.promise=void 0,G||void 0})()}refresh(k){return this.promise||(this.promise=this.getToken(k)),this.promise}}const Mi=_i.g.HeaderConstants;class tn{constructor(k,L,G="Basic"){if(this.authorizationScheme="Basic",null==k||"string"!=typeof k.valueOf())throw new Error("userName cannot be null or undefined and must be of type string.");if(null==L||"string"!=typeof L.valueOf())throw new Error("password cannot be null or undefined and must be of type string.");this.userName=k,this.password=L,this.authorizationScheme=G}signRequest(k){const G=`${this.authorizationScheme} ${q=`${this.userName}:${this.password}`,btoa(q)}`;var q;return k.headers||(k.headers=new h),k.headers.set(Mi.AUTHORIZATION,G),Promise.resolve(k)}}class Ai{constructor(k){if(!k||k&&!k.inHeader&&!k.inQuery)throw new Error('options cannot be null or undefined. Either "inHeader" or "inQuery" property of the options object needs to be provided.');this.inHeader=k.inHeader,this.inQuery=k.inQuery}signRequest(k){if(!k)return Promise.reject(new Error('webResource cannot be null or undefined and must be of type "object".'));if(this.inHeader){k.headers||(k.headers=new h);for(const L in this.inHeader)k.headers.set(L,this.inHeader[L])}if(this.inQuery){if(!k.url)return Promise.reject(new Error("url cannot be null in the request object."));k.url.indexOf("?")<0&&(k.url+="?");for(const L in this.inQuery)k.url.endsWith("?")||(k.url+="&"),k.url+=`${L}=${this.inQuery[L]}`}return Promise.resolve(k)}}class Ca extends Ai{constructor(k){if(!k||k&&"string"!=typeof k)throw new Error("topicKey cannot be null or undefined and must be of type string.");super({inHeader:{"aeg-sas-key":k}})}}},1138:(Q,m,u)=>{"use strict";u.d(m,{M:()=>s});var s=(()=>{return(b=s||(s={}))[b.OFF=0]="OFF",b[b.ERROR=1]="ERROR",b[b.WARNING=2]="WARNING",b[b.INFO=3]="INFO",s;var b})()},6354:(Q,m,u)=>{"use strict";u.d(m,{v:()=>I});var s=u(8239),b=u(2462),h=u(8006),p=u(969);const E={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function T(){return(T=(0,s.Z)(function*(f,c,v){function S(){return g.apply(this,arguments)}function g(){return(g=(0,s.Z)(function*(){if(!(Date.now()<v)){const R=yield f();if(null===R)throw new Error("Failed to refresh access token.");return R}try{return yield f()}catch(R){return null}})).apply(this,arguments)}let C=yield S();for(;null===C;)yield(0,p.g)(c),C=yield S();return C})).apply(this,arguments)}function I(f,c){const v=function(f,c,v){let S=null,g=null;const C=Object.assign(Object.assign({},E),v),R={get isRefreshing(){return null!==S},get shouldRefresh(){var _;return!R.isRefreshing&&(null!==(_=null==g?void 0:g.expiresOnTimestamp)&&void 0!==_?_:0)-C.refreshWindowInMs<Date.now()},get mustRefresh(){return null===g||g.expiresOnTimestamp-C.forcedRefreshWindowInMs<Date.now()}};function D(_){var N;return R.isRefreshing||(S=function(f,c,v){return T.apply(this,arguments)}(()=>f.getToken(c,_),C.retryIntervalInMs,null!==(N=null==g?void 0:g.expiresOnTimestamp)&&void 0!==N?N:Date.now()).then(y=>(S=null,g=y,g)).catch(y=>{throw S=null,g=null,y})),S}return function(){var _=(0,s.Z)(function*(N){return R.mustRefresh?D(N):(R.shouldRefresh&&D(N),g)});return function(N){return _.apply(this,arguments)}}()}(f,c);class S extends b.U{constructor(C,R){super(C,R)}sendRequest(C){var R=this;return(0,s.Z)(function*(){if(!C.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");const{token:D}=yield v({abortSignal:C.abortSignal,tracingOptions:{tracingContext:C.tracingContext}});return C.headers.set(h.g.HeaderConstants.AUTHORIZATION,`Bearer ${D}`),R._nextPolicy.sendRequest(C)})()}}return{create:(g,C)=>new S(g,C)}}},2462:(Q,m,u)=>{"use strict";u.d(m,{U:()=>b,_:()=>h});var s=u(1138);class b{constructor(E,d){this._nextPolicy=E,this._options=d}shouldLog(E){return this._options.shouldLog(E)}log(E,d){this._options.log(E,d)}}class h{constructor(E){this._logger=E}shouldLog(E){return!!this._logger&&E!==s.M.OFF&&E<=this._logger.minimumLogLevel}log(E,d){this._logger&&this.shouldLog(E)&&this._logger.log(E,d)}}},369:(Q,m,u)=>{"use strict";u.d(m,{$4:()=>b,UK:()=>h});var s=u(7694);class b{constructor(){this._rawQuery={}}any(){return Object.keys(this._rawQuery).length>0}keys(){return Object.keys(this._rawQuery)}set(M,U){const $=U;if(M)if(null!=$){const j=Array.isArray($)?$:$.toString();this._rawQuery[M]=j}else delete this._rawQuery[M]}get(M){return M?this._rawQuery[M]:void 0}toString(){let M="";for(const U in this._rawQuery){M&&(M+="&");const $=this._rawQuery[U];if(Array.isArray($)){const j=[];for(const ue of $)j.push(`${U}=${ue}`);M+=j.join("&")}else M+=`${U}=${$}`}return M}static parse(M){const U=new b;if(M){M.startsWith("?")&&(M=M.substring(1));let $="ParameterName",j="",ue="";for(let Z=0;Z<M.length;++Z){const Y=M[Z];switch($){case"ParameterName":switch(Y){case"=":$="ParameterValue";break;case"&":j="",ue="";break;default:j+=Y}break;case"ParameterValue":switch(Y){case"&":U.set(j,ue),j="",ue="",$="ParameterName";break;default:ue+=Y}break;default:throw new Error("Unrecognized URLQuery parse state: "+$)}}"ParameterValue"===$&&U.set(j,ue)}return U}}class h{setScheme(M){M?this.set(M,"SCHEME"):this._scheme=void 0}getScheme(){return this._scheme}setHost(M){M?this.set(M,"SCHEME_OR_HOST"):this._host=void 0}getHost(){return this._host}setPort(M){null==M||""===M?this._port=void 0:this.set(M.toString(),"PORT")}getPort(){return this._port}setPath(M){if(M){const U=M.indexOf("://");if(-1!==U){const $=M.lastIndexOf("/",U);this.set(-1===$?M:M.substr($+1),"SCHEME")}else this.set(M,"PATH")}else this._path=void 0}appendPath(M){if(M){let U=this.getPath();U&&(U.endsWith("/")||(U+="/"),M.startsWith("/")&&(M=M.substring(1)),M=U+M),this.set(M,"PATH")}}getPath(){return this._path}setQuery(M){this._query=M?b.parse(M):void 0}setQueryParameter(M,U){M&&(this._query||(this._query=new b),this._query.set(M,U))}getQueryParameterValue(M){return this._query?this._query.get(M):void 0}getQuery(){return this._query?this._query.toString():void 0}set(M,U){const $=new d(M,U);for(;$.next();){const j=$.current();let ue;if(j)switch(j.type){case"SCHEME":this._scheme=j.text||void 0;break;case"HOST":this._host=j.text||void 0;break;case"PORT":this._port=j.text||void 0;break;case"PATH":ue=j.text||void 0,(!this._path||"/"===this._path||"/"!==ue)&&(this._path=ue);break;case"QUERY":this._query=b.parse(j.text);break;default:throw new Error(`Unrecognized URLTokenType: ${j.type}`)}}}toString(){let M="";return this._scheme&&(M+=`${this._scheme}://`),this._host&&(M+=this._host),this._port&&(M+=`:${this._port}`),this._path&&(this._path.startsWith("/")||(M+="/"),M+=this._path),this._query&&this._query.any()&&(M+=`?${this._query.toString()}`),M}replaceAll(M,U){M&&(this.setScheme((0,s.ko)(this.getScheme(),M,U)),this.setHost((0,s.ko)(this.getHost(),M,U)),this.setPort((0,s.ko)(this.getPort(),M,U)),this.setPath((0,s.ko)(this.getPath(),M,U)),this.setQuery((0,s.ko)(this.getQuery(),M,U)))}static parse(M){const U=new h;return U.set(M,"SCHEME_OR_HOST"),U}}class p{constructor(M,U){this.text=M,this.type=U}static scheme(M){return new p(M,"SCHEME")}static host(M){return new p(M,"HOST")}static port(M){return new p(M,"PORT")}static path(M){return new p(M,"PATH")}static query(M){return new p(M,"QUERY")}}class d{constructor(M,U){this._text=M,this._textLength=M?M.length:0,this._currentState=null!=U?U:"SCHEME_OR_HOST",this._currentIndex=0}current(){return this._currentToken}next(){if(A(this))switch(this._currentState){case"SCHEME":!function(y){const M=function(y){return v(y,M=>function(y){const M=y.charCodeAt(0);return 48<=M&&M<=57||65<=M&&M<=90||97<=M&&M<=122}(M))}(y);y._currentToken=p.scheme(M),y._currentState=A(y)?"HOST":"DONE"}(this);break;case"SCHEME_OR_HOST":!function(y){const M=g(y,":","/","?");A(y)?":"===I(y)?"://"===c(y,3)?(y._currentToken=p.scheme(M),y._currentState="HOST"):(y._currentToken=p.host(M),y._currentState="PORT"):(y._currentToken=p.host(M),y._currentState="/"===I(y)?"PATH":"QUERY"):(y._currentToken=p.host(M),y._currentState="DONE")}(this);break;case"HOST":!function(y){"://"===c(y,3)&&f(y,3);const M=g(y,":","/","?");y._currentToken=p.host(M),y._currentState=A(y)?":"===I(y)?"PORT":"/"===I(y)?"PATH":"QUERY":"DONE"}(this);break;case"PORT":!function(y){":"===I(y)&&f(y);const M=g(y,"/","?");y._currentToken=p.port(M),y._currentState=A(y)?"/"===I(y)?"PATH":"QUERY":"DONE"}(this);break;case"PATH":!function(y){const M=g(y,"?");y._currentToken=p.path(M),y._currentState=A(y)?"QUERY":"DONE"}(this);break;case"QUERY":!function(y){"?"===I(y)&&f(y);const M=function(y){let M="";return y._currentIndex<y._textLength&&(M=y._text.substring(y._currentIndex),y._currentIndex=y._textLength),M}(y);y._currentToken=p.query(M),y._currentState="DONE"}(this);break;default:throw new Error(`Unrecognized URLTokenizerState: ${this._currentState}`)}else this._currentToken=void 0;return!!this._currentToken}}function A(y){return y._currentIndex<y._textLength}function I(y){return y._text[y._currentIndex]}function f(y,M){A(y)&&(M||(M=1),y._currentIndex+=M)}function c(y,M){let U=y._currentIndex+M;return y._textLength<U&&(U=y._textLength),y._text.substring(y._currentIndex,U)}function v(y,M){let U="";for(;A(y);){const $=I(y);if(!M($))break;U+=$,f(y)}return U}function g(y,...M){return v(y,U=>-1===M.indexOf(U))}},8006:(Q,m,u)=>{"use strict";u.d(m,{g:()=>s});const s={coreHttpVersion:"2.2.5",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",NO_PROXY:"NO_PROXY",ALL_PROXY:"ALL_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429,ServiceUnavailable:503}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}}},969:(Q,m,u)=>{"use strict";u.d(m,{g:()=>p});var s=u(5283);function p(E,d,T){return new Promise((A,I)=>{let f,c;const v=()=>I(new s._((null==T?void 0:T.abortErrorMsg)?null==T?void 0:T.abortErrorMsg:"The operation was aborted.")),S=()=>{(null==T?void 0:T.abortSignal)&&c&&T.abortSignal.removeEventListener("abort",c)};if(c=()=>(function(E){return null!=E}(f)&&clearTimeout(f),S(),v()),(null==T?void 0:T.abortSignal)&&T.abortSignal.aborted)return v();f=setTimeout(()=>{S(),A(d)},E),(null==T?void 0:T.abortSignal)&&T.abortSignal.addEventListener("abort",c)})}},4510:(Q,m,u)=>{"use strict";u.d(m,{c:()=>s,I:()=>b});const s="$",b="_"},7694:(Q,m,u)=>{"use strict";u.d(m,{ef:()=>ue,Hh:()=>D,Zf:()=>M,Rl:()=>y,_9:()=>Y,UG:()=>C,Kn:()=>ne,ty:()=>ce,TP:()=>P,WQ:()=>j,_Q:()=>U,yj:()=>$,ko:()=>W,Fl:()=>N,eg:()=>_});var b,s=u(4510),h=new Uint8Array(16);function p(){if(!b&&!(b="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return b(h)}const E=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,T=function(X){return"string"==typeof X&&E.test(X)};for(var A=[],I=0;I<256;++I)A.push((I+256).toString(16).substr(1));const S=function(X,de,te){var K=(X=X||{}).random||(X.rng||p)();if(K[6]=15&K[6]|64,K[8]=63&K[8]|128,de){te=te||0;for(var re=0;re<16;++re)de[te+re]=K[re];return de}return function(X){var de=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,te=(A[X[de+0]]+A[X[de+1]]+A[X[de+2]]+A[X[de+3]]+"-"+A[X[de+4]]+A[X[de+5]]+"-"+A[X[de+6]]+A[X[de+7]]+"-"+A[X[de+8]]+A[X[de+9]]+"-"+A[X[de+10]]+A[X[de+11]]+A[X[de+12]]+A[X[de+13]]+A[X[de+14]]+A[X[de+15]]).toLowerCase();if(!T(te))throw TypeError("Stringified UUID is invalid");return te}(K)},g=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,C="undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node;function D(X){return encodeURIComponent(X).replace(/!/g,"%21").replace(/"/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function _(X){const de={};return de.body=X.bodyAsText,de.headers=X.headers,de.status=X.status,de}function N(X){const de=X.clone();return de.headers&&de.headers.remove("authorization"),de}function P(X){return g.test(X)}function y(){return S()}function M(X,de){let te=Promise.resolve(de);return X.forEach(K=>{te=te.then(K)}),te}function U(X){if("function"!=typeof X.then)throw new Error("The provided input is not a Promise.");return de=>{X.then(te=>de(void 0,te)).catch(te=>{de(te)})}}function $(X){if("function"!=typeof X.then)throw new Error("The provided input is not a Promise.");return de=>{X.then(te=>process.nextTick(de,void 0,te.parsedBody,te.request,te)).catch(te=>{process.nextTick(de,te)})}}function j(X,de,te,K){if(Array.isArray(X)||(X=[X]),!te||!K)return{[de]:X};const re={[de]:X};return re[s.c]={[te]:K},re}function ue(X,de){const te=X;de.forEach(K=>{Object.getOwnPropertyNames(K.prototype).forEach(re=>{te.prototype[re]=K.prototype[re]})})}const Z=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Y(X){return Z.test(X)}function W(X,de,te){return X&&de?X.split(de).join(te||""):X}function ce(X){return"object"!=typeof X&&"function"!=typeof X||null===X}function ne(X){return!("object"!=typeof X||null===X||Array.isArray(X)||X instanceof RegExp||X instanceof Date)}},1259:(Q,m,u)=>{"use strict";u.d(m,{q:()=>p});var s=u(1643),b=u(7504);function p(E){return function(d,T){const A=(0,s.Yz)(),I=(null==T?void 0:T.tracingOptions)||{},f=Object.assign({kind:s.MU.INTERNAL},I.spanOptions),c=E.packagePrefix?`${E.packagePrefix}.${d}`:d;let v;v=function(){var E;if("undefined"==typeof process)return!1;const d=null===(E=process.env.AZURE_TRACING_DISABLED)||void 0===E?void 0:E.toLowerCase();return"false"!==d&&"0"!==d&&Boolean(d)}()?b.g4.wrapSpanContext(b.Rr):A.startSpan(c,f,I.tracingContext),E.namespace&&v.setAttribute("az.namespace",E.namespace);let S=I.spanOptions||{};v.isRecording()&&E.namespace&&(S=Object.assign(Object.assign({},I.spanOptions),{attributes:Object.assign(Object.assign({},f.attributes),{"az.namespace":E.namespace})}));const g=Object.assign(Object.assign({},I),{spanOptions:S,tracingContext:(0,s.WZ)(I.tracingContext||s.Do.active(),v)});return{span:v,updatedOptions:Object.assign(Object.assign({},T),{tracingOptions:g})}}}},1643:(Q,m,u)=>{"use strict";u.d(m,{MU:()=>b,WZ:()=>p,BM:()=>T,Yz:()=>A,Do:()=>I,Qn:()=>f});var s=u(7504),b=(()=>{return(c=b||(b={}))[c.INTERNAL=0]="INTERNAL",c[c.SERVER=1]="SERVER",c[c.CLIENT=2]="CLIENT",c[c.PRODUCER=3]="PRODUCER",c[c.CONSUMER=4]="CONSUMER",b;var c})();function p(c,v){return s.g4.setSpan(c,v)}function T(c){return s.g4.isSpanContextValid(c)}function A(c,v){return s.g4.getTracer(c||"azure/core-tracing",v)}const I=s.Do;var f=(()=>{return(c=f||(f={}))[c.UNSET=0]="UNSET",c[c.OK=1]="OK",c[c.ERROR=2]="ERROR",f;var c})()},1326:(Q,m,u)=>{"use strict";u.d(m,{YR:()=>U});const b="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let h,p=[],E=[];const d=[];b&&A(b);const T=Object.assign(Y=>c(Y),{enable:A,enabled:I,disable:function(){const Y=h||"";return A(""),Y},log:function(...Y){if(Y.length>0){const W=String(Y[0]);W.includes(":error")?console.error(...Y):W.includes(":warning")?console.warn(...Y):W.includes(":info")?console.info(...Y):(W.includes(":verbose"),console.debug(...Y))}}});function A(Y){h=Y,p=[],E=[];const W=/\*/g,ce=Y.split(",").map(Ce=>Ce.trim().replace(W,".*?"));for(const Ce of ce)Ce.startsWith("-")?E.push(new RegExp(`^${Ce.substr(1)}$`)):p.push(new RegExp(`^${Ce}$`));for(const Ce of d)Ce.enabled=I(Ce.namespace)}function I(Y){if(Y.endsWith("*"))return!0;for(const W of E)if(W.test(Y))return!1;for(const W of p)if(W.test(Y))return!0;return!1}function c(Y){const W=Object.assign(function(...Ce){!W.enabled||(Ce.length>0&&(Ce[0]=`${Y} ${Ce[0]}`),W.log(...Ce))},{enabled:I(Y),destroy:v,log:T.log,namespace:Y,extend:S});return d.push(W),W}function v(){const Y=d.indexOf(this);return Y>=0&&(d.splice(Y,1),!0)}function S(Y){const W=c(`${this.namespace}:${Y}`);return W.log=this.log,W}const g=T,C=new Set,R="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let D;const _=g("azure");_.log=(...Y)=>{g.log(...Y)};const N=["verbose","info","warning","error"];R&&(Z(R)?function(Y){if(Y&&!Z(Y))throw new Error(`Unknown log level '${Y}'. Acceptable values: ${N.join(",")}`);D=Y;const W=[];for(const ce of C)ue(ce)&&W.push(ce.namespace);g.enable(W.join(","))}(R):console.error(`AZURE_LOG_LEVEL set to unknown log level '${R}'; logging is not enabled. Acceptable values: ${N.join(", ")}.`));const M={verbose:400,info:300,warning:200,error:100};function U(Y){const W=_.extend(Y);return $(_,W),{error:j(W,"error"),warning:j(W,"warning"),info:j(W,"info"),verbose:j(W,"verbose")}}function $(Y,W){W.log=(...ce)=>{Y.log(...ce)}}function j(Y,W){const ce=Object.assign(Y.extend(W),{level:W});if($(Y,ce),ue(ce)){const Ce=g.disable();g.enable(Ce+","+ce.namespace)}return C.add(ce),ce}function ue(Y){return!!(D&&M[Y.level]<=M[D])}function Z(Y){return N.includes(Y)}},5413:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(1819)),p=u(2e3),E=function d(){(0,b.default)(this,d)};m.default=E,(0,h.default)(E,"requiredOmnichannelConfigurationParameters",["orgUrl","orgId","widgetId"]),(0,h.default)(E,"defaultHeaders",{"Content-Type":"application/json"}),(0,h.default)(E,"bypassCacheHeaders",{"cache-control":"no-store, must-revalidate, no-cache"}),(0,h.default)(E,"defaultChannelId",p.ChannelId.LCW),(0,h.default)(E,"defaultLocale","en-us"),(0,h.default)(E,"noContentStatusCode",204),(0,h.default)(E,"sensitiveProperties",["AuthenticatedUserToken"]),(0,h.default)(E,"transactionid","transaction-id"),(0,h.default)(E,"customerDisplayName","customerDisplayName")},2e3:(Q,m)=>{"use strict";var u,T,s,b,h,p,E,d;Object.defineProperty(m,"__esModule",{value:!0}),m.LiveChatVersion=m.OCSDKTelemetryEvent=m.ChannelId=m.OperatingSystem=m.DeviceType=m.Browser=m.BrowserVendor=void 0,m.BrowserVendor=u,(T=u||(m.BrowserVendor=u={})).IE="IE",T.CHROME="Chrome",T.FIREFOX="Firefox",T.SAFARI="Safari",T.EDGE="Edge",T.EDGE_CHROMIUM="Edg",T.OPERA="Opera",T.UNKNOWN="Unknown",m.Browser=s,function(T){T[T.Chrome=0]="Chrome",T[T.Firefox=1]="Firefox",T[T.Ie=2]="Ie",T[T.Edge=3]="Edge",T[T.Safari=4]="Safari",T[T.None=5]="None"}(s||(m.Browser=s={})),m.DeviceType=b,function(T){T.Desktop="Desktop",T.Mobile="Mobile",T.Tablet="Tablet"}(b||(m.DeviceType=b={})),m.OperatingSystem=h,function(T){T.WINDOWS="Windows",T.MACOSX="Mac OS X",T.WINDOWS_PHONE="Windows Phone",T.WINDOWS_RT="Windows RT",T.IOS="iOS",T.ANDROID="Android",T.LINUX="Linux",T.UNKNOWN="Unknown"}(h||(m.OperatingSystem=h={})),m.ChannelId=p,function(T){T.LCW="lcw",T.SMS="sms",T.FACEBOOK="facebook",T.WECHAT="wechat"}(p||(m.ChannelId=p={})),m.OCSDKTelemetryEvent=E,function(T){T.GETCHATCONFIG="GetChatConfig",T.GETCHATCONFIGSUCCESS="GetChatConfigSucceeded",T.GETRECONNECTABLECHATS="GetReconnnectableChats",T.GETRECONNECTAVAILABILITY="GetReconnnectableAvailability",T.GETCHATTOKENSTARTED="GetChatTokenStarted",T.GETCHATTOKENSUCCEEDED="GetChatTokenSucceeded",T.GETCHATTOKENFAILED="GetChatTokenFailed",T.GETLWISTATUSSTARTED="GetLwiStatusStarted",T.GETLWISTATUSSUCCEEDED="GetLwiStatusSucceeded",T.GETLWISTATUSFAILED="GetLwiStatusFailed",T.SESSIONINITSTARTED="SessionInitStarted",T.SESSIONINITSUCCEEDED="SessionInitSucceeded",T.SESSIONINITFAILED="SessionInitFailed",T.SESSIONCLOSESTARTED="SessionCloseStarted",T.SESSIONCLOSESUCCEEDED="SessionCloseSucceeded",T.SESSIONCLOSEFAILED="SessionCloseFailed",T.SUBMITPOSTCHATSTARTED="SubmitPostChatStarted",T.SUBMITPOSTCHATSUCCEEDED="SubmitPostChatSucceeded",T.SUBMITPOSTCHATFAILED="SubmitPostChatFailed",T.GETCHATTRANSCRIPTSTARTED="GetChatTranscriptStarted",T.GETCHATTRANSCRIPTSUCCEEDED="GetChatTranscriptSucceeded",T.GETCHATTRANSCRIPTFAILED="GetChatTranscriptFailed",T.EMAILTRANSCRIPTSTARTED="EmailTranscriptStarted",T.EMAILTRANSCRIPTSUCCEEDED="EmailTranscriptSucceeded",T.EMAILTRANSCRIPTFAILED="EmailTranscriptFailed",T.FETCHDATAMASKINGSTARTED="FetchDataMaskingStarted",T.FETCHDATAMASKINGSUCCEEDED="FetchDataMaskingSucceeded",T.FETCHDATAMASKINGFAILED="FetchDataMaskingFailed",T.SECONDARYCHANNELEVENTREQUESTSTARTED="SecondaryChannelEventRequestStarted",T.SECONDARYCHANNELEVENTREQUESTSUCCEEDED="SecondaryChannelEventRequestSucceeded",T.SECONDARYCHANNELEVENTREQUESTFAILED="SecondaryChannelEventRequestFailed",T.GETSURVEYINVITELINKSTARTED="GetSurveyInviteLinkStarted",T.GETSURVEYINVITELINKSUCCEEDED="GetSurveyInviteLinkSucceeded",T.GETSURVEYINVITELINKFAILED="GetSurveyInviteLinkFailed",T.VALIDATEAUTHCHATRECORDSTARTED="ValidateAuthChatRecordStarted",T.VALIDATEAUTHCHATRECORDSUCCEEDED="ValidateAuthChatRecordSucceeded",T.VALIDATEAUTHCHATRECORDFAILED="ValidateAuthChatRecordFailed",T.GETQUEUEAVAILABILITYSTARTED="GetQueueAvailabilityStarted",T.GETQUEUEAVAILABILITYSUCCEEDED="GetQueueAvailabilitySucceeded",T.GETQUEUEAVAILABILITYFAILED="GetQueueAvailabilityFailed",T.SENDTYPINGINDICATORFAILED="SendTypingIndicatorFailed",T.SENDTYPINGINDICATORSUCCEEDED="SendTypingIndicatorSucceeded"}(E||(m.OCSDKTelemetryEvent=E={})),m.LiveChatVersion=d,function(T){T[T.V1=1]="V1",T[T.V2=2]="V2"}(d||(m.LiveChatVersion=d={}))},3096:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(2805));m.default=function(){function E(){(0,b.default)(this,E)}return(0,h.default)(E,null,[{key:"OCSDKLOAD",get:function(){return"oc:sdk:load"}}]),E}()},4950:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(1819)),p=function E(){(0,b.default)(this,E)};m.default=p,(0,h.default)(p,"supportedLocales",["ar-sa","bg-bg","ca-es","cs-cz","da-dk","de-de","el-gr","en-us","es-es","et-ee","eu-es","fi-fi","fr-fr","gl-es","he-il","hi-in","hr-hr","hu-hu","id-id","it-it","ja-jp","kk-kz","ko-kr","lt-lt","lv-lv","ms-my","nb-no","nl-nl","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sr-cyrl-cs","sr-latn-cs","sv-se","th-th","tr-tr","uk-ua","vi-vn","zh-cn","zh-hk","zh-tw"])},4162:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(2805)),p=s(u(1819)),E=s(u(7276));m.default=function(){function T(A){(0,b.default)(this,T),(0,p.default)(this,"logger",void 0),this.logger=A}return(0,h.default)(T,[{key:"log",value:function(I,f,c,v){if(this.isLoggingEnabled()){var S=E.default.GETTELEMETRYEVENTDATA(f,c,v);this.logEvent(I,S)}}},{key:"logEvent",value:function(I,f){this.isLoggingEnabled()&&setTimeout(this.logger.logClientSdkTelemetryEvent.bind(this.logger),0,I,f)}},{key:"isLoggingEnabled",value:function(){return!this.isNullOrUndefined(this.logger)}},{key:"isNullOrUndefined",value:function(I){return null==I}}]),T}()},2172:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(1819)),p=function E(){(0,b.default)(this,E)};m.default=p,(0,h.default)(p,"LiveChatConfigPath","livechatconnector/config"),(0,h.default)(p,"LiveChatSessionInitPath","livechatconnector/sessioninit"),(0,h.default)(p,"LiveChatAuthSessionInitPath","livechatconnector/auth/sessioninit"),(0,h.default)(p,"LiveChatGetChatTokenPath","livechatconnector/getchattoken"),(0,h.default)(p,"LiveChatv2GetChatTokenPath","livechatconnector/v2/getchattoken"),(0,h.default)(p,"LiveChatAuthGetChatTokenPath","livechatconnector/auth/getchattoken"),(0,h.default)(p,"LiveChatv2AuthGetChatTokenPath","livechatconnector/v2/auth/getchattoken"),(0,h.default)(p,"LiveChatSessionClosePath","livechatconnector/sessionclose"),(0,h.default)(p,"LiveChatAuthSessionClosePath","livechatconnector/auth/sessionclose"),(0,h.default)(p,"LiveChatSubmitPostChatPath","survey/submitpostchat"),(0,h.default)(p,"LiveChatAuthSubmitPostChatPath","survey/auth/submitpostchat"),(0,h.default)(p,"LiveChatGetSurveyInviteLinkPath","livechatconnector/getsurveyinvite"),(0,h.default)(p,"LiveChatAuthGetSurveyInviteLinkPath","livechatconnector/auth/getsurveyinvite"),(0,h.default)(p,"LiveChatGetChatTranscriptPath","livechatconnector/getchattranscripts"),(0,h.default)(p,"LiveChatv2GetChatTranscriptPath","livechatconnector/v2/getchattranscripts"),(0,h.default)(p,"LiveChatAuthGetChatTranscriptPath","livechatconnector/auth/getchattranscripts"),(0,h.default)(p,"LiveChatv2AuthGetChatTranscriptPath","livechatconnector/v2/auth/getchattranscripts"),(0,h.default)(p,"LiveChatTranscriptEmailRequestPath","livechatconnector/createemailrequest"),(0,h.default)(p,"LiveChatAuthTranscriptEmailRequestPath","livechatconnector/auth/createemailrequest"),(0,h.default)(p,"LiveChatFetchDataMaskingInfoPath","livechatconnector/fetchdatamaskinginfo"),(0,h.default)(p,"LiveChatSecondaryChannelEventPath","livechatconnector/secondarychannelevent"),(0,h.default)(p,"LiveChatAuthSecondaryChannelEventPath","livechatconnector/auth/secondarychannelevent"),(0,h.default)(p,"LiveChatLiveWorkItemDetailsPath","livechatconnector/getliveworkitemdetails"),(0,h.default)(p,"LiveChatAuthLiveWorkItemDetailsPath","livechatconnector/auth/getliveworkitemdetails"),(0,h.default)(p,"LiveChatGetReconnectableChatsPath","livechatconnector/auth/reconnectablechats"),(0,h.default)(p,"LiveChatReconnectAvailabilityPath","livechatconnector/reconnect"),(0,h.default)(p,"LiveChatValidateAuthChatMapRecordPath","livechatconnector/auth/validateauthchatmaprecord"),(0,h.default)(p,"GetQueueAvailabilityPath","livechatconnector/auth/getqueueavailability"),(0,h.default)(p,"SendTypingIndicatorPath","inbound/typingindicator/livechat/sendtypingindicator")},1858:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(1819)),p=function E(){(0,b.default)(this,E)};m.default=p,(0,h.default)(p,"authenticatedUserToken","AuthenticatedUserToken"),(0,h.default)(p,"authorization","Authorization"),(0,h.default)(p,"organizationId","OrganizationId"),(0,h.default)(p,"widgetAppId","widgetAppId"),(0,h.default)(p,"requestId","Request-Id")},6528:(Q,m)=>{"use strict";var u,s;Object.defineProperty(m,"__esModule",{value:!0}),m.LogLevel=void 0,m.LogLevel=u,(s=u||(m.LogLevel=u={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR"},8634:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(6533)),h=s(u(1907)),p=s(u(1298)),E=s(u(8884)),d=s(u(2805)),T=s(u(1819)),A=u(2e3),I=s(u(8686)),f=u(4717),c=s(u(5413)),v=u(6812),S=s(u(4950)),g=u(9569),C=u(6528),R=u(7169),D=s(u(2172)),_=s(u(1858)),N=u(3945),P=s(u(1729)),y=u(8566);function M(Y,W){var ce=Object.keys(Y);if(Object.getOwnPropertySymbols){var Ce=Object.getOwnPropertySymbols(Y);W&&(Ce=Ce.filter(function(ne){return Object.getOwnPropertyDescriptor(Y,ne).enumerable})),ce.push.apply(ce,Ce)}return ce}function U(Y){for(var W=1;W<arguments.length;W++){var ce=null!=arguments[W]?arguments[W]:{};W%2?M(Object(ce),!0).forEach(function(Ce){(0,T.default)(Y,Ce,ce[Ce])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Y,Object.getOwnPropertyDescriptors(ce)):M(Object(ce)).forEach(function(Ce){Object.defineProperty(Y,Ce,Object.getOwnPropertyDescriptor(ce,Ce))})}return Y}function $(Y,W){var ce="undefined"!=typeof Symbol&&Y[Symbol.iterator]||Y["@@iterator"];if(!ce){if(Array.isArray(Y)||(ce=function(Y,W){if(Y){if("string"==typeof Y)return ue(Y,W);var ce=Object.prototype.toString.call(Y).slice(8,-1);if("Object"===ce&&Y.constructor&&(ce=Y.constructor.name),"Map"===ce||"Set"===ce)return Array.from(Y);if("Arguments"===ce||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ce))return ue(Y,W)}}(Y))||W&&Y&&"number"==typeof Y.length){ce&&(Y=ce);var Ce=0,ne=function(){};return{s:ne,n:function(){return Ce>=Y.length?{done:!0}:{done:!1,value:Y[Ce++]}},e:function(re){throw re},f:ne}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var te,X=!0,de=!1;return{s:function(){ce=ce.call(Y)},n:function(){var re=ce.next();return X=re.done,re},e:function(re){de=!0,te=re},f:function(){try{!X&&null!=ce.return&&ce.return()}finally{if(de)throw te}}}}function ue(Y,W){(null==W||W>Y.length)&&(W=Y.length);for(var ce=0,Ce=new Array(W);ce<W;ce++)Ce[ce]=Y[ce];return Ce}var Z=function(){function Y(W){var ce=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y.defaultConfiguration,Ce=arguments.length>2?arguments[2]:void 0;(0,E.default)(this,Y),this.omnichannelConfiguration=W,this.configuration=ce,this.logger=Ce,(0,T.default)(this,"liveChatVersion",void 0),(!Object.keys(this.configuration).length||"object"!==(0,p.default)(ce))&&(this.configuration=Y.defaultConfiguration);for(var ne=0,X=Object.keys(Y.defaultConfiguration);ne<X.length;ne++){var de=X[ne];if(!this.configuration.hasOwnProperty(de))throw new Error("Missing '".concat(de,"' in SDKConfiguration"))}var te=W.channelId;if(!Object.values(A.ChannelId).includes(te))throw new Error("Invalid channelId");var ve,K=Object.keys(W),re=$(c.default.requiredOmnichannelConfigurationParameters);try{for(re.s();!(ve=re.n()).done;){var be=ve.value;if(!K.includes(be))throw new Error("Missing '".concat(be,"' in OmnichannelConfiguration"))}}catch(Be){re.e(Be)}finally{re.f()}this.liveChatVersion=A.LiveChatVersion.V1}return(0,d.default)(Y,[{key:"getChatConfig",value:(W=(0,h.default)(b.default.mark(function Ce(ne){var X,de,te,K,re,ve,be,Be,$e=arguments;return b.default.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return X=$e.length>1&&void 0!==$e[1]&&$e[1],de=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETCHATCONFIG,{RequestId:ne},"Get Chat Config Started"),ne||(ne=(0,y.uuidv4)()),te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatConfigPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"?requestId=").concat(ne,"&channelId=").concat(this.omnichannelConfiguration.channelId),K=I.default.create(),(0,P.default)(K,{retries:this.configuration.maxRequestRetriesOnFailure}),re={},X&&(re=U(U({},c.default.bypassCacheHeaders),re)),se.next=11,K.get(te,{headers:re});case 11:return be=de.milliSecondsElapsed,(Be=(ve=se.sent).data).LiveChatVersion&&Be.LiveChatVersion===A.LiveChatVersion.V2&&(this.liveChatVersion=Be.LiveChatVersion),Be.headers={},ve.headers&&ve.headers.date&&(Be.headers.date=ve.headers.date),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETCHATCONFIGSUCCESS,{RequestId:ne,Region:ve.data.Region,ElapsedTimeInMilliseconds:be,TransactionId:ve.headers["transaction-id"]},"Get Chat config succeeded"),se.abrupt("return",Be);case 19:case"end":return se.stop()}},Ce,this)})),function(Ce){return W.apply(this,arguments)})},{key:"getLWIDetails",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,K,re,ve,be,Be,$e,X=this,Oe=arguments;return b.default.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return de=Oe.length>1&&void 0!==Oe[1]?Oe[1]:{},te=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETLWISTATUSSTARTED,{RequestId:ne},"Get LWI Details Started"),ne||(ne=(0,y.uuidv4)()),K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatLiveWorkItemDetailsPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),re=I.default.create(),(0,P.default)(re,{retries:this.configuration.maxRequestRetriesOnFailure}),be=de.reconnectId,Be=c.default.defaultHeaders,(ve=de.authenticatedUserToken)&&(K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthLiveWorkItemDetailsPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),Be[_.default.authenticatedUserToken]=ve),be&&(K+="/".concat(be)),K+="?channelId=".concat(this.omnichannelConfiguration.channelId),$e={headers:Be,method:"GET",url:K},fe.abrupt("return",new Promise(function(){var we=(0,h.default)(b.default.mark(function Te(ye,Pe){var Ve,Ue,Ie,We;return b.default.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:return Ge.prev=0,Ge.next=3,re($e);case 3:Ue=te.milliSecondsElapsed,Ie=(Ve=Ge.sent).data,X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETLWISTATUSSUCCEEDED,{RequestId:ne,Region:Ve.data.Region,ElapsedTimeInMilliseconds:Ue,TransactionId:Ve.headers["transaction-id"]},"Get LWI Details succeeded"),ye(Ie),Ge.next=18;break;case 10:if(Ge.prev=10,Ge.t0=Ge.catch(0),We=te.milliSecondsElapsed,!X.logger){Ge.next=17;break}return Ge.next=16,g.LoggingSanitizer.stripErrorSensitiveProperties(Ge.t0);case 16:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.GETLWISTATUSFAILED,{RequestId:ne,ExceptionDetails:Ge.t0,ElapsedTimeInMilliseconds:We},"Get LWI Details failed");case 17:Pe();case 18:case"end":return Ge.stop()}},Te,null,[[0,10]])}));return function(Te,ye){return we.apply(this,arguments)}}()));case 14:case"end":return fe.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"getChatToken",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,K,re,ve,be,Be,$e,Oe,se,X=this,fe=arguments;return b.default.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(de=fe.length>1&&void 0!==fe[1]?fe[1]:{},te=fe.length>2&&void 0!==fe[2]?fe[2]:0,K=N.Timer.TIMER(),re=de.reconnectId,ve=de.authenticatedUserToken,be=de.currentLiveChatVersion,this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETCHATTOKENSTARTED,{RequestId:ne},"Get Chat Token Started"),!(te<0)){Te.next=7;break}throw new Error("Invalid currentRetryCount");case 7:return ne||(ne=(0,y.uuidv4)()),Be=c.default.defaultHeaders,$e="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatGetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),this.liveChatVersion===A.LiveChatVersion.V2||be&&be===A.LiveChatVersion.V2?($e="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatv2GetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),ve&&($e="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatv2AuthGetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),Be[_.default.authenticatedUserToken]=ve)):ve&&($e="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthGetChatTokenPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),Be[_.default.authenticatedUserToken]=ve),re&&($e+="/".concat(re)),$e+="?channelId=".concat(this.omnichannelConfiguration.channelId),Oe={headers:Be,method:"GET",url:$e},se=I.default.create(),(0,P.default)(se,{retries:this.configuration.maxRequestRetriesOnFailure}),Te.abrupt("return",new Promise(function(){var ye=(0,h.default)(b.default.mark(function Pe(Ve,Ue){var Ie,We,Qe,Ge;return b.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Le.prev=0,Le.next=3,se(Oe);case 3:if(We=K.milliSecondsElapsed,!(Qe=(Ie=Le.sent).data)){Le.next=11;break}return Qe.requestId=ne,X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETCHATTOKENSUCCEEDED,{RequestId:ne,Region:Ie.data.Region,ElapsedTimeInMilliseconds:We,TransactionId:Ie.headers["transaction-id"]},"Get Chat Token Succeeded"),Ve(Qe),Le.abrupt("return");case 11:if(!re||Ie.status!==c.default.noContentStatusCode){Le.next=14;break}return Ue(Ie),Le.abrupt("return");case 14:Le.next=25;break;case 16:if(Le.prev=16,Le.t0=Le.catch(0),Ge=K.milliSecondsElapsed,!X.logger){Le.next=23;break}return Le.next=22,g.LoggingSanitizer.stripErrorSensitiveProperties(Le.t0);case 22:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.GETCHATTOKENFAILED,{RequestId:ne,ExceptionDetails:Le.t0,ElapsedTimeInMilliseconds:Ge},"Get Chat Token Failed");case 23:return Ue(Le.t0),Le.abrupt("return");case 25:if(!(te+1>=X.configuration.getChatTokenRetryCount)){Le.next=28;break}return Ue(new Error("The retry for getchattoken has exceeded its max value of ".concat(X.configuration.getChatTokenRetryCount))),Le.abrupt("return");case 28:setTimeout(function(){X.getChatToken(ne,de,te+1).then(function(at){return Ve(at)}).catch(function(at){return Ue(at)})},X.configuration.getChatTokenTimeBetweenRetriesOnFailure);case 29:case"end":return Le.stop()}},Pe,null,[[0,16]])}));return function(Pe,Ve){return ye.apply(this,arguments)}}()));case 17:case"end":return Te.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"getReconnectableChats",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,K,re,ve,be,X=this;return b.default.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return de=N.Timer.TIMER(),te=ne.authenticatedUserToken,this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETRECONNECTABLECHATS,"Get Reconnectable chat Started"),K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatGetReconnectableChatsPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(this.omnichannelConfiguration.orgId,"?channelId=").concat(this.omnichannelConfiguration.channelId),(re=c.default.defaultHeaders)[_.default.authenticatedUserToken]=te,ve={headers:re,method:"GET",url:K},be=I.default.create(),$e.abrupt("return",new Promise(function(){var Oe=(0,h.default)(b.default.mark(function se(fe,we){var Te,ye,Pe,Ve;return b.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.prev=0,Ie.next=3,be(ve);case 3:if(ye=de.milliSecondsElapsed,!(Pe=(Te=Ie.sent).data)){Ie.next=10;break}return X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETRECONNECTABLECHATS,{Region:Te.data.Region,ElapsedTimeInMilliseconds:ye,TransactionId:Te.headers[c.default.transactionid]},"Get Reconnectable Chats Succeeded and old session returned"),fe(Pe),Ie.abrupt("return");case 10:return fe(),Ie.abrupt("return");case 14:if(Ie.prev=14,Ie.t0=Ie.catch(0),Ve=de.milliSecondsElapsed,!X.logger){Ie.next=21;break}return Ie.next=20,g.LoggingSanitizer.stripErrorSensitiveProperties(Ie.t0);case 20:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.GETRECONNECTABLECHATS,{ExceptionDetails:Ie.t0,ElapsedTimeInMilliseconds:Ve},"Get Reconnectable Chats Failed");case 21:return we(Ie.t0),Ie.abrupt("return");case 23:case"end":return Ie.stop()}},se,null,[[0,14]])}));return function(se,fe){return Oe.apply(this,arguments)}}()));case 9:case"end":return $e.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"getReconnectAvailability",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,re,ve,X=this;return b.default.wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return de=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,"Get Reconnect availability started"),te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatReconnectAvailabilityPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),re={headers:c.default.defaultHeaders,method:"GET",url:te},ve=I.default.create(),Be.abrupt("return",new Promise(function(){var $e=(0,h.default)(b.default.mark(function Oe(se,fe){var we,Te,ye,Pe;return b.default.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,ve(re);case 3:if(Te=de.milliSecondsElapsed,!(ye=(we=Ue.sent).data)){Ue.next=10;break}return X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,{Region:we.data.Region,ElapsedTimeInMilliseconds:Te,TransactionId:we.headers[c.default.transactionid]},"Get Reconnect availability Succeeded"),se(ye),Ue.abrupt("return");case 10:return X.logger&&X.logger.log(C.LogLevel.WARN,A.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,{Region:we.data.Region,ElapsedTimeInMilliseconds:Te,TransactionId:we.headers[c.default.transactionid]},"Get Reconnect availability didn't send any valid data."),se(),Ue.abrupt("return");case 15:if(Ue.prev=15,Ue.t0=Ue.catch(0),Pe=de.milliSecondsElapsed,!X.logger){Ue.next=22;break}return Ue.next=21,g.LoggingSanitizer.stripErrorSensitiveProperties(Ue.t0);case 21:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.GETRECONNECTAVAILABILITY,{ExceptionDetails:Ue.t0,ElapsedTimeInMilliseconds:Pe},"Get Reconnect Availability Failed");case 22:return fe(Ue.t0),Ue.abrupt("return");case 24:case"end":return Ue.stop()}},Oe,null,[[0,15]])}));return function(Oe,se){return $e.apply(this,arguments)}}()));case 7:case"end":return Be.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"getQueueAvailability",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,K,re,ve,be,Be,$e,Oe,se,X=this,fe=arguments;return b.default.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(de=fe.length>1&&void 0!==fe[1]?fe[1]:{},te=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETQUEUEAVAILABILITYSTARTED,{RequestId:ne},"Get queue availability started"),K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.GetQueueAvailabilityPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne,"?channelId=lcw"),re=I.default.create(),(0,P.default)(re,{retries:this.configuration.maxRequestRetriesOnFailure}),be=de.initContext,Be=de.getContext,$e=c.default.defaultHeaders,(ve=de.authenticatedUserToken)&&($e[_.default.authenticatedUserToken]=ve),Oe=be||{},!Be||window.document){Te.next=12;break}return Te.abrupt("return",Promise.reject(new Error("getContext is only supported on web browsers")));case 12:if(Be&&(Oe.browser=f.BrowserInfo.getBrowserName(),Oe.device=v.DeviceInfo.getDeviceType(),Oe.originurl=window.location.href,Oe.os=R.OSInfo.getOsType()),Oe.locale||(Oe.locale=c.default.defaultLocale),!Oe.locale||S.default.supportedLocales.includes(Oe.locale)){Te.next=16;break}return Te.abrupt("return",Promise.reject(new Error("Unsupported locale: '".concat(Oe.locale,"'"))));case 16:return se={data:Oe,headers:$e,method:"POST",url:K},Te.abrupt("return",new Promise(function(){var ye=(0,h.default)(b.default.mark(function Pe(Ve,Ue){var Ie,We,Qe,Ge;return b.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Le.prev=0,Le.next=3,re(se);case 3:We=te.milliSecondsElapsed,(Qe=(Ie=Le.sent).data)&&(X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETQUEUEAVAILABILITYSUCCEEDED,{RequestId:ne,Region:Ie.data.Region,ElapsedTimeInMilliseconds:We,TransactionId:Ie.headers["transaction-id"]},"Get queue availability Succeeded"),Ve(Qe)),Le.next=17;break;case 9:if(Le.prev=9,Le.t0=Le.catch(0),Ge=te.milliSecondsElapsed,!X.logger){Le.next=16;break}return Le.next=15,g.LoggingSanitizer.stripErrorSensitiveProperties(Le.t0);case 15:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.GETQUEUEAVAILABILITYFAILED,{RequestId:ne,ExceptionDetails:Le.t0,ElapsedTimeInMilliseconds:Ge},"Get queue availability failed");case 16:Ue(Le.t0);case 17:case"end":return Le.stop()}},Pe,null,[[0,9]])}));return function(Pe,Ve){return ye.apply(this,arguments)}}()));case 18:case"end":return Te.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"sessionInit",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,K,re,ve,be,Be,$e,Oe,se,fe,X=this,we=arguments;return b.default.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(de=we.length>1&&void 0!==we[1]?we[1]:{},te=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SESSIONINITSTARTED,{RequestId:ne},"Session Init Started"),K=I.default.create(),(0,P.default)(K,{retries:this.configuration.maxRequestRetriesOnFailure}),re=de.reconnectId,ve=de.authenticatedUserToken,be=de.initContext,Be=de.getContext,$e=c.default.defaultHeaders,Oe="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatSessionInitPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),ve&&(Oe="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthSessionInitPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),$e[_.default.authenticatedUserToken]=ve),re&&(Oe+="/".concat(re)),Oe+="?channelId=".concat(this.omnichannelConfiguration.channelId),se=be||{},!Be||window.document){ye.next=14;break}return ye.abrupt("return",Promise.reject(new Error("getContext is only supported on web browsers")));case 14:if(Be&&(se.browser=f.BrowserInfo.getBrowserName(),se.device=v.DeviceInfo.getDeviceType(),se.originurl=window.location.href,se.os=R.OSInfo.getOsType()),se.locale||(se.locale=c.default.defaultLocale),!se.locale||S.default.supportedLocales.includes(se.locale)){ye.next=18;break}return ye.abrupt("return",Promise.reject(new Error("Unsupported locale: '".concat(se.locale,"'"))));case 18:return fe={data:se,headers:$e,method:"POST",url:Oe},ye.abrupt("return",new Promise(function(){var Pe=(0,h.default)(b.default.mark(function Ve(Ue,Ie){var We,Qe,Ge;return b.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Le.prev=0,Le.next=3,K(fe);case 3:We=Le.sent,Qe=te.milliSecondsElapsed,X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SESSIONINITSUCCEEDED,{RequestId:ne,Region:We.data.Region,ElapsedTimeInMilliseconds:Qe,TransactionId:We.headers["transaction-id"]},"Session Init Succeeded"),Ue(),Le.next=17;break;case 9:if(Le.prev=9,Le.t0=Le.catch(0),Ge=te.milliSecondsElapsed,!X.logger){Le.next=16;break}return Le.next=15,g.LoggingSanitizer.stripErrorSensitiveProperties(Le.t0);case 15:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.SESSIONINITFAILED,{RequestId:ne,ExceptionDetails:Le.t0,ElapsedTimeInMilliseconds:Ge},"Session Init Failed");case 16:Ie(Le.t0);case 17:case"end":return Le.stop()}},Ve,null,[[0,9]])}));return function(Ve,Ue){return Pe.apply(this,arguments)}}()));case 20:case"end":return ye.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"sessionClose",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,K,re,ve,be,Be,Oe,se,fe,X=this,we=arguments;return b.default.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return de=we.length>1&&void 0!==we[1]?we[1]:{},te=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SESSIONCLOSESTARTED,{RequestId:ne},"Session Close Started"),K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatSessionClosePath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),re=I.default.create(),(0,P.default)(re,{retries:this.configuration.maxRequestRetriesOnFailure}),ve=de.authenticatedUserToken,be=de.isReconnectChat,Be=de.isPersistentChat,Oe=c.default.defaultHeaders,(se={}).chatId=de.chatId,ve&&(K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthSessionClosePath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),Oe[_.default.authenticatedUserToken]=ve),be&&(K+="&isReconnectChat=true"),Be&&(K+="&isPersistentChat=true"),fe={data:se,headers:Oe,method:"POST",url:K},ye.abrupt("return",new Promise(function(){var Pe=(0,h.default)(b.default.mark(function Ve(Ue,Ie){var We,Qe,Ge;return b.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Le.prev=0,Le.next=3,re(fe);case 3:We=Le.sent,Qe=te.milliSecondsElapsed,X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SESSIONCLOSESUCCEEDED,{RequestId:ne,Region:We.data.Region,ElapsedTimeInMilliseconds:Qe,TransactionId:We.headers["transaction-id"]},"Session Close Succeeded"),Ue(),Le.next=17;break;case 9:if(Le.prev=9,Le.t0=Le.catch(0),Ge=te.milliSecondsElapsed,!X.logger){Le.next=16;break}return Le.next=15,g.LoggingSanitizer.stripErrorSensitiveProperties(Le.t0);case 15:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.SESSIONCLOSEFAILED,{RequestId:ne,ExceptionDetails:Le.t0,ElapsedTimeInMilliseconds:Ge},"Session Close Failed");case 16:Ie();case 17:case"end":return Le.stop()}},Ve,null,[[0,9]])}));return function(Ve,Ue){return Pe.apply(this,arguments)}}()));case 15:case"end":return ye.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"validateAuthChatRecord",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne,X){var de,te,K,re,ve,be,Be,$e,Oe,se,fe,we,Te,ye;return b.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return de=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDSTARTED,{RequestId:ne},"Validate Auth Chat Record Started"),te=X.authenticatedUserToken,K=X.chatId,re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatValidateAuthChatMapRecordPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(K,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),ve=I.default.create(),(0,P.default)(ve,{retries:this.configuration.maxRequestRetriesOnFailure}),be=c.default.defaultHeaders,te&&(be[_.default.authenticatedUserToken]=te),Be={headers:be,method:"GET",url:re},Ve.prev=9,Ve.next=12,ve(Be);case 12:if(se=de.milliSecondsElapsed,!0!==(null===($e=(Oe=Ve.sent).data)||void 0===$e?void 0:$e.authChatExist)){Ve.next=19;break}return null===(fe=this.logger)||void 0===fe||fe.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDSUCCEEDED,{RequestId:ne,Region:Oe.data.Region,ElapsedTimeInMilliseconds:se,TransactionId:Oe.headers["transaction-id"]},"Validate Auth Chat Record Succeeded"),Ve.abrupt("return",Promise.resolve(Oe.data));case 19:return null===(we=this.logger)||void 0===we||we.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDFAILED,{RequestId:ne,Region:Oe.data.Region,ElapsedTimeInMilliseconds:se,TransactionId:Oe.headers["transaction-id"],ErrorCode:Oe.status},"Validate Auth Chat Record Failed. Record is not found or request is not authorized"),Ve.abrupt("return",Promise.reject(new Error("Validate Auth Chat Record Failed. Record is not found or request is not authorized")));case 21:Ve.next=34;break;case 23:return Ve.prev=23,Ve.t0=Ve.catch(9),ye=de.milliSecondsElapsed,Ve.next=28,g.LoggingSanitizer.stripErrorSensitiveProperties(Ve.t0);case 28:if(null===(Te=this.logger)||void 0===Te||Te.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.VALIDATEAUTHCHATRECORDFAILED,{RequestId:ne,ExceptionDetails:Ve.t0,ElapsedTimeInMilliseconds:ye},"Validate Auth Chat Record Failed"),"Error: Request failed with status code 404"!==Ve.t0.toString()){Ve.next=33;break}return Ve.abrupt("return",Promise.resolve({}));case 33:return Ve.abrupt("return",Promise.reject());case 34:case"end":return Ve.stop()}},Ce,this,[[9,23]])}));return function(Ce,ne){return W.apply(this,arguments)}}()},{key:"submitPostChatResponse",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne,X){var te,K,re,ve,be,Be,$e,de=this,Oe=arguments;return b.default.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return te=Oe.length>2&&void 0!==Oe[2]?Oe[2]:{},K=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SUBMITPOSTCHATSTARTED,{RequestId:ne},"Submit Post Chat Started"),re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatSubmitPostChatPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),ve=I.default.create(),(0,P.default)(ve,{retries:this.configuration.maxRequestRetriesOnFailure}),Be=c.default.defaultHeaders,(be=te.authenticatedUserToken)&&(re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthSubmitPostChatPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),Be[_.default.authenticatedUserToken]=be),$e={data:JSON.stringify(X),headers:Be,method:"POST",url:re},fe.abrupt("return",new Promise(function(){var we=(0,h.default)(b.default.mark(function Te(ye,Pe){var Ve,Ue,Ie;return b.default.wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:return Qe.prev=0,Qe.next=3,ve($e);case 3:Ve=Qe.sent,Ue=K.milliSecondsElapsed,de.logger&&de.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SUBMITPOSTCHATSUCCEEDED,{RequestId:ne,Region:Ve.data.Region,ElapsedTimeInMilliseconds:Ue,TransactionId:Ve.headers["transaction-id"]},"Submit Post Chat Succeeded"),ye(),Qe.next=17;break;case 9:if(Qe.prev=9,Qe.t0=Qe.catch(0),Ie=K.milliSecondsElapsed,!de.logger){Qe.next=16;break}return Qe.next=15,g.LoggingSanitizer.stripErrorSensitiveProperties(Qe.t0);case 15:de.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.SUBMITPOSTCHATFAILED,{RequestId:ne,ExceptionDetails:Qe.t0,ElapsedTimeInMilliseconds:Ie},"Submit Post Chat Failed");case 16:Pe();case 17:case"end":return Qe.stop()}},Te,null,[[0,9]])}));return function(Te,ye){return we.apply(this,arguments)}}()));case 11:case"end":return fe.stop()}},Ce,this)}));return function(Ce,ne){return W.apply(this,arguments)}}()},{key:"getSurveyInviteLink",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne,X){var te,K,re,ve,be,Be,$e,Oe,de=this,se=arguments;return b.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return te=se.length>2&&void 0!==se[2]?se[2]:{},K=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETSURVEYINVITELINKSTARTED,{SurveyOwnerId:ne},"Get Survey Invite Link Started"),re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatGetSurveyInviteLinkPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(ne),ve=I.default.create(),(0,P.default)(ve,{retries:this.configuration.maxRequestRetriesOnFailure}),Be=te.requestId,$e=c.default.defaultHeaders,(be=te.authenticatedUserToken)&&(re="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthGetSurveyInviteLinkPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(ne),$e[_.default.authenticatedUserToken]=be,$e[_.default.widgetAppId]=this.omnichannelConfiguration.widgetId),Be&&($e[_.default.requestId]=Be),Oe={data:JSON.stringify(X),headers:$e,method:"POST",url:re},we.abrupt("return",new Promise(function(){var Te=(0,h.default)(b.default.mark(function ye(Pe,Ve){var Ue,Ie,We,Qe;return b.default.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:return rt.prev=0,rt.next=3,ve(Oe);case 3:Ie=(Ue=rt.sent).data,We=K.milliSecondsElapsed,de.logger&&de.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETSURVEYINVITELINKSUCCEEDED,{Region:Ue.data.Region,ElapsedTimeInMilliseconds:We,TransactionId:Ue.headers["transaction-id"]},"Get Survey Invite Link Succeeded"),Pe(Ie),rt.next=18;break;case 10:if(rt.prev=10,rt.t0=rt.catch(0),Qe=K.milliSecondsElapsed,!de.logger){rt.next=17;break}return rt.next=16,g.LoggingSanitizer.stripErrorSensitiveProperties(rt.t0);case 16:de.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.GETSURVEYINVITELINKFAILED,{ExceptionDetails:rt.t0,ElapsedTimeInMilliseconds:Qe},"Get Survey Invite Link Failed");case 17:Ve();case 18:case"end":return rt.stop()}},ye,null,[[0,10]])}));return function(ye,Pe){return Te.apply(this,arguments)}}()));case 12:case"end":return we.stop()}},Ce,this)}));return function(Ce,ne){return W.apply(this,arguments)}}()},{key:"getChatTranscripts",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne,X,de){var K,re,ve,be,Be,$e,Oe,se,te=this,fe=arguments;return b.default.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return K=fe.length>3&&void 0!==fe[3]?fe[3]:{},re=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETCHATTRANSCRIPTSTARTED,{RequestId:ne},"Get Chat Transcript Started"),ve="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatGetChatTranscriptPath,"/").concat(X,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),be=I.default.create(),(0,P.default)(be,{retries:this.configuration.maxRequestRetriesOnFailure}),Be=K.authenticatedUserToken,$e=K.currentLiveChatVersion,(Oe=c.default.defaultHeaders)[_.default.organizationId]=this.omnichannelConfiguration.orgId,Oe[_.default.widgetAppId]=this.omnichannelConfiguration.widgetId,Oe[_.default.authorization]=de,this.liveChatVersion===A.LiveChatVersion.V2||$e&&$e===A.LiveChatVersion.V2?(ve="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatv2GetChatTranscriptPath,"/").concat(X,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),Be&&(ve="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatv2AuthGetChatTranscriptPath,"/").concat(X,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId))):Be&&(ve="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthGetChatTranscriptPath,"/").concat(X,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId)),se={headers:Oe,method:"GET",url:ve},Te.abrupt("return",new Promise(function(){var ye=(0,h.default)(b.default.mark(function Pe(Ve,Ue){var Ie,We,Qe,Ge;return b.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return Le.prev=0,Le.next=3,be(se);case 3:We=re.milliSecondsElapsed,Qe=(Ie=Le.sent).data,te.logger&&te.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.GETCHATTRANSCRIPTSUCCEEDED,{RequestId:ne,Region:Ie.data.Region,ElapsedTimeInMilliseconds:We,TransactionId:Ie.headers["transaction-id"]},"Get Chat Transcript Succeeded"),Ve(Qe),Le.next=18;break;case 10:if(Le.prev=10,Le.t0=Le.catch(0),Ge=re.milliSecondsElapsed,!te.logger){Le.next=17;break}return Le.next=16,g.LoggingSanitizer.stripErrorSensitiveProperties(Le.t0);case 16:te.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.GETCHATTRANSCRIPTFAILED,{RequestId:ne,ExceptionDetails:Le.t0,ElapsedTimeInMilliseconds:Ge},"Get Chat Transcript Failed");case 17:Ue(Le.t0);case 18:case"end":return Le.stop()}},Pe,null,[[0,10]])}));return function(Pe,Ve){return ye.apply(this,arguments)}}()));case 14:case"end":return Te.stop()}},Ce,this)}));return function(Ce,ne,X){return W.apply(this,arguments)}}()},{key:"emailTranscript",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne,X,de){var K,re,ve,be,Be,$e,Oe,te=this,se=arguments;return b.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return K=se.length>3&&void 0!==se[3]?se[3]:{},re=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.EMAILTRANSCRIPTSTARTED,{RequestId:ne},"Email Transcript Started"),ve="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatTranscriptEmailRequestPath,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId),be=I.default.create(),(0,P.default)(be,{retries:this.configuration.maxRequestRetriesOnFailure}),Be=K.authenticatedUserToken,($e=c.default.defaultHeaders)[_.default.organizationId]=this.omnichannelConfiguration.orgId,$e[_.default.widgetAppId]=this.omnichannelConfiguration.widgetId,$e[_.default.authorization]=X,Be&&(ve="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthTranscriptEmailRequestPath,"/").concat(ne,"?channelId=").concat(this.omnichannelConfiguration.channelId)),Oe={data:JSON.stringify(de),headers:$e,method:"POST",url:ve},we.abrupt("return",new Promise(function(){var Te=(0,h.default)(b.default.mark(function ye(Pe,Ve){var Ue,Ie,We;return b.default.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:return Ge.prev=0,Ge.next=3,be(Oe);case 3:Ue=Ge.sent,Ie=re.milliSecondsElapsed,te.logger&&te.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.EMAILTRANSCRIPTSUCCEEDED,{RequestId:ne,Region:Ue.data.Region,ElapsedTimeInMilliseconds:Ie,TransactionId:Ue.headers["transaction-id"]},"Email Transcript Succeeded"),Pe(),Ge.next=17;break;case 9:if(Ge.prev=9,Ge.t0=Ge.catch(0),We=re.milliSecondsElapsed,!te.logger){Ge.next=16;break}return Ge.next=15,g.LoggingSanitizer.stripErrorSensitiveProperties(Ge.t0);case 15:te.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.EMAILTRANSCRIPTFAILED,{RequestId:ne,ExceptionDetails:Ge.t0,ElapsedTimeInMilliseconds:We},"Email Transcript Failed");case 16:Ve();case 17:case"end":return Ge.stop()}},ye,null,[[0,9]])}));return function(ye,Pe){return Te.apply(this,arguments)}}()));case 14:case"end":return we.stop()}},Ce,this)}));return function(Ce,ne,X){return W.apply(this,arguments)}}()},{key:"fetchDataMaskingInfo",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne){var de,te,K,re,ve,X=this;return b.default.wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return de=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.FETCHDATAMASKINGSTARTED,{RequestId:ne},"Fetch Data Masking Started"),ne||(ne=(0,y.uuidv4)()),te="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatFetchDataMaskingInfoPath,"/").concat(this.omnichannelConfiguration.orgId),K=I.default.create(),(0,P.default)(K,{retries:this.configuration.maxRequestRetriesOnFailure}),(re=c.default.defaultHeaders)[_.default.organizationId]=this.omnichannelConfiguration.orgId,re[_.default.requestId]=ne,ve={headers:re,method:"GET",url:te},Be.abrupt("return",new Promise(function(){var $e=(0,h.default)(b.default.mark(function Oe(se,fe){var we,Te,ye,Pe;return b.default.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,K(ve);case 3:Te=de.milliSecondsElapsed,ye=(we=Ue.sent).data,X.logger&&X.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.FETCHDATAMASKINGSUCCEEDED,{RequestId:ne,Region:we.data.Region,ElapsedTimeInMilliseconds:Te,TransactionId:we.headers["transaction-id"]},"Fetch Data Masking Succeeded"),se(ye),Ue.next=18;break;case 10:if(Ue.prev=10,Ue.t0=Ue.catch(0),Pe=de.milliSecondsElapsed,!X.logger){Ue.next=17;break}return Ue.next=16,g.LoggingSanitizer.stripErrorSensitiveProperties(Ue.t0);case 16:X.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.FETCHDATAMASKINGFAILED,{RequestId:ne,ExceptionDetails:Ue.t0,ElapsedTimeInMilliseconds:Pe},"Fetch Data Masking Failed");case 17:fe();case 18:case"end":return Ue.stop()}},Oe,null,[[0,10]])}));return function(Oe,se){return $e.apply(this,arguments)}}()));case 11:case"end":return Be.stop()}},Ce,this)}));return function(Ce){return W.apply(this,arguments)}}()},{key:"makeSecondaryChannelEventRequest",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne,X){var de,te,K,re,ve,be,Be,$e,Oe,se,fe,we=arguments;return b.default.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return de=we.length>2&&void 0!==we[2]?we[2]:{},te=N.Timer.TIMER(),this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SECONDARYCHANNELEVENTREQUESTSTARTED,{RequestId:ne},"Secondary Channel Event Request Started"),K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatSecondaryChannelEventPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne),re=I.default.create(),(0,P.default)(re,{retries:this.configuration.maxRequestRetriesOnFailure}),ve=de.authenticatedUserToken,(be=c.default.defaultHeaders)[_.default.organizationId]=this.omnichannelConfiguration.orgId,ve&&(be[_.default.authenticatedUserToken]=ve,K="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.LiveChatAuthSecondaryChannelEventPath,"/").concat(this.omnichannelConfiguration.orgId,"/").concat(this.omnichannelConfiguration.widgetId,"/").concat(ne)),K+="?channelId="+c.default.defaultChannelId,Be={data:JSON.stringify(X),headers:be,method:"POST",url:K},ye.prev=12,ye.next=15,re(Be);case 15:Oe=te.milliSecondsElapsed,se=($e=ye.sent).data,this.logger&&this.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SECONDARYCHANNELEVENTREQUESTSUCCEEDED,{RequestId:ne,Region:se.Region,ElapsedTimeInMilliseconds:Oe,TransactionId:$e.headers["transaction-id"]},"Secondary Channel Event Request Succeeded"),ye.next=29;break;case 21:if(ye.prev=21,ye.t0=ye.catch(12),fe=te.milliSecondsElapsed,!this.logger){ye.next=28;break}return ye.next=27,g.LoggingSanitizer.stripErrorSensitiveProperties(ye.t0);case 27:this.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.SECONDARYCHANNELEVENTREQUESTFAILED,{RequestId:ne,ExceptionDetails:ye.t0,ElapsedTimeInMilliseconds:fe},"Secondary Channel Event Request Failed");case 28:throw ye.t0;case 29:case"end":return ye.stop()}},Ce,this,[[12,21]])}));return function(Ce,ne){return W.apply(this,arguments)}}()},{key:"sendTypingIndicator",value:function(){var W=(0,h.default)(b.default.mark(function Ce(ne,X){var te,K,re,ve,be,Be,$e,de=this,Oe=arguments;return b.default.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(te=Oe.length>2&&void 0!==Oe[2]?Oe[2]:{},X&&X===A.LiveChatVersion.V2){fe.next=3;break}return fe.abrupt("return",Promise.resolve());case 3:if(K=N.Timer.TIMER(),re=te.customerDisplayName,X&&X===A.LiveChatVersion.V2){fe.next=7;break}throw new Error("Typing indicator is only supported on v2");case 7:return ve="".concat(this.omnichannelConfiguration.orgUrl,"/").concat(D.default.SendTypingIndicatorPath,"/").concat(ne),be=I.default.create(),(Be=c.default.defaultHeaders)[_.default.organizationId]=this.omnichannelConfiguration.orgId,re&&(Be[c.default.customerDisplayName]=re),$e={headers:Be,method:"POST",url:ve},fe.abrupt("return",new Promise(function(){var we=(0,h.default)(b.default.mark(function Te(ye,Pe){var Ve,Ue,Ie,We;return b.default.wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:return Ge.prev=0,Ge.next=3,be($e);case 3:Ue=K.milliSecondsElapsed,Ie=(Ve=Ge.sent).data,de.logger&&de.logger.log(C.LogLevel.INFO,A.OCSDKTelemetryEvent.SENDTYPINGINDICATORSUCCEEDED,{RequestId:ne,Region:Ie.Region,ElapsedTimeInMilliseconds:Ue,TransactionId:Ve.headers["transaction-id"]},"Send Typing Indicator Succeeded"),ye(),Ge.next=18;break;case 10:if(Ge.prev=10,Ge.t0=Ge.catch(0),We=K.milliSecondsElapsed,!de.logger){Ge.next=17;break}return Ge.next=16,g.LoggingSanitizer.stripErrorSensitiveProperties(Ge.t0);case 16:de.logger.log(C.LogLevel.ERROR,A.OCSDKTelemetryEvent.SENDTYPINGINDICATORFAILED,{RequestId:ne,ExceptionDetails:Ge.t0,ElapsedTimeInMilliseconds:We},"Send Typing Indicator Failed");case 17:Pe(Ge.t0);case 18:case"end":return Ge.stop()}},Te,null,[[0,10]])}));return function(Te,ye){return we.apply(this,arguments)}}()));case 14:case"end":return fe.stop()}},Ce,this)}));return function(Ce,ne){return W.apply(this,arguments)}}()}]),Y;var W}();m.default=Z,(0,T.default)(Z,"defaultConfiguration",{getChatTokenRetryCount:35,getChatTokenTimeBetweenRetriesOnFailure:1e4,maxRequestRetriesOnFailure:3})},4491:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(2805)),p=s(u(5413)),E=s(u(4162)),d=s(u(8634));m.default=function(){function A(){(0,b.default)(this,A)}return(0,h.default)(A,null,[{key:"getSDK",value:function(f,c,v){var S=new E.default(v);return new d.default({channelId:f.channelId||p.default.defaultChannelId,orgId:f.orgId,orgUrl:f.orgUrl,widgetId:f.widgetId},c||{},S)}}]),A}()},4717:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.BrowserInfo=m.UNKNOWN_VERSION=void 0;var b=s(u(8884)),h=s(u(2805)),p=s(u(1819)),E=u(2e3),d="([\\d,.]+)";m.UNKNOWN_VERSION="U";var A=function(){function I(){(0,b.default)(this,I)}return(0,h.default)(I,null,[{key:"getUserAgent",value:function(){return this.userAgent()}},{key:"userAgentContainsString",value:function(c){return this.getUserAgent().indexOf(c)>-1}},{key:"isChrome",value:function(){return this.userAgentContainsString(E.BrowserVendor.CHROME)&&!this.userAgentContainsString(E.BrowserVendor.EDGE)&&!this.userAgentContainsString(E.BrowserVendor.EDGE_CHROMIUM)}},{key:"isIe",value:function(){return this.userAgentContainsString("Trident")}},{key:"isEdge",value:function(){return this.userAgentContainsString(E.BrowserVendor.EDGE)||this.userAgentContainsString(E.BrowserVendor.EDGE_CHROMIUM)}},{key:"isOpera",value:function(){return this.userAgentContainsString("OPR/")}},{key:"getBrowserName",value:function(){return this.isOpera()?E.BrowserVendor.OPERA:this.isEdge()?E.BrowserVendor.EDGE:this.isChrome()?E.BrowserVendor.CHROME:this.userAgentContainsString(E.BrowserVendor.FIREFOX)?E.BrowserVendor.FIREFOX:this.userAgentContainsString(E.BrowserVendor.SAFARI)?E.BrowserVendor.SAFARI:this.isIe()?E.BrowserVendor.IE:E.BrowserVendor.UNKNOWN}},{key:"getBrowserVersion",value:function(){var c=this;return this.isIe()?function(){var C=c.getUserAgent(),R=C.match(new RegExp(E.BrowserVendor.IE+" "+d));if(R)return R[1];var D=C.match(new RegExp("rv:"+d));return D?D[1]:void 0}():function(C){C===E.BrowserVendor.SAFARI&&(C="Version"),C===E.BrowserVendor.OPERA&&(C="OPR"),C===E.BrowserVendor.EDGE&&(C="Edge?");var R=c.getUserAgent().match(new RegExp(C+"/"+d));return R?R[1]:"U"}(this.getBrowserName())}}]),I}();m.BrowserInfo=A,(0,p.default)(A,"userAgent",function(){return window.navigator.userAgent})},6812:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.DeviceInfo=void 0;var b=s(u(8884)),h=s(u(2805)),p=u(2e3);m.DeviceInfo=function(){function d(){(0,b.default)(this,d)}return(0,h.default)(d,null,[{key:"getDeviceType",value:function(){return window.navigator.userAgent.match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?p.DeviceType.Mobile:window.navigator.userAgent.match(/tablet|ipad/i)?p.DeviceType.Tablet:p.DeviceType.Desktop}}]),d}()},682:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(2805));m.default=function(){function E(){(0,b.default)(this,E)}return(0,h.default)(E,null,[{key:"raiseCustomEvent",value:function(T,A){var I=E.createCustomEvent(T,A);window.dispatchEvent(I)}},{key:"createCustomEvent",value:function(T,A){var I=A?{detail:A}:void 0,f=null;try{f=new CustomEvent(T,I)}catch(c){(f=document.createEvent("CustomEvent")).initCustomEvent(T,!0,!0,I)}return f}}]),E}()},9569:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.LoggingSanitizer=void 0;var b=s(u(1298)),h=s(u(8884)),p=s(u(2805)),E=s(u(5413));m.LoggingSanitizer=function(){function T(){(0,h.default)(this,T)}return(0,p.default)(T,null,[{key:"stripErrorSensitiveProperties",value:function(I){var f,v,c=this;I&&"object"===(0,b.default)(I)&&(null===(f=Object.keys(I))||void 0===f?void 0:f.length)>0&&(null===(v=Object.keys(I))||void 0===v||v.forEach(function(S){-1!==E.default.sensitiveProperties.indexOf(S)&&delete I["".concat(S)],null===I["".concat(S)]||"object"!==(0,b.default)(I["".concat(S)])||c.stripErrorSensitiveProperties(I["".concat(S)])}))}}]),T}()},7169:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.OSInfo=void 0;var b=s(u(8884)),h=s(u(2805)),p=u(2e3);m.OSInfo=function(){function d(){(0,b.default)(this,d)}return(0,h.default)(d,null,[{key:"getOsType",value:function(){var C=function(){return window.navigator.userAgent};return C().match(/windows\sphone\s\d+\.\d+/i)?p.OperatingSystem.WINDOWS_PHONE:C().match(/ arm;/i)?p.OperatingSystem.WINDOWS_RT:C().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?p.OperatingSystem.IOS:C().match(/android/i)?p.OperatingSystem.ANDROID:C().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?p.OperatingSystem.LINUX:C().match(/(macintosh|mac os x)/i)?p.OperatingSystem.MACOSX:C().match(/(windows|win32)/i)?p.OperatingSystem.WINDOWS:p.OperatingSystem.UNKNOWN}}]),d}()},7276:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var b=s(u(8884)),h=s(u(2805));m.default=function(){function E(){(0,b.default)(this,E)}return(0,h.default)(E,null,[{key:"GETTELEMETRYEVENTDATA",value:function(T,A,I){return{Description:I,ElapsedTimeInMilliseconds:A.ElapsedTimeInMilliseconds,Event:T,ExceptionDetails:A.ExceptionDetails,Region:A.Region,RequestId:A.RequestId,TransactionId:A.TransactionId}}}]),E}()},3945:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),m.Timer=void 0;var b=s(u(8884)),h=s(u(2805));m.Timer=function(){function E(){(0,b.default)(this,E)}return(0,h.default)(E,null,[{key:"TIMER",value:function(){var T=(new Date).getTime();return{get milliSecondsElapsed(){return(new Date).getTime()-T}}}}]),E}()},1729:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0,m.default=function(h,p){var E=p.retries,d=0;h.interceptors.response.use(void 0,function(f){var c=f.config;return c&&d<E?(d++,new Promise(function(S){return S(h(c))})):Promise.reject(f)})}},8566:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.uuidv4=void 0,m.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var h=16*Math.random()|0;return("x"===b?h:3&h|8).toString(16)})}},3762:(Q,m,u)=>{"use strict";var s=u(1127);Object.defineProperty(m,"__esModule",{value:!0}),Object.defineProperty(m,"SDKProvider",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(m,"uuidv4",{enumerable:!0,get:function(){return d.uuidv4}});var b=s(u(1298)),h=s(u(3096)),p=s(u(4491)),E=s(u(682)),d=u(8566);!function(){if(void 0===global.window&&(global.window=global),void 0===("undefined"==typeof window?"undefined":(0,b.default)(window)))throw new Error("window object not found");"Microsoft"in window||(window.Microsoft={}),"CRM"in window.Microsoft||(window.Microsoft.CRM={}),"Omnichannel"in window.Microsoft.CRM||(window.Microsoft.CRM.Omnichannel={}),"SDK"in window.Microsoft.CRM.Omnichannel||(window.Microsoft.CRM.Omnichannel.SDK={SDKProvider:p.default,Util:{uuidv4:d.uuidv4}}),window.document&&E.default.raiseCustomEvent(h.default.OCSDKLOAD)}()},7987:function(Q,m){"use strict";var u=this&&this.__assign||function(){return(u=Object.assign||function(b){for(var h,p=1,E=arguments.length;p<E;p++)for(var d in h=arguments[p])Object.prototype.hasOwnProperty.call(h,d)&&(b[d]=h[d]);return b}).apply(this,arguments)};Object.defineProperty(m,"__esModule",{value:!0});var s=function(){function b(h){this.debug=!1,this.debug=!1,this.logger=h}return b.prototype.setDebug=function(h){this.debug=h},b.prototype.log=function(h,p,E){var d,T=u(u({},E),{Event:p});this.debug&&console.log(T),null===(d=this.logger)||void 0===d||d.logClientSdkTelemetryEvent(h,T)},b}();m.default=s},9237:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(R){for(var D,_=1,N=arguments.length;_<N;_++)for(var P in D=arguments[_])Object.prototype.hasOwnProperty.call(D,P)&&(R[P]=D[P]);return R}).apply(this,arguments)},b=this&&this.__awaiter||function(R,D,_,N){return new(_||(_=Promise))(function(y,M){function U(ue){try{j(N.next(ue))}catch(Z){M(Z)}}function $(ue){try{j(N.throw(ue))}catch(Z){M(Z)}}function j(ue){ue.done?y(ue.value):function(y){return y instanceof _?y:new _(function(M){M(y)})}(ue.value).then(U,$)}j((N=N.apply(R,D||[])).next())})},h=this&&this.__generator||function(R,D){var N,P,y,M,_={label:0,sent:function(){if(1&y[0])throw y[1];return y[1]},trys:[],ops:[]};return M={next:U(0),throw:U(1),return:U(2)},"function"==typeof Symbol&&(M[Symbol.iterator]=function(){return this}),M;function U(j){return function(ue){return function(j){if(N)throw new TypeError("Generator is already executing.");for(;_;)try{if(N=1,P&&(y=2&j[0]?P.return:j[0]?P.throw||((y=P.return)&&y.call(P),0):P.next)&&!(y=y.call(P,j[1])).done)return y;switch(P=0,y&&(j=[2&j[0],y.value]),j[0]){case 0:case 1:y=j;break;case 4:return _.label++,{value:j[1],done:!1};case 5:_.label++,P=j[1],j=[0];continue;case 7:j=_.ops.pop(),_.trys.pop();continue;default:if(!(y=(y=_.trys).length>0&&y[y.length-1])&&(6===j[0]||2===j[0])){_=0;continue}if(3===j[0]&&(!y||j[1]>y[0]&&j[1]<y[3])){_.label=j[1];break}if(6===j[0]&&_.label<y[1]){_.label=y[1],y=j;break}if(y&&_.label<y[2]){_.label=y[2],_.ops.push(j);break}y[2]&&_.ops.pop(),_.trys.pop();continue}j=D.call(R,_)}catch(ue){j=[6,ue],P=0}finally{N=y=0}if(5&j[0])throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}([j,ue])}}};Object.defineProperty(m,"__esModule",{value:!0});var p=u(7643),E=(()=>{return(R=E||(E={})).Accept="Accept",R.AcceptEncoding="Accept-Encoding",R.BehaviorOverride="BehaviorOverride",R.Authorization="Authorization",R.ClientVersion="X-MS-Client-Version",R.ContentType="Content-Type",E;var R})(),d=(()=>{return(R=d||(d={})).applicationFormUrlEncoded="application/x-www-form-urlencoded",R.applicationJson="application/json",d;var R})(),T=(()=>{return(R=T||(T={})).Expired="expired",R.Failed="failed",R.InProgress="in progress",R.Malware="malware",R.Ready="ready",T;var R})(),A=["jpeg","jpg","gif","png","bmp","tiff","jfif"],I=function(R){R.regionGTMS||(R.regionGTMS={ams:"https://us-api.asm.skype.com"})},f=function(R){var D;return(D={})[E.Authorization]="skype_token "+R,D[E.ClientVersion]="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country=IN; clientName=swc; clientVer=912/0.106.0.34//swc",D};m.default={skypeTokenAuth:function(R){return b(void 0,void 0,void 0,function(){var D,N,y,M,U;return h(this,function($){switch($.label){case 0:p.default.debug&&console.log("[API][skypeTokenAuth]"),I(R),D=(R.amsEndpoint||(null===(U=R.regionGTMS)||void 0===U?void 0:U.ams))+"/v1/skypetokenauth",(M={})[E.Authorization]="skype_token "+R.token,M[E.Accept]=d.applicationJson,M[E.BehaviorOverride]="redirectAs404",M[E.ContentType]=d.applicationFormUrlEncoded,N={headers:M,method:"POST",body:"skypetoken="+R.token},$.label=1;case 1:return $.trys.push([1,3,,4]),[4,fetch(D,N)];case 2:return[2,$.sent()];case 3:throw y=$.sent(),!p.default.silentError&&console.log(y),new Error("AMSAuth");case 4:return[2]}})})},createObject:function(R,D,_){return b(void 0,void 0,void 0,function(){var P,y,M,U,ue,Z,Y,W;return h(this,function(ce){switch(ce.label){case 0:p.default.debug&&console.log("[API][createObject]"),(Z={})[R]=["read"],P={filename:D.name,permissions:Z,type:D.type.includes("image")?"pish/image":"sharing/file"},I(_),y=(_.amsEndpoint||(null===(W=null==_?void 0:_.regionGTMS)||void 0===W?void 0:W.ams))+"/v1/objects",M=s(s({},f(_.token)),((Y={})[E.ContentType]=d.applicationJson,Y)),U={headers:M,method:"POST",body:JSON.stringify(P),credentials:"include"},ce.label=1;case 1:return ce.trys.push([1,4,,5]),[4,fetch(y,U)];case 2:return[4,ce.sent().json()];case 3:return[2,ce.sent()];case 4:throw ue=ce.sent(),!p.default.silentError&&console.log(ue),new Error("AMSCreateObjectFailed");case 5:return[2]}})})},uploadDocument:function(R,D,_){return b(void 0,void 0,void 0,function(){var N,P,y,U,$,j;return h(this,function(ue){switch(ue.label){case 0:p.default.debug&&console.log("[API][uploadDocument]"),I(_),N=(_.amsEndpoint||(null===(j=null==_?void 0:_.regionGTMS)||void 0===j?void 0:j.ams))+"/v1/objects/"+R+"/content/"+(D.type.includes("image")?"imgpsh":"original"),P=s(s({},f(_.token)),(($={})[E.ContentType]=d.applicationFormUrlEncoded,$)),y={headers:P,method:"PUT",body:D.data?D.data:D},ue.label=1;case 1:return ue.trys.push([1,3,,4]),[4,fetch(N,y)];case 2:return ue.sent(),[2,{name:D.name,size:D.size,type:D.type,id:R,url:N,fileSharingProtocolType:0}];case 3:throw U=ue.sent(),!p.default.silentError&&console.log(U),new Error("AMSUploadDocumentFailed");case 4:return[2]}})})},getViewStatus:function(R,D){return b(void 0,void 0,void 0,function(){var _,N,P,M,U,$,ue,Z;return h(this,function(Y){switch(Y.label){case 0:p.default.debug&&console.log("[API][getViewStatus]"),I(D),_=(D.amsEndpoint||(null===(Z=null==D?void 0:D.regionGTMS)||void 0===Z?void 0:Z.ams))+"/v1/objects/"+R.id+"/views/"+(A.includes(R.type)?"imgpsh_fullsize_anim":"original")+"/status",N=f(D.token),P={headers:N,method:"GET"},Y.label=1;case 1:return Y.trys.push([1,4,,5]),[4,fetch(_,P)];case 2:return[4,Y.sent().json()];case 3:if(M=Y.sent(),U=M.content_state,$=M.view_state,!M.view_location)throw new Error("view_location is empty");if($&&$!==T.Ready.toString()&&!p.default.silentError&&console.error("view_state is not ready"),U===T.Expired.toString())throw new Error("content_state is expired");return[2,M];case 4:throw ue=Y.sent(),!p.default.silentError&&console.log(ue),new Error("AMSGetViewStatusFailed");case 5:return[2]}})})},getView:function(R,D,_){return b(void 0,void 0,void 0,function(){var N,P,y,$;return h(this,function(j){switch(j.label){case 0:p.default.debug&&console.log("[API][getView]"),I(_),N=D,P=f(_.token),A.includes(R.type)&&(P[E.Accept]="image/webp,image/ *,*/*;q=0.8",P[E.AcceptEncoding]="gzip, deflate, sdch, br"),y={headers:P,method:"GET"},j.label=1;case 1:return j.trys.push([1,4,,5]),[4,fetch(N,y)];case 2:return[4,j.sent().blob()];case 3:return[2,j.sent()];case 4:throw $=j.sent(),!p.default.silentError&&console.log($),new Error("AMSGetViewFailed");case 5:return[2]}})})}}},4543:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(S){for(var g,C=1,R=arguments.length;C<R;C++)for(var D in g=arguments[C])Object.prototype.hasOwnProperty.call(g,D)&&(S[D]=g[D]);return S}).apply(this,arguments)},b=this&&this.__awaiter||function(S,g,C,R){return new(C||(C=Promise))(function(_,N){function P(U){try{M(R.next(U))}catch($){N($)}}function y(U){try{M(R.throw(U))}catch($){N($)}}function M(U){U.done?_(U.value):function(_){return _ instanceof C?_:new C(function(N){N(_)})}(U.value).then(P,y)}M((R=R.apply(S,g||[])).next())})},h=this&&this.__generator||function(S,g){var R,D,_,N,C={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return N={next:P(0),throw:P(1),return:P(2)},"function"==typeof Symbol&&(N[Symbol.iterator]=function(){return this}),N;function P(M){return function(U){return function(M){if(R)throw new TypeError("Generator is already executing.");for(;C;)try{if(R=1,D&&(_=2&M[0]?D.return:M[0]?D.throw||((_=D.return)&&_.call(D),0):D.next)&&!(_=_.call(D,M[1])).done)return _;switch(D=0,_&&(M=[2&M[0],_.value]),M[0]){case 0:case 1:_=M;break;case 4:return C.label++,{value:M[1],done:!1};case 5:C.label++,D=M[1],M=[0];continue;case 7:M=C.ops.pop(),C.trys.pop();continue;default:if(!(_=(_=C.trys).length>0&&_[_.length-1])&&(6===M[0]||2===M[0])){C=0;continue}if(3===M[0]&&(!_||M[1]>_[0]&&M[1]<_[3])){C.label=M[1];break}if(6===M[0]&&C.label<_[1]){C.label=_[1],_=M;break}if(_&&C.label<_[2]){C.label=_[2],C.ops.push(M);break}_[2]&&C.ops.pop(),C.trys.pop();continue}M=g.call(S,C)}catch(U){M=[6,U],D=0}finally{R=_=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([M,U])}}};Object.defineProperty(m,"__esModule",{value:!0});var p=u(2782),E=u(7643),d=u(4239),T=u(9638),A=u(759),I=u(8202),f=p.sdkVersion,v=function(){function S(g,C){void 0===g&&(g=void 0),void 0===C&&(C=void 0),this.clientId=I.uuidv4(),this.origin=window.location.origin,this.requestCallbacks={},this.debug=!1,this.iframeLoaded=!1,this.logger=g,this.iframeId="Microsoft_Omnichannel_AMSClient_Iframe_Window",C&&C.multiClient&&(this.iframeId=this.clientId)}return S.prototype.setDebug=function(g){this.debug=g},S.prototype.setup=function(){return b(this,void 0,void 0,function(){var g=this;return h(this,function(C){switch(C.label){case 0:if(this.debug&&console.log("[FramedClient][initialize]"),this.onMessageEvent(function(R){return g.handleEvent(R)}),!d.default.isBrowser())throw new Error("FramedMode was used in non-Web platform");return[4,this.loadIframe()];case 1:return C.sent(),this.iframeLoaded||!E.default.silentError&&console.error("iframe not loaded"),[2]}})})},S.prototype.initialize=function(g){return b(this,void 0,void 0,function(){return h(this,function(C){switch(C.label){case 0:return this.debug&&console.log("[FramedClient][initialize]"),this.chatToken=g.chatToken,[4,this.skypeTokenAuth()];case 1:return C.sent(),[2]}})})},S.prototype.skypeTokenAuth=function(g){return void 0===g&&(g=null),b(this,void 0,void 0,function(){var C,R=this;return h(this,function(D){switch(D.label){case 0:return this.debug&&console.log("[FramedClient][skypeAuth]"),C={chatToken:g||this.chatToken},[4,this.loadIframe()];case 1:return D.sent(),[2,new Promise(function(_,N){R.postMessage(A.default.Request,T.default.SkypeTokenAuth,C,_,N)})]}})})},S.prototype.createObject=function(g,C,R){return void 0===R&&(R=null),b(this,void 0,void 0,function(){var D,_=this;return h(this,function(N){switch(N.label){case 0:return this.debug&&console.log("[FramedClient][createObject]"),D={id:g,file:C,chatToken:R||this.chatToken},[4,this.loadIframe()];case 1:return N.sent(),[2,new Promise(function(P,y){_.postMessage(A.default.Request,T.default.CreateObject,D,P,y)})]}})})},S.prototype.uploadDocument=function(g,C,R){return void 0===R&&(R=null),b(this,void 0,void 0,function(){var D,_=this;return h(this,function(N){switch(N.label){case 0:return this.debug&&console.log("[FramedClient][uploadDocument]"),D={documentId:g,file:C,chatToken:R||this.chatToken},[4,this.loadIframe()];case 1:return N.sent(),[2,new Promise(function(P,y){_.postMessage(A.default.Request,T.default.UploadDocument,D,P,y)})]}})})},S.prototype.getViewStatus=function(g,C){return void 0===C&&(C=null),b(this,void 0,void 0,function(){var R,D=this;return h(this,function(_){switch(_.label){case 0:return R={fileMetadata:g,chatToken:C||this.chatToken},[4,this.loadIframe()];case 1:return _.sent(),[2,new Promise(function(N,P){D.postMessage(A.default.Request,T.default.GetViewStatus,R,N,P)})]}})})},S.prototype.getView=function(g,C,R){return void 0===R&&(R=null),b(this,void 0,void 0,function(){var D,_=this;return h(this,function(N){switch(N.label){case 0:return D={fileMetadata:g,viewLocation:C,chatToken:R||this.chatToken},[4,this.loadIframe()];case 1:return N.sent(),[2,new Promise(function(P,y){_.postMessage(A.default.Request,T.default.GetView,D,P,y)})]}})})},S.prototype.fetchBlob=function(g){return b(this,void 0,void 0,function(){var D;return h(this,function(_){switch(_.label){case 0:return _.trys.push([0,3,,4]),[4,fetch(g)];case 1:return[4,_.sent().blob()];case 2:return[2,_.sent()];case 3:throw D=_.sent(),!E.default.silentError&&console.log(D),new Error("fetchBlob");case 4:return[2]}})})},S.prototype.onMessageEvent=function(g){window.addEventListener("message",g,!0)},S.prototype.postMessage=function(g,C,R,D,_){void 0===R&&(R={}),void 0===D&&(D=function(P){return{}}),void 0===_&&(_=function(P){return{}});var N=I.uuidv4();this.requestCallbacks[N]={resolve:D,reject:_},this.targetWindow?this.targetWindow.postMessage(s({clientId:this.clientId,requestId:N,eventType:g,eventName:C},R),"*"):!E.default.silentError&&console.error("Target window not found!")},S.prototype.handleEvent=function(g){var C;return b(this,void 0,void 0,function(){var R;return h(this,function(D){return g.origin===this.origin||p.baseUrl.includes(g.origin)?(g.data.clientId!==this.clientId||(this.debug&&console.log(g),g.source&&(this.targetWindow=g.source),g.data.eventType===A.default.Response&&(this.debug&&console.log("[FramedClient][Response]"),R=g.data,g.data.eventName===T.default.SkypeTokenAuth?R.requestId in this.requestCallbacks&&(this.requestCallbacks[R.requestId].resolve(),delete this.requestCallbacks[R.requestId]):g.data.eventName===T.default.CreateObject||g.data.eventName===T.default.UploadDocument||g.data.eventName===T.default.GetViewStatus||g.data.eventName===T.default.GetView?R.requestId in this.requestCallbacks&&(this.requestCallbacks[R.requestId].resolve(R.response),delete this.requestCallbacks[R.requestId]):g.data.eventName===T.default.SendTelemetry&&(null===(C=this.logger)||void 0===C||C.log(R.logLevel,R.logData.Event,R.logData)))),[2]):[2]})})},S.prototype.dispose=function(){var g;null===(g=document.getElementById(this.iframeId))||void 0===g||g.remove(),this.requestCallbacks={},this.iframeLoaded=!1},S.prototype.loadIframe=function(){return b(this,void 0,void 0,function(){var g=this;return h(this,function(C){return[2,new Promise(function(R,D){if(Array.from(document.getElementsByTagName("iframe")).filter(function(y){return y.id==g.iframeId}).length)return R();var P=document.createElement("iframe");P.id=g.iframeId,P.src=p.baseUrl+"/"+f+"/iframe.html?clientId="+g.clientId+"&debug="+g.debug+"&telemetry=true",P.addEventListener("load",function(){g.debug&&console.log("iframe loaded!"),g.iframeLoaded=!0,R()}),P.addEventListener("error",function(){D()}),document.head.append(P)})]})})},S}();m.default=v},1700:function(Q,m,u){"use strict";var s=this&&this.__awaiter||function(I,f,c,v){return new(c||(c=Promise))(function(g,C){function R(N){try{_(v.next(N))}catch(P){C(P)}}function D(N){try{_(v.throw(N))}catch(P){C(P)}}function _(N){N.done?g(N.value):function(g){return g instanceof c?g:new c(function(C){C(g)})}(N.value).then(R,D)}_((v=v.apply(I,f||[])).next())})},b=this&&this.__generator||function(I,f){var v,S,g,C,c={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return C={next:R(0),throw:R(1),return:R(2)},"function"==typeof Symbol&&(C[Symbol.iterator]=function(){return this}),C;function R(_){return function(N){return function(_){if(v)throw new TypeError("Generator is already executing.");for(;c;)try{if(v=1,S&&(g=2&_[0]?S.return:_[0]?S.throw||((g=S.return)&&g.call(S),0):S.next)&&!(g=g.call(S,_[1])).done)return g;switch(S=0,g&&(_=[2&_[0],g.value]),_[0]){case 0:case 1:g=_;break;case 4:return c.label++,{value:_[1],done:!1};case 5:c.label++,S=_[1],_=[0];continue;case 7:_=c.ops.pop(),c.trys.pop();continue;default:if(!(g=(g=c.trys).length>0&&g[g.length-1])&&(6===_[0]||2===_[0])){c=0;continue}if(3===_[0]&&(!g||_[1]>g[0]&&_[1]<g[3])){c.label=_[1];break}if(6===_[0]&&c.label<g[1]){c.label=g[1],g=_;break}if(g&&c.label<g[2]){c.label=g[2],c.ops.push(_);break}g[2]&&c.ops.pop(),c.trys.pop();continue}_=f.call(I,c)}catch(N){_=[6,N],S=0}finally{v=g=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,N])}}};Object.defineProperty(m,"__esModule",{value:!0});var h=u(9237),p=u(5356),E=u(9638),d=u(4239),T=u(2782),A=function(){function I(f){void 0===f&&(f=void 0),this.debug=!1,this.logger=f,d.default.isBrowser()&&console.error("FramedMode should be used on Web platform")}return I.prototype.setDebug=function(f){this.debug=f},I.prototype.setup=function(){return s(this,void 0,void 0,function(){return b(this,function(f){return[2,Promise.resolve()]})})},I.prototype.initialize=function(f){return s(this,void 0,void 0,function(){return b(this,function(c){switch(c.label){case 0:return this.debug&&console.log("[FramedlessClient][initialize]"),this.chatToken=f.chatToken,[4,this.skypeTokenAuth()];case 1:return c.sent(),[2]}})})},I.prototype.skypeTokenAuth=function(f){var c,v,S;return void 0===f&&(f=null),s(this,void 0,void 0,function(){var g,C;return b(this,function(R){switch(R.label){case 0:return R.trys.push([0,2,,3]),[4,h.default.skypeTokenAuth(f||this.chatToken)];case 1:return(g=R.sent()).ok||null===(c=this.logger)||void 0===c||c.log(p.default.ERROR,E.default.SkypeTokenAuth,{ChatId:f?f.chatId:null===(v=this.chatToken)||void 0===v?void 0:v.chatId,AMSClientVersion:T.sdkVersion,ExceptionDetails:{status:g.status}}),[2,g];case 2:throw C=R.sent(),null===(S=this.logger)||void 0===S||S.log(p.default.ERROR,E.default.SkypeTokenAuth,{ChatId:f?f.chatId:this.chatToken.chatId,AMSClientVersion:T.sdkVersion,ExceptionDetails:C}),new Error("skypeTokenAuth");case 3:return[2]}})})},I.prototype.createObject=function(f,c,v){var S;return void 0===v&&(v=null),s(this,void 0,void 0,function(){var C;return b(this,function(R){switch(R.label){case 0:return R.trys.push([0,2,,3]),[4,h.default.createObject(f,c,v||this.chatToken)];case 1:return[2,R.sent()];case 2:throw C=R.sent(),null===(S=this.logger)||void 0===S||S.log(p.default.ERROR,E.default.CreateObject,{ChatId:v?v.chatId:this.chatToken.chatId,AMSClientVersion:T.sdkVersion,ExceptionDetails:C}),new Error("createObject");case 3:return[2]}})})},I.prototype.uploadDocument=function(f,c,v){var S;return void 0===v&&(v=null),s(this,void 0,void 0,function(){var C;return b(this,function(R){switch(R.label){case 0:return R.trys.push([0,2,,3]),[4,h.default.uploadDocument(f,c,v||this.chatToken)];case 1:return[2,R.sent()];case 2:throw C=R.sent(),null===(S=this.logger)||void 0===S||S.log(p.default.ERROR,E.default.UploadDocument,{ChatId:v?v.chatId:this.chatToken.chatId,AMSClientVersion:T.sdkVersion,ExceptionDetails:C}),new Error("uploadDocument");case 3:return[2]}})})},I.prototype.getViewStatus=function(f,c){var v;return void 0===c&&(c=null),s(this,void 0,void 0,function(){var g;return b(this,function(C){switch(C.label){case 0:return C.trys.push([0,2,,3]),[4,h.default.getViewStatus(f,c||this.chatToken)];case 1:return[2,C.sent()];case 2:throw g=C.sent(),null===(v=this.logger)||void 0===v||v.log(p.default.ERROR,E.default.GetViewStatus,{ChatId:c?c.chatId:this.chatToken.chatId,AMSClientVersion:T.sdkVersion,ExceptionDetails:g}),new Error("getViewStatus");case 3:return[2]}})})},I.prototype.getView=function(f,c,v){var S;return void 0===v&&(v=null),s(this,void 0,void 0,function(){var C;return b(this,function(R){switch(R.label){case 0:return R.trys.push([0,2,,3]),[4,h.default.getView(f,c,v||this.chatToken)];case 1:return[2,R.sent()];case 2:throw C=R.sent(),null===(S=this.logger)||void 0===S||S.log(p.default.ERROR,E.default.GetView,{ChatId:v?v.chatId:this.chatToken.chatId,AMSClientVersion:T.sdkVersion,ExceptionDetails:C}),new Error("getView");case 3:return[2]}})})},I.prototype.fetchBlob=function(f){return s(this,void 0,void 0,function(){var S;return b(this,function(g){switch(g.label){case 0:return g.trys.push([0,3,,4]),[4,fetch(f)];case 1:return[4,g.sent().blob()];case 2:return[2,g.sent()];case 3:throw S=g.sent(),console.log(S),new Error("fetchBlob");case 4:return[2]}})})},I}();m.default=A},7643:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.silentError=!0,s.debug=!1,s}();m.default=u},5356:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR",s.LOG="LOG",u;var s})();m.default=u},9638:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).IframeLoaded="AMSIframeLoaded",s.SkypeTokenAuth="AMSSkypeTokenAuth",s.CreateObject="AMSCreateObject",s.UploadDocument="AMSUploadDocument",s.GetViewStatus="AMSGetViewStatus",s.GetView="AMSGetView",s.SendTelemetry="AMSSendTelemetry",u;var s})();m.default=u},759:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).None="None",s.Request="Request",s.Response="Response",u;var s})();m.default=u},2782:(Q,m)=>{m.baseUrl="https://comms.omnichannelengagementhub.com/ams",m.sdkVersion="0.1.0"},3285:function(Q,m,u){"use strict";var s=this&&this.__awaiter||function(A,I,f,c){return new(f||(f=Promise))(function(S,g){function C(_){try{D(c.next(_))}catch(N){g(N)}}function R(_){try{D(c.throw(_))}catch(N){g(N)}}function D(_){_.done?S(_.value):function(S){return S instanceof f?S:new f(function(g){g(S)})}(_.value).then(C,R)}D((c=c.apply(A,I||[])).next())})},b=this&&this.__generator||function(A,I){var c,v,S,g,f={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return g={next:C(0),throw:C(1),return:C(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function C(D){return function(_){return function(D){if(c)throw new TypeError("Generator is already executing.");for(;f;)try{if(c=1,v&&(S=2&D[0]?v.return:D[0]?v.throw||((S=v.return)&&S.call(v),0):v.next)&&!(S=S.call(v,D[1])).done)return S;switch(v=0,S&&(D=[2&D[0],S.value]),D[0]){case 0:case 1:S=D;break;case 4:return f.label++,{value:D[1],done:!1};case 5:f.label++,v=D[1],D=[0];continue;case 7:D=f.ops.pop(),f.trys.pop();continue;default:if(!(S=(S=f.trys).length>0&&S[S.length-1])&&(6===D[0]||2===D[0])){f=0;continue}if(3===D[0]&&(!S||D[1]>S[0]&&D[1]<S[3])){f.label=D[1];break}if(6===D[0]&&f.label<S[1]){f.label=S[1],S=D;break}if(S&&f.label<S[2]){f.label=S[2],f.ops.push(D);break}S[2]&&f.ops.pop(),f.trys.pop();continue}D=I.call(A,f)}catch(_){D=[6,_],v=0}finally{c=S=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([D,_])}}};Object.defineProperty(m,"__esModule",{value:!0});var h=u(7987),p=u(4543),E=u(1700),d=u(7643);m.default=function(A){return s(void 0,void 0,void 0,function(){var I,f,c;return b(this,function(v){switch(v.label){case 0:return A.debug&&console.log("[createAMSClient] "+(A.framedMode?"FramedClient":"FramedlessClient")),I=new h.default(A.logger),f={multiClient:A.multiClient||!1},[4,(c=A.framedMode?new p.default(I,f):new E.default(I)).setup()];case 1:return v.sent(),A.debug&&c.setDebug(A.debug||!1),d.default.debug=A.debug||!1,d.default.silentError=A.silentError||!0,[2,c]}})})}},7463:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(3285),b=u(1700),h=u(4543);m.default=s.default,function(){if(void 0===typeof window)throw new Error("window object not found");"Microsoft"in window||(window.Microsoft={}),"CRM"in window.Microsoft||(window.Microsoft.CRM={}),"Omnichannel"in window.Microsoft.CRM||(window.Microsoft.CRM.Omnichannel={}),"AMSClient"in window.Microsoft.CRM.Omnichannel||(window.Microsoft.CRM.Omnichannel.AMS={SDK:{createAMSClient:s.default,FramedClient:h.default,FramedlessClient:b.default}})}()},4239:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.isReactNative=m.isNode=m.isBrowser=void 0,m.isBrowser=function(){return"undefined"!=typeof window&&void 0!==window.document},m.isNode=function(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node},m.isReactNative=function(){return"undefined"!=typeof navigator&&"ReactNative"==navigator.product},m.default={isBrowser:m.isBrowser,isNode:m.isNode,isReactNative:m.isReactNative}},8202:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.uuidv4=void 0,m.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var b=16*Math.random()|0;return("x"===s?b:3&b|8).toString(16)})}},7626:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(Oe){for(var se,fe=1,we=arguments.length;fe<we;fe++)for(var Te in se=arguments[fe])Object.prototype.hasOwnProperty.call(se,Te)&&(Oe[Te]=se[Te]);return Oe}).apply(this,arguments)},b=this&&this.__awaiter||function(Oe,se,fe,we){return new(fe||(fe=Promise))(function(ye,Pe){function Ve(We){try{Ie(we.next(We))}catch(Qe){Pe(Qe)}}function Ue(We){try{Ie(we.throw(We))}catch(Qe){Pe(Qe)}}function Ie(We){We.done?ye(We.value):function(ye){return ye instanceof fe?ye:new fe(function(Pe){Pe(ye)})}(We.value).then(Ve,Ue)}Ie((we=we.apply(Oe,se||[])).next())})},h=this&&this.__generator||function(Oe,se){var we,Te,ye,Pe,fe={label:0,sent:function(){if(1&ye[0])throw ye[1];return ye[1]},trys:[],ops:[]};return Pe={next:Ve(0),throw:Ve(1),return:Ve(2)},"function"==typeof Symbol&&(Pe[Symbol.iterator]=function(){return this}),Pe;function Ve(Ie){return function(We){return function(Ie){if(we)throw new TypeError("Generator is already executing.");for(;fe;)try{if(we=1,Te&&(ye=2&Ie[0]?Te.return:Ie[0]?Te.throw||((ye=Te.return)&&ye.call(Te),0):Te.next)&&!(ye=ye.call(Te,Ie[1])).done)return ye;switch(Te=0,ye&&(Ie=[2&Ie[0],ye.value]),Ie[0]){case 0:case 1:ye=Ie;break;case 4:return fe.label++,{value:Ie[1],done:!1};case 5:fe.label++,Te=Ie[1],Ie=[0];continue;case 7:Ie=fe.ops.pop(),fe.trys.pop();continue;default:if(!(ye=(ye=fe.trys).length>0&&ye[ye.length-1])&&(6===Ie[0]||2===Ie[0])){fe=0;continue}if(3===Ie[0]&&(!ye||Ie[1]>ye[0]&&Ie[1]<ye[3])){fe.label=Ie[1];break}if(6===Ie[0]&&fe.label<ye[1]){fe.label=ye[1],ye=Ie;break}if(ye&&fe.label<ye[2]){fe.label=ye[2],fe.ops.push(Ie);break}ye[2]&&fe.ops.pop(),fe.trys.pop();continue}Ie=se.call(Oe,fe)}catch(We){Ie=[6,We],Te=0}finally{we=ye=0}if(5&Ie[0])throw Ie[1];return{value:Ie[0]?Ie[1]:void 0,done:!0}}([Ie,We])}}},p=this&&this.__spreadArrays||function(){for(var Oe=0,se=0,fe=arguments.length;se<fe;se++)Oe+=arguments[se].length;var we=Array(Oe),Te=0;for(se=0;se<fe;se++)for(var ye=arguments[se],Pe=0,Ve=ye.length;Pe<Ve;Pe++,Te++)we[Te]=ye[Pe];return we};Object.defineProperty(m,"__esModule",{value:!0});var E=u(2811),d=u(2902),T=u(3762),A=u(8290),I=u(6345),f=u(8098),c=u(641),v=u(8953),S=u(2921),g=u(6419),C=u(2562),R=u(7925),D=u(2900),_=u(4694),N=u(2217),P=u(6194),y=u(8191),M=u(5642),U=u(448),$=u(3372),j=u(6233),ue=u(4352),Z=u(5655),Y=u(1247),W=u(9600),ce=u(7463),Ce=u(7432),ne=u(5480),X=u(3968),de=u(9340),te=u(838),K=u(6633),re=u(813),ve=u(9425),be=u(1775),Be=u(7616),$e=function(){function Oe(se,fe){var we,Te,ye,Pe,Ve,Ue,Ie,We;void 0===fe&&(fe=c.defaultChatSDKConfig),this.ACSClient=null,this.AMSClient=null,this.authSettings=null,this.authenticatedUserToken=null,this.conversation=null,this.callingOption=g.default.NoCalling,this.telemetry=null,this.ic3ClientLogger=null,this.ocSdkLogger=null,this.acsClientLogger=null,this.acsAdapterLogger=null,this.callingSdkLogger=null,this.isPersistentChat=!1,this.isChatReconnect=!1,this.reconnectId=null,this.refreshTokenTimer=null,this.debug=!1,this.runtimeId=T.uuidv4(),this.omnichannelConfig=se,this.chatSDKConfig=s(s({},c.defaultChatSDKConfig),fe),this.isInitialized=!1,this.liveChatVersion=y.default.V1,this.localeId=A.defaultLocaleId,this.requestId=T.uuidv4(),this.chatToken={},this.liveChatConfig={},this.dataMaskingRules={},this.authSettings=null,this.preChatSurvey=null,this.telemetry=te.default(this.debug),this.scenarioMarker=new Y.default(this.omnichannelConfig),this.ic3ClientLogger=E.createIC3ClientLogger(this.omnichannelConfig),this.ocSdkLogger=E.createOCSDKLogger(this.omnichannelConfig),this.acsClientLogger=E.createACSClientLogger(this.omnichannelConfig),this.acsAdapterLogger=E.createACSAdapterLogger(this.omnichannelConfig),this.callingSdkLogger=E.createCallingSDKLogger(this.omnichannelConfig),this.scenarioMarker.useTelemetry(this.telemetry),this.ic3ClientLogger.useTelemetry(this.telemetry),this.ocSdkLogger.useTelemetry(this.telemetry),this.acsClientLogger.useTelemetry(this.telemetry),this.acsAdapterLogger.useTelemetry(this.telemetry),this.callingSdkLogger.useTelemetry(this.telemetry),this.scenarioMarker.setRuntimeId(this.runtimeId),this.ic3ClientLogger.setRuntimeId(this.runtimeId),this.ocSdkLogger.setRuntimeId(this.runtimeId),this.acsClientLogger.setRuntimeId(this.runtimeId),this.acsAdapterLogger.setRuntimeId(this.runtimeId),this.callingSdkLogger.setRuntimeId(this.runtimeId),Be.default(se),c.default(fe),(null===(we=this.chatSDKConfig.telemetry)||void 0===we?void 0:we.disable)&&(null===(Te=this.telemetry)||void 0===Te||Te.disable()),(null===(ye=this.chatSDKConfig.telemetry)||void 0===ye?void 0:ye.ariaTelemetryKey)&&this.telemetry.initialize(this.chatSDKConfig.telemetry.ariaTelemetryKey),null===(Pe=this.ic3ClientLogger)||void 0===Pe||Pe.setRequestId(this.requestId),null===(Ve=this.ocSdkLogger)||void 0===Ve||Ve.setRequestId(this.requestId),null===(Ue=this.acsClientLogger)||void 0===Ue||Ue.setRequestId(this.requestId),null===(Ie=this.acsAdapterLogger)||void 0===Ie||Ie.setRequestId(this.requestId),null===(We=this.callingSdkLogger)||void 0===We||We.setRequestId(this.requestId)}return Oe.prototype.setDebug=function(se){var fe,we,Te,ye,Pe,Ve,Ue;this.debug=se,null===(fe=this.AMSClient)||void 0===fe||fe.setDebug(se),null===(we=this.telemetry)||void 0===we||we.setDebug(se),this.scenarioMarker.setDebug(se),null===(Te=this.ic3ClientLogger)||void 0===Te||Te.setDebug(se),null===(ye=this.ocSdkLogger)||void 0===ye||ye.setDebug(se),null===(Pe=this.acsClientLogger)||void 0===Pe||Pe.setDebug(se),null===(Ve=this.acsAdapterLogger)||void 0===Ve||Ve.setDebug(se),null===(Ue=this.callingSdkLogger)||void 0===Ue||Ue.setDebug(se)},Oe.prototype.initialize=function(){return b(this,void 0,void 0,function(){var se,fe,we;return h(this,function(ye){switch(ye.label){case 0:if(this.scenarioMarker.startScenario(W.default.InitializeChatSDK),this.isInitialized)return this.scenarioMarker.completeScenario(W.default.InitializeChatSDK),[2,this.liveChatConfig];ye.label=1;case 1:return ye.trys.push([1,8,,9]),this.OCSDKProvider=T.SDKProvider,se=this,[4,T.SDKProvider.getSDK(this.omnichannelConfig,{},this.ocSdkLogger)];case 2:return se.OCClient=ye.sent(),[4,this.getChatConfig()];case 3:return ye.sent(),this.liveChatVersion!==y.default.V2?[3,5]:(this.ACSClient=new d.default(this.acsClientLogger),fe=this,[4,ce.default({framedMode:f.isBrowser(),debug:!1,logger:void 0})]);case 4:return fe.AMSClient=ye.sent(),[3,7];case 5:return we=this,[4,this.getIC3Client()];case 6:we.IC3Client=ye.sent(),ye.label=7;case 7:return this.isInitialized=!0,this.scenarioMarker.completeScenario(W.default.InitializeChatSDK),[3,9];case 8:return ye.sent(),this.scenarioMarker.failScenario(W.default.InitializeChatSDK),[3,9];case 9:return[2,this.liveChatConfig]}})})},Oe.prototype.getChatReconnectContext=function(se){return void 0===se&&(se={}),b(this,void 0,void 0,function(){var fe,Te,ye,Ve,Ue,Pe;return h(this,function(Ie){switch(Ie.label){case 0:if(this.scenarioMarker.startScenario(W.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),fe={reconnectId:null,redirectURL:null},!this.authenticatedUserToken)return[3,5];Ie.label=1;case 1:return Ie.trys.push([1,3,,4]),[4,this.OCClient.getReconnectableChats({authenticatedUserToken:this.authenticatedUserToken})];case 2:return(Te=Ie.sent())&&Te.reconnectid&&(fe.reconnectId=Te.reconnectid),this.scenarioMarker.completeScenario(W.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:return ye=Ie.sent(),Pe={response:"OCClientGetReconnectableChatsFailed"},this.scenarioMarker.failScenario(W.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Pe)}),console.error("OmnichannelChatSDK/GetChatReconnectContext/error "+ye),[3,4];case 4:return[3,9];case 5:if(!se.reconnectId)return[3,9];Ie.label=6;case 6:return Ie.trys.push([6,8,,9]),[4,this.OCClient.getReconnectAvailability(se.reconnectId)];case 7:return(Ve=Ie.sent())&&!Ve.isReconnectAvailable?Ve.reconnectRedirectionURL&&(fe.redirectURL=Ve.reconnectRedirectionURL):fe.reconnectId=se.reconnectId,this.scenarioMarker.completeScenario(W.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,9];case 8:return Ue=Ie.sent(),Pe={response:"OCClientGetReconnectAvailabilityFailed"},this.scenarioMarker.failScenario(W.default.GetChatReconnectContext,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(Pe)}),console.error("OmnichannelChatSDK/GetChatReconnectContext/error "+Ue),[3,9];case 9:return[2,fe]}})})},Oe.prototype.startChat=function(se){var fe,we,Te,ye,Pe,Ve,Ue,Ie,We,Qe,Ge,rt,Le,at,tt,vt,Qt;return void 0===se&&(se={}),b(this,void 0,void 0,function(){var Ke,bt,Xt,gn,dr,Xe,Tr,br,Ci,Kn,xt,Er,ot,It=this;return h(this,function(Lt){switch(Lt.label){case 0:return this.scenarioMarker.startScenario(W.default.StartChat,{RequestId:this.requestId}),f.default.isNode()||f.default.isReactNative()||this.IC3Client||this.liveChatVersion!==y.default.V1?[3,2]:(Ke=this,[4,this.getIC3Client()]);case 1:Ke.IC3Client=Lt.sent(),Lt.label=2;case 2:if(this.isChatReconnect&&!(null===(fe=this.chatSDKConfig.chatReconnect)||void 0===fe?void 0:fe.disable)&&!this.isPersistentChat&&se.reconnectId&&(this.reconnectId=se.reconnectId),!this.isPersistentChat||(null===(we=this.chatSDKConfig.persistentChat)||void 0===we?void 0:we.disable))return[3,6];Lt.label=3;case 3:return Lt.trys.push([3,5,,6]),[4,this.OCClient.getReconnectableChats({authenticatedUserToken:this.authenticatedUserToken})];case 4:return(bt=Lt.sent())&&bt.reconnectid&&(this.reconnectId=bt.reconnectid),[3,6];case 5:throw Lt.sent(),ot={response:"OCClientGetReconnectableChatsFailed"},Error(ot.response);case 6:return se.liveChatContext&&!this.reconnectId?(this.chatToken=se.liveChatContext.chatToken||{},this.requestId=se.liveChatContext.requestId||T.uuidv4(),[4,this.getConversationDetails()]):[3,8];case 7:if(Xt=Lt.sent(),0===Object.keys(Xt).length)throw ot={response:"InvalidConversation"},this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),console.error("Conversation not found"),Error(ot.response);if(Xt.state===M.default.WrapUp||Xt.state===M.default.Closed)throw ot={response:"ClosedConversation"},this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),console.error("Unable to join conversation that's in '"+Xt.state+"' state"),Error(ot.response);Lt.label=8;case 8:return this.chatToken&&0===Object.keys(this.chatToken).length?[4,this.getChatToken(!1)]:[3,10];case 9:Lt.sent(),Lt.label=10;case 10:if(null===(Te=this.ic3ClientLogger)||void 0===Te||Te.setChatId(this.chatToken.chatId||""),null===(ye=this.ocSdkLogger)||void 0===ye||ye.setChatId(this.chatToken.chatId||""),null===(Pe=this.acsClientLogger)||void 0===Pe||Pe.setChatId(this.chatToken.chatId||""),null===(Ve=this.acsAdapterLogger)||void 0===Ve||Ve.setChatId(this.chatToken.chatId||""),null===(Ue=this.callingSdkLogger)||void 0===Ue||Ue.setChatId(this.chatToken.chatId||""),(gn={initContext:{}}).initContext.locale=A.getLocaleStringFromId(this.localeId),this.isPersistentChat&&!(null===(Ie=this.chatSDKConfig.persistentChat)||void 0===Ie?void 0:Ie.disable)&&(gn.reconnectId=this.reconnectId),this.isChatReconnect&&!(null===(We=this.chatSDKConfig.chatReconnect)||void 0===We?void 0:We.disable)&&!this.isPersistentChat&&(gn.reconnectId=this.reconnectId),se.customContext&&(gn.initContext.customContextData=se.customContext),se.browser&&(gn.initContext.browser=se.browser),se.os&&(gn.initContext.os=se.os),se.locale&&(gn.initContext.locale=se.locale),se.device&&(gn.initContext.device=se.device),se.preChatResponse&&(gn.initContext.preChatResponse=se.preChatResponse),se.initContext&&(gn.initContext=se.initContext),this.authenticatedUserToken&&(gn.authenticatedUserToken=this.authenticatedUserToken),se.liveChatContext)return[3,14];Lt.label=11;case 11:return Lt.trys.push([11,13,,14]),[4,this.OCClient.sessionInit(this.requestId,gn)];case 12:return Lt.sent(),[3,14];case 13:throw dr=Lt.sent(),ot={response:"OCClientSessionInitFailed"},(null===(Qe=dr)||void 0===Qe?void 0:Qe.isAxiosError)&&(null===(rt=null===(Ge=dr.response)||void 0===Ge?void 0:Ge.headers)||void 0===rt?void 0:rt.errorcode.toString())===j.default.WidgetUseOutsideOperatingHour.toString()&&(ot.response=j.default[j.default.WidgetUseOutsideOperatingHour].toString(),ot.message="Widget used outside of operating hours",console.error(ot.message)),this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),new Error(ot.response);case 14:if(this.liveChatVersion!==y.default.V2)return[3,25];Xe={token:this.chatToken.token,id:this.chatToken.visitorId||"teamsvisitor",threadId:this.chatToken.chatId,environmentUrl:this.chatToken.acsEndpoint,pollingInterval:1e3},Lt.label=15;case 15:return Lt.trys.push([15,17,,18]),[4,null===(Le=this.ACSClient)||void 0===Le?void 0:Le.initialize({token:Xe.token,environmentUrl:Xe.environmentUrl})];case 16:return Lt.sent(),[3,18];case 17:return Tr=Lt.sent(),ot={response:"ACSClientInitializeFailed"},this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),console.error("OmnichannelChatSDK/startChat/initialize/error "+Tr),[2,Tr];case 18:return Lt.trys.push([18,20,,21]),br=this,[4,null===(at=this.ACSClient)||void 0===at?void 0:at.joinConversation({id:Xe.id,threadId:Xe.threadId,pollingInterval:Xe.pollingInterval})];case 19:return br.conversation=Lt.sent(),this.scenarioMarker.completeScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,21];case 20:throw Ci=Lt.sent(),ot={response:"ACSClientJoinConversationFailed"},this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),console.error("OmnichannelChatSDK/startChat/joinConversation/error "+Ci),Error(ot.response);case 21:return Lt.trys.push([21,23,,24]),[4,null===(tt=this.AMSClient)||void 0===tt?void 0:tt.initialize({chatToken:this.chatToken})];case 22:return Lt.sent(),[3,24];case 23:throw Lt.sent(),ot={response:"AMSClientInitializeFailed"},this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),Error(ot.response);case 24:return[3,31];case 25:return Lt.trys.push([25,27,,28]),[4,this.IC3Client.initialize({token:this.chatToken.token,regionGtms:this.chatToken.regionGTMS,visitor:!0})];case 26:return Lt.sent(),[3,28];case 27:return Kn=Lt.sent(),ot={response:"IC3ClientInitializeFailed"},this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),console.error("OmnichannelChatSDK/startChat/initialize/error "+Kn),[2,Kn];case 28:return Lt.trys.push([28,30,,31]),xt=this,[4,this.IC3Client.joinConversation(this.chatToken.chatId)];case 29:return xt.conversation=Lt.sent(),this.scenarioMarker.completeScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,31];case 30:return Er=Lt.sent(),ot={response:"IC3ClientJoinConversationFailed"},this.scenarioMarker.failScenario(W.default.StartChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify(ot)}),console.error("OmnichannelChatSDK/startChat/joinConversation/error "+Er),[2,Er];case 31:return this.isPersistentChat&&!(null===(vt=this.chatSDKConfig.persistentChat)||void 0===vt?void 0:vt.disable)&&(this.refreshTokenTimer=setInterval(function(){return b(It,void 0,void 0,function(){return h(this,function(Lr){switch(Lr.label){case 0:return[4,this.getChatToken(!1)];case 1:return Lr.sent(),this.updateChatToken(this.chatToken.token,this.chatToken.regionGTMS),[2]}})})},null===(Qt=this.chatSDKConfig.persistentChat)||void 0===Qt?void 0:Qt.tokenUpdateTime)),[2]}})})},Oe.prototype.endChat=function(){var se,fe,we,Te,ye,Pe,Ve,Ue,Ie,We,Qe,Ge,rt;return b(this,void 0,void 0,function(){var Le,at,tt,vt;return h(this,function(De){switch(De.label){case 0:this.scenarioMarker.startScenario(W.default.EndChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),Le={},this.isPersistentChat&&!(null===(se=this.chatSDKConfig.persistentChat)||void 0===se?void 0:se.disable)&&(at=null!==this.reconnectId,Le.isPersistentChat=this.isPersistentChat,Le.isReconnectChat=at),this.isChatReconnect&&!(null===(fe=this.chatSDKConfig.chatReconnect)||void 0===fe?void 0:fe.disable)&&!this.isPersistentChat&&(this.requestId=(tt=null!==this.reconnectId)?this.reconnectId:this.requestId,Le.isReconnectChat=tt),this.authenticatedUserToken&&(Le.authenticatedUserToken=this.authenticatedUserToken),De.label=1;case 1:return De.trys.push([1,3,,4]),[4,this.OCClient.sessionClose(this.requestId,Le)];case 2:return De.sent(),this.scenarioMarker.completeScenario(W.default.EndChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),null===(we=this.conversation)||void 0===we||we.disconnect(),this.conversation=null,this.requestId=T.uuidv4(),this.chatToken={},this.reconnectId=null,this.IC3Client&&(this.IC3Client.dispose(),!f.default.isNode()&&!f.default.isReactNative()&&I.removeElementById(this.IC3Client.id),this.IC3Client=null),null===(Te=this.ic3ClientLogger)||void 0===Te||Te.setRequestId(this.requestId),null===(ye=this.ic3ClientLogger)||void 0===ye||ye.setChatId(""),null===(Pe=this.ocSdkLogger)||void 0===Pe||Pe.setRequestId(this.requestId),null===(Ve=this.ocSdkLogger)||void 0===Ve||Ve.setChatId(""),null===(Ue=this.acsClientLogger)||void 0===Ue||Ue.setRequestId(this.requestId),null===(Ie=this.acsClientLogger)||void 0===Ie||Ie.setChatId(""),null===(We=this.acsAdapterLogger)||void 0===We||We.setRequestId(this.requestId),null===(Qe=this.acsAdapterLogger)||void 0===Qe||Qe.setChatId(""),null===(Ge=this.callingSdkLogger)||void 0===Ge||Ge.setRequestId(this.requestId),null===(rt=this.callingSdkLogger)||void 0===rt||rt.setChatId(""),[3,4];case 3:return vt=De.sent(),this.scenarioMarker.failScenario(W.default.EndChat,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify({response:"OCClientSessionCloseFailed"})}),console.error("OmnichannelChatSDK/endChat/error "+vt),[2,vt];case 4:return null!==this.refreshTokenTimer&&(clearInterval(this.refreshTokenTimer),this.refreshTokenTimer=null),[2]}})})},Oe.prototype.getCurrentLiveChatContext=function(){return b(this,void 0,void 0,function(){var se,fe,we;return h(this,function(Te){switch(Te.label){case 0:return[4,this.getChatToken()];case 1:return se=Te.sent(),this.scenarioMarker.startScenario(W.default.GetCurrentLiveChatContext,{RequestId:fe=this.requestId,ChatId:se.chatId}),we={chatToken:se,requestId:fe},0===Object.keys(we.chatToken).length?[2,{}]:(this.scenarioMarker.completeScenario(W.default.GetCurrentLiveChatContext,{RequestId:fe,ChatId:se.chatId}),[2,we])}})})},Oe.prototype.getConversationDetails=function(){var se,fe,we,Te;return b(this,void 0,void 0,function(){var ye,Pe,Ie,We,Qe,Ge,rt;return h(this,function(Le){switch(Le.label){case 0:this.scenarioMarker.startScenario(W.default.GetConversationDetails,{RequestId:this.requestId,ChatId:(null===(se=this.chatToken)||void 0===se?void 0:se.chatId)||""}),ye={},this.isPersistentChat&&!(null===(fe=this.chatSDKConfig.persistentChat)||void 0===fe?void 0:fe.disable)&&this.reconnectId&&(ye.reconnectId=this.reconnectId),this.isChatReconnect&&!(null===(we=this.chatSDKConfig.chatReconnect)||void 0===we?void 0:we.disable)&&!this.isPersistentChat&&this.reconnectId&&(ye.reconnectId=this.reconnectId),this.authenticatedUserToken&&(ye.authenticatedUserToken=this.authenticatedUserToken),Le.label=1;case 1:return Le.trys.push([1,3,,4]),[4,this.OCClient.getLWIDetails(this.requestId,ye)];case 2:return Pe=Le.sent(),We=Pe.CanRenderPostChat,Qe=Pe.ParticipantType,Ge={state:Pe.State,conversationId:Pe.ConversationId},(Ie=Pe.AgentAcceptedOn)&&(Ge.agentAcceptedOn=Ie),We&&(Ge.canRenderPostChat=We),Qe&&(Ge.participantType=Qe),this.scenarioMarker.completeScenario(W.default.GetConversationDetails,{RequestId:this.requestId,ChatId:(null===(Te=this.chatToken)||void 0===Te?void 0:Te.chatId)||""}),[2,Ge];case 3:return rt=Le.sent(),this.scenarioMarker.failScenario(W.default.GetConversationDetails,{RequestId:this.requestId,ChatId:this.chatToken.chatId||""}),console.error("OmnichannelChatSDK/getConversationDetails/error "+rt),[3,4];case 4:return[2,{}]}})})},Oe.prototype.getPreChatSurvey=function(se){return void 0===se&&(se=!0),b(this,void 0,void 0,function(){var fe;return h(this,function(we){this.scenarioMarker.startScenario(W.default.GetPreChatSurvey);try{return fe=se?JSON.parse(this.preChatSurvey):this.preChatSurvey,this.scenarioMarker.completeScenario(W.default.GetPreChatSurvey),[2,fe]}catch(Te){this.scenarioMarker.failScenario(W.default.GetPreChatSurvey)}return[2]})})},Oe.prototype.getLiveChatConfig=function(se){return void 0===se&&(se=!0),b(this,void 0,void 0,function(){return h(this,function(fe){return se?[2,this.liveChatConfig]:[2,this.getChatConfig()]})})},Oe.prototype.getChatToken=function(se){var fe,we;return void 0===se&&(se=!0),b(this,void 0,void 0,function(){var Te,ye,Ve,Ie,We,Qe,Ge,rt,Le;return h(this,function(tt){switch(tt.label){case 0:if(this.scenarioMarker.startScenario(W.default.GetChatToken,{RequestId:this.requestId}),se)return[3,5];tt.label=1;case 1:return tt.trys.push([1,3,,4]),Te={},this.authenticatedUserToken&&(Te.authenticatedUserToken=this.authenticatedUserToken),this.isPersistentChat&&!(null===(fe=this.chatSDKConfig.persistentChat)||void 0===fe?void 0:fe.disable)&&(Te.reconnectId=this.reconnectId),this.isChatReconnect&&!(null===(we=this.chatSDKConfig.chatReconnect)||void 0===we?void 0:we.disable)&&!this.isPersistentChat&&(Te.reconnectId=this.reconnectId),[4,this.OCClient.getChatToken(this.requestId,Te)];case 2:return ye=tt.sent(),Ve=ye.Token,Ie=ye.ExpiresIn,We=ye.VisitorId,Qe=ye.VoiceVideoCallToken,Ge=ye.ACSEndpoint,rt=ye.AttachmentConfiguration,this.chatToken={chatId:ye.ChatId,regionGTMS:JSON.parse(ye.RegionGtms),requestId:this.requestId,token:Ve,expiresIn:Ie,visitorId:We,voiceVideoCallToken:Qe,acsEndpoint:Ge},rt&&rt.AttachmentServiceEndpoint&&(this.chatToken.amsEndpoint=rt.AttachmentServiceEndpoint),this.scenarioMarker.completeScenario(W.default.GetChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:return Le=tt.sent(),this.scenarioMarker.failScenario(W.default.GetChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify({response:"OCClientGetChatTokenFailed"})}),console.error("OmnichannelChatSDK/getChatToken/error "+Le),[3,4];case 4:return[3,6];case 5:this.scenarioMarker.completeScenario(W.default.GetChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),tt.label=6;case 6:return[2,this.chatToken]}})})},Oe.prototype.getCallingToken=function(){return b(this,void 0,void 0,function(){return h(this,function(se){return this.chatToken&&0===Object.keys(this.chatToken).length?[2,""]:this.chatToken.voiceVideoCallToken?(this.debug&&console.log("calling:acs"),[2,this.chatToken.voiceVideoCallToken.Token]):(this.debug&&console.log("calling:skype"),[2,this.chatToken.token])})})},Oe.prototype.getMessages=function(){var se;return b(this,void 0,void 0,function(){var fe;return h(this,function(Te){switch(Te.label){case 0:this.scenarioMarker.startScenario(W.default.GetMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),Te.label=1;case 1:return Te.trys.push([1,3,,4]),[4,null===(se=this.conversation)||void 0===se?void 0:se.getMessages()];case 2:return fe=Te.sent(),this.scenarioMarker.completeScenario(W.default.GetMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,fe];case 3:return Te.sent(),this.scenarioMarker.failScenario(W.default.GetMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 4:return[2]}})})},Oe.prototype.getDataMaskingRules=function(){return b(this,void 0,void 0,function(){return h(this,function(se){return[2,this.dataMaskingRules]})})},Oe.prototype.sendMessage=function(se){var fe;return b(this,void 0,void 0,function(){var we,Te,ye,Pe,Ve,Ue,We,Qe,Ge,rt,at;return h(this,function(vt){switch(vt.label){case 0:if(this.scenarioMarker.startScenario(W.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),Te=(we=this.chatSDKConfig.dataMasking).disable,ye=we.maskingCharacter,Pe=se.content,Object.keys(this.dataMaskingRules).length>0&&!Te)for(Ve=0,Ue=Object.values(this.dataMaskingRules);Ve<Ue.length;Ve++)for(We=new RegExp(Ue[Ve],"g"),Qe=void 0;Qe=We.exec(Pe);)Ge=Qe[0].replace(/./g,ye),Pe=Pe.replace(Qe[0],Ge);if(se.content=Pe,this.liveChatVersion!==y.default.V2)return[3,5];(rt={content:se.content}).metadata={widgetId:this.omnichannelConfig.widgetId,clientMessageId:Date.now().toString()},se.metadata&&(rt.metadata=s(s({},rt.metadata),se.metadata)),vt.label=1;case 1:return vt.trys.push([1,3,,4]),[4,null===(fe=this.conversation)||void 0===fe?void 0:fe.sendMessage(rt)];case 2:return vt.sent(),this.scenarioMarker.completeScenario(W.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:throw vt.sent(),this.scenarioMarker.failScenario(W.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("ChatSDKSendMessageFailed");case 4:return[3,9];case 5:at={content:se.content,timestamp:new Date,contentType:U.default.Text,deliveryMode:D.default.Bridged,messageType:$.default.UserMessage,properties:void 0,tags:p(re.defaultMessageTags),sender:{displayName:"Customer",id:"customer",type:ue.default.User}},se.tags&&(at.tags=se.tags),se.timestamp&&(at.timestamp=se.timestamp),vt.label=6;case 6:return vt.trys.push([6,8,,9]),[4,this.conversation.sendMessage(at)];case 7:return vt.sent(),this.scenarioMarker.completeScenario(W.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,9];case 8:throw vt.sent(),this.scenarioMarker.failScenario(W.default.SendMessages,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("ChatSDKSendMessageFailed");case 9:return[2]}})})},Oe.prototype.onNewMessage=function(se,fe){var we,Te;return void 0===fe&&(fe={}),b(this,void 0,void 0,function(){var ye,Ve,Ue,We,Qe,Pe,Ge,rt,Ie,Le,at,tt=this;return h(this,function(vt){switch(vt.label){case 0:return this.scenarioMarker.startScenario(W.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==y.default.V2?[3,3]:(ye=new Set,fe.rehydrate?(this.debug&&console.log("[OmnichannelChatSDK][onNewMessage] rehydrate"),[4,this.getMessages()]):[3,2]);case 1:for(Pe=vt.sent(),Ve=0,Ue=Pe.reverse();Ve<Ue.length;Ve++)!ye.has(We=(Ie=Ue[Ve]).id)&&(ye.add(We),se(Ie));vt.label=2;case 2:try{null===(we=this.conversation)||void 0===we||we.registerOnNewMessage(function(Qt){var De=Qt.id,Ke=de.default(Qt,{liveChatVersion:tt.liveChatVersion,debug:tt.debug});ye.has(De)||(se(Ke),ye.add(De))}),this.scenarioMarker.completeScenario(W.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(Qt){this.scenarioMarker.failScenario(W.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[3,6];case 3:return Qe=new Set,fe.rehydrate?(this.debug&&console.log("[OmnichannelChatSDK][onNewMessage] rehydrate"),[4,this.getMessages()]):[3,5];case 4:if(Pe=vt.sent())for(Ge=0,rt=Pe.reverse();Ge<rt.length;Ge++)!Qe.has(Le=(Ie=rt[Ge]).clientmessageid)&&(Qe.add(Le),at=de.default(Ie,{liveChatVersion:this.liveChatVersion,debug:this.debug}),se(at));vt.label=5;case 5:try{null===(Te=this.conversation)||void 0===Te||Te.registerOnNewMessage(function(Qt){var De=Qt.clientmessageid,Ke=Qt.messageType;if(!ve.isCustomerMessage(Qt)&&!Qe.has(De)&&Ke!==$.default.Typing){var nt=de.default(Qt,{liveChatVersion:tt.liveChatVersion,debug:tt.debug});se(nt)}}),this.scenarioMarker.completeScenario(W.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(Qt){this.scenarioMarker.failScenario(W.default.OnNewMessage,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}vt.label=6;case 6:return[2]}})})},Oe.prototype.sendTypingEvent=function(){return b(this,void 0,void 0,function(){var fe,we,Te,ye;return h(this,function(Pe){switch(Pe.label){case 0:if(this.scenarioMarker.startScenario(W.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==y.default.V2)return[3,6];Pe.label=1;case 1:return Pe.trys.push([1,4,,5]),[4,this.OCClient.sendTypingIndicator(this.requestId,y.default.V2,{customerDisplayName:v.default.Customer})];case 2:return Pe.sent(),[4,this.conversation.sendTyping()];case 3:return Pe.sent(),this.scenarioMarker.completeScenario(W.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,5];case 4:throw Pe.sent(),this.scenarioMarker.failScenario(W.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("OCClientSendTypingFailed");case 5:return[3,12];case 6:fe="{isTyping: 0}",Pe.label=7;case 7:return Pe.trys.push([7,11,,12]),[4,this.conversation.indicateTypingStatus(0)];case 8:return Pe.sent(),[4,this.conversation.getMembers()];case 9:return we=Pe.sent(),Te=we.filter(function(Ve){return Ve.type===ue.default.Bot}),[4,this.conversation.sendMessageToBot(Te[0].id,{payload:fe})];case 10:return Pe.sent(),this.scenarioMarker.completeScenario(W.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,12];case 11:return ye=Pe.sent(),console.error("OmnichannelChatSDK/sendTypingEvent/error"),this.scenarioMarker.failScenario(W.default.SendTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,ye];case 12:return[2]}})})},Oe.prototype.onTypingEvent=function(se){var fe;return b(this,void 0,void 0,function(){return h(this,function(we){if(this.scenarioMarker.startScenario(W.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion===y.default.V2)try{this.conversation.onTypingEvent(se),this.scenarioMarker.completeScenario(W.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(Te){this.scenarioMarker.failScenario(W.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}else try{null===(fe=this.conversation)||void 0===fe||fe.registerOnNewMessage(function(Te){var ye=Te.messageType;ve.isCustomerMessage(Te)||ye===$.default.Typing&&se(Te)}),this.scenarioMarker.completeScenario(W.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(Te){this.scenarioMarker.failScenario(W.default.OnTypingEvent,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},Oe.prototype.onAgentEndSession=function(se){var fe;return b(this,void 0,void 0,function(){var we=this;return h(this,function(Te){if(this.scenarioMarker.startScenario(W.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion===y.default.V2)try{this.conversation.registerOnThreadUpdate(function(ye){se(ye)}),this.scenarioMarker.completeScenario(W.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(ye){this.scenarioMarker.failScenario(W.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}else try{null===(fe=this.conversation)||void 0===fe||fe.registerOnThreadUpdate(function(ye){1===ye.members.length&&(se(ye),null!==we.refreshTokenTimer&&(clearInterval(we.refreshTokenTimer),we.refreshTokenTimer=null))}),this.scenarioMarker.completeScenario(W.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}catch(ye){this.scenarioMarker.failScenario(W.default.OnAgentEndSession,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},Oe.prototype.uploadFileAttachment=function(se){var fe,we,Te,ye;return b(this,void 0,void 0,function(){var Pe,Ve,Ue,Ie,We,Qe,Le,Ge,at;return h(this,function(tt){switch(tt.label){case 0:return this.scenarioMarker.startScenario(W.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==y.default.V2?[3,7]:[4,null===(fe=this.AMSClient)||void 0===fe?void 0:fe.createObject(null===(we=this.chatToken)||void 0===we?void 0:we.chatId,se)];case 1:return Pe=tt.sent(),Ve=Pe.id,[4,null===(Te=this.AMSClient)||void 0===Te?void 0:Te.uploadDocument(Ve,se)];case 2:Ue=tt.sent(),Ie={amsReferences:JSON.stringify([Ve])},We={amsMetadata:JSON.stringify([{contentType:se.type,fileName:se.name}])},Qe={content:"",metadata:s(s({widgetId:this.omnichannelConfig.widgetId,clientMessageId:Date.now().toString()},Ie),We)},Ge={content:"",timestamp:new Date,contentType:U.default.Text,deliveryMode:D.default.Bridged,messageType:$.default.UserMessage,tags:p(re.defaultMessageTags),sender:{displayName:"Customer",id:"customer",type:ue.default.User},fileMetadata:Ue},tt.label=3;case 3:return tt.trys.push([3,5,,6]),[4,null===(ye=this.conversation)||void 0===ye?void 0:ye.sendMessage(Qe)];case 4:return tt.sent(),this.scenarioMarker.completeScenario(W.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Ge];case 5:return tt.sent(),console.error("OmnichannelChatSDK/uploadFileAttachment/sendMessage/error"),this.scenarioMarker.failScenario(W.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,6];case 6:return[2,{}];case 7:return Le=void 0,f.default.isReactNative()||f.default.isNode()?[4,this.conversation.sendFileData(se,_.default.AmsBasedFileSharing)]:[3,9];case 8:return Le=tt.sent(),[3,11];case 9:return[4,this.conversation.uploadFile(se,_.default.AmsBasedFileSharing)];case 10:Le=tt.sent(),tt.label=11;case 11:Ge={content:"",timestamp:new Date,contentType:U.default.Text,deliveryMode:D.default.Bridged,messageType:$.default.UserMessage,tags:p(re.defaultMessageTags),sender:{displayName:"Customer",id:"customer",type:ue.default.User},fileMetadata:Le},tt.label=12;case 12:return tt.trys.push([12,14,,15]),[4,this.conversation.sendFileMessage(Le,Ge)];case 13:return tt.sent(),this.scenarioMarker.completeScenario(W.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Ge];case 14:return at=tt.sent(),console.error("OmnichannelChatSDK/uploadFileAttachment/error: "+at),this.scenarioMarker.failScenario(W.default.UploadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,at];case 15:return[2]}})})},Oe.prototype.downloadFileAttachment=function(se){var fe,we;return b(this,void 0,void 0,function(){var Te,ye,Pe,Ue,Ie;return h(this,function(We){switch(We.label){case 0:if(this.scenarioMarker.startScenario(W.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),this.liveChatVersion!==y.default.V2)return[3,6];We.label=1;case 1:return We.trys.push([1,4,,5]),[4,null===(fe=this.AMSClient)||void 0===fe?void 0:fe.getViewStatus(se)];case 2:return Te=We.sent(),ye=Te.view_location,[4,null===(we=this.AMSClient)||void 0===we?void 0:we.getView(se,ye)];case 3:return Pe=We.sent(),this.scenarioMarker.completeScenario(W.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Pe];case 4:throw We.sent(),this.scenarioMarker.failScenario(W.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("DownloadFileAttachmentFailed");case 5:return[3,9];case 6:return We.trys.push([6,8,,9]),[4,this.conversation.downloadFile(se)];case 7:return Ue=We.sent(),this.scenarioMarker.completeScenario(W.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Ue];case 8:throw Ie=We.sent(),console.error("OmnichannelChatSDK/downloadFileAttachment/error: "+Ie),this.scenarioMarker.failScenario(W.default.DownloadFileAttachment,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),new Error("DownloadFileAttachmentFailed");case 9:return[2]}})})},Oe.prototype.emailLiveChatTranscript=function(se){return b(this,void 0,void 0,function(){var fe,we,Te;return h(this,function(ye){fe={},this.scenarioMarker.startScenario(W.default.EmailLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId});try{return this.authenticatedUserToken&&(fe.authenticatedUserToken=this.authenticatedUserToken),we={ChatId:this.chatToken.chatId,EmailAddress:se.emailAddress,DefaultAttachmentMessage:se.attachmentMessage,CustomerLocale:se.locale||A.getLocaleStringFromId(this.localeId)},Te=this.OCClient.emailTranscript(this.requestId,this.chatToken.token,we,fe),this.scenarioMarker.completeScenario(W.default.EmailLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,Te]}catch(Pe){console.error("OmnichannelChatSDK/emailLiveChatTranscript/error: "+Pe),this.scenarioMarker.failScenario(W.default.EmailLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},Oe.prototype.getLiveChatTranscript=function(){return b(this,void 0,void 0,function(){var se,fe;return h(this,function(we){se={},this.scenarioMarker.startScenario(W.default.GetLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId});try{return this.authenticatedUserToken&&(se.authenticatedUserToken=this.authenticatedUserToken),fe=this.OCClient.getChatTranscripts(this.requestId,this.chatToken.chatId,this.chatToken.token,se),this.scenarioMarker.completeScenario(W.default.GetLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[2,fe]}catch(Te){this.scenarioMarker.failScenario(W.default.GetLiveChatTranscript,{RequestId:this.requestId,ChatId:this.chatToken.chatId})}return[2]})})},Oe.prototype.createChatAdapter=function(se){return void 0===se&&(se={}),b(this,void 0,void 0,function(){var fe,we,Te=this;return h(this,function(ye){return f.default.isNode()||f.default.isReactNative()?[2,Promise.reject("ChatAdapter is only supported on browser")]:(we=[C.default.ACS,C.default.IC3],(fe=se.protocol)&&!we.includes(fe)?[2,Promise.reject("ChatAdapter for protocol "+fe+" currently not supported")]:fe===C.default.ACS||this.liveChatVersion===y.default.V2?[2,new Promise(function(Pe,Ve){return b(Te,void 0,void 0,function(){var Ue,Ie,We,Qe,Ge,rt,Le,tt,at=this;return h(this,function(vt){switch(vt.label){case 0:return Ue=se.ACSAdapter?se.ACSAdapter.options:{},Ie=[Ce.default({widgetId:this.omnichannelConfig.widgetId}),ne.default()],We=[X.default()],Qe=(null==Ue?void 0:Ue.egressMiddleware)?p(Ue.egressMiddleware,Ie):p(Ie),Ge=(null==Ue?void 0:Ue.ingressMiddleware)?p(Ue.egressMiddleware,We):p(We),rt=s(s({enableAdaptiveCards:!0,enableThreadMemberUpdateNotification:!0,enableLeaveThreadOnWindowClosed:!1},Ue),{ingressMiddleware:Ge,egressMiddleware:Qe}),Le=this.resolveChatAdapterUrl(fe||C.default.ACS),null===(tt=this.telemetry)||void 0===tt||tt.setCDNPackages({ACSAdapter:Le}),[4,I.loadScript(Le,function(){at.debug&&console.debug("ACSAdapter loaded!");try{var Qt=window.ChatAdapter,De=new S.default(at.AMSClient,at.acsAdapterLogger),Ke=Qt.createACSAdapter(at.chatToken.token,at.chatToken.visitorId||"teamsvisitor",at.chatToken.chatId,at.chatToken.acsEndpoint,De,v.default.Customer,void 0,at.acsAdapterLogger,rt);Pe(Ke)}catch(nt){throw new Error("Failed to load ACSAdapter")}},function(){Ve("Failed to load ACSADapter")})];case 1:return vt.sent(),[2]}})})})]:fe===C.default.IC3||this.liveChatVersion===y.default.V1?[2,new Promise(function(Pe,Ve){return b(Te,void 0,void 0,function(){var Ue,Ie,Qe,We=this;return h(this,function(Ge){switch(Ge.label){case 0:return Ue=se.IC3Adapter?se.IC3Adapter.options:{},Ie=this.resolveChatAdapterUrl(fe||C.default.IC3),null===(Qe=this.telemetry)||void 0===Qe||Qe.setCDNPackages({IC3Adapter:Ie}),this.scenarioMarker.startScenario(W.default.CreateIC3Adapter),[4,I.loadScript(Ie,function(){We.debug&&console.debug("IC3Adapter loaded!");var rt=s({chatToken:We.chatToken,userDisplayName:"Customer",userId:We.chatToken.visitorId||"teamsvisitor",sdkURL:We.resolveIC3ClientUrl(),sdk:We.IC3Client},Ue),Le=new window.Microsoft.BotFramework.WebChat.IC3Adapter(rt);Le.logger=We.ic3ClientLogger,We.scenarioMarker.completeScenario(W.default.CreateIC3Adapter),Pe(Le)},function(){We.scenarioMarker.failScenario(W.default.CreateIC3Adapter),Ve("Failed to load IC3Adapter")})];case 1:return Ge.sent(),[2]}})})})]:[2,Promise.reject("ChatAdapter for protocol "+fe+" currently not supported")])})})},Oe.prototype.getVoiceVideoCalling=function(se){return void 0===se&&(se={}),b(this,void 0,void 0,function(){var fe,we,ye,Pe,Ve,Ue=this;return h(this,function(Ie){switch(Ie.label){case 0:if(this.scenarioMarker.startScenario(W.default.GetVoiceVideoCalling),f.default.isNode()||f.default.isReactNative())throw fe={response:"UnsupportedPlatform",message:"VoiceVideoCalling is only supported on browser"},this.scenarioMarker.failScenario(W.default.GetVoiceVideoCalling,{ExceptionDetails:JSON.stringify(fe)}),new Error(fe.response);if(this.callingOption.toString()===g.default.NoCalling.toString())throw fe={response:"FeatureDisabled",message:"Voice and video call is not enabled"},this.scenarioMarker.failScenario(W.default.GetVoiceVideoCalling,{ExceptionDetails:JSON.stringify(fe)}),new Error(fe.response);return[4,this.getChatConfig()];case 1:return we=Ie.sent(),ye=we.LiveWSAndLiveChatEngJoin.msdyn_widgetsnippet,Pe=new RegExp('src="(https:\\/\\/[\\w-.]+)[\\w-.\\/]+"'),(Ve=ye.match(Pe))&&Ve.length?[2,new Promise(function(We){return b(Ue,void 0,void 0,function(){var Qe,Ge,Le,rt=this;return h(this,function(at){switch(at.label){case 0:return Qe=Ve[1]+"/livechatwidget/WebChatControl/lib/CallingBundle.js",null===(Le=this.telemetry)||void 0===Le||Le.setCDNPackages({VoiceVideoCalling:Qe}),Ge={logger:this.callingSdkLogger},[4,I.loadScript(Qe,function(){return b(rt,void 0,void 0,function(){var tt;return h(this,function(vt){switch(vt.label){case 0:return this.debug&&console.debug(Qe+" loaded!"),[4,K.default(s(s({},se),Ge))];case 1:return tt=vt.sent(),this.scenarioMarker.completeScenario(W.default.GetVoiceVideoCalling),tt.useScenarioMarker(this.scenarioMarker),We(tt),[2]}})})},function(){return b(rt,void 0,void 0,function(){var tt;return h(this,function(vt){throw tt={response:"VoiceVideoCallingLoadFailed",message:"Failed to load VoiceVideoCalling"},this.scenarioMarker.failScenario(W.default.GetVoiceVideoCalling,{ExceptionDetails:JSON.stringify(tt)}),new Error(tt.response)})})})];case 1:return at.sent(),[2]}})})})]:[2]}})})},Oe.prototype.getPostChatSurveyContext=function(){return b(this,void 0,void 0,function(){var se,we,ye,Pe,Ve,Ue,Ie,We,Qe,Ge,rt,at,tt,vt,De;return h(this,function(Ke){switch(Ke.label){case 0:this.scenarioMarker.startScenario(W.default.GetPostChatSurveyContext,{RequestId:this.requestId}),Ke.label=1;case 1:return Ke.trys.push([1,6,,7]),ye=(we=this.liveChatConfig.LiveWSAndLiveChatEngJoin).msfp_sourcesurveyidentifier,Pe=we.msfp_botsourcesurveyidentifier,Ve=we.postConversationSurveyOwnerId,Ue=we.postConversationBotSurveyOwnerId,"true"!==we.msdyn_postconversationsurveyenable?[3,4]:[4,this.getConversationDetails()];case 2:return Ie=Ke.sent(),We="True"===(null==Ie?void 0:Ie.canRenderPostChat),Ge={FormId:"Bot"===(Qe=null==Ie?void 0:Ie.participantType)?Pe:ye,ConversationId:se=null==Ie?void 0:Ie.conversationId,OCLocaleCode:A.getLocaleStringFromId(this.localeId)},rt={requestId:this.requestId},this.authenticatedUserToken&&(rt.authenticatedUserToken=this.authenticatedUserToken),[4,this.OCClient.getSurveyInviteLink("Bot"===Qe?Ue:Ve,Ge,rt)];case 3:return at=Ke.sent(),tt=void 0,vt=void 0,null!=at?null==at.inviteList||1!=at.inviteList.length?(this.scenarioMarker.failScenario(W.default.GetPostChatSurveyContext,{ConversationId:se,RequestId:this.requestId,ExceptionDetails:"Survey Invite link failed to send response."}),[2,Promise.reject("Survey Invite link failed to send response.")]):(tt=at.inviteList[0].invitationLink,null!=at.formsProLocaleCode&&(vt=at.formsProLocaleCode),[2,Promise.resolve({participantJoined:We,participantType:Qe,surveyInviteLink:tt,formsProLocale:vt})]):(this.scenarioMarker.failScenario(W.default.GetPostChatSurveyContext,{ConversationId:se,RequestId:this.requestId,ExceptionDetails:"surveyInviteLinkResponse is null."}),[2,Promise.reject("surveyInviteLinkResponse is null.")]);case 4:return this.scenarioMarker.failScenario(W.default.GetPostChatSurveyContext,{RequestId:this.requestId,ExceptionDetails:"Post Chat Survey is disabled. Please check the Omnichannel Administration Portal."}),[2,Promise.reject("Post Chat is disabled from admin side.")];case 5:return[3,7];case 6:return De=Ke.sent(),this.scenarioMarker.failScenario(W.default.GetPostChatSurveyContext,{ConversationId:null!=se?se:"",RequestId:this.requestId,ExceptionDetails:JSON.stringify(De)}),[2,Promise.reject("Retrieving post chat context failed "+JSON.stringify(De))];case 7:return[2]}})})},Oe.prototype.getIC3Client=function(){return b(this,void 0,void 0,function(){var se,fe=this;return h(this,function(we){switch(we.label){case 0:return f.default.isNode()||f.default.isReactNative()?(this.debug&&console.debug("IC3Core"),this.scenarioMarker.startScenario(W.default.GetIC3Client),this.IC3SDKProvider=P.SDKProvider,[4,P.SDKProvider.getSDK({hostType:N.default.Page,protocolType:Z.default.IC3V1SDK})]):[3,2];case 1:return(se=we.sent()).setDebug(this.debug),this.scenarioMarker.completeScenario(W.default.GetIC3Client),[2,se];case 2:return this.debug&&console.debug("IC3Client"),[2,new Promise(function(Te,ye){return b(fe,void 0,void 0,function(){var Pe,Ve,Ie,Ue=this;return h(this,function(We){switch(We.label){case 0:return Pe=this.resolveIC3ClientUrl(),null===(Ie=this.telemetry)||void 0===Ie||Ie.setCDNPackages({IC3Client:Pe}),this.scenarioMarker.startScenario(W.default.GetIC3Client),this.IC3SDKProvider?[4,this.IC3SDKProvider.getSDK({hostType:N.default.IFrame,protocolType:Z.default.IC3V1SDK,logger:this.ic3ClientLogger})]:[3,2];case 1:return Ve=We.sent(),[2,Te(Ve)];case 2:return window.addEventListener("ic3:sdk:load",function(){return b(Ue,void 0,void 0,function(){var Qe,Ge,rt;return h(this,function(Le){switch(Le.label){case 0:return this.debug&&console.debug("ic3:sdk:load"),Qe=window.Microsoft.CRM.Omnichannel.IC3Client.SDK,this.IC3SDKProvider=Ge=Qe.SDKProvider,[4,Ge.getSDK({hostType:N.default.IFrame,protocolType:Z.default.IC3V1SDK,logger:this.ic3ClientLogger})];case 1:return rt=Le.sent(),this.scenarioMarker.completeScenario(W.default.GetIC3Client),Te(rt),[2]}})})}),[4,I.loadScript(Pe,function(){Ue.debug&&console.debug("IC3Client loaded!")},function(){Ue.scenarioMarker.failScenario(W.default.GetIC3Client,{ExceptionDetails:JSON.stringify({response:"IC3ClientLoadFailed"})}),ye("Failed to load IC3Client")})];case 3:return We.sent(),[2]}})})})]}})})},Oe.prototype.getChatConfig=function(){return b(this,void 0,void 0,function(){var se,fe,we,Te,ye,Ie,We,Qe,Ge,rt,Le,at,tt;return h(this,function(vt){switch(vt.label){case 0:return vt.trys.push([0,4,,5]),[4,this.OCClient.getChatConfig()];case 1:return se=vt.sent(),fe=se.DataMaskingInfo,we=se.LiveChatConfigAuthSettings,Te=se.LiveWSAndLiveChatEngJoin,ye=se.LiveChatVersion,this.localeId=se.ChatWidgetLanguage.msdyn_localeid||A.defaultLocaleId,this.liveChatVersion=ye||y.default.V1,this.debug&&console.log("[OmnichannelChatSDK][getChatConfig][liveChatVersion] "+this.liveChatVersion),fe.setting.msdyn_maskforcustomer&&(this.dataMaskingRules=fe.dataMaskingRules),we&&(this.authSettings=we),Ie=Te.PreChatSurvey,Qe=Te.msdyn_callingoptions,Le=!0===(We=Te.msdyn_prechatenabled)||"true"==We,at=!0===(rt=Te.msdyn_enablechatreconnect)||"true"==rt,(null==(Ge=Te.msdyn_conversationmode)?void 0:Ge.toString())===R.default.PersistentChat.toString()&&(this.isPersistentChat=!0),at&&!this.isPersistentChat&&(this.isChatReconnect=!0),Le&&Ie&&Ie.trim().length>0&&(this.preChatSurvey=Ie),this.authSettings?[4,this.setAuthTokenProvider(this.chatSDKConfig.getAuthToken)]:[3,3];case 2:vt.sent(),vt.label=3;case 3:return this.preChatSurvey&&this.debug&&console.log("Prechat Survey!"),this.callingOption=Qe,this.liveChatConfig=se,[2,this.liveChatConfig];case 4:return tt=vt.sent(),console.error("OmnichannelChatSDK/getChatConfig/error "+tt),[2,tt];case 5:return[2]}})})},Oe.prototype.resolveIC3ClientUrl=function(){return this.chatSDKConfig.ic3Config&&"ic3ClientCDNUrl"in this.chatSDKConfig.ic3Config?this.chatSDKConfig.ic3Config.ic3ClientCDNUrl:this.chatSDKConfig.ic3Config&&"ic3ClientVersion"in this.chatSDKConfig.ic3Config?be.default.getIC3ClientCDNUrl(this.chatSDKConfig.ic3Config.ic3ClientVersion):be.default.getIC3ClientCDNUrl()},Oe.prototype.resolveChatAdapterUrl=function(se){if(se&&![C.default.ACS,C.default.IC3].includes(se))throw new Error("ChatAdapter for protocol "+se+" currently not supported");return se===C.default.ACS||this.liveChatVersion===y.default.V2?this.chatSDKConfig.chatAdapterConfig&&"webChatACSAdapterCDNUrl"in this.chatSDKConfig.chatAdapterConfig?this.chatSDKConfig.chatAdapterConfig.webChatACSAdapterCDNUrl:this.chatSDKConfig.chatAdapterConfig&&"webChatACSAdapterVersion"in this.chatSDKConfig.chatAdapterConfig?be.default.getACSAdapterCDNUrl(this.chatSDKConfig.chatAdapterConfig.webChatACSAdapterVersion):be.default.getACSAdapterCDNUrl():se===C.default.IC3||this.liveChatVersion===y.default.V1?this.chatSDKConfig.chatAdapterConfig&&"webChatIC3AdapterCDNUrl"in this.chatSDKConfig.chatAdapterConfig?this.chatSDKConfig.chatAdapterConfig.webChatIC3AdapterCDNUrl:this.chatSDKConfig.chatAdapterConfig&&"webChatIC3AdapterVersion"in this.chatSDKConfig.chatAdapterConfig?be.default.getIC3AdapterCDNUrl(this.chatSDKConfig.chatAdapterConfig.webChatIC3AdapterVersion):be.default.getIC3AdapterCDNUrl():""},Oe.prototype.updateChatToken=function(se,fe){return b(this,void 0,void 0,function(){var Te;return h(this,function(Pe){switch(Pe.label){case 0:this.scenarioMarker.startScenario(W.default.UpdateChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),Pe.label=1;case 1:return Pe.trys.push([1,3,,4]),[4,this.IC3Client.initialize({token:se,regionGtms:fe,visitor:!0})];case 2:return Pe.sent(),this.scenarioMarker.completeScenario(W.default.UpdateChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId}),[3,4];case 3:return Te=Pe.sent(),this.scenarioMarker.failScenario(W.default.UpdateChatToken,{RequestId:this.requestId,ChatId:this.chatToken.chatId,ExceptionDetails:JSON.stringify({response:"UpdateChatTokenFailed"})}),console.error("OmnichannelChatSDK/updateChatToken/error "+Te),[3,4];case 4:return[2]}})})},Oe.prototype.setAuthTokenProvider=function(se){return b(this,void 0,void 0,function(){var fe,we;return h(this,function(ye){switch(ye.label){case 0:if(this.scenarioMarker.startScenario(W.default.GetAuthToken),this.chatSDKConfig.getAuthToken=se,!this.chatSDKConfig.getAuthToken)return[3,5];ye.label=1;case 1:return ye.trys.push([1,3,,4]),[4,this.chatSDKConfig.getAuthToken()];case 2:return(fe=ye.sent())?(this.authenticatedUserToken=fe,this.scenarioMarker.completeScenario(W.default.GetAuthToken)):(we={response:"UndefinedAuthToken"},this.scenarioMarker.failScenario(W.default.GetAuthToken,{ExceptionDetails:JSON.stringify(we)})),[3,4];case 3:return ye.sent(),we={response:"GetAuthTokenFailed"},this.scenarioMarker.failScenario(W.default.GetAuthToken,{ExceptionDetails:JSON.stringify(we)}),[3,4];case 4:return[3,6];case 5:we={response:"GetAuthTokenNotFound"},this.scenarioMarker.failScenario(W.default.GetAuthToken,{ExceptionDetails:JSON.stringify(we)}),ye.label=6;case 6:return[2]}})})},Oe}();m.default=$e},6633:function(Q,m,u){"use strict";var s=this&&this.__awaiter||function(I,f,c,v){return new(c||(c=Promise))(function(g,C){function R(N){try{_(v.next(N))}catch(P){C(P)}}function D(N){try{_(v.throw(N))}catch(P){C(P)}}function _(N){N.done?g(N.value):function(g){return g instanceof c?g:new c(function(C){C(g)})}(N.value).then(R,D)}_((v=v.apply(I,f||[])).next())})},b=this&&this.__generator||function(I,f){var v,S,g,C,c={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return C={next:R(0),throw:R(1),return:R(2)},"function"==typeof Symbol&&(C[Symbol.iterator]=function(){return this}),C;function R(_){return function(N){return function(_){if(v)throw new TypeError("Generator is already executing.");for(;c;)try{if(v=1,S&&(g=2&_[0]?S.return:_[0]?S.throw||((g=S.return)&&g.call(S),0):S.next)&&!(g=g.call(S,_[1])).done)return g;switch(S=0,g&&(_=[2&_[0],g.value]),_[0]){case 0:case 1:g=_;break;case 4:return c.label++,{value:_[1],done:!1};case 5:c.label++,S=_[1],_=[0];continue;case 7:_=c.ops.pop(),c.trys.pop();continue;default:if(!(g=(g=c.trys).length>0&&g[g.length-1])&&(6===_[0]||2===_[0])){c=0;continue}if(3===_[0]&&(!g||_[1]>g[0]&&_[1]<g[3])){c.label=_[1];break}if(6===_[0]&&c.label<g[1]){c.label=g[1],g=_;break}if(g&&c.label<g[2]){c.label=g[2],c.ops.push(_);break}g[2]&&c.ops.pop(),c.trys.pop();continue}_=f.call(I,c)}catch(N){_=[6,N],S=0}finally{v=g=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,N])}}};Object.defineProperty(m,"__esModule",{value:!0}),m.VoiceVideoCallingProxy=void 0;var h=u(9600),p=(()=>{return(I=p||(p={}))[I.Voice=19237e4]="Voice",I[I.Video=19238e4]="Video",I[I.Cobrowse=19239e4]="Cobrowse",p;var I})(),E=(()=>{return(I=E||(E={})).Accept="accept",I.Reject="reject",I.Connect="connect",I.End="end",E;var I})(),d=(()=>{return(I=d||(d={})).CallAdded="callAdded",I.LocalVideoStreamAdded="localVideoStreamAdded",I.LocalVideoStreamRemoved="localVideoStreamRemoved",I.RemoteVideoStreamAdded="remoteVideoStreamAdded",I.RemoteVideoStreamRemoved="remoteVideoStreamRemoved",I.CallDisconnected="callDisconnected",I.ParticipantDisconnected="participantDisconnected",I.IncomingCallEnded="incomingCallEnded",d;var I})(),T=function(){function I(){this.debug=!1,this.callClientName="ElevateToVoiceVideo",this.proxy=window["Microsoft.Omnichannel.Calling.SDK"].VoiceVideoCalling,this.proxyInstance=this.proxy.getInstance()}return I.getInstance=function(){return this._instance||(this._instance=new I),this._instance},I.prototype.setDebug=function(f){this.debug=f},I.prototype.useScenarioMarker=function(f){this.scenarioMarker=f},I.prototype.load=function(f){return void 0===f&&(f={}),s(this,void 0,void 0,function(){return b(this,function(c){return f.logger&&(this.logger=f.logger),this.proxyInstance.load(f),[2]})})},I.prototype.isInitialized=function(){return this.proxyInstance.isInitialized()},I.prototype.initialize=function(f){var c,v,S,g,C,R,D,_;return s(this,void 0,void 0,function(){var N;return b(this,function(P){switch(P.label){case 0:return this.debug&&console.debug("[VoiceVideoCallingProxy] VoiceVideoCallingParams: "+JSON.stringify(f)),this.callingParams=f,null===(c=this.scenarioMarker)||void 0===c||c.startScenario(h.default.InitializeVoiceVideoCallingSDK),this.debug&&console.debug("[VoiceVideoCallingProxy][initialize] _isLoaded: "+this.proxyInstance._isLoaded),this.proxyInstance._isLoaded?[3,2]:[4,this.proxyInstance.load({logger:this.logger||void 0})];case 1:P.sent(),P.label=2;case 2:return P.trys.push([2,4,,5]),[4,this.proxyInstance.initialize({callClientName:this.callClientName,accesstoken:(null===(S=null===(v=this.callingParams)||void 0===v?void 0:v.chatToken.voiceVideoCallToken)||void 0===S?void 0:S.Token)||(null===(g=this.callingParams)||void 0===g?void 0:g.chatToken.token),selfVideoHTMLElementId:null===(C=this.callingParams)||void 0===C?void 0:C.selfVideoHTMLElementId,remoteVideoHTMLElementId:null===(R=this.callingParams)||void 0===R?void 0:R.remoteVideoHTMLElementId})];case 3:return P.sent(),null===(D=this.scenarioMarker)||void 0===D||D.completeScenario(h.default.InitializeVoiceVideoCallingSDK),[3,5];case 4:return N=P.sent(),console.log(N),null===(_=this.scenarioMarker)||void 0===_||_.failScenario(h.default.InitializeVoiceVideoCallingSDK),[3,5];case 5:return[2]}})})},I.prototype.addEventListener=function(f,c){var v=this;this.proxyInstance.registerEvent(f,function(S){var g=S.callId;f===d.CallAdded&&(v.callId=g),v.debug&&console.debug("[VoiceVideoCallingProxy]["+f+"] callId: "+g),g===v.callId&&c(S)})},I.prototype.isMicrophoneMuted=function(){return this.proxyInstance.isMicrophoneMuted({callClientName:this.callClientName,callId:this.callId})},I.prototype.acceptCall=function(f){var c,v,S,g,C,R;return void 0===f&&(f={}),s(this,void 0,void 0,function(){var D,_,N,M,y;return b(this,function(U){switch(U.label){case 0:_=(D=this).callClientName,N=D.callId,null===(c=this.scenarioMarker)||void 0===c||c.startScenario(f.withVideo?h.default.AcceptVideoCall:h.default.AcceptVoiceCall,{CallId:N||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][acceptCall] callId: "+N),this.debug&&console.debug(f),U.label=1;case 1:return U.trys.push([1,3,,4]),[4,this.proxyInstance.acceptCall({callClientName:_,callId:N,withVideo:f.withVideo||!1})];case 2:return U.sent(),[3,4];case 3:return U.sent(),y={response:f.withVideo?"AcceptVideoCallFailed":"AcceptVoiceCallFailed"},null===(v=this.scenarioMarker)||void 0===v||v.failScenario(f.withVideo?h.default.AcceptVideoCall:h.default.AcceptVoiceCall,{CallId:N||"",ExceptionDetails:JSON.stringify(y)}),[3,4];case 4:M={SecondaryChannelType:f.withVideo?p.Video:p.Voice,SecondaryChannelEventType:E.Accept};try{null===(S=this.callingParams)||void 0===S||S.OCClient.makeSecondaryChannelEventRequest(null===(g=this.callingParams)||void 0===g?void 0:g.chatToken.requestId,M),null===(C=this.scenarioMarker)||void 0===C||C.completeScenario(f.withVideo?h.default.AcceptVideoCall:h.default.AcceptVoiceCall,{CallId:N||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][acceptCall][makeSecondaryChannelEventRequest]")}catch($){y={response:"OCClientMakeSecondaryChannelEventRequestFailed"},null===(R=this.scenarioMarker)||void 0===R||R.failScenario(f.withVideo?h.default.AcceptVideoCall:h.default.AcceptVoiceCall,{CallId:N||"",ExceptionDetails:JSON.stringify(y)}),console.error("[VoiceVideoCallingProxy][acceptCall][makeSecondaryChannelEventRequest] Failure "+$)}return[2]}})})},I.prototype.rejectCall=function(){var f,c,v,S,g,C;return s(this,void 0,void 0,function(){var R,D,_,y,P;return b(this,function(M){switch(M.label){case 0:D=(R=this).callClientName,_=R.callId,null===(f=this.scenarioMarker)||void 0===f||f.startScenario(h.default.RejectCall,{CallId:_||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][rejectCall] callId: "+_),M.label=1;case 1:return M.trys.push([1,3,,4]),[4,this.proxyInstance.rejectCall({callClientName:D,callId:_})];case 2:return M.sent(),null===(c=this.scenarioMarker)||void 0===c||c.completeScenario(h.default.RejectCall,{CallId:_||""}),[3,4];case 3:return M.sent(),P={response:"RejectCallFailed"},null===(v=this.scenarioMarker)||void 0===v||v.failScenario(h.default.RejectCall,{CallId:_||"",ExceptionDetails:JSON.stringify(P)}),[3,4];case 4:y={SecondaryChannelType:this.isRemoteVideoEnabled()?p.Video:p.Voice,SecondaryChannelEventType:E.Reject};try{null===(S=this.callingParams)||void 0===S||S.OCClient.makeSecondaryChannelEventRequest(null===(g=this.callingParams)||void 0===g?void 0:g.chatToken.requestId,y),this.debug&&console.debug("[VoiceVideoCallingProxy][rejectCall][makeSecondaryChannelEventRequest]")}catch(U){return P={response:"OCClientMakeSecondaryChannelEventRequestFailed"},null===(C=this.scenarioMarker)||void 0===C||C.failScenario(h.default.RejectCall,{CallId:_||"",ExceptionDetails:JSON.stringify(P)}),console.error("[VoiceVideoCallingProxy][rejectCall][makeSecondaryChannelEventRequest] Failure "+U),[2,U]}return[2]}})})},I.prototype.stopCall=function(){var f,c,v,S,g;return s(this,void 0,void 0,function(){var C,R,D,_;return b(this,function(P){switch(P.label){case 0:R=(C=this).callClientName,D=C.callId,null===(f=this.scenarioMarker)||void 0===f||f.startScenario(h.default.StopCall,{CallId:D||""}),this.debug&&console.debug("[VoiceVideoCallingProxy][stopCall] callId: "+D),_=!!(null===(v=null===(c=this.callingParams)||void 0===c?void 0:c.chatToken.voiceVideoCallToken)||void 0===v?void 0:v.Token),P.label=1;case 1:return P.trys.push([1,3,,4]),[4,this.proxyInstance.stopCall({callClientName:R,callId:D,forEveryone:_})];case 2:return P.sent(),null===(S=this.scenarioMarker)||void 0===S||S.completeScenario(h.default.StopCall,{CallId:D||""}),[3,4];case 3:return P.sent(),null===(g=this.scenarioMarker)||void 0===g||g.failScenario(h.default.StopCall,{CallId:D||""}),[3,4];case 4:return[2]}})})},I.prototype.toggleMute=function(){return s(this,void 0,void 0,function(){var f;return b(this,function(S){return[2,this.proxyInstance.toggleMute({callClientName:(f=this).callClientName,callId:f.callId})]})})},I.prototype.isRemoteVideoEnabled=function(){return this.proxyInstance.isRemoteVideoEnabled({callClientName:this.callClientName,callId:this.callId})},I.prototype.isLocalVideoEnabled=function(){return this.proxyInstance.isLocalVideoEnabled({callClientName:this.callClientName,callId:this.callId})},I.prototype.toggleLocalVideo=function(){return s(this,void 0,void 0,function(){var f;return b(this,function(S){return[2,this.proxyInstance.toggleLocalVideo({callClientName:(f=this).callClientName,callId:f.callId})]})})},I.prototype.isInACall=function(){return this.proxyInstance.isInACall({callClientName:this.callClientName,callId:this.callId})},I.prototype.renderVideoStreams=function(){return this.proxyInstance.renderVideoStreams({callClientName:this.callClientName,callId:this.callId})},I.prototype.disposeVideoRenderers=function(){return this.proxyInstance.disposeVideoRenderers({callClientName:this.callClientName,callId:this.callId})},I.prototype.close=function(){this.debug&&console.debug("[VoiceVideoCallingProxy][close]"),this.proxyInstance.dispose(),this.callingParams=void 0,this.callId=void 0},I.prototype.onCallAdded=function(f){var c=d.CallAdded;this.debug&&console.debug("[VoiceVideoCallingProxy]["+c+"]"),this.addEventListener(c,f)},I.prototype.onLocalVideoStreamAdded=function(f){var c=d.LocalVideoStreamAdded;this.debug&&console.debug("[VoiceVideoCallingProxy]["+c+"]"),this.addEventListener(c,f)},I.prototype.onLocalVideoStreamRemoved=function(f){var c=d.LocalVideoStreamRemoved;this.debug&&console.debug("[VoiceVideoCallingProxy]["+c+"]"),this.addEventListener(c,f)},I.prototype.onRemoteVideoStreamAdded=function(f){var c=d.RemoteVideoStreamAdded;this.debug&&console.debug("[VoiceVideoCallingProxy]["+c+"]"),this.addEventListener(c,f)},I.prototype.onRemoteVideoStreamRemoved=function(f){var c=d.RemoteVideoStreamRemoved;this.debug&&console.debug("[VoiceVideoCallingProxy]["+c+"]"),this.addEventListener(c,f)},I.prototype.onCallDisconnected=function(f){var c=this,v=d.CallDisconnected;this.debug&&console.debug("[VoiceVideoCallingProxy]["+v+"]"),this.addEventListener(v,function(S){return s(c,void 0,void 0,function(){var g,C,R,D,_,N,P;return b(this,function(y){g={SecondaryChannelType:p.Voice,SecondaryChannelEventType:E.End},null===(R=this.scenarioMarker)||void 0===R||R.startScenario(h.default.OnCallDisconnected,{CallId:this.callId||""});try{null===(D=this.callingParams)||void 0===D||D.OCClient.makeSecondaryChannelEventRequest(null===(_=this.callingParams)||void 0===_?void 0:_.chatToken.requestId,g),this.debug&&console.debug("[VoiceVideoCallingProxy][onCallDisconnected][makeSecondaryChannelEventRequest]"),null===(N=this.scenarioMarker)||void 0===N||N.completeScenario(h.default.OnCallDisconnected,{CallId:this.callId||""})}catch(M){console.error("[VoiceVideoCallingProxy][onCallDisconnected][makeSecondaryChannelEventRequest] Failure "+M),C={response:"OCClientMakeSecondaryChannelEventRequestFailed"},null===(P=this.scenarioMarker)||void 0===P||P.failScenario(h.default.OnCallDisconnected,{CallId:this.callId||"",ExceptionDetails:JSON.stringify(C)})}return this.clearRemoteVideoElementChildren(),f(S),[2]})})})},I.prototype.clearRemoteVideoElementChildren=function(){var f,c;if(null===(f=this.callingParams)||void 0===f?void 0:f.remoteVideoHTMLElementId)for(var v=document.getElementById(null===(c=this.callingParams)||void 0===c?void 0:c.remoteVideoHTMLElementId);null==v?void 0:v.firstChild;)this.debug&&console.debug("[VoiceVideoCallingProxy][clearRemoteVideoElement]"),v.firstChild.remove()},I}();m.VoiceVideoCallingProxy=T,m.default=function(I){return void 0===I&&(I={}),s(void 0,void 0,void 0,function(){var f;return b(this,function(c){switch(c.label){case 0:return[4,(f=T.getInstance()).load({logger:I.logger||void 0})];case 1:return c.sent(),[2,Promise.resolve(f)]}})})}},4151:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.ariaTelemetryKey=m.webChatACSAdapterVersion=m.webChatIC3AdapterVersion=m.ic3ClientVersion=void 0,m.ic3ClientVersion="2021.08.14.1",m.webChatIC3AdapterVersion="0.1.0-master.2dba07b",m.webChatACSAdapterVersion="0.0.35-beta.4",m.ariaTelemetryKey="c7655518acf1403f93ff6b9f77942f0a-d01a02fd-6b50-4de3-a566-62eda11f93bc-7083"},6419:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.NoCalling=19235e4]="NoCalling",s[s.VideoAndVoiceCalling=192350001]="VideoAndVoiceCalling",s[s.VoiceOnly=192350002]="VoiceOnly",u;var s})();m.default=u},7925:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.LiveChat=19235e4]="LiveChat",s[s.PersistentChat=192350001]="PersistentChat",u;var s})();m.default=u},8191:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.V1=1]="V1",s[s.V2=2]="V2",u;var s})();m.default=u},5642:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).Active="Active",s.Closed="Closed",s.Open="Open",s.Waiting="Waiting",s.WrapUp="WrapUp",u;var s})();m.default=u},6233:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.WidgetUseOutsideOperatingHour=705]="WidgetUseOutsideOperatingHour",u;var s})();m.default=u},1974:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).Text="text",s.TopicUpdated="topicUpdated",s.ParticipantAdded="participantAdded",s.ParticipantRemoved="participantRemoved",u;var s})();m.default=u},2902:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(C){for(var R,D=1,_=arguments.length;D<_;D++)for(var N in R=arguments[D])Object.prototype.hasOwnProperty.call(R,N)&&(C[N]=R[N]);return C}).apply(this,arguments)},b=this&&this.__awaiter||function(C,R,D,_){return new(D||(D=Promise))(function(P,y){function M(j){try{$(_.next(j))}catch(ue){y(ue)}}function U(j){try{$(_.throw(j))}catch(ue){y(ue)}}function $(j){j.done?P(j.value):function(P){return P instanceof D?P:new D(function(y){y(P)})}(j.value).then(M,U)}$((_=_.apply(C,R||[])).next())})},h=this&&this.__generator||function(C,R){var _,N,P,y,D={label:0,sent:function(){if(1&P[0])throw P[1];return P[1]},trys:[],ops:[]};return y={next:M(0),throw:M(1),return:M(2)},"function"==typeof Symbol&&(y[Symbol.iterator]=function(){return this}),y;function M($){return function(j){return function($){if(_)throw new TypeError("Generator is already executing.");for(;D;)try{if(_=1,N&&(P=2&$[0]?N.return:$[0]?N.throw||((P=N.return)&&P.call(N),0):N.next)&&!(P=P.call(N,$[1])).done)return P;switch(N=0,P&&($=[2&$[0],P.value]),$[0]){case 0:case 1:P=$;break;case 4:return D.label++,{value:$[1],done:!1};case 5:D.label++,N=$[1],$=[0];continue;case 7:$=D.ops.pop(),D.trys.pop();continue;default:if(!(P=(P=D.trys).length>0&&P[P.length-1])&&(6===$[0]||2===$[0])){D=0;continue}if(3===$[0]&&(!P||$[1]>P[0]&&$[1]<P[3])){D.label=$[1];break}if(6===$[0]&&D.label<P[1]){D.label=P[1],P=$;break}if(P&&D.label<P[2]){D.label=P[2],D.ops.push($);break}P[2]&&D.ops.pop(),D.trys.pop();continue}$=R.call(C,D)}catch(j){$=[6,j],N=0}finally{_=P=0}if(5&$[0])throw $[1];return{value:$[0]?$[1]:void 0,done:!0}}([$,j])}}};Object.defineProperty(m,"__esModule",{value:!0}),m.ACSConversation=void 0;var p=u(1974),E=u(8953),d=u(8764),T=u(9116),A=u(9340),I=u(813),f=u(2900),c=u(8191),v=(()=>{return(C=v||(v={})).InitializeACSClient="InitializeACSClient",C.InitializeACSConversation="InitializeACSConversation",C.GetParticipants="GetParticipants",C.RegisterOnNewMessage="RegisterOnNewMessage",C.RegisterOnThreadUpdate="RegisterOnThreadUpdate",C.OnTypingEvent="OnTypingEvent",C.GetMessages="GetMessages",C.SendMessage="SendMessage",C.SendTyping="SendTyping",C.Disconnect="Disconnect",v;var C})(),S=function(){function C(R,D,_){void 0===_&&(_=null),this.logger=null,this.logger=_,this.tokenCredential=R,this.chatClient=D,this.eventListeners={}}return C.prototype.initialize=function(R){var D,_,N,P,y;return b(this,void 0,void 0,function(){var M,U,j,$,ue;return h(this,function(Z){switch(Z.label){case 0:null===(D=this.logger)||void 0===D||D.startScenario(v.InitializeACSConversation),this.sessionInfo=R,Z.label=1;case 1:return Z.trys.push([1,3,,4]),M=this,[4,null===(_=this.chatClient)||void 0===_?void 0:_.getChatThreadClient(R.threadId)];case 2:return M.chatThreadClient=Z.sent(),[3,4];case 3:throw U=Z.sent(),$={response:"ChatClientGetChatThreadClientFailure",errorObject:""+U},null===(N=this.logger)||void 0===N||N.failScenario(v.InitializeACSConversation,{ExceptionDetails:JSON.stringify($)}),new Error("GetChatThreadClientFailed");case 4:return Z.trys.push([4,6,,7]),[4,this.chatClient.startRealtimeNotifications()];case 5:return Z.sent(),[3,7];case 6:throw j=Z.sent(),$={response:"StartRealtimeNotificationsFailed",errorObject:""+j},null===(P=this.logger)||void 0===P||P.failScenario(v.InitializeACSConversation,{ExceptionDetails:JSON.stringify($)}),new Error($.response);case 7:return ue=this,[4,this.createParticipantsMapping()];case 8:return ue.participantsMapping=Z.sent(),null===(y=this.logger)||void 0===y||y.completeScenario(v.InitializeACSConversation),[2]}})})},C.prototype.getMessages=function(){var R,D,_,N,P;return b(this,void 0,void 0,function(){var y,M,U,$,Z,Y,W;return h(this,function(ce){switch(ce.label){case 0:null===(R=this.logger)||void 0===R||R.startScenario(v.GetMessages),y=[],ce.label=1;case 1:return ce.trys.push([1,9,,10]),[4,this.chatThreadClient.listMessages()];case 2:return[4,(M=ce.sent()).next()];case 3:U=ce.sent(),ce.label=4;case 4:return U.done?[3,8]:($=U.value).type===p.default.Text?[3,6]:[4,M.next()];case 5:return U=ce.sent(),[3,4];case 6:return(null===(D=$.content)||void 0===D?void 0:D.message)&&Object.assign($,{content:null===(_=$.content)||void 0===_?void 0:_.message}),Object.assign($.sender,{alias:this.participantsMapping[$.sender.communicationUserId].displayName}),Z=A.default($,{liveChatVersion:c.default.V2}),y.push(Z),[4,M.next()];case 7:return U=ce.sent(),[3,4];case 8:return null===(N=this.logger)||void 0===N||N.completeScenario(v.GetMessages),[3,10];case 9:throw Y=ce.sent(),W={errorObject:""+Y},null===(P=this.logger)||void 0===P||P.failScenario(v.GetMessages,{ExceptionDetails:JSON.stringify(W)}),new Error(v.GetMessages);case 10:return[2,y]}})})},C.prototype.getParticipants=function(){var R,D,_;return b(this,void 0,void 0,function(){var N,P,y,U,$;return h(this,function(j){switch(j.label){case 0:null===(R=this.logger)||void 0===R||R.startScenario(v.GetParticipants),N=[],j.label=1;case 1:return j.trys.push([1,7,,8]),[4,this.chatThreadClient.listParticipants()];case 2:return[4,(P=j.sent()).next()];case 3:y=j.sent(),j.label=4;case 4:return y.done?[3,6]:(N.push(y.value),[4,P.next()]);case 5:return y=j.sent(),[3,4];case 6:return null===(D=this.logger)||void 0===D||D.completeScenario(v.GetParticipants),[3,8];case 7:throw U=j.sent(),$={errorObject:""+U},null===(_=this.logger)||void 0===_||_.failScenario(v.GetParticipants,{ExceptionDetails:JSON.stringify($)}),new Error(v.GetParticipants);case 8:return[2,N]}})})},C.prototype.registerOnNewMessage=function(R){var D,_,N,P,y;return b(this,void 0,void 0,function(){var M,U,$,j,ue,Z,Y=this;return h(this,function(W){switch(W.label){case 0:null===(D=this.logger)||void 0===D||D.startScenario(v.RegisterOnNewMessage),M=!1,U=new Set,W.label=1;case 1:return W.trys.push([1,3,,4]),[4,($=function(ce){return b(Y,void 0,void 0,function(){var Ce,ne,X,de,te;return h(this,function(be){switch(be.label){case 0:if(M)return[2];be.label=1;case 1:return be.trys.push([1,3,,4]),[4,this.getMessages()];case 2:for(Ce=be.sent(),ne=0,X=Ce.reverse();ne<X.length;ne++)te=(de=X[ne]).id,de.sender.displayName!==E.default.Customer&&(U.has(te)||(R(de),U.add(te)));return[3,4];case 3:return be.sent(),[3,4];case 4:return setTimeout(function(){$(ce)},ce),[2]}})})})(null===(_=this.sessionInfo)||void 0===_?void 0:_.pollingInterval)];case 2:return W.sent(),j=function(ce){var Ce;M=!0;var ne=ce.id,X=ce.sender;X.communicationUserId===(null===(Ce=Y.sessionInfo)||void 0===Ce?void 0:Ce.id)||U.has(ne)||(ce.message&&Object.assign(ce,{content:ce.message}),Object.assign(ce.sender,{alias:Y.participantsMapping[X.communicationUserId].displayName}),R(ce),U.add(ne))},null===(N=this.chatClient)||void 0===N||N.on("chatMessageReceived",j),this.trackListener("chatMessageReceived",j),null===(P=this.logger)||void 0===P||P.completeScenario(v.RegisterOnNewMessage),[3,4];case 3:throw ue=W.sent(),Z={errorObject:""+ue},null===(y=this.logger)||void 0===y||y.failScenario(v.RegisterOnNewMessage,{ExceptionDetails:JSON.stringify(Z)}),new Error(v.RegisterOnNewMessage);case 4:return[2]}})})},C.prototype.registerOnThreadUpdate=function(R){var D,_,N,P;return b(this,void 0,void 0,function(){var y;return h(this,function(M){null===(D=this.logger)||void 0===D||D.startScenario(v.RegisterOnThreadUpdate);try{y=function(U){R(U)},null===(_=this.chatClient)||void 0===_||_.on("participantsRemoved",y),this.trackListener("participantsRemoved",y),null===(N=this.logger)||void 0===N||N.completeScenario(v.RegisterOnThreadUpdate)}catch(U){null===(P=this.logger)||void 0===P||P.failScenario(v.RegisterOnThreadUpdate)}return[2]})})},C.prototype.onTypingEvent=function(R){var D,_,N,P;return b(this,void 0,void 0,function(){var y;return h(this,function(M){null===(D=this.logger)||void 0===D||D.startScenario(v.OnTypingEvent);try{y=function(U){R(U)},null===(_=this.chatClient)||void 0===_||_.on("typingIndicatorReceived",y),this.trackListener("typingIndicatorReceived",y),null===(N=this.logger)||void 0===N||N.completeScenario(v.OnTypingEvent)}catch(U){null===(P=this.logger)||void 0===P||P.failScenario(v.OnTypingEvent)}return[2]})})},C.prototype.sendMessage=function(R){var D,_,N,P;return b(this,void 0,void 0,function(){var y,M;return h(this,function($){switch($.label){case 0:null===(D=this.logger)||void 0===D||D.startScenario(v.SendMessage),R.metadata||(R.metadata={}),y={content:R.content},M={senderDisplayName:E.default.Customer,metadata:s({deliveryMode:f.default.Bridged,tags:I.defaultMessageTags.join(",")},R.metadata)},$.label=1;case 1:return $.trys.push([1,3,,4]),[4,null===(_=this.chatThreadClient)||void 0===_?void 0:_.sendMessage(y,M)];case 2:return $.sent(),null===(N=this.logger)||void 0===N||N.completeScenario(v.SendMessage),[3,4];case 3:throw $.sent(),null===(P=this.logger)||void 0===P||P.failScenario(v.SendMessage),new Error("SendMessageFailed");case 4:return[2]}})})},C.prototype.sendTyping=function(){var R,D,_,N;return b(this,void 0,void 0,function(){return h(this,function(y){switch(y.label){case 0:null===(R=this.logger)||void 0===R||R.startScenario(v.SendTyping),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,null===(D=this.chatThreadClient)||void 0===D?void 0:D.sendTypingNotification()];case 2:return y.sent(),null===(_=this.logger)||void 0===_||_.completeScenario(v.SendTyping),[3,4];case 3:throw y.sent(),null===(N=this.logger)||void 0===N||N.failScenario(v.SendTyping),new Error("SendTypingFailed");case 4:return[2]}})})},C.prototype.sendFileMessage=function(){return b(this,void 0,void 0,function(){return h(this,function(R){return[2,void 0]})})},C.prototype.sendFileData=function(){return b(this,void 0,void 0,function(){return h(this,function(R){return[2,void 0]})})},C.prototype.uploadFile=function(){return b(this,void 0,void 0,function(){return h(this,function(R){return[2,void 0]})})},C.prototype.downloadFile=function(){return b(this,void 0,void 0,function(){return h(this,function(R){return[2,void 0]})})},C.prototype.disconnect=function(){var R,D,_;return b(this,void 0,void 0,function(){var N,P,y,M,j=this;return h(this,function(ue){null===(R=this.logger)||void 0===R||R.startScenario(v.Disconnect);try{for(N=function(Z,Y){Y.forEach(function(W){j.chatClient.off(Z,W)})},P=0,y=Object.entries(this.eventListeners);P<y.length;P++)N((M=y[P])[0],M[1]);null===(D=this.logger)||void 0===D||D.completeScenario(v.Disconnect)}catch(Z){null===(_=this.logger)||void 0===_||_.failScenario(v.Disconnect)}return[2]})})},C.prototype.createParticipantsMapping=function(){return b(this,void 0,void 0,function(){var R,D,_,N,P,y,M;return h(this,function(U){switch(U.label){case 0:return[4,this.getParticipants()];case 1:for(R=U.sent(),D={},_=0,N=R;_<N.length;_++)y=(P=N[_]).id,Object.keys(D).includes(y.communicationUserId)||Object.assign(D,((M={})[y.communicationUserId]=P,M));return[2,D]}})})},C.prototype.trackListener=function(R,D){R in this.eventListeners||(this.eventListeners[R]=[]),this.eventListeners[R].push(D)},C}();m.ACSConversation=S;var g=function(){function C(R){void 0===R&&(R=null),this.logger=null,this.tokenCredential=null,this.chatClient=null,this.logger=R}return C.prototype.initialize=function(R){var D,_,N,P;return b(this,void 0,void 0,function(){var y;return h(this,function(M){null===(D=this.logger)||void 0===D||D.startScenario(v.InitializeACSClient);try{this.tokenCredential=new T.AzureCommunicationTokenCredential(R.token)}catch(U){throw y={response:"CreateTokenCredentialFailure",errorObject:""+U},null===(_=this.logger)||void 0===_||_.failScenario(v.InitializeACSClient,{ExceptionDetails:JSON.stringify(y)}),new Error("CreateTokenCredentialFailed")}try{this.chatClient=new d.ChatClient(R.environmentUrl,this.tokenCredential)}catch(U){throw y={response:"CreateChatClientFailure",errorObject:""+U},null===(N=this.logger)||void 0===N||N.failScenario(v.InitializeACSClient,{ExceptionDetails:JSON.stringify(y)}),new Error("CreateChatClientFailed")}return null===(P=this.logger)||void 0===P||P.completeScenario(v.InitializeACSClient),[2]})})},C.prototype.joinConversation=function(R){return b(this,void 0,void 0,function(){var D;return h(this,function(_){switch(_.label){case 0:return[4,(D=new S(this.tokenCredential,this.chatClient,this.logger)).initialize(R)];case 1:return _.sent(),[2,D]}})})},C}();m.default=g},8953:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).Customer="Customer",s.Agent="__agent__",s.System="__system__",u;var s})();m.default=u},2562:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.default={IC3:"IC3",DirectLine:"DirectLine",ACS:"ACS"}},813:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.defaultMessageTags=m.customerMessageTag=m.channelIdTag=void 0,m.channelIdTag="ChannelId-lcw",m.customerMessageTag="FromCustomer",m.defaultMessageTags=[m.channelIdTag,m.customerMessageTag]},3709:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.ResourceType=m.FileSharingProtocolType=m.PersonType=m.MessageType=m.DeliveryMode=m.MessageContentType=void 0;var u=function(){function d(){}return d.RichText="RichText",d.Text="Text",d}();m.MessageContentType=u;var s=function(){function d(){}return d.Bridged="bridged",d.Unbridged="unbridged",d}();m.DeliveryMode=s;var d,b=function(){function d(){}return d.UserMessage="UserMessage",d.SwiftCard="SwiftCard",d.Typing="Control/Typing",d.ClearTyping="Control/ClearTyping",d.LiveState="Control/LiveState",d}();m.MessageType=b,(d=m.PersonType||(m.PersonType={}))[d.Unknown=0]="Unknown",d[d.User=1]="User",d[d.Bot=2]="Bot",function(d){d[d.AmsBasedFileSharing=0]="AmsBasedFileSharing"}(m.FileSharingProtocolType||(m.FileSharingProtocolType={}));var E=function(){function d(){}return d.NewMessage="NewMessage",d.MessageUpdate="MessageUpdate",d.UserPresence="UserPresence",d.ConversationUpdate="ConversationUpdate",d.ThreadUpdate="ThreadUpdate",d}();m.ResourceType=E},2921:function(Q,m){"use strict";var u=this&&this.__awaiter||function(E,d,T,A){return new(T||(T=Promise))(function(f,c){function v(C){try{g(A.next(C))}catch(R){c(R)}}function S(C){try{g(A.throw(C))}catch(R){c(R)}}function g(C){C.done?f(C.value):function(f){return f instanceof T?f:new T(function(c){c(f)})}(C.value).then(v,S)}g((A=A.apply(E,d||[])).next())})},s=this&&this.__generator||function(E,d){var A,I,f,c,T={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return c={next:v(0),throw:v(1),return:v(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function v(g){return function(C){return function(g){if(A)throw new TypeError("Generator is already executing.");for(;T;)try{if(A=1,I&&(f=2&g[0]?I.return:g[0]?I.throw||((f=I.return)&&f.call(I),0):I.next)&&!(f=f.call(I,g[1])).done)return f;switch(I=0,f&&(g=[2&g[0],f.value]),g[0]){case 0:case 1:f=g;break;case 4:return T.label++,{value:g[1],done:!1};case 5:T.label++,I=g[1],g=[0];continue;case 7:g=T.ops.pop(),T.trys.pop();continue;default:if(!(f=(f=T.trys).length>0&&f[f.length-1])&&(6===g[0]||2===g[0])){T=0;continue}if(3===g[0]&&(!f||g[1]>f[0]&&g[1]<f[3])){T.label=g[1];break}if(6===g[0]&&T.label<f[1]){T.label=f[1],f=g;break}if(f&&T.label<f[2]){T.label=f[2],T.ops.push(g);break}f[2]&&T.ops.pop(),T.trys.pop();continue}g=d.call(E,T)}catch(C){g=[6,C],I=0}finally{A=f=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([g,C])}}};Object.defineProperty(m,"__esModule",{value:!0});var h=(()=>{return(E=h||(h={})).AMSUpload="AMSUpload",E.AMSDownload="AMSDownload",E.GetFileIds="GetFileIds",E.CreateFileIdProperty="CreateFileIdProperty",E.GetFileMetadata="GetFileMetadata",E.CreateFileMetadataProperty="CreateFileMetadataProperty",h;var E})(),p=function(){function E(d,T){void 0===T&&(T=null),this.logger=T,this.amsClient=d}return E.prototype.uploadFiles=function(d){return u(this,void 0,void 0,function(){var T=this;return s(this,function(A){return[2,Promise.all(d.map(function(I){return u(T,void 0,void 0,function(){return s(this,function(f){return[2,this.uploadFileToAMS(I)]})})}))]})})},E.prototype.downloadFiles=function(d){return u(this,void 0,void 0,function(){var T=this;return s(this,function(A){return[2,Promise.all(d.map(function(I){return u(T,void 0,void 0,function(){return s(this,function(f){return[2,this.downloadFileFromAMS(I)]})})}))]})})},E.prototype.updatePermissions=function(){return u(this,void 0,void 0,function(){return s(this,function(d){return[2,void 0]})})},E.prototype.getFileIds=function(d){var T,A,I;null===(T=this.logger)||void 0===T||T.startScenario(h.GetFileIds);try{var f=JSON.parse(null==d?void 0:d.amsReferences);return null===(A=this.logger)||void 0===A||A.completeScenario(h.GetFileIds),f}catch(v){return void(null===(I=this.logger)||void 0===I||I.failScenario(h.GetFileIds,{ExceptionDetails:JSON.stringify({metadata:""+d,errorObject:""+v})}))}},E.prototype.createFileIdProperty=function(d){var T,A,I;null===(T=this.logger)||void 0===T||T.startScenario(h.CreateFileIdProperty);try{var f={amsReferences:JSON.stringify(d)};return null===(A=this.logger)||void 0===A||A.completeScenario(h.CreateFileIdProperty),f}catch(v){return void(null===(I=this.logger)||void 0===I||I.failScenario(h.CreateFileIdProperty,{ExceptionDetails:JSON.stringify({fileIds:""+d,errorObject:""+v})}))}},E.prototype.getFileMetadata=function(d){var T,A,I;null===(T=this.logger)||void 0===T||T.startScenario(h.GetFileMetadata);try{var f=JSON.parse(null==d?void 0:d.amsMetadata);return null===(A=this.logger)||void 0===A||A.completeScenario(h.GetFileMetadata),f}catch(v){return void(null===(I=this.logger)||void 0===I||I.failScenario(h.GetFileMetadata,{ExceptionDetails:JSON.stringify({metadata:""+d,errorObject:""+v})}))}},E.prototype.createFileMetadataProperty=function(d){var T,A,I;null===(T=this.logger)||void 0===T||T.startScenario(h.CreateFileMetadataProperty);try{var f={amsMetadata:JSON.stringify(d)};return null===(A=this.logger)||void 0===A||A.completeScenario(h.CreateFileMetadataProperty),f}catch(v){return void(null===(I=this.logger)||void 0===I||I.failScenario(h.CreateFileMetadataProperty,{ExceptionDetails:JSON.stringify({metadata:""+d,errorObject:""+v})}))}},E.prototype.uploadFileToAMS=function(d){var T,A,I,f,c;return u(this,void 0,void 0,function(){var v,S,C,R,D,_,g;return s(this,function(N){switch(N.label){case 0:if(null===(T=this.logger)||void 0===T||T.startScenario(h.AMSUpload),!d.contentUrl||!d.name)return[3,12];v=void 0,N.label=1;case 1:return N.trys.push([1,3,,4]),[4,this.amsClient.fetchBlob(d.contentUrl)];case 2:return v=N.sent(),[3,4];case 3:return S=N.sent(),g={response:"AMSFetchBlobFailure",errorObject:""+S},null===(A=this.logger)||void 0===A||A.failScenario(h.AMSUpload,{ExceptionDetails:JSON.stringify(g)}),[2,void 0];case 4:C=new File([v],d.name,{type:d.contentType}),R=void 0,N.label=5;case 5:return N.trys.push([5,7,,8]),[4,this.amsClient.createObject(this.amsClient.chatToken.chatId,C)];case 6:return R=N.sent(),[3,8];case 7:return D=N.sent(),g={response:"AMSCreateObjectFailure",errorObject:""+D},null===(I=this.logger)||void 0===I||I.failScenario(h.AMSUpload,{ExceptionDetails:JSON.stringify(g)}),[2,void 0];case 8:return N.trys.push([8,10,,11]),[4,this.amsClient.uploadDocument(R.id,C)];case 9:return N.sent(),[3,11];case 10:return _=N.sent(),g={response:"AMSUploadDocumentFailure",errorObject:""+_},null===(f=this.logger)||void 0===f||f.failScenario(h.AMSUpload,{ExceptionDetails:JSON.stringify(g)}),[2,void 0];case 11:return null===(c=this.logger)||void 0===c||c.completeScenario(h.AMSUpload),[2,{fileId:R.id,metadata:{contentType:d.contentType,fileName:d.name}}];case 12:return[2]}})})},E.prototype.downloadFileFromAMS=function(d){var T,A,I,f;return u(this,void 0,void 0,function(){var c,v,S,C,R,D,g,_;return s(this,function(N){switch(N.label){case 0:if(null===(T=this.logger)||void 0===T||T.startScenario(h.AMSDownload),!(d.fileId&&d.metadata&&d.metadata.fileName))return[3,9];c={id:d.fileId,type:d.metadata.contentType.split("/").pop()},v=void 0,N.label=1;case 1:return N.trys.push([1,3,,4]),[4,this.amsClient.getViewStatus(c)];case 2:return v=N.sent(),[3,4];case 3:return S=N.sent(),g={response:"AMSGetViewStatusFailure",errorObject:""+S},null===(A=this.logger)||void 0===A||A.failScenario(h.AMSDownload,{ExceptionDetails:JSON.stringify(g)}),[2,void 0];case 4:C=v.view_location,R=void 0,N.label=5;case 5:return N.trys.push([5,7,,8]),[4,this.amsClient.getView(c,C)];case 6:return R=N.sent(),[3,8];case 7:return D=N.sent(),g={response:"AMSGetViewFailure",errorObject:""+D},null===(I=this.logger)||void 0===I||I.failScenario(h.AMSDownload,{ExceptionDetails:JSON.stringify(g)}),[2,void 0];case 8:return _=new File([R],d.metadata.fileName,{type:d.metadata.contentType}),null===(f=this.logger)||void 0===f||f.completeScenario(h.AMSDownload),[2,_];case 9:return[2]}})})},E}();m.default=p},7432:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(813),b=u(3709);m.default=function(p){return function(){return function(d){return function(T){return T&&T.channelData&&(T.channelData.tags||(T.channelData.tags=[]),T.channelData.tags.includes(s.channelIdTag)||T.channelData.tags.push(s.channelIdTag),T.channelData.tags.includes(s.customerMessageTag)||T.channelData.tags.push(s.customerMessageTag),T.channelData.metadata||(T.channelData.metadata={}),T.channelData.metadata.deliveryMode||(T.channelData.metadata.deliveryMode=b.DeliveryMode.Bridged),p.widgetId&&(T.channelData.metadata.widgetId=p.widgetId)),d(T)}}}}},5480:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.default=function(){return function(){return function(b){return function(h){var p=JSON.parse(JSON.stringify(h));if(p&&p.channelData&&p.channelData.tags){var E=p.channelData.tags;if("string"==typeof E)return b(h);if(E instanceof Array)p.channelData.tags=E.toString();else if("object"==typeof p.channelData.tags)try{p.channelData.tags=JSON.stringify(E)}catch(d){console.error(d)}}return b(p)}}}}},3968:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.default=function(){return function(){return function(b){return function(h){var p=JSON.parse(JSON.stringify(h));if(p&&p.channelData&&p.channelData.tags){var E=p.channelData.tags;if("string"==typeof E)try{p.channelData.tags=JSON.parse(E)}catch(d){p.channelData.tags=E.split(",")}}return b(p)}}}}},9451:(Q,m)=>{"use strict";var s;Object.defineProperty(m,"__esModule",{value:!0}),(s=m._BondDataType||(m._BondDataType={}))[s._BT_STOP=0]="_BT_STOP",s[s._BT_STOP_BASE=1]="_BT_STOP_BASE",s[s._BT_BOOL=2]="_BT_BOOL",s[s._BT_DOUBLE=8]="_BT_DOUBLE",s[s._BT_STRING=9]="_BT_STRING",s[s._BT_STRUCT=10]="_BT_STRUCT",s[s._BT_LIST=11]="_BT_LIST",s[s._BT_MAP=13]="_BT_MAP",s[s._BT_INT32=16]="_BT_INT32",s[s._BT_INT64=17]="_BT_INT64"},1464:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(6649),b=u(5644),h=u(514);m._Utf8_GetBytes=function(c){for(var v=[],S=0;S<c.length;++S){var g=c.charCodeAt(S);g<128?v.push(g):g<2048?v.push(192|g>>6,128|63&g):g<55296||g>=57344?v.push(224|g>>12,128|g>>6&63,128|63&g):(g=65536+((1023&g)<<10|1023&c.charCodeAt(++S)),v.push(240|g>>18,128|g>>12&63,128|g>>6&63,128|63&g))}return v},m._Base64_GetString=function(c){for(var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=[],g=c.length%3,R=0,D=c.length-g;R<D;R+=3)S.push([v.charAt((P=_=(c[R]<<16)+(c[R+1]<<8)+c[R+2])>>18&63),v.charAt(P>>12&63),v.charAt(P>>6&63),v.charAt(63&P)].join(""));var P;switch(g){case 1:var _;S.push(v.charAt((_=c[c.length-1])>>2)),S.push(v.charAt(_<<4&63)),S.push("==");break;case 2:var N=(c[c.length-2]<<8)+c[c.length-1];S.push(v.charAt(N>>10)),S.push(v.charAt(N>>4&63)),S.push(v.charAt(N<<2&63)),S.push("=")}return S.join("")},m._Varint_GetBytes=function(c){for(var v=[];4294967168&c;)v.push(127&c|128),c>>>=7;return v.push(127&c),v},m._Varint64_GetBytes=function(c){for(var v=c.low,S=c.high,g=[];S||4294967168&v;)g.push(127&v|128),v=(127&S)<<25|v>>>7,S>>>=7;return g.push(127&v),g},m._Double_GetBytes=function(c){if(h.BrowserChecker._IsDataViewSupport()){var v=new DataView(new ArrayBuffer(8));v.setFloat64(0,c,!0);for(var S=[],g=0;g<8;++g)S.push(v.getUint8(g));return S}return b.FloatUtils._ConvertNumberToArray(c,!0)},m._Zigzag_EncodeZigzag32=function(c){return(c=s.Number._ToInt32(c))<<1^c>>31},m._Zigzag_EncodeZigzag64=function(c){var v=c.low,S=c.high,g=S<<1|v>>>31,C=v<<1;2147483648&S&&(g=~g,C=~C);var R=new s.UInt64("0");return R.low=C,R.high=g,R}},5644:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s._ConvertNumberToArray=function(b,h){if(!b)return h?this._doubleZero:this._floatZero;var E=h?52:23,d=(1<<(h?11:8)-1)-1,T=1-d,A=d,I=b<0?1:0;b=Math.abs(b);for(var f=Math.floor(b),c=b-f,v=2*(d+2)+E,S=new Array(v),g=0;g<v;)S[g++]=0;for(g=d+2;g&&f;)S[--g]=f%2,f=Math.floor(f/2);for(g=d+1;g<v-1&&c>0;)(c*=2)>=1?(S[++g]=1,--c):S[++g]=0;for(var C=0;C<v&&!S[C];)C++;var R=d+1-C,D=C+E;if(S[D+1]){for(g=D;g>C&&(S[g]=1-S[g],!S);--g);g===C&&++R}if(R>A||f)return I?h?this._doubleNegInifinity:this._floatNegInifinity:h?this._doubleInifinity:this._floatInifinity;if(R<T)return h?this._doubleZero:this._floatZero;if(h){var _=0;for(g=0;g<20;++g)_=_<<1|S[++C];for(var N=0;g<52;++g)N=N<<1|S[++C];return[255&N,N>>8&255,N>>16&255,N>>>24,255&(_=I<<31|2147483647&(_|=R+d<<20)),_>>8&255,_>>16&255,_>>>24]}var y=0;for(g=0;g<23;++g)y=y<<1|S[++C];return[255&(y=I<<31|2147483647&(y|=R+d<<23)),y>>8&255,y>>16&255,y>>>24]},s._floatZero=[0,0,0,0],s._doubleZero=[0,0,0,0,0,0,0,0],s._floatInifinity=[0,0,128,127],s._floatNegInifinity=[0,0,128,255],s._doubleInifinity=[0,0,0,0,0,0,240,127],s._doubleNegInifinity=[0,0,0,0,0,0,240,255],s}();m.FloatUtils=u},67:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(6649),b=function(){function h(){this._buffer=[]}return h.prototype._WriteByte=function(p){this._buffer.push(s.Number._ToByte(p))},h.prototype._Write=function(p,E,d){for(;d--;)this._WriteByte(p[E++])},h.prototype._GetBuffer=function(){return this._buffer},h}();m.MemoryStream=b},4356:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(9451);m._BondDataType=s._BondDataType;var b=u(1464);m._Encoding=b;var h=u(67);m.IO=h;var p=u(6649);m.Int64=p.Int64,m.UInt64=p.UInt64,m.Number=p.Number;var E=function(){function d(T){this._stream=T}return d.prototype._WriteBlob=function(T){this._stream._Write(T,0,T.length)},d.prototype._WriteBool=function(T){this._stream._WriteByte(T?1:0)},d.prototype._WriteContainerBegin=function(T,A){this._WriteUInt8(A),this._WriteUInt32(T)},d.prototype._WriteMapContainerBegin=function(T,A,I){this._WriteUInt8(A),this._WriteUInt8(I),this._WriteUInt32(T)},d.prototype._WriteDouble=function(T){var A=b._Double_GetBytes(T);this._stream._Write(A,0,A.length)},d.prototype._WriteFieldBegin=function(T,A,I){A<=5?this._stream._WriteByte(T|A<<5):A<=255?(this._stream._WriteByte(192|T),this._stream._WriteByte(A)):(this._stream._WriteByte(224|T),this._stream._WriteByte(A),this._stream._WriteByte(A>>8))},d.prototype._WriteInt32=function(T){T=b._Zigzag_EncodeZigzag32(T),this._WriteUInt32(T)},d.prototype._WriteInt64=function(T){this._WriteUInt64(b._Zigzag_EncodeZigzag64(T))},d.prototype._WriteString=function(T){if(""===T)this._WriteUInt32(0);else{var A=b._Utf8_GetBytes(T);this._WriteUInt32(A.length),this._stream._Write(A,0,A.length)}},d.prototype._WriteStructEnd=function(T){this._WriteUInt8(T?s._BondDataType._BT_STOP_BASE:s._BondDataType._BT_STOP)},d.prototype._WriteUInt32=function(T){var A=b._Varint_GetBytes(p.Number._ToUInt32(T));this._stream._Write(A,0,A.length)},d.prototype._WriteUInt64=function(T){var A=b._Varint64_GetBytes(T);this._stream._Write(A,0,A.length)},d.prototype._WriteUInt8=function(T){this._stream._WriteByte(p.Number._ToUInt8(T))},d}();m.CompactBinaryProtocolWriter=E},6649:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function h(p){this.low=0,this.high=0,this.low=parseInt(p,10),this.low<0&&(this.high=-1)}return h.prototype._Equals=function(p){var E=new h(p);return this.low===E.low&&this.high===E.high},h}();m.Int64=u;var s=function(){function h(p){this.low=0,this.high=0,this.low=parseInt(p,10)}return h.prototype._Equals=function(p){var E=new h(p);return this.low===E.low&&this.high===E.high},h}();m.UInt64=s;var b=function(){function h(){}return h._ToByte=function(p){return this._ToUInt8(p)},h._ToUInt8=function(p){return 255&p},h._ToInt32=function(p){return 2147483647&p|2147483648&p},h._ToUInt32=function(p){return 4294967295&p},h}();m.Number=b},514:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},s}();m.BrowserChecker=u},4501:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(b){this.clockSkewRefreshDurationInMins=b,this._reset()}return s.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},s.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},s.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},s.prototype.setClockSkew=function(b){this._clockSkewSet||(b?this._clockSkewHeaderValue=b:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},s.prototype._reset=function(){var b=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout(function(){return b._reset()},6e4*this.clockSkewRefreshDurationInMins)},s}();m.default=u},7190:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=function(){function b(){this._killedTokenDictionary={}}return b.prototype.setKillSwitchTenants=function(h,p){if(h&&p)try{var E=h.split(",");if("this-request-only"===p)return E;for(var d=1e3*parseInt(p,10),T=0;T<E.length;++T)this._killedTokenDictionary[E[T]]=Date.now()+d}catch(A){return[]}return[]},b.prototype.isTenantKilled=function(h){return void 0!==this._killedTokenDictionary[h]&&this._killedTokenDictionary[h]>Date.now()||(delete this._killedTokenDictionary[h],!1)},b}();m.default=s},2551:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.addNotificationListener=function(b){this.listeners.push(b)},s.removeNotificationListener=function(b){for(var h=this.listeners.indexOf(b);h>-1;)this.listeners.splice(h,1),h=this.listeners.indexOf(b)},s.eventsSent=function(b){for(var h=this,p=function(T){E.listeners[T].eventsSent&&setTimeout(function(){return h.listeners[T].eventsSent(b)},0)},E=this,d=0;d<this.listeners.length;++d)p(d)},s.eventsDropped=function(b,h){for(var p=this,E=function(A){d.listeners[A].eventsDropped&&setTimeout(function(){return p.listeners[A].eventsDropped(b,h)},0)},d=this,T=0;T<this.listeners.length;++T)E(T)},s.eventsRetrying=function(b){for(var h=this,p=function(T){E.listeners[T].eventsRetrying&&setTimeout(function(){return h.listeners[T].eventsRetrying(b)},0)},E=this,d=0;d<this.listeners.length;++d)p(d)},s.eventsRejected=function(b,h){for(var p=this,E=function(A){d.listeners[A].eventsRejected&&setTimeout(function(){return p.listeners[A].eventsRejected(b,h)},0)},d=this,T=0;T<this.listeners.length;++T)E(T)},s.listeners=[],s}();m.default=u},2659:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(676),b=function(){function h(p,E){this._outboundQueue=p,this._maxNumberOfEvents=E,this._currentBatch={},this._currentNumEventsInBatch=0}return h.prototype.addEventToBatch=function(p){if(p.priority===s.AWTEventPriority.Immediate_sync){var E={};return E[p.apiKey]=[p],E}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[p.apiKey]&&(this._currentBatch[p.apiKey]=[]),this._currentBatch[p.apiKey].push(p),this._currentNumEventsInBatch++,null},h.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},h.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},h}();m.default=b},7270:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var p=function(){function E(){}return E.shouldRetryForStatus=function(d){return!(d>=300&&d<500&&408!==d||501===d||505===d)},E.getMillisToBackoffForRetry=function(d){var T,f=Math.floor(1200*Math.random())+2400;return T=Math.pow(4,d)*f,Math.min(T,12e4)},E}();m.default=p},6064:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(4356),b=u(676),h=u(2551),p=u(5593),E=2936012,d=function(){function T(){}return T.getPayloadBlob=function(A,I){var c,f=!1,v=new s.IO.MemoryStream,S=new s.CompactBinaryProtocolWriter(v);for(var g in S._WriteFieldBegin(s._BondDataType._BT_MAP,3,null),S._WriteMapContainerBegin(I,s._BondDataType._BT_STRING,s._BondDataType._BT_LIST),A)if(f)c||(c={}),c[g]=A[g],delete A[g];else if(A.hasOwnProperty(g)){S._WriteString(g);var C=A[g];S._WriteContainerBegin(1,s._BondDataType._BT_STRUCT),S._WriteFieldBegin(s._BondDataType._BT_STRING,2,null),S._WriteString("act_default_source"),S._WriteFieldBegin(s._BondDataType._BT_STRING,5,null),S._WriteString(p.newGuid()),S._WriteFieldBegin(s._BondDataType._BT_INT64,6,null),S._WriteInt64(p.numberToBondInt64(Date.now())),S._WriteFieldBegin(s._BondDataType._BT_LIST,8,null);var R=v._GetBuffer().length+1;S._WriteContainerBegin(A[g].length,s._BondDataType._BT_STRUCT);for(var D=v._GetBuffer().length-R,_=0;_<C.length;++_){var N=v._GetBuffer().length;if(this.writeEvent(C[_],S),v._GetBuffer().length-N>E)h.default.eventsRejected([C[_]],b.AWTEventsRejectedReason.SizeLimitExceeded),C.splice(_--,1),v._GetBuffer().splice(N),this._addNewDataPackageSize(C.length,v,D,R);else if(v._GetBuffer().length>E){v._GetBuffer().splice(N),c||(c={}),A[g]=C.splice(0,_),c[g]=C,this._addNewDataPackageSize(A[g].length,v,D,R),f=!0;break}}S._WriteStructEnd(!1)}return S._WriteStructEnd(!1),{payloadBlob:v._GetBuffer(),remainingRequest:c}},T._addNewDataPackageSize=function(A,I,f,c){for(var v=s._Encoding._Varint_GetBytes(s.Number._ToUInt32(A)),S=0;S<f;++S){if(!(S<v.length)){I._GetBuffer().slice(c+S,f-S);break}I._GetBuffer()[c+S]=v[S]}},T.writeEvent=function(A,I){I._WriteFieldBegin(s._BondDataType._BT_STRING,1,null),I._WriteString(A.id),I._WriteFieldBegin(s._BondDataType._BT_INT64,3,null),I._WriteInt64(p.numberToBondInt64(A.timestamp)),I._WriteFieldBegin(s._BondDataType._BT_STRING,5,null),I._WriteString(A.type),I._WriteFieldBegin(s._BondDataType._BT_STRING,6,null),I._WriteString(A.name);var f={},c=0,v={},S=0,g={},C=0,R={},D=0,_={},N=0,P={},y=0,M={},U=0;for(var $ in A.properties)if(A.properties.hasOwnProperty($))if((j=A.properties[$]).cc>0)M[$]=j,U++;else if(j.pii>0)P[$]=j,y++;else switch(j.type){case b.AWTPropertyType.String:f[$]=j.value,c++;break;case b.AWTPropertyType.Int64:v[$]=j.value,S++;break;case b.AWTPropertyType.Double:g[$]=j.value,C++;break;case b.AWTPropertyType.Boolean:R[$]=j.value,D++;break;case b.AWTPropertyType.Date:_[$]=j.value,N++}if(c)for(var $ in I._WriteFieldBegin(s._BondDataType._BT_MAP,13,null),I._WriteMapContainerBegin(c,s._BondDataType._BT_STRING,s._BondDataType._BT_STRING),f)if(f.hasOwnProperty($)){var ue=f[$];I._WriteString($),I._WriteString(ue.toString())}if(y)for(var $ in I._WriteFieldBegin(s._BondDataType._BT_MAP,30,null),I._WriteMapContainerBegin(y,s._BondDataType._BT_STRING,s._BondDataType._BT_STRUCT),P)if(P.hasOwnProperty($)){var j=P[$];I._WriteString($),I._WriteFieldBegin(s._BondDataType._BT_INT32,1,null),I._WriteInt32(1),I._WriteFieldBegin(s._BondDataType._BT_INT32,2,null),I._WriteInt32(j.pii),I._WriteFieldBegin(s._BondDataType._BT_STRING,3,null),I._WriteString(j.value.toString()),I._WriteStructEnd(!1)}if(D)for(var $ in I._WriteFieldBegin(s._BondDataType._BT_MAP,31,null),I._WriteMapContainerBegin(D,s._BondDataType._BT_STRING,s._BondDataType._BT_BOOL),R)R.hasOwnProperty($)&&(ue=R[$],I._WriteString($),I._WriteBool(ue));if(N)for(var $ in I._WriteFieldBegin(s._BondDataType._BT_MAP,32,null),I._WriteMapContainerBegin(N,s._BondDataType._BT_STRING,s._BondDataType._BT_INT64),_)_.hasOwnProperty($)&&(ue=_[$],I._WriteString($),I._WriteInt64(p.numberToBondInt64(ue)));if(S)for(var $ in I._WriteFieldBegin(s._BondDataType._BT_MAP,33,null),I._WriteMapContainerBegin(S,s._BondDataType._BT_STRING,s._BondDataType._BT_INT64),v)v.hasOwnProperty($)&&(ue=v[$],I._WriteString($),I._WriteInt64(p.numberToBondInt64(ue)));if(C)for(var $ in I._WriteFieldBegin(s._BondDataType._BT_MAP,34,null),I._WriteMapContainerBegin(C,s._BondDataType._BT_STRING,s._BondDataType._BT_DOUBLE),g)g.hasOwnProperty($)&&(ue=g[$],I._WriteString($),I._WriteDouble(ue));if(U)for(var $ in I._WriteFieldBegin(s._BondDataType._BT_MAP,36,null),I._WriteMapContainerBegin(U,s._BondDataType._BT_STRING,s._BondDataType._BT_STRUCT),M)M.hasOwnProperty($)&&(j=M[$],I._WriteString($),I._WriteFieldBegin(s._BondDataType._BT_INT32,1,null),I._WriteInt32(j.cc),I._WriteFieldBegin(s._BondDataType._BT_STRING,2,null),I._WriteString(j.value.toString()),I._WriteStructEnd(!1));I._WriteStructEnd(!1)},T.base64Encode=function(A){return s._Encoding._Base64_GetString(A)},T}();m.default=d},5816:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(5593),b=u(2551),h=u(676),E=function(){function d(){}return d.initialize=function(T){var A=this;this._sendStats=T,this._isInitalized=!0,b.default.addNotificationListener({eventsSent:function(I){A._addStat("records_sent_count",I.length,I[0].apiKey)},eventsDropped:function(I,f){switch(f){case h.AWTEventsDroppedReason.NonRetryableStatus:A._addStat("d_send_fail",I.length,I[0].apiKey),A._addStat("records_dropped_count",I.length,I[0].apiKey);break;case h.AWTEventsDroppedReason.MaxRetryLimit:A._addStat("d_retry_limit",I.length,I[0].apiKey),A._addStat("records_dropped_count",I.length,I[0].apiKey);break;case h.AWTEventsDroppedReason.QueueFull:A._addStat("d_queue_full",I.length,I[0].apiKey)}},eventsRejected:function(I,f){switch(f){case h.AWTEventsRejectedReason.InvalidEvent:A._addStat("r_inv",I.length,I[0].apiKey);break;case h.AWTEventsRejectedReason.KillSwitch:A._addStat("r_kl",I.length,I[0].apiKey);break;case h.AWTEventsRejectedReason.SizeLimitExceeded:A._addStat("r_size",I.length,I[0].apiKey)}A._addStat("r_count",I.length,I[0].apiKey)},eventsRetrying:null}),setTimeout(function(){return A.flush()},6e4)},d.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},d.eventReceived=function(T){d._addStat("records_received_count",1,T)},d.flush=function(){var T=this;if(this._isInitalized){for(var A in this._stats)this._stats.hasOwnProperty(A)&&this._sendStats(this._stats[A],A);this._stats={},setTimeout(function(){return T.flush()},6e4)}},d._addStat=function(T,A,I){if(this._isInitalized&&I!==s.StatsApiKey){var f=s.getTenantId(I);this._stats[f]||(this._stats[f]={}),this._stats[f][T]=this._stats[f][T]?this._stats[f][T]+A:A}},d._isInitalized=!1,d._stats={},d}();m.default=E},676:(Q,m)=>{"use strict";var d;Object.defineProperty(m,"__esModule",{value:!0}),(d=m.AWTPropertyType||(m.AWTPropertyType={}))[d.Unspecified=0]="Unspecified",d[d.String=1]="String",d[d.Int64=2]="Int64",d[d.Double=3]="Double",d[d.Boolean=4]="Boolean",d[d.Date=5]="Date",function(d){d[d.NotSet=0]="NotSet",d[d.DistinguishedName=1]="DistinguishedName",d[d.GenericData=2]="GenericData",d[d.IPV4Address=3]="IPV4Address",d[d.IPv6Address=4]="IPv6Address",d[d.MailSubject=5]="MailSubject",d[d.PhoneNumber=6]="PhoneNumber",d[d.QueryString=7]="QueryString",d[d.SipAddress=8]="SipAddress",d[d.SmtpAddress=9]="SmtpAddress",d[d.Identity=10]="Identity",d[d.Uri=11]="Uri",d[d.Fqdn=12]="Fqdn",d[d.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(m.AWTPiiKind||(m.AWTPiiKind={})),function(d){d[d.NotSet=0]="NotSet",d[d.GenericContent=1]="GenericContent"}(m.AWTCustomerContentKind||(m.AWTCustomerContentKind={})),function(d){d[d.Low=1]="Low",d[d.Normal=2]="Normal",d[d.High=3]="High",d[d.Immediate_sync=5]="Immediate_sync"}(m.AWTEventPriority||(m.AWTEventPriority={})),function(d){d[d.NonRetryableStatus=1]="NonRetryableStatus",d[d.QueueFull=3]="QueueFull",d[d.MaxRetryLimit=4]="MaxRetryLimit"}(m.AWTEventsDroppedReason||(m.AWTEventsDroppedReason={})),function(d){d[d.InvalidEvent=1]="InvalidEvent",d[d.SizeLimitExceeded=2]="SizeLimitExceeded",d[d.KillSwitch=3]="KillSwitch"}(m.AWTEventsRejectedReason||(m.AWTEventsRejectedReason={}))},5593:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(6649),b=u(676),h=/[xy]/g,d=null;m.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,m.EventNameDotRegex=/\./g,m.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,m.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var T=d,A=d,I=d;function v(K){return"string"==typeof K}function S(K){return"number"==typeof K}function g(K){return"boolean"==typeof K}function C(K){return K instanceof Date}function R(K){return 1e4*(K+621355968e5)}function j(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function ue(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function Z(K){return K<10?"0"+K:K.toString()}function te(K){return void 0===K||K===d||""===K}m.numberToBondInt64=function(K){var re=new s.Int64("0");return re.low=4294967295&K,re.high=Math.floor(K/4294967296),re},m.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(h,function(K){var re=16*Math.random()|0;return("x"===K?re:3&re|8).toString(16)})},m.isString=v,m.isNumber=S,m.isBoolean=g,m.isDate=C,m.msToTicks=R,m.getTenantId=function(K){var re=K.indexOf("-");return re>-1?K.substring(0,re):""},m.isBeaconsSupported=function(){return T===d&&(T="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),T},m.isUint8ArrayAvailable=function(){return A===d&&(A="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var K=navigator.userAgent.toLowerCase();if((K.indexOf("safari")>=0||K.indexOf("firefox")>=0)&&K.indexOf("chrome")<0)return!0}return!1}()&&!j()),A},m.isPriority=function(K){return!(!S(K)||!(K>=1&&K<=3||5===K))},m.sanitizeProperty=function(K,re){return!m.PropertyNameRegex.test(K)||te(re)||(te(re.value)&&(re={value:re,type:b.AWTPropertyType.Unspecified}),re.type=function(K,re){switch(re=function(K){return!!(S(K)&&K>=0&&K<=4)}(re)?re:b.AWTPropertyType.Unspecified){case b.AWTPropertyType.Unspecified:return function(K){switch(typeof K){case"string":return b.AWTPropertyType.String;case"boolean":return b.AWTPropertyType.Boolean;case"number":return b.AWTPropertyType.Double;case"object":return C(K)?b.AWTPropertyType.Date:d}return d}(K);case b.AWTPropertyType.String:return v(K)?re:d;case b.AWTPropertyType.Boolean:return g(K)?re:d;case b.AWTPropertyType.Date:return C(K)&&NaN!==K.getTime()?re:d;case b.AWTPropertyType.Int64:return S(K)&&K%1==0?re:d;case b.AWTPropertyType.Double:return S(K)?re:d}return d}(re.value,re.type),!re.type)||(C(re.value)&&(re.value=R(re.value.getTime())),re.pii>0&&re.cc>0)?d:re.pii?function(K){return!!(S(K)&&K>=0&&K<=13)}(re.pii)?re:d:re.cc?function(K){return!!(S(K)&&K>=0&&K<=1)}(re.cc)?re:d:re},m.getISOString=function(K){return K.getUTCFullYear()+"-"+Z(K.getUTCMonth()+1)+"-"+Z(K.getUTCDate())+"T"+Z(K.getUTCHours())+":"+Z(K.getUTCMinutes())+":"+Z(K.getUTCSeconds())+"."+function(K){return K<10?"00"+K:K<100?"0"+K:K.toString()}(K.getUTCMilliseconds())+"Z"},m.useXDomainRequest=function(){if(I===d){var K=new XMLHttpRequest;I=void 0===K.withCredentials&&"undefined"!=typeof XDomainRequest}return I},m.useFetchRequest=function(){return j()||ue()},m.isReactNative=j,m.isServiceWorkerGlobalScope=ue},4094:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(5593),b="MicrosoftApplicationsTelemetryDeviceId",h="MicrosoftApplicationsTelemetryFirstLaunchTime",d_WIN=/(windows|win32)/i,d_WINRT=/ arm;/i,d_WINPHONE=/windows\sphone\s\d+\.\d+/i,d_OSX=/(macintosh|mac os x)/i,d_IOS=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,d_LINUX=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,d_ANDROID=/android/i,d_CROS=/CrOS/i,T={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},A="([\\d,.]+)",f="Unknown",c="undefined",v=function(){function S(){}return S.addPropertyStorageOverride=function(g){return!!g&&(this._propertyStorage=g,!0)},S.autoCollect=function(g,C,R){if(this._semanticContext=g,this._disableCookies=C,this._autoCollect(),!R&&typeof navigator!==c&&(R=navigator.userAgent||""),this._autoCollectFromUserAgent(R),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(b),void this._deleteCookie(h);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},S.checkAndSaveDeviceId=function(g){if(g){var C=this._getData(b),R=this._getData(h);C!==g&&(R=s.getISOString(new Date)),this._saveData(b,g),this._saveData(h,R),this._setFirstLaunchTime(R)}},S._autoCollectDeviceId=function(){var g=this._getData(b);g||(g=s.newGuid()),this._semanticContext.setDeviceId(g)},S._autoCollect=function(){typeof document!==c&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),typeof navigator!==c&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var g=(new Date).getTimezoneOffset(),C=g%60,R=(g-C)/60,D="+";R>0&&(D="-"),R=Math.abs(R),C=Math.abs(C),this._semanticContext.setUserTimeZone(D+(R<10?"0"+R:R.toString())+":"+(C<10?"0"+C:C.toString()))},S._autoCollectFromUserAgent=function(g){if(g){var C=this._getBrowserName(g);this._semanticContext.setDeviceBrowserName(C),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(g,C));var R=this._getOsName(g);this._semanticContext.setDeviceOsName(R),this._semanticContext.setDeviceOsVersion(this._getOsVersion(g,R))}},S._getBrowserName=function(g){return this._userAgentContainsString("OPR/",g)?"Opera":this._userAgentContainsString("PhantomJS",g)?"PhantomJS":this._userAgentContainsString("Edge",g)||this._userAgentContainsString("Edg",g)?"Edge":this._userAgentContainsString("Electron",g)?"Electron":this._userAgentContainsString("Chrome",g)?"Chrome":this._userAgentContainsString("Trident",g)?"MSIE":this._userAgentContainsString("Firefox",g)?"Firefox":this._userAgentContainsString("Safari",g)?"Safari":this._userAgentContainsString("SkypeShell",g)?"SkypeShell":f},S._setFirstLaunchTime=function(g){if(!isNaN(g)){var C=new Date;C.setTime(parseInt(g,10)),g=s.getISOString(C)}this.firstLaunchTime=g},S._userAgentContainsString=function(g,C){return C.indexOf(g)>-1},S._getBrowserVersion=function(g,C){if("MSIE"===C)return this._getIeVersion(g);if("Edge"===C){var R=this._getOtherVersion(C,g);return R===f?this._getOtherVersion("Edg",g):R}return this._getOtherVersion(C,g)},S._getIeVersion=function(g){var C=g.match(new RegExp("MSIE "+A));if(C)return C[1];var R=g.match(new RegExp("rv:"+A));return R?R[1]:void 0},S._getOtherVersion=function(g,C){"Safari"===g&&(g="Version");var R=C.match(new RegExp(g+"/"+A));return R?R[1]:f},S._getOsName=function(g){return g.match(d_WINPHONE)?"Windows Phone":g.match(d_WINRT)?"Windows RT":g.match(d_IOS)?"iOS":g.match(d_ANDROID)?"Android":g.match(d_LINUX)?"Linux":g.match(d_OSX)?"Mac OS X":g.match(d_WIN)?"Windows":g.match(d_CROS)?"Chrome OS":f},S._getOsVersion=function(g,C){return"Windows"===C?this._getGenericOsVersion(g,"Windows NT"):"Android"===C?this._getGenericOsVersion(g,C):"Mac OS X"===C?this._getMacOsxVersion(g):f},S._getGenericOsVersion=function(g,C){var R=g.match(new RegExp(C+" "+A));return R?T[R[1]]?T[R[1]]:R[1]:f},S._getMacOsxVersion=function(g){var C=g.match(new RegExp("Mac OS X ([\\d,_,.]+)"));if(C){var R=C[1].replace(/_/g,".");if(R){var D=this._getDelimiter(R);return D?R.split(D)[0]:R}}return f},S._getDelimiter=function(g){return g.indexOf(".")>-1?".":g.indexOf("_")>-1?"_":null},S._saveData=function(g,C){if(this._propertyStorage)this._propertyStorage.setProperty(g,C);else if(this._areCookiesAvailable){var R=new Date;R.setTime(R.getTime()+31536e6);var D="expires="+R.toUTCString();document.cookie=g+"="+C+"; "+D}},S._getData=function(g){if(this._propertyStorage)return this._propertyStorage.getProperty(g)||"";if(this._areCookiesAvailable){g+="=";for(var C=document.cookie.split(";"),R=0;R<C.length;R++){for(var D=C[R],_=0;" "===D.charAt(_);)_++;if(0===(D=D.substring(_)).indexOf(g))return D.substring(g.length,D.length)}}return""},S._deleteCookie=function(g){this._areCookiesAvailable&&(document.cookie=g+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},S._disableCookies=!1,S._areCookiesAvailable=typeof document!==c&&typeof document.cookie!==c,S}();m.default=v},58:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(5593),b=u(676),h=function(){function p(E){this._event={name:"",properties:{}},E&&this.setName(E)}return p.prototype.setName=function(E){this._event.name=E},p.prototype.getName=function(){return this._event.name},p.prototype.setType=function(E){this._event.type=E},p.prototype.getType=function(){return this._event.type},p.prototype.setTimestamp=function(E){this._event.timestamp=E},p.prototype.getTimestamp=function(){return this._event.timestamp},p.prototype.setEventPriority=function(E){this._event.priority=E},p.prototype.getEventPriority=function(){return this._event.priority},p.prototype.setProperty=function(E,d,T){void 0===T&&(T=b.AWTPropertyType.Unspecified);var A={value:d,type:T,pii:b.AWTPiiKind.NotSet,cc:b.AWTCustomerContentKind.NotSet};null!==(A=s.sanitizeProperty(E,A))?this._event.properties[E]=A:delete this._event.properties[E]},p.prototype.setPropertyWithPii=function(E,d,T,A){void 0===A&&(A=b.AWTPropertyType.Unspecified);var I={value:d,type:A,pii:T,cc:b.AWTCustomerContentKind.NotSet};null!==(I=s.sanitizeProperty(E,I))?this._event.properties[E]=I:delete this._event.properties[E]},p.prototype.setPropertyWithCustomerContent=function(E,d,T,A){void 0===A&&(A=b.AWTPropertyType.Unspecified);var I={value:d,type:A,pii:b.AWTPiiKind.NotSet,cc:T};null!==(I=s.sanitizeProperty(E,I))?this._event.properties[E]=I:delete this._event.properties[E]},p.prototype.getPropertyMap=function(){return this._event.properties},p.prototype.getEvent=function(){return this._event},p}();m.default=h},9449:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(676),b=u(6064),h=u(7270),p=u(7190),E=u(4501),d=u(8779),T=u(5593),A=u(2551),I=u(4023),v="POST",S=function(){function g(C,R,D,_,N){var P=this;this._requestQueue=C,this._queueManager=D,this._httpInterface=_,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+d.FullVersionString,this._killSwitch=new p.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new E.default(N),T.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=R+this._urlString,this._httpInterface||(this._useBeacons=!T.isReactNative(),this._httpInterface={sendPOST:function(y,M,U,$,j,ue){try{if(T.useFetchRequest())fetch(y,{body:M,method:v}).then(function(W){var ce={};W.headers&&W.headers.forEach(function(Ce,ne){ce[ne]=Ce}),j(W.status,ce)}).catch(function(W){$(0,{})});else if(T.useXDomainRequest()){var Z=new XDomainRequest;Z.open(v,y),Z.onload=function(){j(200,null)},Z.onerror=function(){$(400,null)},Z.ontimeout=function(){U(500,null)},Z.send(M)}else{var Y=new XMLHttpRequest;Y.open(v,y,!ue),Y.onload=function(){j(Y.status,P._convertAllHeadersToMap(Y.getAllResponseHeaders()))},Y.onerror=function(){$(Y.status,P._convertAllHeadersToMap(Y.getAllResponseHeaders()))},Y.ontimeout=function(){U(Y.status,P._convertAllHeadersToMap(Y.getAllResponseHeaders()))},Y.send(M)}}catch(W){$(400,null)}}})}return g.prototype.hasIdleConnection=function(){return this._activeConnections<2},g.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&I.default.scheduleTimer()},g.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},g.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},g.prototype.pause=function(){this._paused=!0},g.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},g.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},g.prototype.sendSynchronousRequest=function(C,R){this._paused&&(C[R][0].priority=s.AWTEventPriority.High),this._activeConnections++,this._sendRequest(C,0,!1,!0)},g.prototype._sendRequest=function(C,R,D,_){var N=this;void 0===_&&(_=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(C);var P=0,y="";for(var M in C)C.hasOwnProperty(M)&&(this._killSwitch.isTenantKilled(M)?(A.default.eventsRejected(C[M],s.AWTEventsRejectedReason.KillSwitch),delete C[M]):(y.length>0&&(y+=","),y+=M,P++));if(P>0){var U=b.default.getPayloadBlob(C,P);U.remainingRequest&&this._requestQueue.push(U.remainingRequest);var $=this._urlString+"&x-apikey="+y+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&($=$+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var j;for(var M in j=T.isUint8ArrayAvailable()?new Uint8Array(U.payloadBlob):b.default.base64Encode(U.payloadBlob),C)if(C.hasOwnProperty(M))for(var ue=0;ue<C[M].length;++ue)C[M][ue].sendAttempt>0?C[M][ue].sendAttempt++:C[M][ue].sendAttempt=1;if(this._useBeacons&&D&&T.isBeaconsSupported()&&navigator.sendBeacon($,j))return;this._httpInterface.sendPOST($,j,function(Z,Y){N._retryRequestIfNeeded(Z,Y,C,P,y,R,D,_)},function(Z,Y){N._retryRequestIfNeeded(Z,Y,C,P,y,R,D,_)},function(Z,Y){N._retryRequestIfNeeded(Z,Y,C,P,y,R,D,_)},D||_)}else D||this._handleRequestFinished(!1,{},D,_)}catch(Z){this._handleRequestFinished(!1,{},D,_)}},g.prototype._retryRequestIfNeeded=function(C,R,D,_,N,P,y,M){var U=this,$=!0;if(void 0!==C){if(R){var j=this._killSwitch.setKillSwitchTenants(R["kill-tokens"],R["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(R["time-delta-millis"]);for(var ue=0;ue<j.length;++ue)A.default.eventsRejected(D[j[ue]],s.AWTEventsRejectedReason.KillSwitch),delete D[j[ue]],_--}else this._clockSkewManager.setClockSkew(null);if(200===C)return void this._handleRequestFinished(!0,D,y,M);(!h.default.shouldRetryForStatus(C)||_<=0)&&($=!1)}if($)if(M)this._activeConnections--,D[N][0].priority=s.AWTEventPriority.High,this._queueManager.addBackRequest(D);else if(P<1){for(var Z in D)D.hasOwnProperty(Z)&&A.default.eventsRetrying(D[Z]);setTimeout(function(){return U._sendRequest(D,P+1,!1)},h.default.getMillisToBackoffForRetry(P))}else this._activeConnections--,I.default.backOffTransmission(),this._queueManager.addBackRequest(D);else this._handleRequestFinished(!1,D,y,M)},g.prototype._handleRequestFinished=function(C,R,D,_){for(var N in C&&I.default.clearBackOff(),R)R.hasOwnProperty(N)&&(C?A.default.eventsSent(R[N]):A.default.eventsDropped(R[N],s.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,!_&&!D&&this.sendQueuedRequests()},g.prototype._convertAllHeadersToMap=function(C){var R={};if(C)for(var D=C.split("\n"),_=0;_<D.length;++_){var N=D[_].split(": ");R[N[0]]=N[1]}return R},g}();m.default=S},7613:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(676),b=u(5640),h=u(4189),p=u(6208),E=u(4023),d=u(2551),T=u(4094),A=function(){function I(){}return I.initialize=function(f,c){if(void 0===c&&(c={}),!this._isInitialized)return this._isInitialized=!0,h.default.defaultTenantToken=f,this._overrideValuesFromConfig(c),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(h.default.sessionEnabled=!1),T.default.addPropertyStorageOverride(this._config.propertyStorageOverride),T.default.autoCollect(h.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),E.default.initialize(this._config),h.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(b.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},I.getSemanticContext=function(){return h.default.semanticContext},I.flush=function(f){this._isInitialized&&!this._isDestroyed&&E.default.flush(f)},I.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(b.AWTSessionState.Ended),E.default.flushAndTeardown(),h.default.loggingEnabled=!1,this._isDestroyed=!0)},I.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&E.default.pauseTransmission()},I.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&E.default.resumeTransmision()},I.setTransmitProfile=function(f){this._isInitialized&&!this._isDestroyed&&E.default.setTransmitProfile(f)},I.loadTransmitProfiles=function(f){this._isInitialized&&!this._isDestroyed&&E.default.loadTransmitProfiles(f)},I.setContext=function(f,c,v){void 0===v&&(v=s.AWTPropertyType.Unspecified),h.default.logManagerContext.setProperty(f,c,v)},I.setContextWithPii=function(f,c,v,S){void 0===S&&(S=s.AWTPropertyType.Unspecified),h.default.logManagerContext.setPropertyWithPii(f,c,v,S)},I.setContextWithCustomerContent=function(f,c,v,S){void 0===S&&(S=s.AWTPropertyType.Unspecified),h.default.logManagerContext.setPropertyWithCustomerContent(f,c,v,S)},I.getLogger=function(f){var c=f;return(!c||c===h.default.defaultTenantToken)&&(c=""),this._loggers[c]||(this._loggers[c]=new p.default(c)),this._loggers[c]},I.addNotificationListener=function(f){d.default.addNotificationListener(f)},I.removeNotificationListener=function(f){d.default.removeNotificationListener(f)},I._overrideValuesFromConfig=function(f){f.collectorUri&&(this._config.collectorUri=f.collectorUri),f.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=f.cacheMemorySizeLimitInNumberOfEvents),f.httpXHROverride&&f.httpXHROverride.sendPOST&&(this._config.httpXHROverride=f.httpXHROverride),f.propertyStorageOverride&&f.propertyStorageOverride.getProperty&&f.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=f.propertyStorageOverride),f.userAgent&&(this._config.userAgent=f.userAgent),f.disableCookiesUsage&&(this._config.disableCookiesUsage=f.disableCookiesUsage),f.canSendStatEvent&&(this._config.canSendStatEvent=f.canSendStatEvent),f.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=f.enableAutoUserSession),f.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=f.clockSkewRefreshDurationInMins)},I._loggers={},I._isInitialized=!1,I._isDestroyed=!1,I._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(f){return!0},clockSkewRefreshDurationInMins:0},I}();m.default=A},4189:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(58),b=u(1009),h=function(){function p(){}return p.logManagerContext=new s.default,p.sessionEnabled=!0,p.loggingEnabled=!1,p.defaultTenantToken="",p.semanticContext=new b.default(!0,p.logManagerContext),p}();m.default=h},6208:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(676),b=u(5640),h=u(58),p=u(5593),E=u(5816),d=u(2551),T=u(4023),A=u(4189),I=u(8779),f=u(1009),c=u(4094),v=function(){function S(g){this._apiKey=g,this._contextProperties=new h.default,this._semanticContext=new f.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return S.prototype.setContext=function(g,C,R){void 0===R&&(R=s.AWTPropertyType.Unspecified),this._contextProperties.setProperty(g,C,R)},S.prototype.setContextWithPii=function(g,C,R,D){void 0===D&&(D=s.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(g,C,R,D)},S.prototype.setContextWithCustomerContent=function(g,C,R,D){void 0===D&&(D=s.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(g,C,R,D)},S.prototype.getSemanticContext=function(){return this._semanticContext},S.prototype.logEvent=function(g){if(A.default.loggingEnabled){this._apiKey||(this._apiKey=A.default.defaultTenantToken,this._createInitId());var C=!0;p.isString(g)?g={name:g}:g instanceof h.default&&(g=g.getEvent(),C=!1),E.default.eventReceived(this._apiKey),S._logEvent(S._getInternalEvent(g,this._apiKey,C),this._contextProperties)}},S.prototype.logSession=function(g,C){if(A.default.sessionEnabled){var R={name:"session",type:"session",properties:{}};if(S._addPropertiesToEvent(R,C),R.priority=s.AWTEventPriority.High,g===b.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=p.newGuid(),this.setContext("Session.Id",this._sessionId),R.properties["Session.State"]="Started"}else{if(g!==b.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var D=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);R.properties["Session.Id"]=this._sessionId,R.properties["Session.State"]="Ended",R.properties["Session.Duration"]=D.toString(),R.properties["Session.DurationBucket"]=S._getSessionDurationFromTime(D),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}R.properties["Session.FirstLaunchTime"]=c.default.firstLaunchTime,this.logEvent(R)}},S.prototype.getSessionId=function(){return this._sessionId},S.prototype.logFailure=function(g,C,R,D,_){if(g&&C){var N={name:"failure",type:"failure",properties:{}};S._addPropertiesToEvent(N,_),N.properties["Failure.Signature"]=g,N.properties["Failure.Detail"]=C,R&&(N.properties["Failure.Category"]=R),D&&(N.properties["Failure.Id"]=D),N.priority=s.AWTEventPriority.High,this.logEvent(N)}},S.prototype.logPageView=function(g,C,R,D,_,N){if(g&&C){var P={name:"pageview",type:"pageview",properties:{}};S._addPropertiesToEvent(P,N),P.properties["PageView.Id"]=g,P.properties["PageView.Name"]=C,R&&(P.properties["PageView.Category"]=R),D&&(P.properties["PageView.Uri"]=D),_&&(P.properties["PageView.ReferrerUri"]=_),this.logEvent(P)}},S.prototype._createInitId=function(){!S._initIdMap[this._apiKey]&&this._apiKey&&(S._initIdMap[this._apiKey]=p.newGuid())},S._addPropertiesToEvent=function(g,C){if(C)for(var R in C instanceof h.default&&(C=C.getEvent()),C.name&&(g.name=C.name),C.priority&&(g.priority=C.priority),C.properties)C.properties.hasOwnProperty(R)&&(g.properties[R]=C.properties[R])},S._getSessionDurationFromTime=function(g){return g<0?"Undefined":g<=3?"UpTo3Sec":g<=10?"UpTo10Sec":g<=30?"UpTo30Sec":g<=60?"UpTo60Sec":g<=180?"UpTo3Min":g<=600?"UpTo10Min":g<=1800?"UpTo30Min":"Above30Min"},S._logEvent=function(g,C){g.name&&p.isString(g.name)?(g.name=g.name.toLowerCase(),g.name=g.name.replace(p.EventNameDotRegex,"_"),g.type=g.type&&p.isString(g.type)?g.type.toLowerCase():"custom",p.EventNameAndTypeRegex.test(g.name)&&p.EventNameAndTypeRegex.test(g.type)?((!p.isNumber(g.timestamp)||g.timestamp<0)&&(g.timestamp=(new Date).getTime()),g.properties||(g.properties={}),this._addContextIfAbsent(g,C.getPropertyMap()),this._addContextIfAbsent(g,A.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(g,"EventInfo.InitId",this._getInitId(g.apiKey)),this._setDefaultProperty(g,"EventInfo.Sequence",this._getSequenceId(g.apiKey)),this._setDefaultProperty(g,"EventInfo.SdkVersion",I.FullVersionString),this._setDefaultProperty(g,"EventInfo.Name",g.name),this._setDefaultProperty(g,"EventInfo.Time",new Date(g.timestamp).toISOString()),p.isPriority(g.priority)||(g.priority=s.AWTEventPriority.Normal),this._sendEvent(g)):d.default.eventsRejected([g],s.AWTEventsRejectedReason.InvalidEvent)):d.default.eventsRejected([g],s.AWTEventsRejectedReason.InvalidEvent)},S._addContextIfAbsent=function(g,C){if(C)for(var R in C)C.hasOwnProperty(R)&&(g.properties[R]||(g.properties[R]=C[R]))},S._setDefaultProperty=function(g,C,R){g.properties[C]={value:R,pii:s.AWTPiiKind.NotSet,type:s.AWTPropertyType.String}},S._sendEvent=function(g){T.default.sendEvent(g)},S._getInternalEvent=function(g,C,R){if(g.properties=g.properties||{},R)for(var D in g.properties)g.properties.hasOwnProperty(D)&&(g.properties[D]=p.sanitizeProperty(D,g.properties[D]),null===g.properties[D]&&delete g.properties[D]);var _=g;return _.id=p.newGuid(),_.apiKey=C,_},S._getInitId=function(g){return S._initIdMap[g]},S._getSequenceId=function(g){return void 0===S._sequenceIdMap[g]&&(S._sequenceIdMap[g]=0),(++S._sequenceIdMap[g]).toString()},S._sequenceIdMap={},S._initIdMap={},S}();m.default=v},4220:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(676),b=u(9449),h=u(4023),p=u(2659),E=u(2551),d=u(5593),f=function(){function c(v,S,g,C){this._queueSizeLimit=S,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[s.AWTEventPriority.High]=[],this._inboundQueues[s.AWTEventPriority.Normal]=[],this._inboundQueues[s.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new p.default(this._outboundQueue,500),this._httpManager=new b.default(this._outboundQueue,v,this,g,C)}return c.prototype.addEvent=function(v){d.isPriority(v.priority)||(v.priority=s.AWTEventPriority.Normal),v.priority===s.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(v),v.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(v.priority)?this._addEventToProperQueue(v):E.default.eventsDropped([v],s.AWTEventsDroppedReason.QueueFull)},c.prototype.sendEventsForPriorityAndAbove=function(v){this._batchEvents(v),this._httpManager.sendQueuedRequests()},c.prototype.hasEvents=function(){return(this._inboundQueues[s.AWTEventPriority.High][0].length>0||this._inboundQueues[s.AWTEventPriority.Normal][0].length>0||this._inboundQueues[s.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},c.prototype.addBackRequest=function(v){if(!this._paused||!this._shouldDropEventsOnPause){for(var S in v)if(v.hasOwnProperty(S))for(var g=0;g<v[S].length;++g)v[S][g].sendAttempt<6?this.addEvent(v[S][g]):E.default.eventsDropped([v[S][g]],s.AWTEventsDroppedReason.MaxRetryLimit);h.default.scheduleTimer()}},c.prototype.teardown=function(){this._paused||(this._batchEvents(s.AWTEventPriority.Low),this._httpManager.teardown())},c.prototype.uploadNow=function(v){var S=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(v):(this._isCurrentlyUploadingNow=!0,setTimeout(function(){return S._uploadNow(v)},0))},c.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this._shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[s.AWTEventPriority.High][0].length+this._inboundQueues[s.AWTEventPriority.Normal][0].length+this._inboundQueues[s.AWTEventPriority.Low][0].length,this._inboundQueues[s.AWTEventPriority.High][0]=[],this._inboundQueues[s.AWTEventPriority.Normal][0]=[],this._inboundQueues[s.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},c.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},c.prototype.shouldDropEventsOnPause=function(v){this._shouldDropEventsOnPause=v},c.prototype._removeFirstQueues=function(){this._inboundQueues[s.AWTEventPriority.High].shift(),this._inboundQueues[s.AWTEventPriority.Normal].shift(),this._inboundQueues[s.AWTEventPriority.Low].shift()},c.prototype._addEmptyQueues=function(){this._inboundQueues[s.AWTEventPriority.High].push([]),this._inboundQueues[s.AWTEventPriority.Normal].push([]),this._inboundQueues[s.AWTEventPriority.Low].push([])},c.prototype._addEventToProperQueue=function(v){(!this._paused||!this._shouldDropEventsOnPause)&&(this._queueSize++,this._inboundQueues[v.priority][this._inboundQueues[v.priority].length-1].push(v))},c.prototype._dropEventWithPriorityOrLess=function(v){for(var S=s.AWTEventPriority.Low;S<=v;){if(this._inboundQueues[S][this._inboundQueues[S].length-1].length>0)return E.default.eventsDropped([this._inboundQueues[S][this._inboundQueues[S].length-1].shift()],s.AWTEventsDroppedReason.QueueFull),!0;S++}return!1},c.prototype._batchEvents=function(v){for(var S=s.AWTEventPriority.High;S>=v;){for(;this._inboundQueues[S][0].length>0;){var g=this._inboundQueues[S][0].pop();this._queueSize--,this._batcher.addEventToBatch(g)}S--}this._batcher.flushBatch()},c.prototype._uploadNow=function(v){var S=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(s.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent(function(){S._removeFirstQueues(),null!=v&&v(),S._uploadNowQueue.length>0?setTimeout(function(){return S._uploadNow(S._uploadNowQueue.shift())},0):(S._isCurrentlyUploadingNow=!1,S.hasEvents()&&h.default.scheduleTimer())})},c.prototype._checkOutboundQueueEmptyAndSent=function(v){var S=this;this._httpManager.isCompletelyIdle()?v():setTimeout(function(){return S._checkOutboundQueueEmptyAndSent(v)},250)},c}();m.default=f},1009:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(4094),b=u(676),h=u(5640),p="UserInfo.IdType",E=function(){function d(T,A){this._allowDeviceFields=T,this._properties=A}return d.prototype.setAppId=function(T){this._addContext("AppInfo.Id",T)},d.prototype.setAppVersion=function(T){this._addContext("AppInfo.Version",T)},d.prototype.setAppLanguage=function(T){this._addContext("AppInfo.Language",T)},d.prototype.setDeviceId=function(T){this._allowDeviceFields&&(s.default.checkAndSaveDeviceId(T),this._addContext("DeviceInfo.Id",T))},d.prototype.setDeviceOsName=function(T){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",T)},d.prototype.setDeviceOsVersion=function(T){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",T)},d.prototype.setDeviceBrowserName=function(T){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",T)},d.prototype.setDeviceBrowserVersion=function(T){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",T)},d.prototype.setDeviceMake=function(T){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",T)},d.prototype.setDeviceModel=function(T){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",T)},d.prototype.setUserId=function(T,A,I){if(!isNaN(I)&&null!==I&&I>=0&&I<=12)this._addContext(p,I.toString());else{var f=void 0;switch(A){case b.AWTPiiKind.SipAddress:f=h.AWTUserIdType.SipAddress;break;case b.AWTPiiKind.PhoneNumber:f=h.AWTUserIdType.PhoneNumber;break;case b.AWTPiiKind.SmtpAddress:f=h.AWTUserIdType.EmailAddress;break;default:f=h.AWTUserIdType.Unknown}this._addContext(p,f.toString())}if(isNaN(A)||null===A||A===b.AWTPiiKind.NotSet||A>13)switch(I){case h.AWTUserIdType.Skype:A=b.AWTPiiKind.Identity;break;case h.AWTUserIdType.EmailAddress:A=b.AWTPiiKind.SmtpAddress;break;case h.AWTUserIdType.PhoneNumber:A=b.AWTPiiKind.PhoneNumber;break;case h.AWTUserIdType.SipAddress:A=b.AWTPiiKind.SipAddress;break;default:A=b.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",T,A)},d.prototype.setUserAdvertisingId=function(T){this._addContext("UserInfo.AdvertisingId",T)},d.prototype.setUserTimeZone=function(T){this._addContext("UserInfo.TimeZone",T)},d.prototype.setUserLanguage=function(T){this._addContext("UserInfo.Language",T)},d.prototype._addContext=function(T,A){"string"==typeof A&&this._properties.setProperty(T,A)},d.prototype._addContextWithPii=function(T,A,I){"string"==typeof A&&this._properties.setPropertyWithPii(T,A,I)},d}();m.default=E},2621:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(4023),b=function(){function h(){}return h.setEventsHandler=function(p){s.default.setEventsHandler(p)},h.getEventsHandler=function(){return s.default.getEventsHandler()},h.scheduleTimer=function(){s.default.scheduleTimer()},h}();m.default=b},4023:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(1842),b=u(676),h=u(4220),p=u(5816),E=u(58),d=u(7613),T=u(5593),f="awt_stats",c=function(){function v(){}return v.setEventsHandler=function(S){this._eventHandler=S},v.getEventsHandler=function(){return this._eventHandler},v.scheduleTimer=function(){var S=this,g=this._profiles[this._currentProfile][2];this._timeout<0&&g>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===g&&this._currentBackoffCount>0&&(g=1),this._timeout=setTimeout(function(){return S._batchAndSendEvents()},g*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},v.initialize=function(S){var g=this;this._newEventsAllowed=!0,this._config=S,this._eventHandler=new h.default(S.collectorUri,S.cacheMemorySizeLimitInNumberOfEvents,S.httpXHROverride,S.clockSkewRefreshDurationInMins),this._initializeProfiles(),p.default.initialize(function(C,R){if(g._config.canSendStatEvent(f)){var D=new E.default(f);for(var _ in D.setEventPriority(b.AWTEventPriority.High),D.setProperty("TenantId",R),C)C.hasOwnProperty(_)&&D.setProperty(_,C[_].toString());d.default.getLogger(T.StatsApiKey).logEvent(D)}})},v.setTransmitProfile=function(S){this._currentProfile!==S&&void 0!==this._profiles[S]&&(this.clearTimeout(),this._currentProfile=S,this.scheduleTimer())},v.loadTransmitProfiles=function(S){for(var g in this._resetTransmitProfiles(),S)if(S.hasOwnProperty(g)){if(3!==S[g].length)continue;for(var C=2;C>=0;--C)if(S[g][C]<0){for(var R=C;R>=0;--R)S[g][R]=-1;break}for(C=2;C>0;--C)S[g][C]>0&&S[g][C-1]>0&&(S[g][C-1]=Math.ceil(S[g][C-1]/S[g][C])*S[g][C]);this._profiles[g]=S[g]}},v.sendEvent=function(S){this._newEventsAllowed&&(this._currentBackoffCount>0&&S.priority===b.AWTEventPriority.Immediate_sync&&(S.priority=b.AWTEventPriority.High),this._eventHandler.addEvent(S),this.scheduleTimer())},v.flush=function(S){var g=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<g&&(this._lastUploadNowCall=g,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(S))},v.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},v.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},v.flushAndTeardown=function(){p.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},v.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},v.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},v._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=s.AWT_REAL_TIME,this.scheduleTimer()},v.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},v._batchAndSendEvents=function(){var S=b.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(S=b.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(S=b.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(S),this._timeout=-1,this.scheduleTimer()},v._initializeProfiles=function(){this._profiles={},this._profiles[s.AWT_REAL_TIME]=[4,2,1],this._profiles[s.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[s.AWT_BEST_EFFORT]=[36,18,9]},v._newEventsAllowed=!1,v._currentProfile=s.AWT_REAL_TIME,v._timeout=-1,v._currentBackoffCount=0,v._paused=!1,v._timerCount=0,v._lastUploadNowCall=0,v}();m.default=c},5234:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(676);m.AWTPropertyType=s.AWTPropertyType,m.AWTPiiKind=s.AWTPiiKind,m.AWTEventPriority=s.AWTEventPriority,m.AWTEventsDroppedReason=s.AWTEventsDroppedReason,m.AWTEventsRejectedReason=s.AWTEventsRejectedReason,m.AWTCustomerContentKind=s.AWTCustomerContentKind;var b=u(5640);m.AWTUserIdType=b.AWTUserIdType,m.AWTSessionState=b.AWTSessionState;var h=u(1842);m.AWT_BEST_EFFORT=h.AWT_BEST_EFFORT,m.AWT_NEAR_REAL_TIME=h.AWT_NEAR_REAL_TIME,m.AWT_REAL_TIME=h.AWT_REAL_TIME;var p=u(58);m.AWTEventProperties=p.default;var E=u(6208);m.AWTLogger=E.default;var d=u(7613);m.AWTLogManager=d.default;var T=u(2621);m.AWTTransmissionManager=T.default;var A=u(6064);m.AWTSerializer=A.default;var I=u(1009);m.AWTSemanticContext=I.default,m.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",m.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",m.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",m.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",m.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",m.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",m.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},1842:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.AWT_REAL_TIME="REAL_TIME",m.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",m.AWT_BEST_EFFORT="BEST_EFFORT"},5640:(Q,m)=>{"use strict";var b;Object.defineProperty(m,"__esModule",{value:!0}),(b=m.AWTUserIdType||(m.AWTUserIdType={}))[b.Unknown=0]="Unknown",b[b.MSACID=1]="MSACID",b[b.MSAPUID=2]="MSAPUID",b[b.ANID=3]="ANID",b[b.OrgIdCID=4]="OrgIdCID",b[b.OrgIdPUID=5]="OrgIdPUID",b[b.UserObjectId=6]="UserObjectId",b[b.Skype=7]="Skype",b[b.Yammer=8]="Yammer",b[b.EmailAddress=9]="EmailAddress",b[b.PhoneNumber=10]="PhoneNumber",b[b.SipAddress=11]="SipAddress",b[b.MUID=12]="MUID",function(b){b[b.Started=0]="Started",b[b.Ended=1]="Ended"}(m.AWTSessionState||(m.AWTSessionState={}))},8779:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.Version="1.8.7",m.FullVersionString="AWT-Web-JS-"+m.Version},5436:(Q,m,u)=>{"use strict";m.Mg=void 0;u(3762),u(8290),u(9425);u(2900);u(6194);u(448),u(3372);var I=u(7626);m.Mg=I.default,u(4352)},2235:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(c){for(var v,S=1,g=arguments.length;S<g;S++)for(var C in v=arguments[S])Object.prototype.hasOwnProperty.call(v,C)&&(c[C]=v[C]);return c}).apply(this,arguments)};Object.defineProperty(m,"__esModule",{value:!0});var b=u(4151),h=u(676),p=u(5234),E=u(7095),d=u(3037),T=u(4151),A=u(8098),I=(()=>((I||(I={})).ReactNative="ReactNative",I))(),f=function(){function c(){}return c.initialize=function(v){this._debug&&console.log("[AriaTelemetry][logger][initialize][custom]"),c._logger=p.AWTLogManager.initialize(v)},c.setDebug=function(v){c._debug=v},c.disable=function(){this._debug&&console.log("[AriaTelemetry][disable]"),c._disable=!0},c.setCDNPackages=function(v){c._CDNPackagesInfo=s(s({},c._CDNPackagesInfo),v)},c.info=function(v,S){var g;void 0===S&&(S=d.default.EVENTS);var C={name:d.default.EVENTS,properties:s(s(s(s(s({},c.populateBaseProperties()),c.fillWebPlatformData()),c.fillMobilePlatformData()),v),{LogLevel:E.default.INFO}),priority:h.AWTEventPriority.High};S==d.default.IC3CLIENT&&(C={name:d.default.IC3CLIENT,properties:s(s(s({},c.populateIC3ClientBaseProperties()),v),{LogLevel:E.default.INFO}),priority:h.AWTEventPriority.High}),S==d.default.OCSDK&&(C={name:d.default.OCSDK,properties:s(s(s({},c.populateOCSDKBaseProperties()),v),{LogLevel:E.default.INFO}),priority:h.AWTEventPriority.High}),S==d.default.ACSCLIENT&&(C={name:d.default.ACSCLIENT,properties:s(s(s({},c.populateACSClientBaseProperties()),v),{LogLevel:E.default.INFO}),priority:h.AWTEventPriority.High}),S==d.default.ACSADAPTER&&(C={name:d.default.ACSADAPTER,properties:s(s(s({},c.populateACSAdapterBaseProperties()),v),{LogLevel:E.default.INFO}),priority:h.AWTEventPriority.High}),S==d.default.CALLINGSDK&&(C={name:d.default.CALLINGSDK,properties:s(s(s({},c.populateCallingSDKBaseProperties()),v),{LogLevel:E.default.INFO}),priority:h.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][info] "+S),this._debug&&console.log(C),this._debug&&console.log(C.properties.Event),!c._disable&&(null===(g=c.logger)||void 0===g||g.logEvent(C))},c.debug=function(v,S){var g;void 0===S&&(S=d.default.EVENTS);var C={name:d.default.EVENTS,properties:s(s(s(s(s({},c.populateBaseProperties()),c.fillWebPlatformData()),c.fillMobilePlatformData()),v),{LogLevel:E.default.DEBUG}),priority:h.AWTEventPriority.High};S==d.default.IC3CLIENT&&(C={name:d.default.IC3CLIENT,properties:s(s(s({},c.populateIC3ClientBaseProperties()),v),{LogLevel:E.default.DEBUG}),priority:h.AWTEventPriority.High}),S==d.default.OCSDK&&(C={name:d.default.OCSDK,properties:s(s(s({},c.populateOCSDKBaseProperties()),v),{LogLevel:E.default.DEBUG}),priority:h.AWTEventPriority.High}),S==d.default.ACSCLIENT&&(C={name:d.default.ACSCLIENT,properties:s(s(s({},c.populateACSClientBaseProperties()),v),{LogLevel:E.default.DEBUG}),priority:h.AWTEventPriority.High}),S==d.default.ACSADAPTER&&(C={name:d.default.ACSADAPTER,properties:s(s(s({},c.populateACSAdapterBaseProperties()),v),{LogLevel:E.default.DEBUG}),priority:h.AWTEventPriority.High}),S==d.default.CALLINGSDK&&(C={name:d.default.CALLINGSDK,properties:s(s(s({},c.populateCallingSDKBaseProperties()),v),{LogLevel:E.default.DEBUG}),priority:h.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][debug] "+S),this._debug&&console.log(C),this._debug&&console.log(C.properties.Event),!c._disable&&(null===(g=c.logger)||void 0===g||g.logEvent(C))},c.warn=function(v,S){var g;void 0===S&&(S=d.default.EVENTS);var C={name:d.default.EVENTS,properties:s(s(s(s(s({},c.populateBaseProperties()),c.fillWebPlatformData()),c.fillMobilePlatformData()),v),{LogLevel:E.default.WARN}),priority:h.AWTEventPriority.High};S==d.default.IC3CLIENT&&(C={name:d.default.IC3CLIENT,properties:s(s(s({},c.populateIC3ClientBaseProperties()),v),{LogLevel:E.default.WARN}),priority:h.AWTEventPriority.High}),S==d.default.OCSDK&&(C={name:d.default.OCSDK,properties:s(s(s({},c.populateOCSDKBaseProperties()),v),{LogLevel:E.default.WARN}),priority:h.AWTEventPriority.High}),S==d.default.ACSCLIENT&&(C={name:d.default.ACSCLIENT,properties:s(s(s({},c.populateACSClientBaseProperties()),v),{LogLevel:E.default.WARN}),priority:h.AWTEventPriority.High}),S==d.default.ACSADAPTER&&(C={name:d.default.ACSADAPTER,properties:s(s(s({},c.populateACSAdapterBaseProperties()),v),{LogLevel:E.default.WARN}),priority:h.AWTEventPriority.High}),S==d.default.CALLINGSDK&&(C={name:d.default.CALLINGSDK,properties:s(s(s({},c.populateCallingSDKBaseProperties()),v),{LogLevel:E.default.WARN}),priority:h.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][warn] "+S),this._debug&&console.log(C),this._debug&&console.log(C.properties.Event),!c._disable&&(null===(g=c.logger)||void 0===g||g.logEvent(C))},c.error=function(v,S){var g;void 0===S&&(S=d.default.EVENTS);var C={name:d.default.EVENTS,properties:s(s(s(s(s({},c.populateBaseProperties()),c.fillWebPlatformData()),c.fillMobilePlatformData()),v),{LogLevel:E.default.ERROR}),priority:h.AWTEventPriority.High};S==d.default.IC3CLIENT&&(C={name:d.default.IC3CLIENT,properties:s(s(s({},c.populateIC3ClientBaseProperties()),v),{LogLevel:E.default.ERROR}),priority:h.AWTEventPriority.High}),S==d.default.OCSDK&&(C={name:d.default.OCSDK,properties:s(s(s({},c.populateOCSDKBaseProperties()),v),{LogLevel:E.default.ERROR}),priority:h.AWTEventPriority.High}),S==d.default.ACSCLIENT&&(C={name:d.default.ACSCLIENT,properties:s(s(s({},c.populateACSClientBaseProperties()),v),{LogLevel:E.default.ERROR}),priority:h.AWTEventPriority.High}),S==d.default.ACSADAPTER&&(C={name:d.default.ACSADAPTER,properties:s(s(s({},c.populateACSAdapterBaseProperties()),v),{LogLevel:E.default.ERROR}),priority:h.AWTEventPriority.High}),S==d.default.CALLINGSDK&&(C={name:d.default.CALLINGSDK,properties:s(s(s({},c.populateCallingSDKBaseProperties()),v),{LogLevel:E.default.ERROR}),priority:h.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][error] "+S),this._debug&&console.log(C),this._debug&&console.log(C.properties.Event),!c._disable&&(null===(g=c.logger)||void 0===g||g.logEvent(C))},c.log=function(v,S){var g;void 0===S&&(S=d.default.EVENTS);var C={name:d.default.EVENTS,properties:s(s(s(s(s({},c.populateBaseProperties()),c.fillWebPlatformData()),c.fillMobilePlatformData()),v),{LogLevel:E.default.LOG}),priority:h.AWTEventPriority.High};S==d.default.IC3CLIENT&&(C={name:d.default.IC3CLIENT,properties:s(s(s({},c.populateIC3ClientBaseProperties()),v),{LogLevel:E.default.LOG}),priority:h.AWTEventPriority.High}),S==d.default.OCSDK&&(C={name:d.default.OCSDK,properties:s(s(s({},c.populateOCSDKBaseProperties()),v),{LogLevel:E.default.LOG}),priority:h.AWTEventPriority.High}),S==d.default.ACSCLIENT&&(C={name:d.default.ACSCLIENT,properties:s(s(s({},c.populateACSClientBaseProperties()),v),{LogLevel:E.default.LOG}),priority:h.AWTEventPriority.High}),S==d.default.ACSADAPTER&&(C={name:d.default.ACSADAPTER,properties:s(s(s({},c.populateACSAdapterBaseProperties()),v),{LogLevel:E.default.LOG}),priority:h.AWTEventPriority.High}),S==d.default.CALLINGSDK&&(C={name:d.default.CALLINGSDK,properties:s(s(s({},c.populateCallingSDKBaseProperties()),v),{LogLevel:E.default.LOG}),priority:h.AWTEventPriority.High}),this._debug&&console.log("[AriaTelemetry][log]"),this._debug&&console.log(C),this._debug&&console.log(C.properties.Event),!c._disable&&(null===(g=c.logger)||void 0===g||g.logEvent(C))},Object.defineProperty(c,"logger",{get:function(){return c._logger||(this._debug&&console.log("[AriaTelemetry][logger][initialize]"),c._logger=p.AWTLogManager.initialize(b.ariaTelemetryKey)),c._logger},enumerable:!1,configurable:!0}),c.populateBaseProperties=function(){var v={OCSDK:u(1528).i8,IC3Core:u(5233).i8,ACSChat:u(2861).i8,ACSCommon:u(6638).i8,AMSClient:u(5500).i8};return{ChatSDKRuntimeId:"",OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",CallId:"",Domain:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",ChatSDKVersion:u(8464).i8,NPMPackagesInfo:JSON.stringify(v),CDNPackagesInfo:JSON.stringify(c._CDNPackagesInfo),PlatformDetails:""}},c.fillMobilePlatformData=function(){var v={},S={};if(!A.isReactNative())return v;try{var C=u(Object(function(){var D=new Error("Cannot find module 'react-native'");throw D.code="MODULE_NOT_FOUND",D}())).Platform;S.Renderer=I.ReactNative,v.DeviceInfo_OsVersion=C.Version,S.DeviceInfo_OsVersion=C.Version,"android"===C.OS.toLowerCase()?(v.DeviceInfo_OsName="Android",S.DeviceInfo_OsName="Android"):"ios"===C.OS.toLowerCase()?(v.DeviceInfo_OsName="iOS",S.DeviceInfo_OsName="iOS"):(v.DeviceInfo_OsName=""+C.OS,S.DeviceInfo_OsName=""+C.OS),this._debug&&console.log("[AriaTelemetry][fillMobilePlatformData]["+v.DeviceInfo_OsName+"]")}catch(R){this._debug&&console.log("[AriaTelemetry][fillMobilePlatformData][Web]")}return v.PlatformDetails=JSON.stringify(S),v},c.fillWebPlatformData=function(){var v={};if(!A.isBrowser())return v;try{v.Domain=window.location.origin||"",this._debug&&console.log("[AriaTelemetry][fillWebPlatformData]")}catch(S){this._debug&&console.log("[AriaTelemetry][fillWebPlatformData][Error]")}return v},c.populateIC3ClientBaseProperties=function(){return{ChatSDKRuntimeId:"",OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",Event:"",Description:"",SubscriptionId:"",EndpointId:"",EndpointUrl:"",ErrorCode:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",IC3ClientVersion:T.ic3ClientVersion}},c.populateOCSDKBaseProperties=function(){return{ChatSDKRuntimeId:"",OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",TransactionId:"",Event:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",OCSDKVersion:u(1528).i8}},c.populateACSClientBaseProperties=function(){return{ChatSDKRuntimeId:"",OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",Event:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",ACSChatVersion:u(2861).i8}},c.populateACSAdapterBaseProperties=function(){return{ChatSDKRuntimeId:"",OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",Event:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:"",ACSAdapterVersion:T.webChatACSAdapterVersion}},c.populateCallingSDKBaseProperties=function(){return{ChatSDKRuntimeId:"",OrgId:"",OrgUrl:"",WidgetId:"",RequestId:"",ChatId:"",CallId:"",Event:"",Description:"",ExceptionDetails:"",ElapsedTimeInMilliseconds:""}},c._debug=!1,c._disable=!1,c}();m.default=f},9066:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.failEvent=m.completeEvent=m.startEvent=void 0,m.startEvent=function(u){return u+"Started"},m.completeEvent=function(u){return u+"Completed"},m.failEvent=function(u){return u+"Failed"}},7095:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR",s.LOG="LOG",u;var s})();m.default=u},1247:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(d){for(var T,A=1,I=arguments.length;A<I;A++)for(var f in T=arguments[A])Object.prototype.hasOwnProperty.call(T,f)&&(d[f]=T[f]);return d}).apply(this,arguments)};Object.defineProperty(m,"__esModule",{value:!0});var b=u(3037),h=u(8485),p=u(9066),E=function(){function d(T){this.omnichannelConfig=T,this.runtimeId="",this.telemetry=null,this.debug=!1,this.telemetryEvents=new Map,this.scenarioType=b.default.EVENTS}return d.prototype.setDebug=function(T){var A;this.debug=T,null===(A=this.telemetry)||void 0===A||A.setDebug(T)},d.prototype.setScenarioType=function(T){this.scenarioType=T},d.prototype.setRuntimeId=function(T){this.runtimeId=T},d.prototype.useTelemetry=function(T){this.debug&&console.log("[ScenarioMarker][useTelemetry]"),this.telemetry=T},d.prototype.startScenario=function(T,A){var I;if(void 0===A&&(A={}),this.debug&&console.log("[ScenarioMarker][startScenario]"),!this.telemetryEvents.has(T)){var f=new h.default;f.start(),this.telemetryEvents.set(T,f)}var c=s({ChatSDKRuntimeId:this.runtimeId,Event:p.startEvent(T),OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId},A);null===(I=this.telemetry)||void 0===I||I.info(c,this.scenarioType)},d.prototype.failScenario=function(T,A){var I;if(void 0===A&&(A={}),this.debug&&console.log("[ScenarioMarker][failScenario]"),this.telemetryEvents.has(T)){var f=this.telemetryEvents.get(T);this.telemetryEvents.delete(T);var c=s({ChatSDKRuntimeId:this.runtimeId,Event:p.failEvent(T),OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,ElapsedTimeInMilliseconds:f.stop()},A);null===(I=this.telemetry)||void 0===I||I.error(c,this.scenarioType)}else console.warn("'"+T+"' event has not started.")},d.prototype.completeScenario=function(T,A){var I;if(void 0===A&&(A={}),this.debug&&console.log("[ScenarioMarker][completeScenario]"),this.telemetryEvents.has(T)){var f=this.telemetryEvents.get(T);this.telemetryEvents.delete(T);var c=s({ChatSDKRuntimeId:this.runtimeId,Event:p.completeEvent(T),OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,ElapsedTimeInMilliseconds:f.stop()},A);null===(I=this.telemetry)||void 0===I||I.info(c,this.scenarioType)}else console.warn("'"+T+"' event has not started.")},d}();m.default=E},3037:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).EVENTS="occhatsdk_events",s.IC3CLIENT="occhatsdk_ic3clientevents",s.OCSDK="occhatsdk_ocsdkevents",s.ACSCLIENT="occhatsdk_acsclientevents",s.ACSADAPTER="occhatsdk_acsadapterevents",s.CALLINGSDK="occhatsdk_callingsdkevents",s.UNDEFINED="undefined",u;var s})();m.default=u},8485:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.prototype.start=function(){this.timeStart=(new Date).getTime()},s.prototype.stop=function(){return(new Date).getTime()-this.timeStart},s}();m.default=u},9600:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).ValidateOmnichannelConfig="ValidateOmnichannelConfig",s.ValidateSDKConfig="ValidateSDKConfig",s.InitializeChatSDK="InitializeChatSDK",s.StartChat="StartChat",s.EndChat="EndChat",s.GetLiveChatConfig="GetLiveChatConfig",s.GetAuthToken="GetAuthToken",s.GetPreChatSurvey="GetPreChatSurvey",s.GetChatToken="GetChatToken",s.GetConversationDetails="GetConversationDetails",s.GetCurrentLiveChatContext="GetCurrentLiveChatContext",s.GetMessages="GetMessages",s.SendMessages="SendMessages",s.SendTypingEvent="SendTypingEvent",s.OnAgentEndSession="OnAgentEndSession",s.OnNewMessage="OnNewMessage",s.OnTypingEvent="OnTypingEvent",s.UploadFileAttachment="UploadFileAttachment",s.DownloadFileAttachment="DownloadFileAttachment",s.EmailLiveChatTranscript="EmailLiveChatTranscript",s.GetLiveChatTranscript="GetLiveChatTranscript",s.CreateIC3Adapter="CreateChatAdapter",s.CreateACSAdapter="CreateACSAdapter",s.GetVoiceVideoCalling="GetVoiceVideoCalling",s.GetIC3Client="GetIC3Client",s.InitializeVoiceVideoCallingSDK="InitializeVoiceVideoCallingSDK",s.AcceptVoiceCall="AcceptVoiceCall",s.AcceptVideoCall="AcceptVideoCall",s.RejectCall="RejectCall",s.StopCall="StopCall",s.OnCallDisconnected="OnCallDisconnected",s.UpdateChatToken="UpdateChatToken",s.GetChatReconnectContext="GetChatReconnectContext",s.GetPostChatSurveyContext="GetPostChatSurveyContext",u;var s})();m.default=u},6345:function(Q,m){"use strict";var u=this&&this.__awaiter||function(p,E,d,T){return new(d||(d=Promise))(function(I,f){function c(g){try{S(T.next(g))}catch(C){f(C)}}function v(g){try{S(T.throw(g))}catch(C){f(C)}}function S(g){g.done?I(g.value):function(I){return I instanceof d?I:new d(function(f){f(I)})}(g.value).then(c,v)}S((T=T.apply(p,E||[])).next())})},s=this&&this.__generator||function(p,E){var T,A,I,f,d={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]};return f={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function c(S){return function(g){return function(S){if(T)throw new TypeError("Generator is already executing.");for(;d;)try{if(T=1,A&&(I=2&S[0]?A.return:S[0]?A.throw||((I=A.return)&&I.call(A),0):A.next)&&!(I=I.call(A,S[1])).done)return I;switch(A=0,I&&(S=[2&S[0],I.value]),S[0]){case 0:case 1:I=S;break;case 4:return d.label++,{value:S[1],done:!1};case 5:d.label++,A=S[1],S=[0];continue;case 7:S=d.ops.pop(),d.trys.pop();continue;default:if(!(I=(I=d.trys).length>0&&I[I.length-1])&&(6===S[0]||2===S[0])){d=0;continue}if(3===S[0]&&(!I||S[1]>I[0]&&S[1]<I[3])){d.label=S[1];break}if(6===S[0]&&d.label<I[1]){d.label=I[1],I=S;break}if(I&&d.label<I[2]){d.label=I[2],d.ops.push(S);break}I[2]&&d.ops.pop(),d.trys.pop();continue}S=E.call(p,d)}catch(g){S=[6,g],A=0}finally{T=I=0}if(5&S[0])throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}([S,g])}}};Object.defineProperty(m,"__esModule",{value:!0}),m.removeElementById=m.loadScript=void 0;var b=function(p,E,d){return void 0===E&&(E=function(){}),void 0===d&&(d=function(){}),u(void 0,void 0,void 0,function(){return s(this,function(T){return[2,new Promise(function(A,I){return u(void 0,void 0,void 0,function(){var v;return s(this,function(S){switch(S.label){case 0:return Array.from(document.getElementsByTagName("script")).filter(function(g){return g.src==p}).length?[4,E()]:[3,2];case 1:return S.sent(),[2,A()];case 2:return(v=document.createElement("script")).setAttribute("src",p),v.setAttribute("type","text/javascript"),document.head.appendChild(v),v.addEventListener("load",function(){return u(void 0,void 0,void 0,function(){return s(this,function(g){switch(g.label){case 0:return[4,E()];case 1:return g.sent(),A(),[2]}})})}),v.addEventListener("error",function(){return u(void 0,void 0,void 0,function(){return s(this,function(g){switch(g.label){case 0:return[4,d()];case 1:return g.sent(),I(),[2]}})})}),[2]}})})})]})})};m.loadScript=b;var h=function(p){var E;null===(E=document.getElementById(p))||void 0===E||E.remove()};m.removeElementById=h,m.default={loadScript:b,removeElementById:h}},9340:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(E){for(var d,T=1,A=arguments.length;T<A;T++)for(var I in d=arguments[T])Object.prototype.hasOwnProperty.call(d,I)&&(E[I]=d[I]);return E}).apply(this,arguments)};Object.defineProperty(m,"__esModule",{value:!0});var b=u(8191),h=u(3709);m.default=function(E,d){var T={};if(T.liveChatVersion=d.liveChatVersion||b.default.V1,d.debug&&console.log(E),d.liveChatVersion===b.default.V2){var f=E.content,c=E.metadata,v=E.sender,S=E.senderDisplayName,g=E.createdOn;if(T.id=E.id,T.messageid=void 0,T.clientmessageid=void 0,T.deliveryMode=void 0,T.properties={},T.content=f||"",T.properties.tags=c&&c.tags?c.tags:[],T.tags=c&&c.tags?c.tags.replace(/\"/g,"").split(",").filter(function(N){return N.length>0}):[],T.timestamp=g,T.messageType=h.MessageType.UserMessage,T.sender={id:v.communicationUserId,displayName:S,type:h.PersonType.Bot},c&&c.amsMetadata&&c.amsReferences)try{var C=JSON.parse(c.amsReferences),D=JSON.parse(c.amsMetadata)[0].fileName;T.fileMetadata={},T.fileMetadata.fileSharingProtocolType=0,T.fileMetadata.id=C[0],T.fileMetadata.name=D,T.fileMetadata.size=0,T.fileMetadata.type=D.split(".").pop(),T.fileMetadata.url=""}catch(N){}}else T.id=E.clientmessageid,T=s({},E);return T}},838:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(2235);m.default=function(h){return void 0===h&&(h=!1),s.default.setDebug(h),s.default}},1775:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.getACSAdapterCDNUrl=m.getIC3AdapterCDNUrl=m.getIC3ClientCDNUrl=void 0;var s=u(4151),b=function(E){return void 0===E&&(E=s.ic3ClientVersion),"https://comms.omnichannelengagementhub.com/release/"+E+"/Scripts/SDK/SDK.min.js"};m.getIC3ClientCDNUrl=b;var h=function(E){return void 0===E&&(E=s.webChatIC3AdapterVersion),"https://webchatic3.blob.core.windows.net/webchat-ic3adapter/"+E+"/botframework-webchat-adapter-ic3.production.min.js"};m.getIC3AdapterCDNUrl=h;var p=function(E){return void 0===E&&(E=s.webChatACSAdapterVersion),"https://unpkg.com/acs_webchat-chat-adapter@"+E+"/dist/chat-adapter.js"};m.getACSAdapterCDNUrl=p,m.default={getIC3ClientCDNUrl:b,getIC3AdapterCDNUrl:h,getACSAdapterCDNUrl:p}},8290:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.defaultLocaleString=m.defaultLocaleId=m.getLocaleIdFromString=m.getLocaleStringFromId=void 0;var u={1025:"ar-sa",1026:"bg-bg",1027:"ca-es",1029:"cs-cz",1030:"da-dk",1031:"de-de",1032:"el-gr",1033:"en-us",3082:"es-es",1061:"et-ee",1069:"eu-es",1035:"fi-fi",1036:"fr-fr",1110:"gl-es",1037:"he-il",1081:"hi-in",1050:"hr-hr",1038:"hu-hu",1057:"id-id",1040:"it-it",1041:"ja-jp",1087:"kk-kz",1042:"ko-kr",1063:"lt-lt",1062:"lv-lv",1086:"ms-my",1044:"nb-no",1043:"nl-nl",1045:"pl-pl",1046:"pt-br",2070:"pt-pt",1048:"ro-ro",1049:"ru-ru",1051:"sk-sk",1060:"sl-si",3098:"sr-cyrl-cs",2074:"sr-latn-cs",1053:"sv-se",1054:"th-th",1055:"tr-tr",1058:"uk-ua",1066:"vi-vn",2052:"zh-cn",3076:"zh-hk",1028:"zh-tw"};m.getLocaleStringFromId=function(s){var b=Object.keys(u).find(function(h){return h===s});return b?u[b]:m.defaultLocaleString},m.getLocaleIdFromString=function(s){var b=Object.keys(u).find(function(h){return u[h]===s});return null!=b?b:m.defaultLocaleId},m.defaultLocaleId="1033",m.defaultLocaleString="en-us"},2811:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(f){for(var c,v=1,S=arguments.length;v<S;v++)for(var g in c=arguments[v])Object.prototype.hasOwnProperty.call(c,g)&&(f[g]=c[g]);return f}).apply(this,arguments)};Object.defineProperty(m,"__esModule",{value:!0}),m.createCallingSDKLogger=m.createACSAdapterLogger=m.createACSClientLogger=m.createOCSDKLogger=m.createIC3ClientLogger=m.CallingSDKLogger=m.ACSAdapterLogger=m.ACSClientLogger=m.OCSDKLogger=m.IC3ClientLogger=void 0;var b=u(7095),h=u(3037),p=u(1247),E=function(){function f(c){this.omnichannelConfig=c,this.debug=!1,this.runtimeId="",this.requestId="",this.chatId="",this.telemetry=null,this.debug=!1}return f.prototype.setDebug=function(c){this.debug=c},f.prototype.setRuntimeId=function(c){this.runtimeId=c},f.prototype.setRequestId=function(c){this.requestId=c},f.prototype.setChatId=function(c){this.chatId=c},f.prototype.useTelemetry=function(c){this.debug&&console.log("[IC3ClientLogger][useTelemetry]"),this.telemetry=c},f.prototype.logClientSdkTelemetryEvent=function(c,v){var S,g,C,R;this.debug&&console.log("[IC3ClientLogger][logClientSdkTelemetryEvent]["+c+"]"),this.debug&&console.log(v);var D={ChatSDKRuntimeId:this.runtimeId,OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},_=s(s({},v),{ExceptionDetails:v.ExceptionDetails?JSON.stringify(v.ExceptionDetails):""});switch(c){case b.default.DEBUG:null===(S=this.telemetry)||void 0===S||S.debug(s(s({},D),_),h.default.IC3CLIENT);break;case b.default.WARN:null===(g=this.telemetry)||void 0===g||g.warn(s(s({},D),_),h.default.IC3CLIENT);break;case b.default.ERROR:null===(C=this.telemetry)||void 0===C||C.error(s(s({},D),_),h.default.IC3CLIENT);break;case b.default.INFO:default:null===(R=this.telemetry)||void 0===R||R.info(s(s({},D),_),h.default.IC3CLIENT)}},f}();m.IC3ClientLogger=E;var d=function(){function f(c){this.omnichannelConfig=c,this.debug=!1,this.runtimeId="",this.requestId="",this.chatId="",this.telemetry=null,this.debug=!1}return f.prototype.setDebug=function(c){this.debug=c},f.prototype.setRuntimeId=function(c){this.runtimeId=c},f.prototype.setRequestId=function(c){this.requestId=c},f.prototype.setChatId=function(c){this.chatId=c},f.prototype.useTelemetry=function(c){this.debug&&console.log("[OCSDKLogger][useTelemetry]"),this.telemetry=c},f.prototype.logClientSdkTelemetryEvent=function(c,v){var S,g,C,R;this.debug&&console.log("[OCSDKLogger][logClientSdkTelemetryEvent]["+c+"]"),this.debug&&console.log(v);var D={ChatSDKRuntimeId:this.runtimeId,OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},_=s(s({},v),{ExceptionDetails:v.ExceptionDetails?JSON.stringify(v.ExceptionDetails):""});switch(c){case b.default.DEBUG:null===(S=this.telemetry)||void 0===S||S.debug(s(s({},D),_),h.default.OCSDK);break;case b.default.WARN:null===(g=this.telemetry)||void 0===g||g.warn(s(s({},D),_),h.default.OCSDK);break;case b.default.ERROR:null===(C=this.telemetry)||void 0===C||C.error(s(s({},D),_),h.default.OCSDK);break;case b.default.INFO:default:null===(R=this.telemetry)||void 0===R||R.info(s(s({},D),_),h.default.OCSDK)}},f}();m.OCSDKLogger=d;var T=function(){function f(c){this.omnichannelConfig=c,this.debug=!1,this.runtimeId="",this.requestId="",this.chatId="",this.telemetry=null,this.scenarioMarker=null,this.debug=!1,this.scenarioMarker=new p.default(c),this.scenarioMarker.setScenarioType(h.default.ACSCLIENT)}return f.prototype.setDebug=function(c){var v;this.debug=c,null===(v=this.scenarioMarker)||void 0===v||v.setDebug(c)},f.prototype.setRuntimeId=function(c){var v;this.runtimeId=c,null===(v=this.scenarioMarker)||void 0===v||v.setRuntimeId(c)},f.prototype.setRequestId=function(c){this.requestId=c},f.prototype.setChatId=function(c){this.chatId=c},f.prototype.useTelemetry=function(c){var v;this.debug&&console.log("[ACSClientLogger][useTelemetry]"),this.telemetry=c,null===(v=this.scenarioMarker)||void 0===v||v.useTelemetry(this.telemetry)},f.prototype.logClientSdkTelemetryEvent=function(c,v){var S,g,C,R;this.debug&&console.log("[ACSClientLogger][logClientSdkTelemetryEvent]["+c+"]"),this.debug&&console.log(v);var D={ChatSDKRuntimeId:this.runtimeId,OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},_=s(s({},v),{ExceptionDetails:v.ExceptionDetails?JSON.stringify(v.ExceptionDetails):""});switch(c){case b.default.DEBUG:null===(S=this.telemetry)||void 0===S||S.debug(s(s({},D),_),h.default.ACSCLIENT);break;case b.default.WARN:null===(g=this.telemetry)||void 0===g||g.warn(s(s({},D),_),h.default.ACSCLIENT);break;case b.default.ERROR:null===(C=this.telemetry)||void 0===C||C.error(s(s({},D),_),h.default.ACSCLIENT);break;case b.default.INFO:default:null===(R=this.telemetry)||void 0===R||R.info(s(s({},D),_),h.default.ACSCLIENT)}},f.prototype.startScenario=function(c,v){var S;void 0===v&&(v={}),null===(S=this.scenarioMarker)||void 0===S||S.startScenario(c,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),v))},f.prototype.failScenario=function(c,v){var S;void 0===v&&(v={}),null===(S=this.scenarioMarker)||void 0===S||S.failScenario(c,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),v))},f.prototype.completeScenario=function(c,v){var S;void 0===v&&(v={}),null===(S=this.scenarioMarker)||void 0===S||S.completeScenario(c,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),v))},f}();m.ACSClientLogger=T;var A=function(){function f(c){this.omnichannelConfig=c,this.debug=!1,this.runtimeId="",this.requestId="",this.chatId="",this.telemetry=null,this.scenarioMarker=null,this.debug=!1,this.scenarioMarker=new p.default(c),this.scenarioMarker.setScenarioType(h.default.ACSADAPTER)}return f.prototype.setDebug=function(c){var v;this.debug=c,null===(v=this.scenarioMarker)||void 0===v||v.setDebug(c)},f.prototype.setRuntimeId=function(c){var v;this.runtimeId=c,null===(v=this.scenarioMarker)||void 0===v||v.setRuntimeId(this.runtimeId)},f.prototype.setRequestId=function(c){this.requestId=c},f.prototype.setChatId=function(c){this.chatId=c},f.prototype.useTelemetry=function(c){var v;this.debug&&console.log("[ACSAdapterLogger][useTelemetry]"),this.telemetry=c,null===(v=this.scenarioMarker)||void 0===v||v.useTelemetry(this.telemetry)},f.prototype.logEvent=function(c,v){var S,g,C,R;this.debug&&console.log("[ACSAdapterLogger][logClientSdkTelemetryEvent]["+c+"]"),this.debug&&console.log(v);var D={ChatSDKRuntimeId:this.runtimeId,OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},_=s(s({},v),{ExceptionDetails:v.ExceptionDetails?JSON.stringify(v.ExceptionDetails):""});switch(c){case b.default.DEBUG:null===(S=this.telemetry)||void 0===S||S.debug(s(s({},D),_),h.default.ACSADAPTER);break;case b.default.WARN:null===(g=this.telemetry)||void 0===g||g.warn(s(s({},D),_),h.default.ACSADAPTER);break;case b.default.ERROR:null===(C=this.telemetry)||void 0===C||C.error(s(s({},D),_),h.default.ACSADAPTER);break;case b.default.INFO:default:null===(R=this.telemetry)||void 0===R||R.info(s(s({},D),_),h.default.ACSADAPTER)}},f.prototype.startScenario=function(c,v){var S;void 0===v&&(v={}),null===(S=this.scenarioMarker)||void 0===S||S.startScenario(c,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),v))},f.prototype.failScenario=function(c,v){var S;void 0===v&&(v={}),null===(S=this.scenarioMarker)||void 0===S||S.failScenario(c,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),v))},f.prototype.completeScenario=function(c,v){var S;void 0===v&&(v={}),null===(S=this.scenarioMarker)||void 0===S||S.completeScenario(c,s(s({},{RequestId:this.requestId,ChatId:this.chatId}),v))},f}();m.ACSAdapterLogger=A;var I=function(){function f(c){this.omnichannelConfig=c,this.debug=!1,this.runtimeId="",this.requestId="",this.chatId="",this.telemetry=null,this.debug=!1}return f.prototype.setDebug=function(c){this.debug=c},f.prototype.setRuntimeId=function(c){this.runtimeId=c},f.prototype.setRequestId=function(c){this.requestId=c},f.prototype.setChatId=function(c){this.chatId=c},f.prototype.useTelemetry=function(c){this.debug&&console.log("[CallingSDKLogger][useTelemetry]"),this.telemetry=c},f.prototype.logCallingSdkTelemetryEvent=function(c,v){var S,g,C,R;this.debug&&console.log("[CallingSDKLogger][logClientSdkTelemetryEvent]["+c+"]"),this.debug&&console.log(v);var D={ChatSDKRuntimeId:this.runtimeId,OrgId:this.omnichannelConfig.orgId,OrgUrl:this.omnichannelConfig.orgUrl,WidgetId:this.omnichannelConfig.widgetId,RequestId:this.requestId,ChatId:this.chatId},_=s(s({},v),{ExceptionDetails:v.ExceptionDetails?JSON.stringify(v.ExceptionDetails):""});switch(c){case b.default.DEBUG:null===(S=this.telemetry)||void 0===S||S.debug(s(s({},D),_),h.default.CALLINGSDK);break;case b.default.WARN:null===(g=this.telemetry)||void 0===g||g.warn(s(s({},D),_),h.default.CALLINGSDK);break;case b.default.ERROR:null===(C=this.telemetry)||void 0===C||C.error(s(s({},D),_),h.default.CALLINGSDK);break;case b.default.INFO:default:null===(R=this.telemetry)||void 0===R||R.info(s(s({},D),_),h.default.CALLINGSDK)}},f}();m.CallingSDKLogger=I,m.createIC3ClientLogger=function(f,c){void 0===c&&(c=!1);var v=new E(f);return v.setDebug(c),v},m.createOCSDKLogger=function(f,c){void 0===c&&(c=!1);var v=new d(f);return v.setDebug(c),v},m.createACSClientLogger=function(f,c){void 0===c&&(c=!1);var v=new T(f);return v.setDebug(c),v},m.createACSAdapterLogger=function(f,c){void 0===c&&(c=!1);var v=new A(f);return v.setDebug(c),v},m.createCallingSDKLogger=function(f,c){void 0===c&&(c=!1);var v=new I(f);return v.setDebug(c),v}},8098:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.isReactNative=m.isNode=m.isBrowser=void 0,m.isBrowser=function(){return"undefined"!=typeof window&&void 0!==window.document},m.isNode=function(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node},m.isReactNative=function(){return"undefined"!=typeof navigator&&"ReactNative"==navigator.product},m.default={isBrowser:m.isBrowser,isNode:m.isNode,isReactNative:m.isReactNative}},9425:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.isCustomerMessage=m.isSystemMessage=void 0;var s=u(3372),b=u(8953);m.isSystemMessage=function(h){var E=h.properties,d=h.messageType===s.default.UserMessage&&E&&E.tags&&E.tags.includes("system"),T=h.tags&&h.tags.includes("system");return d||T||!1},m.isCustomerMessage=function(h){var p=h.sender;return p&&p.id&&p.id.includes("contacts/8:")||p&&p.displayName&&p.displayName===b.default.Customer||!1}},7616:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=["orgUrl","orgId","widgetId"];m.default=function(b){if(!b)throw new Error("OmnichannelConfiguration not found");for(var h=Object.keys(b),p=0,E=u;p<E.length;p++){var d=E[p];if(!h.includes(d))throw new Error("Missing '"+d+"' in OmnichannelConfiguration")}}},641:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.defaultChatSDKConfig=void 0;var b={dataMasking:{disable:!1,maskingCharacter:"#"},telemetry:{disable:!1,ariaTelemetryKey:u(4151).ariaTelemetryKey},persistentChat:{disable:!0,tokenUpdateTime:216e5},chatReconnect:{disable:!0}};m.defaultChatSDKConfig=b,m.default=function(d){d.dataMasking&&function(d){"boolean"!=typeof d.disable&&(d.disable=b.dataMasking.disable),("string"!=typeof d.maskingCharacter||1!==d.maskingCharacter.length)&&(d.maskingCharacter=b.dataMasking.maskingCharacter)}(d.dataMasking),d.persistentChat&&function(d){("number"!=typeof d.tokenUpdateTime||!d.tokenUpdateTime)&&(d.tokenUpdateTime=b.persistentChat.tokenUpdateTime)}(d.persistentChat)}},5145:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.read="read",s}();m.default=u},3865:function(Q,m,u){"use strict";var s=this&&this.__awaiter||function(S,g,C,R){return new(C||(C=Promise))(function(_,N){function P(U){try{M(R.next(U))}catch($){N($)}}function y(U){try{M(R.throw(U))}catch($){N($)}}function M(U){U.done?_(U.value):function(_){return _ instanceof C?_:new C(function(N){N(_)})}(U.value).then(P,y)}M((R=R.apply(S,g||[])).next())})},b=this&&this.__generator||function(S,g){var R,D,_,N,C={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return N={next:P(0),throw:P(1),return:P(2)},"function"==typeof Symbol&&(N[Symbol.iterator]=function(){return this}),N;function P(M){return function(U){return function(M){if(R)throw new TypeError("Generator is already executing.");for(;C;)try{if(R=1,D&&(_=2&M[0]?D.return:M[0]?D.throw||((_=D.return)&&_.call(D),0):D.next)&&!(_=_.call(D,M[1])).done)return _;switch(D=0,_&&(M=[2&M[0],_.value]),M[0]){case 0:case 1:_=M;break;case 4:return C.label++,{value:M[1],done:!1};case 5:C.label++,D=M[1],M=[0];continue;case 7:M=C.ops.pop(),C.trys.pop();continue;default:if(!(_=(_=C.trys).length>0&&_[_.length-1])&&(6===M[0]||2===M[0])){C=0;continue}if(3===M[0]&&(!_||M[1]>_[0]&&M[1]<_[3])){C.label=M[1];break}if(6===M[0]&&C.label<_[1]){C.label=_[1],_=M;break}if(_&&C.label<_[2]){C.label=_[2],C.ops.push(M);break}_[2]&&C.ops.pop(),C.trys.pop();continue}M=g.call(S,C)}catch(U){M=[6,U],D=0}finally{R=_=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([M,U])}}};Object.defineProperty(m,"__esModule",{value:!0});var h=u(501),p=u(6849),E=u(5874),d=u(2915),T=u(1927),A=u(6648),I=u(5145),f=u(6355),c=u(8636),v=function(){function S(){}return S.getDocumentTypeFromContentType=function(g){return c.default.isDocumentTypeImage(g)?h.default.DocumentTypeImage:h.default.DocumentTypeFile},S.createNewDocument=function(g,C,R){return s(this,void 0,void 0,function(){var _,N,P,y,M;return b(this,function(U){return(M={})[g]=[I.default[I.default.read]],_={filename:C.name,permissions:M,type:S.getDocumentTypeFromContentType(C.type)},N=T.default.getAmsObjectsUrl(R.RegionGtms),(P=A.default.getDefaultAMSHeaders(R.SkypeToken))[p.default.ContentTypeHeader]=h.default.ContentTypeJson,y={data:JSON.stringify(_),headers:P,type:E.default.POST,url:N},[2,d.HttpClient.MakeRequest(y)]})})},S.uploadDocument=function(g,C,R){return s(this,void 0,void 0,function(){var D,_,N;return b(this,function(y){return console.log("AmsHelper.ts uploadDocument(): "+g+", "+C+", "+R),D=c.default.isDocumentTypeImage(C.type),_=T.default.getAmsObjectContentUrl(g,R.RegionGtms,D),N=A.default.getDefaultAMSHeaders(R.SkypeToken),[2,d.HttpClient.MakeRequest({data:C.data,headers:N,processData:!1,type:E.default.PUT,url:_})]})})},S.getFileStatus=function(g,C){var R=c.default.isImageType(g.type),D=T.default.getAmsStatusUrl(g.id,C.RegionGtms,R);return this.getViewStatus(D,C).then(function(_){return _.scan&&_.scan.status===h.default.Malware?f.default.Error:_.view_state===h.default.Ready?f.default.Success:_.scan&&_.scan.status===h.default.InProgress||_.view_state&&_.view_state!==h.default.Failed?f.default.InProgress:f.default.Error}).catch(function(){return Promise.reject({})})},S.downloadDocument=function(g,C){var R=this,D=c.default.isImageType(g.type),_=T.default.getAmsStatusUrl(g.id,C.RegionGtms,D);return new Promise(function(N){R.getViewUri(_,C).then(function(P){var y=new Headers;return y.append("Authorization","skype_token "+C.SkypeToken),y.append("X-MS-Client-Version",h.default.ClientVersion),D&&(y.append("accept",h.default.AMSAcceptHeaderValue),y.append("Accept-Encoding",h.default.AMSAcceptEncodingHeaderValue)),fetch(P,{headers:y,method:E.default.GET}).then(function(U){N(U.blob())}).catch(function(){return Promise.reject({})})})})},S.getViewUri=function(g,C){var R=this;return this.getViewStatus(g,C).then(function(D){return!D.view_location||D.view_state===h.default.Failed||D.scan&&D.scan.status===h.default.Malware?Promise.reject({}):D.view_state&&D.view_state!==h.default.Ready?R.getViewUri(g,C):D.content_state===h.default.Expired?Promise.reject({}):Promise.resolve(D.view_location)}).catch(function(){return Promise.reject("")})},S.getViewStatus=function(g,C){var R=this;return console.log("AmsHelper.ts getViewStatus(): "+g+", "+C),new Promise(function(D){setTimeout(D,h.default.DelayForAms)}).then(function(){var D=A.default.getDefaultAMSViewHeaders(C.SkypeToken);return d.HttpClient.MakeRequest({headers:D,type:E.default.GET,url:g}).then(function(N){return N.status_location&&!N.view_state?R.getViewStatus(N.status_location,C):Promise.resolve(N)}).catch(function(N){return Promise.reject(401===N.status||403===N.status?"unauthorized":{})})})},S}();m.default=v},501:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.NewMessageEvent="NewMessage",s.MessageUpdateEvent="MessageUpdate",s.ThreadUpdateEvent="ThreadUpdate",s.ConversationUpdateEvent="ConversationUpdate",s.HttpLongPoll="HttpLongPoll",s.ContentTypeJson="application/json",s.ContentTypeTextPlain="text/plain;charset=UTF-8",s.ContentTypeForm="application/x-www-form-urlencoded",s.RedirectAs404="redirectAs404",s.NoCache="no-cache",s.User="user",s.Web="web",s.ClientInfoValue="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country=IN; clientName=swc; clientVer=912/0.106.0.34//swc",s.TextPlainMimeType="text/plain",s.SwcName="SWC",s.Image="image",s.ClientVersion="937/0.123.0.9",s.DelayForAms=50,s.Reset_Flag="reset_ic3_needed",s.Malware="malware",s.Ready="ready",s.InProgress="in progress",s.Failed="failed",s.Expired="expired",s.ImageView="imgpsh_fullsize_anim",s.FileView="original",s.DocumentTypeImage="pish/image",s.DocumentTypeFile="sharing/file",s.ImageContent="imgpsh",s.FileContent="original",s.AMSAcceptHeaderValue="image/webp,image/ *,*/*;q=0.8",s.AMSAcceptEncodingHeaderValue="gzip, deflate, sdch, br",s.AMSAuthorizationSkypeTokenValue="skype_token ",s.stabilizePollMaxRetryCount=50,s.timeBetweenStabilizingPoll=1e3,s.retryCount=2,s.retry404Count=3,s.retryOtherCount=3,s.liveStateRetryCount=3,s.timeBetweenOperationRetry=1e3,s.heartBeatDuration=3e4,s.endpointRequestLog="Endpoint request",s.subscriptionRequestLog="Subscription request",s.setPropertiesRequestLog="Set message properties request",s.unsubscribeRequestLog="Unsubscribe from endpoint request",s.pollRequestLog="Polling",s.oldInitializer="Old initializer",s.newInitializer="New Initializer",s.skypeTokenAuthURL="/v1/skypetokenauth",s.skypeTokenConstantForData="skypetoken=",s}();m.default=u},1927:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(501),b=u(6849),h=u(909),p=function(){function E(){}return E.getV2EndpointUrl=function(d,T){return T.chatService+"/v2/users/ME/endpoints/"+d},E.getThreadUrl=function(d,T){return T.chatService+"/v1/threads/"+d+"?view=msnp24Equivalent"},E.getMessagesUrl=function(d,T){return T.chatService+"/v1/users/ME/conversations/"+d+"/messages"},E.getBotMessagesUrl=function(d,T){return T.chatService+"/v1/agents/"+d+"/invoke"},E.getAmsObjectsUrl=function(d){return h.default.sanitizeUrlWithBackSlash(d.ams)+"v1/objects"},E.getAmsObjectContentUrl=function(d,T,A){void 0===A&&(A=!1);var I=A?s.default.ImageContent:s.default.FileContent;return h.default.sanitizeUrlWithBackSlash(T.ams)+"v1/objects/"+d+"/content/"+I},E.getAmsObjectViewUrl=function(d,T,A){void 0===A&&(A=!1);var I=A?s.default.ImageView:s.default.FileView;return h.default.sanitizeUrlWithBackSlash(T.ams)+"v1/objects/"+d+"/views/"+I},E.getAmsStatusUrl=function(d,T,A){void 0===A&&(A=!1);var I=A?s.default.ImageView:s.default.FileView;return h.default.sanitizeUrlWithBackSlash(T.ams)+"v1/objects/"+d+"/views/"+I+"/status"},E.getV1EndpointUrl=function(d){return d.chatService+"/v1/users/ME/endpoints"},E.getV1DeleteEndpointUrl=function(d,T){return d.chatService+"/v1/users/ME/endpoints/"+T},E.getV1SubscriptionUrl=function(d){return d.chatService+"/v1/users/ME/endpoints/SELF/subscriptions"},E.getV1PollUrl=function(d,T){return d.chatService+"/v1/users/ME/endpoints/SELF/subscriptions/"+T+"/poll"},E.getV1SetPropertiesUrl=function(d){return d.chatService+"/v1/users/ME/endpoints/SELF/properties?name="+b.default.SetEndpointProperty},E}();m.default=p},8636:function(Q,m,u){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(g){for(var C,R=1,D=arguments.length;R<D;R++)for(var _ in C=arguments[R])Object.prototype.hasOwnProperty.call(C,_)&&(g[_]=C[_]);return g}).apply(this,arguments)};Object.defineProperty(m,"__esModule",{value:!0});var b=u(501),h=u(2900),p=u(4694),E=u(9306),d=u(448),T=u(3207),A=u(3372),I=u(4352),f=u(1927),c=u(7708),v=u(909),S=function(){function g(){}return g.createMessageData=function(C){var D=C.content,_=g.createBaseMessageData(C.contentType===d.default.Text?T.default.Text:T.default.RichTextHtml,C.contentType.toString(),D);return _.properties=this.getMessageProperties(C),v.default.isNullOrUndefined(C.sender.displayName)||(_.imdisplayname=C.sender.displayName),_},g.createBaseMessageData=function(C,R,D){return{"Has-Mentions":"false",clientmessageid:Date.now().toString(),composetime:(new Date).toISOString(),content:D,contenttype:R,messagetype:C}},g.getMessageProperties=function(C){var R={};if(R.deliveryMode=C.deliveryMode.toString(),C.tags){var D=[];C.tags.forEach(function(_){D.push(_)}),R.tags=D.join()}return R},g.createTypingStatusThreadMessageData=function(C,R){var D="";switch(C){case c.default.Typing:D=T.default.ControlTyping;break;case c.default.ClearTyping:D=T.default.ControlClearTyping}var _=g.createBaseMessageData(D,d.default.Text,"");return v.default.isNullOrUndefined(R)||(_=s(s({},R),_)),_},g.createBotMessageData=function(C,R){return JSON.stringify({conversation:{id:C},value:R})},g.createFileMessage=function(C,R,D){var _=T.default.Text,N=d.default.Text.toString().toLowerCase(),P=g.createBaseMessageData(_,N.toString(),"");return P.amsreferences=JSON.stringify([C.id]),P.properties=JSON.stringify(this.createFileMessageProperties(C,R,D)),v.default.isNullOrUndefined(D.sender.displayName)||(P.imdisplayname=D.sender.displayName),P},g.createFileMessageProperties=function(C,R,D){var _={};if(_.deliveryMode=D.deliveryMode.toString(),_.files=JSON.stringify([this.createFileProperty(C,R)]),_.importance="",_.subject="",D.tags){var N=[];D.tags.forEach(function(P){N.push(P)}),_.tags=N.join()}return _},g.createFileProperty=function(C,R){var D=!!g.isDocumentTypeImage(C.type);return{"@type":"http://schema.skype.com/File",type:C.type,itemid:"",baseUrl:"",providerData:"",version:2,id:C.id,title:C.name,state:"active",objectUrl:f.default.getAmsObjectViewUrl(C.id,R.RegionGtms,D),fileName:C.name,fileType:g.getNameAndExtension(C.name).extension,botFileProperties:{url:f.default.getAmsObjectViewUrl(C.id,R.RegionGtms,D)},fileInfo:{fileUrl:f.default.getAmsObjectContentUrl(C.id,R.RegionGtms,D),siteUrl:"",serverRelativeUrl:""},filePreview:{previewUrl:""}}},g.getNameAndExtension=function(C){var R=(C||"").split("."),D="",_="";return R.length>1?(_=R.pop().toLowerCase(),D=R.join(".")):(_="",D=R[0]),{name:D,extension:_}},g.createIRawMessage=function(C,R,D){var N,P,_={clientmessageid:C.clientmessageid,content:C.content,contentType:g.getMessageContentType(C),deliveryMode:v.default.isNullOrUndefined(C.properties)||C.properties.deliveryMode!==h.default.Bridged?h.default.Unbridged:h.default.Bridged,messageType:g.getMessageType(C),properties:C.properties,sender:{displayName:C.imdisplayname,id:C.from,type:g.getPersonType(C.from)},timestamp:new Date(Date.parse(C.originalarrivaltime))};(D&&(_.resourceType=D),v.default.isNullOrUndefined(C.properties)||v.default.isNullOrEmptyString(C.properties.tags))||(N=C.properties.tags.split(","),_.tags=N);if(!v.default.isNullOrUndefined(C.properties)&&!v.default.isNullOrEmptyString(C.properties.files)&&(P=JSON.parse(C.properties.files)).length>0){var y=P[0].id;v.default.isNullOrUndefined(y)&&C.amsreferences&&(y=C.amsreferences[0]);var M=g.getFileUrl(P[0],y,R);_.fileMetadata={fileSharingProtocolType:p.default.AmsBasedFileSharing,id:y,name:P[0].fileName,size:P[0].version,type:P[0].fileType,url:M}}return _},g.createIRawThread=function(C){return{id:C.id,members:C.members,messages:C.messages,properties:C.properties,rosterVersion:C.rosterVersion,type:C.type,version:C.version}},g.getConversationIdFromUrl=function(C){var R=C&&C.match(/\/(\d+:[^\/]*)[\/]?/);return R&&R[1]?R[1]:void 0},g.isSystemMessage=function(C){var R=!1;return v.default.isNullOrEmptyString(C.messagetype)||(R=g.getSystemMessageTypes().reduce(function(D,_){return D||0===C.messagetype.toLowerCase().indexOf(_.toLowerCase())},R)),R},g.getPersonType=function(C){var R=I.default.Unknown,D=C.split("/").pop();return 0===D.indexOf("28:")?R=I.default.Bot:0===D.indexOf("19:")&&(R=I.default.User),R},g.isImageType=function(C){switch(C.toLowerCase()){case"jpeg":case"jpg":case"gif":case"png":case"bmp":case"tiff":case"jfif":return!0;default:return!1}},g.getMessageType=function(C){var R;switch(C.messagetype){case A.default.Typing:R=A.default.Typing;break;case A.default.ClearTyping:R=A.default.ClearTyping;break;default:R=A.default.UserMessage}return R},g.getMessageContentType=function(C){var D=C.contenttype?C.contenttype:C.messagetype;return D===T.default.Text.toLowerCase()||D.indexOf(b.default.TextPlainMimeType)>=0?d.default.Text:d.default.RichText},g.getSystemMessageTypes=function(){return["ThreadActivity"]},g.getFileUrl=function(C,R,D){var N,_=C.fileInfo;if(_&&_.fileUrl)N=_.fileUrl;else if(R){var P=g.isImageType(C.fileType);N=f.default.getAmsObjectContentUrl(R,D.RegionGtms,P)}return N},g.isDocumentTypeImage=function(C){return-1!==C.indexOf(b.default.Image)},g.getDomainRegexp=function(){return new RegExp(/^(https?:.+?\.microsoft\.com)/i)},g.parseDomain=function(C){var R=C.match(g.getDomainRegexp());return R?R[1]:null},g.parseChatServiceHostUrl=function(C){return g.parseDomain(C)},g.shouldRetryOnFailure=function(C){return C!==E.default.Accepted&&C!==E.default.Created},g}();m.default=S},909:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(6849),b=function(){function h(){}return h.isNullOrEmptyString=function(p){return h.isNullOrUndefined(p)||""===p},h.isNullOrUndefinedOrEmptyArray=function(p){return h.isNullOrUndefined(p)||0===p.length},h.isNullOrUndefined=function(p){return null==p},h.isPrimitiveString=function(p){return"string"==typeof p},h.convertStringToBoolean=function(p){return!h.isNullOrUndefined(p)&&"true"===p.toLowerCase()},h.sanitizeUrlWithBackSlash=function(p){return p.endsWith("/")?p:p+"/"},h.getRegistrationTokenValue=function(p){var E=p.match(/registrationToken=(.+); expires=(\d+)/);return E&&E.length>=2?s.default.RegistrationTokenHeaderValue+E[1]:""},h.addQueryParametersToPath=function(p,E){var d=p;if(!h.isNullOrUndefined(E))for(var T in d.indexOf("?")>=0||(d+="?"),E)if(E.hasOwnProperty(T)){var A=T+"="+E[T];"?"!==d[d.length-1]&&(A="&"+A),d+=A}return d},h.getResponseHeader=function(p,E){var d;return h.isNullOrUndefined(p)||(d=p.headers[E]),d},h.timer=function(){var p=(new Date).getTime();return{get milliSecondsElapsed(){return(new Date).getTime()-p}}},h.concatArrays=function(p,E){!h.isNullOrUndefined(p)&&!h.isNullOrUndefined(E)&&E.forEach(function(d){p.push(d)})},h}();m.default=b},1288:function(Q,m,u){"use strict";var s=this&&this.__awaiter||function(d,T,A,I){return new(A||(A=Promise))(function(c,v){function S(R){try{C(I.next(R))}catch(D){v(D)}}function g(R){try{C(I.throw(R))}catch(D){v(D)}}function C(R){R.done?c(R.value):function(c){return c instanceof A?c:new A(function(v){v(c)})}(R.value).then(S,g)}C((I=I.apply(d,T||[])).next())})},b=this&&this.__generator||function(d,T){var I,f,c,v,A={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return v={next:S(0),throw:S(1),return:S(2)},"function"==typeof Symbol&&(v[Symbol.iterator]=function(){return this}),v;function S(C){return function(R){return function(C){if(I)throw new TypeError("Generator is already executing.");for(;A;)try{if(I=1,f&&(c=2&C[0]?f.return:C[0]?f.throw||((c=f.return)&&c.call(f),0):f.next)&&!(c=c.call(f,C[1])).done)return c;switch(f=0,c&&(C=[2&C[0],c.value]),C[0]){case 0:case 1:c=C;break;case 4:return A.label++,{value:C[1],done:!1};case 5:A.label++,f=C[1],C=[0];continue;case 7:C=A.ops.pop(),A.trys.pop();continue;default:if(!(c=(c=A.trys).length>0&&c[c.length-1])&&(6===C[0]||2===C[0])){A=0;continue}if(3===C[0]&&(!c||C[1]>c[0]&&C[1]<c[3])){A.label=C[1];break}if(6===C[0]&&A.label<c[1]){A.label=c[1],c=C;break}if(c&&A.label<c[2]){A.label=c[2],A.ops.push(C);break}c[2]&&A.ops.pop(),A.trys.pop();continue}C=T.call(d,A)}catch(R){C=[6,R],f=0}finally{I=c=0}if(5&C[0])throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}([C,R])}}};Object.defineProperty(m,"__esModule",{value:!0});var h=u(2217),p=u(737),E=function(){function d(T){this.hostType=h.default.Page,this.id=(0,p.uuidv4)(),this.protocolType=T,this.newConversationMessageListeners={},this.threadUpdateListeners={},this.debug=!1}return d.prototype.setDebug=function(T){this.debug=T},d.prototype.joinConversation=function(T,A){var I=this;return this.onJoinConversation(T,A).then(function(f){return{disconnect:I.disconnectFromConversation.bind(I,f),downloadFile:I.downloadFile.bind(I,f),getFileStatus:I.getFileStatus.bind(I,f),getMembers:I.getMembers.bind(I,f),getMessages:I.getMessages.bind(I,f),id:f.id,indicateTypingStatus:I.indicateTypingStatus.bind(I,f),registerOnNewMessage:I.registerOnNewMessage.bind(I,f),registerOnThreadUpdate:I.registerOnThreadUpdate.bind(I,f),sendFileMessage:I.sendFileMessage.bind(I,f),sendMessage:I.sendMessage.bind(I,f),sendMessageToBot:I.sendMessageToBot.bind(I,f),uploadFile:I.uploadFile.bind(I,f),sendFileData:I.sendFileData.bind(I,f)}})},d.prototype.registerOnNewMessage=function(T,A){return s(this,void 0,void 0,function(){return b(this,function(I){return[2,Promise.resolve()]})})},d.prototype.registerOnThreadUpdate=function(T,A){return s(this,void 0,void 0,function(){return b(this,function(I){return[2,Promise.resolve()]})})},d.prototype.uploadFile=function(T,A,I){return Promise.resolve()},d.prototype.downloadFile=function(T,A){return this.debug&&console.debug("IC3Core/ClientBridge/downloadFile"),this.downloadFileData(T,A).then(function(I){if(I&&I.size)return I;var c=new Blob([new Uint8Array(I)]);return!c||0===c.size&&""===c.type?I:c})},d}();m.default=E},2518:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(333),b=u(2217),h=function(){function p(){}return p.getClientBridge=function(E){switch(E.hostType){case b.default.IFrame:throw new Error("Framed bridge not implemented for "+E.hostType+" in IC3Core");case b.default.Page:return new s.default(E.protocolType);default:throw new Error("Client bridge not implemented for "+E.hostType+" in IC3Core")}},p}();m.default=h},333:function(Q,m,u){"use strict";var A,s=this&&this.__extends||(A=function(I,f){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,v){c.__proto__=v}||function(c,v){for(var S in v)Object.prototype.hasOwnProperty.call(v,S)&&(c[S]=v[S])})(I,f)},function(I,f){if("function"!=typeof f&&null!==f)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function c(){this.constructor=I}A(I,f),I.prototype=null===f?Object.create(f):(c.prototype=f.prototype,new c)}),b=this&&this.__awaiter||function(A,I,f,c){return new(f||(f=Promise))(function(S,g){function C(_){try{D(c.next(_))}catch(N){g(N)}}function R(_){try{D(c.throw(_))}catch(N){g(N)}}function D(_){_.done?S(_.value):function(S){return S instanceof f?S:new f(function(g){g(S)})}(_.value).then(C,R)}D((c=c.apply(A,I||[])).next())})},h=this&&this.__generator||function(A,I){var c,v,S,g,f={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return g={next:C(0),throw:C(1),return:C(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function C(D){return function(_){return function(D){if(c)throw new TypeError("Generator is already executing.");for(;f;)try{if(c=1,v&&(S=2&D[0]?v.return:D[0]?v.throw||((S=v.return)&&S.call(v),0):v.next)&&!(S=S.call(v,D[1])).done)return S;switch(v=0,S&&(D=[2&D[0],S.value]),D[0]){case 0:case 1:S=D;break;case 4:return f.label++,{value:D[1],done:!1};case 5:f.label++,v=D[1],D=[0];continue;case 7:D=f.ops.pop(),f.trys.pop();continue;default:if(!(S=(S=f.trys).length>0&&S[S.length-1])&&(6===D[0]||2===D[0])){f=0;continue}if(3===D[0]&&(!S||D[1]>S[0]&&D[1]<S[3])){f.label=D[1];break}if(6===D[0]&&f.label<S[1]){f.label=S[1],S=D;break}if(S&&f.label<S[2]){f.label=S[2],f.ops.push(D);break}S[2]&&f.ops.pop(),f.trys.pop();continue}D=I.call(A,f)}catch(_){D=[6,_],v=0}finally{c=S=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([D,_])}}};Object.defineProperty(m,"__esModule",{value:!0});var p=u(1288),E=u(2217),d=u(9515),T=function(A){function I(f){var c=A.call(this,f)||this;return c.hostType=E.default.Page,c.protocolAdapter=new d.default("",c.hostType),c}return s(I,A),I.prototype.setup=function(f){return Promise.resolve()},I.prototype.update=function(f){return Promise.resolve()},I.prototype.onRegisterOnNewMessage=function(f){return Promise.resolve()},I.prototype.onRegisterOnThreadUpdate=function(f){return Promise.resolve()},I.prototype.initialize=function(f){return this.protocolAdapter.initialize(f)},I.prototype.dispose=function(){return this.protocolAdapter.dispose()},I.prototype.sendMessage=function(f,c){return this.protocolAdapter.sendMessage(f,c)},I.prototype.sendFileMessage=function(f,c,v){return this.protocolAdapter.sendFileMessage(f,c,v)},I.prototype.getMessages=function(f){return this.protocolAdapter.getMessages(f)},I.prototype.disconnectFromConversation=function(f){return this.protocolAdapter.disconnectFromConversation(f)},I.prototype.onJoinConversation=function(f,c){return this.protocolAdapter.joinConversation(f,c)},I.prototype.sendFileData=function(f,c,v){return this.protocolAdapter.sendFileData(f,c,v)},I.prototype.downloadFileData=function(f,c){return this.protocolAdapter.downloadFileData(f,c)},I.prototype.getFileStatus=function(f,c){return this.protocolAdapter.getFileStatus(f,c)},I.prototype.indicateTypingStatus=function(f,c,v){return this.protocolAdapter.indicateTypingStatus(f,c,v)},I.prototype.sendMessageToBot=function(f,c,v){return this.protocolAdapter.sendMessageToBot(f,c,v)},I.prototype.getMembers=function(f){return this.protocolAdapter.getMembers(f)},I.prototype.registerOnNewMessage=function(f,c){return b(this,void 0,void 0,function(){return h(this,function(v){return this.protocolAdapter.registerOnNewMessage(f,c),[2,Promise.resolve()]})})},I.prototype.registerOnThreadUpdate=function(f,c){return b(this,void 0,void 0,function(){return h(this,function(v){return this.protocolAdapter.registerOnThreadUpdate(f,c),[2,Promise.resolve()]})})},I.prototype.setDebug=function(f){void 0===f&&(f=!1),this.protocolAdapter.setDebug(f)},I}(p.default);m.default=T},1218:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(3865),b=u(501),h=u(4694),p=u(6355),E=u(2217),d=u(2915),T=u(5256),A=u(6849),I=u(5874),f=u(3671),c=u(752),v=u(448),S=u(3207),g=u(5655),C=u(6648),R=u(1927),D=u(8636),_=u(909),N=function(){function P(y){this.hostType=E.default.Page,this.protocolType=g.default.IC3V1SDK,this.id=y,this.conversations=[],this.newConversationMessageListeners={},this.threadUpdateListeners={},this.internalConversationsData={},this.liveStateFailureCount=0,this.debug=!1}return P.prototype.startPolling=function(){this.ic3Initializer&&this.ic3Initializer.startPolling()},P.prototype.stopPolling=function(){this.ic3Initializer&&this.ic3Initializer.stopPolling()},P.prototype.setup=function(y){return this.logger=y.logger,d.HttpClient.setLogger(this.logger),Promise.resolve()},P.prototype.initialize=function(y){return this.setupSession(y),Promise.resolve()},P.prototype.update=function(y){return Promise.resolve()},P.prototype.dispose=function(){return this.conversations=[],this.newConversationMessageListeners={},this.threadUpdateListeners={},this.internalConversationsData={},Promise.resolve()},P.prototype.joinConversation=function(y,M){var U;void 0===M&&(M=!0);var $=_.default.timer(),j={id:y};return-1===this.conversations.findIndex(function(Z){return Z.id===j.id})&&(this.conversations.push(j),this.newConversationMessageListeners[j.id]=this.newConversationMessageListeners[j.id]||[],this.threadUpdateListeners[j.id]=this.threadUpdateListeners[j.id]||[]),null===(U=this.logger)||void 0===U||U.log(c.default.INFO,f.default.JoinConversation,{ElapsedTimeInMilliseconds:$.milliSecondsElapsed,EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}),!_.default.isNullOrUndefined(M)&&!0===M&&this.sendHeartBeat(j.id),Promise.resolve(j)},P.prototype.sendLiveState=function(y){var M=this;this.debug&&console.debug("IC3Core/sendLiveState");var j=D.default.createBaseMessageData(S.default.LiveState,v.default.Text,"");return this.sendMessageToIC3(y,j).then(function(){return M.liveStateFailureCount=0,Promise.resolve()}).catch(function(ue){var Z;M.liveStateFailureCount++,M.liveStateFailureCount>=b.default.liveStateRetryCount&&(null===(Z=M.logger)||void 0===Z||Z.log(c.default.ERROR,f.default.SendLiveStateFailure,{ExceptionDetails:ue,EndpointUrl:M.EndpointUrl,EndpointId:M.EndpointId}),M.stopHeartBeat(),M.liveStateFailureCount=0)})},P.prototype.sendHeartBeat=function(y){this.heartBeatTimer||(this.debug&&console.debug("IC3Core/sendHeartBeat"),this.sendLiveState(y),this.heartBeatTimer=window.setInterval(this.sendLiveState.bind(this,y),b.default.heartBeatDuration))},P.prototype.stopHeartBeat=function(){clearInterval(this.heartBeatTimer)},P.prototype.sendMessage=function(y,M){var U=D.default.createMessageData(M);return this.sendMessageToIC3(y.id,U)},P.prototype.getMessages=function(y){var M=this,U=C.default.getDefaultGetMessagesQueryParameters(),$=_.default.addQueryParametersToPath(R.default.getMessagesUrl(y.id,this.ic3Info.RegionGtms),U),j=C.default.getDefaultIC3Headers();return j[A.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,j[A.default.ContentTypeHeader]=b.default.ContentTypeJson,d.HttpClient.MakeRequest({enableExponentialBackoff:!0,headers:j,redirect404RetryCount:b.default.retryCount,retryCount:b.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:D.default.shouldRetryOnFailure,timeBetweenRetry:b.default.timeBetweenOperationRetry,type:I.default.GET,url:$}).then(function(Z){for(var Y=[],W=0,ce=Z.messages;W<ce.length;W++){var Ce=ce[W];D.default.isSystemMessage(Ce)||Y.push(D.default.createIRawMessage(Ce,M.ic3Info))}return M.getAllMessagesFromBackwardLinkUrl(Z._metadata.backwardLink,U.startTime,Y)})},P.prototype.registerOnNewMessage=function(y,M){var U;return this.newConversationMessageListeners[y.id].push(M),null===(U=this.logger)||void 0===U||U.log(c.default.INFO,f.default.RegisterOnNewMessage,{EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}),Promise.resolve()},P.prototype.registerOnThreadUpdate=function(y,M){var U;return this.threadUpdateListeners[y.id].push(M),null===(U=this.logger)||void 0===U||U.log(c.default.INFO,f.default.RegisterOnThreadUpdate,{EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}),Promise.resolve()},P.prototype.disconnectFromConversation=function(y){return this.conversations.findIndex(function(M){return M.id===y.id}),delete this.internalConversationsData[y.id],this.ic3Info.visitor&&(this.stopHeartBeat(),this.stopPolling()),Promise.resolve()},P.prototype.sendFileData=function(y,M,U){var $=this;if(_.default.isNullOrUndefined(U)&&(U=h.default.AmsBasedFileSharing),M.size<=0)throw new Error("File size is lesser or equal to zero.");var j={fileSharingProtocolType:U,id:"",name:M.name,size:M.size,type:M.type,url:""};return new Promise(function(ue,Z){s.default.createNewDocument(y.id,M,$.ic3Info).then(function(Y){j.id=Y.id;var W=D.default.isDocumentTypeImage(M.type);j.url=R.default.getAmsObjectContentUrl(Y.id,$.ic3Info.RegionGtms,W),s.default.uploadDocument(Y.id,M,$.ic3Info).then(function(){ue(j)}).catch(function(ce){Z(ce)})}).catch(function(Y){Z(Y)})})},P.prototype.sendFileMessage=function(y,M,U){return this.sendMessageToIC3(y.id,D.default.createFileMessage(M,this.ic3Info,U))},P.prototype.downloadFileData=function(y,M){var U=this;return this.debug&&console.debug("IC3Core/IC3ClientAdapter/downloadFileData"),new Promise(function($,j){var ue=M.fileSharingProtocolType;_.default.isNullOrUndefined(ue)&&(ue=h.default.AmsBasedFileSharing),ue===h.default.AmsBasedFileSharing?s.default.downloadDocument(M,U.ic3Info).then(function(Z){$(Z)}).catch(function(Z){j(Z)}):j("This Protocol is not implemented")})},P.prototype.getFileStatus=function(y,M){var U=this;return new Promise(function($,j){var ue=M.fileSharingProtocolType;_.default.isNullOrUndefined(ue)&&(ue=h.default.AmsBasedFileSharing),ue===h.default.AmsBasedFileSharing?s.default.getFileStatus(M,U.ic3Info).then(function(Z){$(Z)}).catch(function(Z){j(p.default.Error+" e")}):j("This Protocol is not implemented")})},P.prototype.indicateTypingStatus=function(y,M,U){var $=D.default.createTypingStatusThreadMessageData(M,U);return this.sendMessageToIC3(y.id,$)},P.prototype.sendMessageToBot=function(y,M,U){var $=D.default.createBotMessageData(y.id,U),j=R.default.getBotMessagesUrl(M,this.ic3Info.RegionGtms),ue=C.default.getDefaultIC3Headers();return ue[A.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,ue[A.default.ContentTypeHeader]=b.default.ContentTypeTextPlain,d.HttpClient.MakeRequest({data:$,dataType:T.default.TEXT,enableExponentialBackoff:!0,headers:ue,redirect404RetryCount:b.default.retryCount,retryCount:b.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:D.default.shouldRetryOnFailure,timeBetweenRetry:b.default.timeBetweenOperationRetry,type:I.default.POST,url:j})},P.prototype.getMembers=function(y){var M=this.internalConversationsData[y.id].members,U=[];return _.default.isNullOrUndefinedOrEmptyArray(M)||M.forEach(function($){var j={displayName:$.friendlyName,id:$.id,type:D.default.getPersonType($.id)};U.push(j)}),Promise.resolve(U)},P.prototype.sendMessageToIC3=function(y,M){var U=R.default.getMessagesUrl(y,this.ic3Info.RegionGtms),$=C.default.getDefaultIC3Headers();$[A.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,$[A.default.ContentTypeHeader]=b.default.ContentTypeJson;var j={data:JSON.stringify(M),enableExponentialBackoff:!0,headers:$,redirect404RetryCount:b.default.retryCount,retryCount:b.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:D.default.shouldRetryOnFailure,timeBetweenRetry:b.default.timeBetweenOperationRetry,type:I.default.POST,url:U};return d.HttpClient.MakeRequest(j)},P.prototype.onNewMessage=function(y,M,U){var j,$=this,ue=_.default.timer();try{y&&(_.default.isNullOrUndefined(this.newConversationMessageListeners[y.id])||D.default.isSystemMessage(M)||this.newConversationMessageListeners[y.id].forEach(function(Y){Y(D.default.createIRawMessage(M,$.ic3Info,U))}))}catch(Y){return void(null===(j=this.logger)||void 0===j||j.log(c.default.ERROR,f.default.OnNewMessageFailure,{ExceptionDetails:Y,ElapsedTimeInMilliseconds:ue.milliSecondsElapsed,EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}))}},P.prototype.onThreadUpdate=function(y,M){var U,$=_.default.timer();try{y&&(_.default.isNullOrUndefined(this.threadUpdateListeners[y.id])||this.threadUpdateListeners[y.id].forEach(function(ue){ue(D.default.createIRawThread(M))}))}catch(ue){return void(null===(U=this.logger)||void 0===U||U.log(c.default.ERROR,f.default.OnThreadUpdateFailure,{ExceptionDetails:ue,ElapsedTimeInMilliseconds:$.milliSecondsElapsed,EndpointUrl:this.EndpointUrl,EndpointId:this.EndpointId}))}},P.prototype.getAllMessagesFromBackwardLinkUrl=function(y,M,U){var $=this;return _.default.isNullOrEmptyString(y)?Promise.resolve(U):this.getMessagesFromBackwardLinkUrl(y,M).then(function(j){for(var ue=0,Z=j.messages;ue<Z.length;ue++){var Y=Z[ue];D.default.isSystemMessage(Y)||U.push(D.default.createIRawMessage(Y,$.ic3Info))}return $.getAllMessagesFromBackwardLinkUrl(j._metadata.backwardLink,M,U)})},P.prototype.getMessagesFromBackwardLinkUrl=function(y,M){var $=_.default.addQueryParametersToPath(y,{startTime:M}),j=C.default.getDefaultIC3Headers();return j[A.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,j[A.default.ContentTypeHeader]=b.default.ContentTypeJson,d.HttpClient.MakeRequest({enableExponentialBackoff:!0,headers:j,redirect404RetryCount:b.default.retryCount,retryCount:b.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:D.default.shouldRetryOnFailure,timeBetweenRetry:b.default.timeBetweenOperationRetry,type:I.default.GET,url:$})},P.prototype.setupSession=function(y){this.ic3Info={SkypeToken:y.token,RegionGtms:y.regionGtms,visitor:y.visitor},_.default.isNullOrUndefined(this.ic3Info)||(this.EndpointId=this.ic3Info.endpointId,this.EndpointUrl=this.ic3Info.RegionGtms?this.ic3Info.RegionGtms.chatService:"")},P.prototype.setDebug=function(y){void 0===y&&(y=!1),this.debug=y},P}();m.default=N},9515:function(Q,m,u){"use strict";var N,s=this&&this.__extends||(N=function(P,y){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,U){M.__proto__=U}||function(M,U){for(var $ in U)Object.prototype.hasOwnProperty.call(U,$)&&(M[$]=U[$])})(P,y)},function(P,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function M(){this.constructor=P}N(P,y),P.prototype=null===y?Object.create(y):(M.prototype=y.prototype,new M)}),b=this&&this.__awaiter||function(N,P,y,M){return new(y||(y=Promise))(function($,j){function ue(W){try{Y(M.next(W))}catch(ce){j(ce)}}function Z(W){try{Y(M.throw(W))}catch(ce){j(ce)}}function Y(W){W.done?$(W.value):function($){return $ instanceof y?$:new y(function(j){j($)})}(W.value).then(ue,Z)}Y((M=M.apply(N,P||[])).next())})},h=this&&this.__generator||function(N,P){var M,U,$,j,y={label:0,sent:function(){if(1&$[0])throw $[1];return $[1]},trys:[],ops:[]};return j={next:ue(0),throw:ue(1),return:ue(2)},"function"==typeof Symbol&&(j[Symbol.iterator]=function(){return this}),j;function ue(Y){return function(W){return function(Y){if(M)throw new TypeError("Generator is already executing.");for(;y;)try{if(M=1,U&&($=2&Y[0]?U.return:Y[0]?U.throw||(($=U.return)&&$.call(U),0):U.next)&&!($=$.call(U,Y[1])).done)return $;switch(U=0,$&&(Y=[2&Y[0],$.value]),Y[0]){case 0:case 1:$=Y;break;case 4:return y.label++,{value:Y[1],done:!1};case 5:y.label++,U=Y[1],Y=[0];continue;case 7:Y=y.ops.pop(),y.trys.pop();continue;default:if(!($=($=y.trys).length>0&&$[$.length-1])&&(6===Y[0]||2===Y[0])){y=0;continue}if(3===Y[0]&&(!$||Y[1]>$[0]&&Y[1]<$[3])){y.label=Y[1];break}if(6===Y[0]&&y.label<$[1]){y.label=$[1],$=Y;break}if($&&y.label<$[2]){y.label=$[2],y.ops.push(Y);break}$[2]&&y.ops.pop(),y.trys.pop();continue}Y=P.call(N,y)}catch(W){Y=[6,W],U=0}finally{M=$=0}if(5&Y[0])throw Y[1];return{value:Y[0]?Y[1]:void 0,done:!0}}([Y,W])}}};Object.defineProperty(m,"__esModule",{value:!0});var p=u(501),E=u(6849),d=u(5874),T=u(1218),A=u(7037),I=u(3671),f=u(2915),c=u(752),v=u(5655),S=u(6648),g=u(5785),C=u(1927),R=u(8636),D=u(909),_=function(N){function P(y,M){var U=N.call(this,y)||this;return U.debug&&console.debug("IC3Core/Constructor"),U.protocolType=v.default.IC3V1SDK,U.hostType=M,U.ic3Initializer=new A.default,U}return s(P,N),P.prototype.startPolling=function(){N.prototype.startPolling.call(this)},P.prototype.stopPolling=function(){N.prototype.stopPolling.call(this)},P.prototype.setup=function(y){return N.prototype.setup.call(this,y)},P.prototype.initialize=function(y){var M=this;return N.prototype.initialize.call(this,y).then(function(){var $;return null===($=M.ic3Initializer)||void 0===$?void 0:$.setup(M.logger).then(function(){return M.setSkypeTokenCookie()}).then(function(){var j;return null===(j=M.ic3Initializer)||void 0===j?void 0:j.setIc3Info(M.ic3Info)}).then(function(){var j;return null===(j=M.ic3Initializer)||void 0===j?void 0:j.initializeIC3(M.handlePollData.bind(M))}).then(function(j){M.ic3Info=j})})},P.prototype.update=function(y){var M=this;return N.prototype.update.call(this,y).then(function(){return M.updateToken({RegionGtms:y.regionGtms,SkypeToken:y.token,visitor:y.visitor})})},P.prototype.dispose=function(){var y;return b(this,void 0,void 0,function(){return h(this,function(M){return null===(y=this.ic3Initializer)||void 0===y||y.stopPolling(),this.heartBeatTimer&&clearInterval(this.heartBeatTimer),Promise.resolve(),[2]})})},P.prototype.joinConversation=function(y,M){var U=this,$=D.default.timer();return N.prototype.joinConversation.call(this,y,M).then(function(j){return U.getThreadRequest(j.id).then(function(ue){return U.internalConversationsData[j.id]={id:y,members:ue.members},j}).catch(function(ue){return U.logger&&U.logger.log(c.default.WARN,I.default.JoinConversationV1GetThreadRequestFailed,{Description:"Unable to retrieve thread: "+ue,ElapsedTimeInMilliseconds:$.milliSecondsElapsed,EndpointUrl:U.EndpointUrl,EndpointId:U.ic3Info.endpointId}),U.internalConversationsData[j.id]={id:y,members:[]},j})})},P.prototype.sendMessage=function(y,M){return N.prototype.sendMessage.call(this,y,M)},P.prototype.sendFileMessage=function(y,M,U){return N.prototype.sendFileMessage.call(this,y,M,U)},P.prototype.getMessages=function(y){return N.prototype.getMessages.call(this,y)},P.prototype.registerOnNewMessage=function(y,M){return N.prototype.registerOnNewMessage.call(this,y,M)},P.prototype.registerOnThreadUpdate=function(y,M){return N.prototype.registerOnThreadUpdate.call(this,y,M)},P.prototype.disconnectFromConversation=function(y){return N.prototype.disconnectFromConversation.call(this,y)},P.prototype.setSkypeTokenCookie=function(){var y=this.ic3Info.RegionGtms.ams.concat(p.default.skypeTokenAuthURL),M=S.default.getDefaultBaseIC3Headers();return M[E.default.ContentTypeHeader]=p.default.ContentTypeForm,f.HttpClient.MakeRequest({data:p.default.skypeTokenConstantForData+this.ic3Info.SkypeToken,enableExponentialBackoff:!0,useXHRWithCredentials:!0,headers:M,redirect404RetryCount:p.default.retryCount,retryCount:p.default.retryCount,shouldRedirectOn404:!1,shouldResetOnFailure:!1,shouldRetryOnFailure:R.default.shouldRetryOnFailure,timeBetweenRetry:p.default.timeBetweenOperationRetry,type:d.default.POST,url:y})},P.prototype.getThreadRequest=function(y){var M=C.default.getThreadUrl(y,this.ic3Info.RegionGtms),U=S.default.getDefaultBaseIC3Headers();return U[E.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,f.HttpClient.MakeRequest({enableExponentialBackoff:!0,headers:U,redirect404RetryCount:p.default.retryCount,retryCount:p.default.retryCount,shouldRedirectOn404:!0,shouldRetryOnFailure:R.default.shouldRetryOnFailure,timeBetweenRetry:p.default.timeBetweenOperationRetry,type:d.default.GET,url:M})},P.prototype.newMessageReceived=function(y,M,U){N.prototype.onNewMessage.call(this,y,M,U)},P.prototype.newThreadUpdate=function(y,M){N.prototype.onThreadUpdate.call(this,y,M)},P.prototype.handleNewMessageEvent=function(y){var M;M=y.resource&&y.resource.conversationid?y.resource.conversationid:R.default.getConversationIdFromUrl(y.resource.conversationLink?y.resource.conversationLink:y.resourceLink);var U=this.conversations.findIndex(function(j){return j.id===M});this.newMessageReceived(this.conversations[U],y.resource,y.resourceType)},P.prototype.handleConversationUpdateEvent=function(y){},P.prototype.handleThreadUpdate=function(y){if(y.resourceType===g.default.ThreadUpdate){var M;M=y.resource&&y.resource.id?y.resource.id:R.default.getConversationIdFromUrl(y.resource.messages?y.resource.messages:y.resourceLink);var U=this.conversations.findIndex(function(j){return j.id===M});this.newThreadUpdate(this.conversations[U],y.resource)}},P.prototype.handlePollData=function(y){if(y&&y.eventMessages)for(var M=0,U=y.eventMessages;M<U.length;M++)this.handlePollEventMessage(U[M])},P.prototype.handlePollEventMessage=function(y){y.resourceType===g.default.NewMessage||y.resourceType===g.default.MessageUpdate?this.handleNewMessageEvent(y):y.resourceType===g.default.ThreadUpdate?this.handleThreadUpdate(y):y.resourceType===g.default.ConversationUpdate&&this.handleConversationUpdateEvent(y)},P.prototype.updateToken=function(y){return b(this,void 0,void 0,function(){var M,U,$,j,ue,Z,Y,W,ce,Ce,X=this;return h(this,function(de){switch(de.label){case 0:return this.logger&&this.logger.log(c.default.INFO,I.default.UpdateToken,{EndpointUrl:this.EndpointUrl,EndpointId:this.ic3Info.endpointId}),M=[],U=function(te){te&&te.eventMessages&&D.default.concatArrays(M,te.eventMessages)},$=[],j=function(te){te&&te.eventMessages&&D.default.concatArrays($,te.eventMessages)},ue=this.ic3Initializer,Z=new A.default,Y=this.updateTokenClearTimeoutHandle,W=this.ic3Info,ue.getPoller().onNewData=U,this.logger?[4,Z.setup(this.logger)]:[3,2];case 1:de.sent(),de.label=2;case 2:return[2,Z.setIc3Info(y).then(function(){return Z.initializeIC3(j)}).then(function(te){ce=te}).then(function(){return X.getMatchingIC3EventIndex(M,$)}).then(function(te){Ce=te}).then(function(){return ue.reset(!0)}).then(function(){return X.syncPollingData(M,$,Ce)}).then(function(){X.ic3Info=ce,X.ic3Initializer=Z,X.ic3Initializer.getPoller().onNewData=X.handlePollData.bind(X)}).catch(function(te){throw X.updateTokenClearTimeoutHandle!==Y&&(clearTimeout(X.updateTokenClearTimeoutHandle),X.updateTokenClearTimeoutHandle=Y),X.ic3Info=W,X.ic3Initializer.getPoller().onNewData=X.handlePollData.bind(X),X.ic3Initializer.getPoller().start(),new Error("Update token failed: "+(te&&te.message))})]}})})},P.prototype.getMatchingIC3EventIndex=function(y,M,U){var $=this;return new Promise(function(j,ue){if((U=U||0)===p.default.stabilizePollMaxRetryCount)j({newPollIndex:-1,previousPollIndex:-1});else{for(var Z=0,Y=0;Z<y.length&&Y<M.length;){var W=y[Z];if(W.time===M[Y].time)return void j({newPollIndex:Y,previousPollIndex:Z});new Date(W.time)<new Date(W.time)?Z++:Y++}setTimeout(function(){$.getMatchingIC3EventIndex(y,M,U+1).then(function(Ce){j(Ce)}).catch(function(Ce){ue(Ce)})},p.default.timeBetweenStabilizingPoll)}})},P.prototype.syncPollingData=function(y,M,U){this.logger&&this.logger.log(c.default.INFO,I.default.SyncingPollData,{EndpointUrl:this.EndpointUrl,EndpointId:this.ic3Info.endpointId});var $=U.previousPollIndex,j=U.newPollIndex+1;-1===U.previousPollIndex&&-1===U.newPollIndex&&($=y.length-1,j=0);for(var ue=0;ue<=$;ue++)this.handlePollEventMessage(y[ue]);for(ue=j;ue<M.length;ue++)this.handlePollEventMessage(M[ue])},P}(T.default);m.default=_},7037:function(Q,m,u){"use strict";var s=this&&this.__awaiter||function(_,N,P,y){return new(P||(P=Promise))(function(U,$){function j(Y){try{Z(y.next(Y))}catch(W){$(W)}}function ue(Y){try{Z(y.throw(Y))}catch(W){$(W)}}function Z(Y){Y.done?U(Y.value):function(U){return U instanceof P?U:new P(function($){$(U)})}(Y.value).then(j,ue)}Z((y=y.apply(_,N||[])).next())})},b=this&&this.__generator||function(_,N){var y,M,U,$,P={label:0,sent:function(){if(1&U[0])throw U[1];return U[1]},trys:[],ops:[]};return $={next:j(0),throw:j(1),return:j(2)},"function"==typeof Symbol&&($[Symbol.iterator]=function(){return this}),$;function j(Z){return function(Y){return function(Z){if(y)throw new TypeError("Generator is already executing.");for(;P;)try{if(y=1,M&&(U=2&Z[0]?M.return:Z[0]?M.throw||((U=M.return)&&U.call(M),0):M.next)&&!(U=U.call(M,Z[1])).done)return U;switch(M=0,U&&(Z=[2&Z[0],U.value]),Z[0]){case 0:case 1:U=Z;break;case 4:return P.label++,{value:Z[1],done:!1};case 5:P.label++,M=Z[1],Z=[0];continue;case 7:Z=P.ops.pop(),P.trys.pop();continue;default:if(!(U=(U=P.trys).length>0&&U[U.length-1])&&(6===Z[0]||2===Z[0])){P=0;continue}if(3===Z[0]&&(!U||Z[1]>U[0]&&Z[1]<U[3])){P.label=Z[1];break}if(6===Z[0]&&P.label<U[1]){P.label=U[1],U=Z;break}if(U&&P.label<U[2]){P.label=U[2],P.ops.push(Z);break}U[2]&&P.ops.pop(),P.trys.pop();continue}Z=N.call(_,P)}catch(Y){Z=[6,Y],M=0}finally{y=U=0}if(5&Z[0])throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}([Z,Y])}}};Object.defineProperty(m,"__esModule",{value:!0});var h=u(501),p=u(6849),E=u(5850),d=u(8311),T=u(6648),A=u(1927),I=u(909),f=u(3805),c=u(752),v=u(3671),S=u(9306),g=u(8636),C=u(2915),R=u(5874),D=function(){function _(){this.debug=!1,this.current404RetryCount=0,this.currentOtherRetryCount=0,this.skipUnsubscribe=!1,this.telemetryMessage="",this.errorCode="",this.pollDataHandler=function(N){},this.resetRetryCount()}return _.prototype.setup=function(N){return s(this,void 0,void 0,function(){return b(this,function(P){return this.logger=N,[2]})})},_.prototype.getPoller=function(){var N=this.pollDataHandler.bind(this);return this.poller||(this.poller=new f.default(this.ic3Info,N,this.redirectErrorHandler.bind(this),this.onRequestCreationFailure.bind(this))),this.poller},_.prototype.setIc3Info=function(N){return s(this,void 0,void 0,function(){var P;return b(this,function(y){return P={RegionGtms:JSON.parse(JSON.stringify(N.RegionGtms)),SkypeToken:N.SkypeToken,visitor:N.visitor},this.ic3Info=P,[2]})})},_.prototype.initializeIC3=function(N){var y,P=this;return N&&(this.pollDataHandler=N),null===(y=this.logger)||void 0===y||y.log(c.default.INFO,v.default.IC3InitializationBegins,{Description:"Endpoint to poll is "+JSON.stringify(this.ic3Info.RegionGtms.chatService),EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.createEndpoint().then(function(){return P.createSubscription()}).then(function(){return P.setEndpointProperty()}).then(function(){return P.startPolling(N)}).then(function(){return P.resetRetryCount()}).then(function(){return Promise.resolve(P.ic3Info)}).catch(function(U){return P.redirectErrorHandler(U)})},_.prototype.startPolling=function(N){var P,y=!N&&this.pollDataHandler?this.pollDataHandler.bind(this):this.pollDataHandler;this.poller||(this.poller=new f.default(this.ic3Info,y,this.redirectErrorHandler.bind(this),this.onRequestCreationFailure.bind(this))),this.poller.ic3Info=this.ic3Info,null===(P=this.logger)||void 0===P||P.log(c.default.INFO,v.default.IC3StartedPolling,{EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.poller.start()},_.prototype.stopPolling=function(N){var P;null===(P=this.logger)||void 0===P||P.log(c.default.INFO,v.default.IC3StoppedPolling,{Description:(N?h.default.oldInitializer:h.default.newInitializer)+" stopped polling.",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.poller&&this.poller.stop()},_.prototype.reset=function(N){return this.stopPolling(N),this.unsubscribeFromEndpoint()},_.prototype.resetRetryCount=function(){this.current404RetryCount=0,this.currentOtherRetryCount=0},_.prototype.onEndpointCreationFailure=function(N){this.onRequestCreationFailure(N,h.default.endpointRequestLog)},_.prototype.onEndpointCreationSuccess=function(N){var P,y,M=I.default.getResponseHeader(N,p.default.SetRegistrationTokenHeader);I.default.isNullOrUndefined(M)||(this.ic3Info.RegistrationToken=I.default.getRegistrationTokenValue(M));var U=I.default.getResponseHeader(N,p.default.LocationHeader);if(!I.default.isNullOrUndefined(U)){var $=U.match(/endpoints\/(%7B[\da-z\-]+%7D)/);this.ic3Info.endpointId=$&&$[1],null===(P=this.logger)||void 0===P||P.log(c.default.INFO,v.default.IC3EndpointCreationSuccess,{Description:"IC3 endpoint Id is "+this.ic3Info.endpointId,EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),N.status===S.default.Created&&g.default.parseChatServiceHostUrl(U)!==this.ic3Info.RegionGtms.chatService&&(this.ic3Info.RegionGtms.chatService=g.default.parseChatServiceHostUrl(U),null===(y=this.logger)||void 0===y||y.log(c.default.WARN,v.default.OnRequestCreationSuccessRedirect,{Description:"Endpoint changed",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}))}},_.prototype.createEndpointRequest=function(){var N=A.default.getV1EndpointUrl(this.ic3Info.RegionGtms),P=T.default.getDefaultIC3Headers();P[p.default.AuthenticationHeader]=p.default.SkypeTokenHeaderValue+this.ic3Info.SkypeToken,P[p.default.ContentTypeHeader]=h.default.ContentTypeJson;var M={endpointFeatures:[d.default.Agent,d.default.InviteFree,d.default.MessageProperties].join(",")},U={callbackOnFailure:this.onEndpointCreationFailure.bind(this),callbackOnSuccess:this.onEndpointCreationSuccess.bind(this),data:JSON.stringify(M),enableExponentialBackoff:!0,headers:P,redirect404RetryCount:h.default.retryCount,retryCount:h.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:g.default.shouldRetryOnFailure,timeBetweenRetry:h.default.timeBetweenOperationRetry,type:R.default.POST,url:N};return C.HttpClient.MakeRequest(U)},_.prototype.createEndpoint=function(){var N=this;return this.createEndpointRequest().then(function(P){return P.subscriptions&&P.subscriptions.length>0&&(N.ic3Info.subscriptionId=P.subscriptions[0].id),P})},_.prototype.onSubscriptionCreationFailure=function(N){this.onRequestCreationFailure(N,h.default.subscriptionRequestLog)},_.prototype.onSubscriptionCreationSuccess=function(N){var P,y=I.default.getResponseHeader(N,p.default.LocationHeader)||"";N.status===S.default.Created&&!I.default.isNullOrUndefined(y)&&g.default.parseChatServiceHostUrl(y)!==this.ic3Info.RegionGtms.chatService&&(this.ic3Info.RegionGtms.chatService=g.default.parseChatServiceHostUrl(y),null===(P=this.logger)||void 0===P||P.log(c.default.WARN,v.default.OnRequestCreationSuccessRedirect,{Description:"Endpoint changed",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}));var M=y.match(/\/(\d+)$/);M&&(this.ic3Info.subscriptionId=M[1])},_.prototype.createSubscriptionRequest=function(){var N=A.default.getV1SubscriptionUrl(this.ic3Info.RegionGtms),P=T.default.getDefaultIC3Headers();P[p.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,P[p.default.ContentTypeHeader]=h.default.ContentTypeJson;var y={channelType:h.default.HttpLongPoll,interestedResources:[E.default.ConversationMessages,E.default.ConversationProperties,E.default.Threads,E.default.Contacts]},M={callbackOnFailure:this.onSubscriptionCreationFailure.bind(this),callbackOnSuccess:this.onSubscriptionCreationSuccess.bind(this),data:JSON.stringify(y),enableExponentialBackoff:!0,headers:P,redirect404RetryCount:h.default.retryCount,retryCount:h.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:g.default.shouldRetryOnFailure,timeBetweenRetry:h.default.timeBetweenOperationRetry,type:R.default.POST,url:N};return C.HttpClient.MakeRequest(M)},_.prototype.createSubscription=function(){return this.createSubscriptionRequest()},_.prototype.onSetEndpointPropertyCreationFailure=function(N){this.onRequestCreationFailure(N,h.default.setPropertiesRequestLog)},_.prototype.setEndpointProperty=function(){if(this.ic3Info.visitor)return Promise.resolve();var N=A.default.getV1SetPropertiesUrl(this.ic3Info.RegionGtms),P={};P[p.default.SetEndpointProperty]=!0;var M=T.default.getDefaultIC3Headers();M[p.default.AuthenticationHeader]=p.default.SkypeTokenHeaderValue+this.ic3Info.SkypeToken,M[p.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,M[p.default.ContentTypeHeader]=h.default.ContentTypeJson;var U={callbackOnFailure:this.onSetEndpointPropertyCreationFailure.bind(this),data:JSON.stringify(P),enableExponentialBackoff:!0,headers:M,redirect404RetryCount:h.default.retryCount,retryCount:h.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:g.default.shouldRetryOnFailure,timeBetweenRetry:h.default.timeBetweenOperationRetry,type:R.default.PUT,url:N};return C.HttpClient.MakeRequest(U)},_.prototype.onUnsubscribeCreationFailure=function(N){this.onRequestCreationFailure(N,h.default.unsubscribeRequestLog)},_.prototype.unsubscribeFromEndpoint=function(){if(this.ic3Info.visitor||I.default.isNullOrUndefined(this.ic3Info.endpointId)||this.skipUnsubscribe)return this.skipUnsubscribe=!0,Promise.resolve();var N=A.default.getV1DeleteEndpointUrl(this.ic3Info.RegionGtms,this.ic3Info.endpointId),P=T.default.getDefaultIC3Headers();P[p.default.AuthenticationHeader]=p.default.SkypeTokenHeaderValue+this.ic3Info.SkypeToken,P[p.default.RegistrationTokenHeader]=this.ic3Info.RegistrationToken,P[p.default.ContentTypeHeader]=h.default.ContentTypeJson;var y={callbackOnFailure:this.onUnsubscribeCreationFailure.bind(this),enableExponentialBackoff:!0,headers:P,redirect404RetryCount:h.default.retryCount,retryCount:h.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:g.default.shouldRetryOnFailure,timeBetweenRetry:h.default.timeBetweenOperationRetry,type:R.default.DELETE,url:N};return C.HttpClient.MakeRequest(y)},_.prototype.onRequestCreationFailure=function(N,P){var y,M,U=I.default.getResponseHeader(N,p.default.LocationHeader);this.telemetryMessage=P+" failed. Error Code: "+N.status+".",this.errorCode=N.status.toString(),this.skipUnsubscribe=!0,N.status!==S.default.Redirect||I.default.isNullOrEmptyString(U)?(null===(M=this.logger)||void 0===M||M.log(c.default.WARN,v.default.ResetOnRequestCreationFailure,{Description:this.telemetryMessage+" Trying to reset.",ErrorCode:N.status.toString(),EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.current404RetryCount=0,this.currentOtherRetryCount++):(null===(y=this.logger)||void 0===y||y.log(c.default.WARN,v.default.RedirectOnRequestCreationFailure,{Description:this.telemetryMessage+" Trying to redirect.",ErrorCode:N.status.toString(),EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.onRequestCreationFailureRedirect(N))},_.prototype.redirectErrorHandler=function(N){var y,P=this;return N.message===h.default.Reset_Flag&&this.current404RetryCount<=h.default.retry404Count&&this.currentOtherRetryCount<=h.default.retryCount?this.reset().then(function(){return P.initializeIC3()}):(null===(y=this.logger)||void 0===y||y.log(c.default.ERROR,v.default.MaxRetryCountReachedForRedirect,{Description:"Fatal Error. Initialization failed. Maximum retry count reached. Exiting. "+this.telemetryMessage,ErrorCode:this.errorCode,ExceptionDetails:N,EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId}),this.reset().then(function(){return Promise.reject(N.message)}))},_.prototype.onRequestCreationFailureRedirect=function(N){var P;this.current404RetryCount++,this.currentOtherRetryCount=0,this.ic3Info.RegionGtms.chatService=g.default.parseChatServiceHostUrl(I.default.getResponseHeader(N,p.default.LocationHeader)),null===(P=this.logger)||void 0===P||P.log(c.default.WARN,v.default.OnRequestCreationFailureRedirect,{Description:"Endpoint changed.",EndpointUrl:this.ic3Info.RegionGtms.chatService,EndpointId:this.ic3Info.endpointId})},_}();m.default=D},9202:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(2518),b=u(1356),h=function(){function p(){}return p.getSDK=function(E){return new Promise(function(d){var A=s.default.getClientBridge({hostType:E.hostType,protocolType:E.protocolType}),I={logger:new b.default(A,E.logger)};return A.setup(I).then(function(){var f={dispose:A.dispose.bind(A),id:A.id,initialize:A.initialize.bind(A),joinConversation:A.joinConversation.bind(A),update:A.update.bind(A),setDebug:A.setDebug.bind(A)};return d(f)})})},p}();m.default=h},2915:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.HttpClient=void 0;var s=u(909),b=u(501),h=u(3671),p=u(752),E=u(6849),d=u(9306),T=u(8686),A=function(){function I(){}return I.MakeRequest=function(f){return new Promise(function(v,S){var R=0,D=f.retryCount||1,_={url:f.url,method:f.type,data:f.data,timeout:f.timeout,headers:f.headers,withCredentials:f.useXHRWithCredentials||!1},N=function(){T.default.request(_).then(function(P){!function(P,y){if(y.status>=400){var M={ResponseText:y.statusText,Status:status};I.logWarning("Requesting "+f.url,y.status,M)}f.callbackOnSuccess&&f.callbackOnSuccess(y),v(P)}(P.data,P)}).catch(function(P){!function(P){var y,M,U,$,j,ue,Z,Y,W,ce,Ce={ErrorThrown:P.message,ResponseText:null===(y=P.response)||void 0===y?void 0:y.statusText,Status:null===(M=P.response)||void 0===M?void 0:M.status},ne=function(){var re,ve;I.logError("Request to "+f.url+" failed.",(null===(re=P.response)||void 0===re?void 0:re.status)||0,Ce),S(new Error((null===(ve=P.response)||void 0===ve?void 0:ve.statusText)||""))},X=function(){var re;I.logError("Request to "+f.url+" failed. Resetting endpoint.",(null===(re=P.response)||void 0===re?void 0:re.status)||0,Ce),f.callbackOnFailure&&f.callbackOnFailure(P),S(new Error(b.default.Reset_Flag))},de=function(){var re;R++;var ve=f.timeBetweenRetry||0;(f.enableExponentialBackoff||(null===(re=P.response)||void 0===re?void 0:re.status)===d.default.TooManyRequests)&&(ve*=Math.exp(R)),setTimeout(function(){N()},ve)},te=null===(U=P.response)||void 0===U?void 0:U.headers[E.default.LocationHeader],K=null===($=P.response)||void 0===$?void 0:$.headers[E.default.SetRegistrationTokenHeader];(null===(j=P.response)||void 0===j?void 0:j.status)!==d.default.Redirect||s.default.isNullOrEmptyString(te)?(null===(ue=P.response)||void 0===ue?void 0:ue.status)!==d.default.Unauthorized&&(null===(Z=P.response)||void 0===Z?void 0:Z.status)!==d.default.Forbidden||s.default.isNullOrEmptyString(K)?R<=D&&f.shouldRetryOnFailure&&f.shouldRetryOnFailure((null===(W=P.response)||void 0===W?void 0:W.status)||0)||(null===(ce=P.response)||void 0===ce?void 0:ce.status)===d.default.TooManyRequests?de():f.shouldResetOnFailure?X():ne():R<=D&&f.shouldRetryOnFailure&&f.shouldRetryOnFailure((null===(Y=P.response)||void 0===Y?void 0:Y.status)||0)?(f.headers&&(f.headers[E.default.RegistrationTokenHeader]=s.default.getRegistrationTokenValue(K)),de()):f.shouldResetOnFailure?X():ne():f.shouldRedirectOn404?X():R<=D?(f.url=te,de()):ne()}(P)})};N()})},I.isClientError=function(f){if(!f)return!1;var c=f.message,v=!1;return s.default.isNullOrEmptyString(c)||(v=c.search(/Status- 40\d/)>=-1),v},I.setLogger=function(f){I.logger=f},I.logError=function(f,c,v){I.logger&&I.logger.log(p.default.ERROR,h.default.HTTPRequestFailed,{Description:f,ErrorCode:c.toString(),ExceptionDetails:v})},I.logWarning=function(f,c,v){I.logger&&I.logger.log(p.default.INFO,h.default.HTTPRequestUnusualResponse,{Description:f,ErrorCode:c.toString(),ExceptionDetails:v})},I}();m.HttpClient=A},9306:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.OK=200,s.Created=201,s.Accepted=202,s.NoContent=204,s.Unauthorized=401,s.Forbidden=403,s.Redirect=404,s.TooManyRequests=429,s.InternalServerError=500,s.ServiceUnavailable=503,s.NotFound=729,s}();m.default=u},5256:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.TEXT="text",s}();m.default=u},6849:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.LocationHeader="location",s.SetRegistrationTokenHeader="set-registrationtoken",s.RegistrationTokenHeader="RegistrationToken",s.RegistrationTokenHeaderValue="registrationToken=",s.ContentTypeHeader="content-type",s.AuthenticationHeader="authentication",s.BehaviorOverrideHeader="behavioroverride",s.SkypeTokenHeaderValue="skypetoken=",s.SetEndpointProperty="supportsMessageProperties",s}();m.default=u},5874:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).GET="get",s.POST="post",s.PUT="put",s.DELETE="delete",u;var s})();m.default=u},6648:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(501),b=u(737),h=function(){function p(){}return p.getDefaultIC3Headers=function(){return{Accept:s.default.ContentTypeJson,BehaviorOverride:s.default.RedirectAs404,ClientInfo:s.default.ClientInfoValue,ContextId:"tcid="+(0,b.uuidv4)(),Expires:0,Pragma:s.default.NoCache,"x-ms-client-type":s.default.Web,"x-ms-user-type":s.default.User}},p.getDefaultBaseIC3Headers=function(){return{Accept:s.default.ContentTypeJson,BehaviorOverride:s.default.RedirectAs404,"content-type":s.default.ContentTypeJson}},p.getDefaultGetMessagesQueryParameters=function(){return{pageSize:20,startTime:0,view:"msnp24Equivalent|supportsMessageProperties"}},p.getDefaultAMSHeaders=function(E){return{Authorization:s.default.AMSAuthorizationSkypeTokenValue+E,"X-MS-Client-Version":s.default.ClientInfoValue}},p.getDefaultAMSViewHeaders=function(E){return{Accept:s.default.AMSAcceptHeaderValue,"Accept-Encoding":s.default.AMSAcceptEncodingHeaderValue,Authorization:s.default.AMSAuthorizationSkypeTokenValue+E,"X-MS-Client-Version":s.default.ClientInfoValue}},p}();m.default=h},6194:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.SDKProvider=void 0;var s=u(9202);m.SDKProvider=s.default},2217:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.IFrame=0,s.Page=1,s}();m.default=u},5655:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.IC3V1SDK=0,s.IC3V2SDK=1,s.MockIC3SDK=2,s}();m.default=u},3671:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).JoinConversation="JoinConversation",s.RegisterOnNewMessage="RegisterOnNewMessage",s.RegisterOnThreadUpdate="RegisterOnThreadUpdate",s.OnNewMessageFailure="OnNewMessageFailure",s.OnThreadUpdateFailure="OnThreadUpdateFailure",s.SendLiveStateFailure="SendLiveStateFailure",s.JoinConversationV1GetThreadRequestFailed="JoinConversationV1GetThreadRequestFailed",s.UpdateToken="UpdateToken",s.SyncingPollData="SyncingPollData",s.IC3InitializationBegins="IC3InitializationBegins",s.IC3StartedPolling="IC3StartedPolling",s.IC3StoppedPolling="IC3StoppedPolling",s.IC3EndpointCreationSuccess="IC3EndpointCreationSuccess",s.RedirectOnRequestCreationFailure="RedirectOnRequestCreationFailure",s.ResetOnRequestCreationFailure="ResetOnRequestCreationFailure",s.MaxRetryCountReachedForRedirect="MaxRetryCountReachedForRedirect",s.OnRequestCreationFailureRedirect="OnRequestCreationFailureRedirect",s.OnRequestCreationSuccessRedirect="OnRequestCreationSuccessRedirect",s.ErrorDuringPolling="ErrorDuringPolling",s.HTTPRequestFailed="HTTPRequestFailed",s.HTTPRequestUnusualResponse="HTTPRequestUnusualResponse",u;var s})();m.default=u},752:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={})).INFO="INFO",s.DEBUG="DEBUG",s.WARN="WARN",s.ERROR="ERROR",u;var s})();m.default=u},1356:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(909),b=u(8261),h=function(){function p(E,d){this.sdk=E,this.logger=d}return p.prototype.log=function(E,d,T){if(this.isLoggingEnabled()){var A=b.default.getTelemetryEventData(this.sdk,d,T);this.logEvent(E,A)}},p.prototype.logEvent=function(E,d){this.isLoggingEnabled()&&setTimeout(this.logger.logClientSdkTelemetryEvent.bind(this.logger),0,E,d)},p.prototype.isLoggingEnabled=function(){return!s.default.isNullOrUndefined(this.logger)},p}();m.default=h},8261:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.getTelemetryEventData=function(b,h,p){return{Description:p.Description,ElapsedTimeInMilliseconds:p.ElapsedTimeInMilliseconds,EndpointUrl:p.EndpointUrl,EndpointId:p.EndpointId,ErrorCode:p.ErrorCode,Event:h,ExceptionDetails:p.ExceptionDetails,ShouldBubbleToHost:p.ShouldBubbleToHost,SubscriptionId:b.id}},s}();m.default=u},2900:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.Bridged="bridged",s.Unbridged="unbridged",s}();m.default=u},4694:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.AmsBasedFileSharing=0]="AmsBasedFileSharing",u;var s})();m.default=u},6355:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.Unknown=0]="Unknown",s[s.InProgress=1]="InProgress",s[s.Success=2]="Success",s[s.Error=3]="Error",u;var s})();m.default=u},5850:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.ConversationProperties="/v1/users/ME/conversations/ALL/properties",s.ConversationMessages="/v1/users/ME/conversations/ALL/messages",s.Threads="/v1/threads/ALL",s.Contacts="/v1/users/ME/contacts/ALL",s}();m.default=u},8311:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.Agent="Agent",s.MessageProperties="MessageProperties",s.InviteFree="InviteFree",s}();m.default=u},448:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.RichText="RichText",s.Text="Text",s}();m.default=u},3207:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.Text="Text",s.RichText="RichText",s.RichTextHtml="RichText/Html",s.ControlTyping="Control/Typing",s.ControlClearTyping="Control/ClearTyping",s.LiveState="Control/LiveState",s}();m.default=u},3372:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.UserMessage="UserMessage",s.SwiftCard="SwiftCard",s.Typing="Control/Typing",s.ClearTyping="Control/ClearTyping",s.LiveState="Control/LiveState",s}();m.default=u},4352:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.Unknown=0]="Unknown",s[s.User=1]="User",s[s.Bot=2]="Bot",u;var s})();m.default=u},5785:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=function(){function s(){}return s.NewMessage="NewMessage",s.MessageUpdate="MessageUpdate",s.UserPresence="UserPresence",s.ConversationUpdate="ConversationUpdate",s.ThreadUpdate="ThreadUpdate",s}();m.default=u},7708:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var u=(()=>{return(s=u||(u={}))[s.Typing=0]="Typing",s[s.ClearTyping=1]="ClearTyping",u;var s})();m.default=u},3805:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(1927),b=u(2553),h=u(501),p=function(){function E(d,T,A,I){this.isPolling=!1,this._ic3Info=d,this._onNewData=T,this._onError=A,this.callbackOnFailure=I}return E.prototype.start=function(){return this.isPolling||(this.isPolling=!0,this.startPolling()),Promise.resolve()},E.prototype.stop=function(){return this.isPolling=!1,Promise.resolve()},Object.defineProperty(E.prototype,"onNewData",{get:function(){return this._onNewData},set:function(d){this._onNewData=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onError",{get:function(){return this._onError},set:function(d){this._onError=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"setCallbackOnFailure",{set:function(d){this.setCallbackOnFailure=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"ic3Info",{get:function(){return this._ic3Info},set:function(d){this._ic3Info=d},enumerable:!1,configurable:!0}),E.prototype.startPolling=function(){var d=this;this.isPolling&&this.poll().then(function(T){d.isPolling&&d._onNewData&&d._onNewData(T)}).catch(function(T){d._onError&&d._onError(T)}).then(function(){d.startPolling()})},E.prototype.poll=function(){var d=s.default.getV1PollUrl(this._ic3Info.RegionGtms,this._ic3Info.subscriptionId);return b.default.poll(d,this._ic3Info.RegistrationToken,this.callbackOnEachRequestCompleted.bind(this))},E.prototype.callbackOnEachRequestCompleted=function(d){this.callbackOnFailure(d,h.default.pollRequestLog)},E}();m.default=p},2553:(Q,m,u)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});var s=u(501),b=u(2915),h=u(6849),p=u(5874),E=u(6648),d=u(8636),T=function(){function A(){}return A.poll=function(I,f,c){var v=E.default.getDefaultIC3Headers();v[h.default.RegistrationTokenHeader]=f,v[h.default.ContentTypeHeader]=s.default.ContentTypeJson;var S=JSON.stringify({});return b.HttpClient.MakeRequest({callbackOnFailure:c,data:S,enableExponentialBackoff:!0,headers:v,redirect404RetryCount:s.default.retryCount,retryCount:s.default.retryCount,shouldRedirectOn404:!0,shouldResetOnFailure:!0,shouldRetryOnFailure:d.default.shouldRetryOnFailure,timeBetweenRetry:s.default.timeBetweenOperationRetry,type:p.default.POST,url:I})},A}();m.default=T},737:(Q,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.uuidv4=void 0,m.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var b=16*Math.random()|0;return("x"===s?b:3&b|8).toString(16)})}},7504:(Q,m,u)=>{"use strict";u.d(m,{Rr:()=>be,Do:()=>fr,g4:()=>bi});var s="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},b="1.1.0",h=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,E=function(he){var _e=new Set([he]),Re=new Set,Ye=he.match(h);if(!Ye)return function(){return!1};var et_major=+Ye[1],et_minor=+Ye[2],et_patch=+Ye[3];if(null!=Ye[4])return function(Ht){return Ht===he};function it(Rn){return Re.add(Rn),!1}function wt(Rn){return _e.add(Rn),!0}return function(Ht){if(_e.has(Ht))return!0;if(Re.has(Ht))return!1;var On=Ht.match(h);if(!On)return it(Ht);var qn_minor=+On[2],qn_patch=+On[3];return null!=On[4]||et_major!==+On[1]?it(Ht):0===et_major?et_minor===qn_minor&&et_patch<=qn_patch?wt(Ht):it(Ht):et_minor<=qn_minor?wt(Ht):it(Ht)}}(b),d=b.split(".")[0],T=Symbol.for("opentelemetry.js.api."+d),A=s;function I(he,_e,Re,Ye){var et;void 0===Ye&&(Ye=!1);var it=A[T]=null!==(et=A[T])&&void 0!==et?et:{version:b};if(!Ye&&it[he]){var wt=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+he);return Re.error(wt.stack||wt.message),!1}return it.version!==b?(wt=new Error("@opentelemetry/api: All API registration versions must match"),Re.error(wt.stack||wt.message),!1):(it[he]=_e,Re.debug("@opentelemetry/api: Registered a global for "+he+" v"+b+"."),!0)}function f(he){var _e,Re,Ye=null===(_e=A[T])||void 0===_e?void 0:_e.version;if(Ye&&E(Ye))return null===(Re=A[T])||void 0===Re?void 0:Re[he]}function c(he,_e){_e.debug("@opentelemetry/api: Unregistering a global for "+he+" v"+b+".");var Re=A[T];Re&&delete Re[he]}var v=function(){function he(_e){this._namespace=_e.namespace||"DiagComponentLogger"}return he.prototype.debug=function(){for(var _e=[],Re=0;Re<arguments.length;Re++)_e[Re]=arguments[Re];return S("debug",this._namespace,_e)},he.prototype.error=function(){for(var _e=[],Re=0;Re<arguments.length;Re++)_e[Re]=arguments[Re];return S("error",this._namespace,_e)},he.prototype.info=function(){for(var _e=[],Re=0;Re<arguments.length;Re++)_e[Re]=arguments[Re];return S("info",this._namespace,_e)},he.prototype.warn=function(){for(var _e=[],Re=0;Re<arguments.length;Re++)_e[Re]=arguments[Re];return S("warn",this._namespace,_e)},he.prototype.verbose=function(){for(var _e=[],Re=0;Re<arguments.length;Re++)_e[Re]=arguments[Re];return S("verbose",this._namespace,_e)},he}();function S(he,_e,Re){var Ye=f("diag");if(Ye)return Re.unshift(_e),Ye[he].apply(Ye,Re)}var g=(()=>{return(he=g||(g={}))[he.NONE=0]="NONE",he[he.ERROR=30]="ERROR",he[he.WARN=50]="WARN",he[he.INFO=60]="INFO",he[he.DEBUG=70]="DEBUG",he[he.VERBOSE=80]="VERBOSE",he[he.ALL=9999]="ALL",g;var he})(),D=function(){function he(){function _e(Ye){return function(){for(var et=[],it=0;it<arguments.length;it++)et[it]=arguments[it];var wt=f("diag");if(wt)return wt[Ye].apply(wt,et)}}var Re=this;Re.setLogger=function(Ye,et){var it,wt;if(void 0===et&&(et=g.INFO),Ye===Re){var Rn=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return Re.error(null!==(it=Rn.stack)&&void 0!==it?it:Rn.message),!1}var Ht=f("diag"),On=function(he,_e){function Re(Ye,et){var it=_e[Ye];return"function"==typeof it&&he>=et?it.bind(_e):function(){}}return he<g.NONE?he=g.NONE:he>g.ALL&&(he=g.ALL),_e=_e||{},{error:Re("error",g.ERROR),warn:Re("warn",g.WARN),info:Re("info",g.INFO),debug:Re("debug",g.DEBUG),verbose:Re("verbose",g.VERBOSE)}}(et,Ye);if(Ht){var qn=null!==(wt=(new Error).stack)&&void 0!==wt?wt:"<failed to generate stacktrace>";Ht.warn("Current logger will be overwritten from "+qn),On.warn("Current logger will overwrite one already registered from "+qn)}return I("diag",On,Re,!0)},Re.disable=function(){c("diag",Re)},Re.createComponentLogger=function(Ye){return new v(Ye)},Re.verbose=_e("verbose"),Re.debug=_e("debug"),Re.info=_e("info"),Re.warn=_e("warn"),Re.error=_e("error")}return he.instance=function(){return this._instance||(this._instance=new he),this._instance},he}(),_=function(){function he(_e){this._entries=_e?new Map(_e):new Map}return he.prototype.getEntry=function(_e){var Re=this._entries.get(_e);if(Re)return Object.assign({},Re)},he.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(_e){return[_e[0],_e[1]]})},he.prototype.setEntry=function(_e,Re){var Ye=new he(this._entries);return Ye._entries.set(_e,Re),Ye},he.prototype.removeEntry=function(_e){var Re=new he(this._entries);return Re._entries.delete(_e),Re},he.prototype.removeEntries=function(){for(var _e=[],Re=0;Re<arguments.length;Re++)_e[Re]=arguments[Re];for(var Ye=new he(this._entries),et=0,it=_e;et<it.length;et++){var wt=it[et];Ye._entries.delete(wt)}return Ye},he.prototype.clear=function(){return new he},he}();function y(he){return void 0===he&&(he={}),new _(new Map(Object.entries(he)))}Symbol("BaggageEntryMetadata"),D.instance();var j={get:function(he,_e){if(null!=he)return he[_e]},keys:function(he){return null==he?[]:Object.keys(he)}},ue={set:function(he,_e,Re){null!=he&&(he[_e]=Re)}};function Z(he){return Symbol.for(he)}var W=new function he(_e){var Re=this;Re._currentContext=_e?new Map(_e):new Map,Re.getValue=function(Ye){return Re._currentContext.get(Ye)},Re.setValue=function(Ye,et){var it=new he(Re._currentContext);return it._currentContext.set(Ye,et),it},Re.deleteValue=function(Ye){var et=new he(Re._currentContext);return et._currentContext.delete(Ye),et}},ce=function(he,_e){for(var Re=0,Ye=_e.length,et=he.length;Re<Ye;Re++,et++)he[et]=_e[Re];return he},Ce=function(){function he(){}return he.prototype.active=function(){return W},he.prototype.with=function(_e,Re,Ye){for(var et=[],it=3;it<arguments.length;it++)et[it-3]=arguments[it];return Re.call.apply(Re,ce([Ye],et))},he.prototype.bind=function(_e,Re){return Re},he.prototype.enable=function(){return this},he.prototype.disable=function(){return this},he}(),ne=function(he,_e){for(var Re=0,Ye=_e.length,et=he.length;Re<Ye;Re++,et++)he[et]=_e[Re];return he},X="context",de=new Ce,te=function(){function he(){}return he.getInstance=function(){return this._instance||(this._instance=new he),this._instance},he.prototype.setGlobalContextManager=function(_e){return I(X,_e,D.instance())},he.prototype.active=function(){return this._getContextManager().active()},he.prototype.with=function(_e,Re,Ye){for(var et,it=[],wt=3;wt<arguments.length;wt++)it[wt-3]=arguments[wt];return(et=this._getContextManager()).with.apply(et,ne([_e,Re,Ye],it))},he.prototype.bind=function(_e,Re){return this._getContextManager().bind(_e,Re)},he.prototype._getContextManager=function(){return f(X)||de},he.prototype.disable=function(){this._getContextManager().disable(),c(X,D.instance())},he}(),K=(()=>{return(he=K||(K={}))[he.NONE=0]="NONE",he[he.SAMPLED=1]="SAMPLED",K;var he})(),re="0000000000000000",ve="00000000000000000000000000000000",be={traceId:ve,spanId:re,traceFlags:K.NONE},Be=function(){function he(_e){void 0===_e&&(_e=be),this._spanContext=_e}return he.prototype.spanContext=function(){return this._spanContext},he.prototype.setAttribute=function(_e,Re){return this},he.prototype.setAttributes=function(_e){return this},he.prototype.addEvent=function(_e,Re){return this},he.prototype.setStatus=function(_e){return this},he.prototype.updateName=function(_e){return this},he.prototype.end=function(_e){},he.prototype.isRecording=function(){return!1},he.prototype.recordException=function(_e,Re){},he}(),$e=Z("OpenTelemetry Context Key SPAN");function Oe(he){return he.getValue($e)||void 0}function se(he,_e){return he.setValue($e,_e)}function fe(he){return he.deleteValue($e)}function we(he,_e){return se(he,new Be(_e))}function Te(he){var _e;return null===(_e=Oe(he))||void 0===_e?void 0:_e.spanContext()}var ye=/^([0-9a-f]{32})$/i,Pe=/^[0-9a-f]{16}$/i;function Ie(he){return function(he){return ye.test(he)&&he!==ve}(he.traceId)&&function(he){return Pe.test(he)&&he!==re}(he.spanId)}function We(he){return new Be(he)}var Qe=te.getInstance(),Ge=function(){function he(){}return he.prototype.startSpan=function(_e,Re,Ye){if(Boolean(null==Re?void 0:Re.root))return new Be;var it=Ye&&Te(Ye);return function(he){return"object"==typeof he&&"string"==typeof he.spanId&&"string"==typeof he.traceId&&"number"==typeof he.traceFlags}(it)&&Ie(it)?new Be(it):new Be},he.prototype.startActiveSpan=function(_e,Re,Ye,et){var it,wt,Rn;if(!(arguments.length<2)){2===arguments.length?Rn=Re:3===arguments.length?(it=Re,Rn=Ye):(it=Re,wt=Ye,Rn=et);var Ht=null!=wt?wt:Qe.active(),On=this.startSpan(_e,it,Ht),qn=se(Ht,On);return Qe.with(qn,Rn,void 0,On)}},he}(),Le=new Ge,at=function(){function he(_e,Re,Ye,et){this._provider=_e,this.name=Re,this.version=Ye,this.options=et}return he.prototype.startSpan=function(_e,Re,Ye){return this._getTracer().startSpan(_e,Re,Ye)},he.prototype.startActiveSpan=function(_e,Re,Ye,et){var it=this._getTracer();return Reflect.apply(it.startActiveSpan,it,arguments)},he.prototype._getTracer=function(){if(this._delegate)return this._delegate;var _e=this._provider.getDelegateTracer(this.name,this.version,this.options);return _e?(this._delegate=_e,this._delegate):Le},he}(),vt=new(function(){function he(){}return he.prototype.getTracer=function(_e,Re,Ye){return new Ge},he}()),Qt=function(){function he(){}return he.prototype.getTracer=function(_e,Re,Ye){var et;return null!==(et=this.getDelegateTracer(_e,Re,Ye))&&void 0!==et?et:new at(this,_e,Re,Ye)},he.prototype.getDelegate=function(){var _e;return null!==(_e=this._delegate)&&void 0!==_e?_e:vt},he.prototype.setDelegate=function(_e){this._delegate=_e},he.prototype.getDelegateTracer=function(_e,Re,Ye){var et;return null===(et=this._delegate)||void 0===et?void 0:et.getTracer(_e,Re,Ye)},he}(),bt=new RegExp("^(?:[a-z][_0-9a-z-*/]{0,255}|[a-z0-9][_0-9a-z-*/]{0,240}@[a-z][_0-9a-z-*/]{0,13})$"),Nt=/^[ -~]{0,255}[!-~]$/,ot=/,|=/;!function(){function he(_e){this._internalState=new Map,_e&&this._parse(_e)}he.prototype.set=function(_e,Re){var Ye=this._clone();return Ye._internalState.has(_e)&&Ye._internalState.delete(_e),Ye._internalState.set(_e,Re),Ye},he.prototype.unset=function(_e){var Re=this._clone();return Re._internalState.delete(_e),Re},he.prototype.get=function(_e){return this._internalState.get(_e)},he.prototype.serialize=function(){var _e=this;return this._keys().reduce(function(Re,Ye){return Re.push(Ye+"="+_e.get(Ye)),Re},[]).join(",")},he.prototype._parse=function(_e){_e.length>512||(this._internalState=_e.split(",").reverse().reduce(function(Re,Ye){var et=Ye.trim(),it=et.indexOf("=");if(-1!==it){var wt=et.slice(0,it),Rn=et.slice(it+1,Ye.length);(function(he){return bt.test(he)})(wt)&&function(he){return Nt.test(he)&&!ot.test(he)}(Rn)&&Re.set(wt,Rn)}return Re},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},he.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},he.prototype._clone=function(){var _e=new he;return _e._internalState=new Map(this._internalState),_e}}();var Kn="trace",xt=function(){function he(){this._proxyTracerProvider=new Qt,this.wrapSpanContext=We,this.isSpanContextValid=Ie,this.deleteSpan=fe,this.getSpan=Oe,this.getSpanContext=Te,this.setSpan=se,this.setSpanContext=we}return he.getInstance=function(){return this._instance||(this._instance=new he),this._instance},he.prototype.setGlobalTracerProvider=function(_e){var Re=I(Kn,this._proxyTracerProvider,D.instance());return Re&&this._proxyTracerProvider.setDelegate(_e),Re},he.prototype.getTracerProvider=function(){return f(Kn)||this._proxyTracerProvider},he.prototype.getTracer=function(_e,Re){return this.getTracerProvider().getTracer(_e,Re)},he.prototype.disable=function(){c(Kn,D.instance()),this._proxyTracerProvider=new Qt},he}(),Er=function(){function he(){}return he.prototype.inject=function(_e,Re){},he.prototype.extract=function(_e,Re){return _e},he.prototype.fields=function(){return[]},he}(),It=Z("OpenTelemetry Baggage Key");function Lt(he){return he.getValue(It)||void 0}function Lr(he,_e){return he.setValue(It,_e)}function Ti(he){return he.deleteValue(It)}var ft="propagation",Gi=new Er,Io=function(){function he(){this.createBaggage=y,this.getBaggage=Lt,this.setBaggage=Lr,this.deleteBaggage=Ti}return he.getInstance=function(){return this._instance||(this._instance=new he),this._instance},he.prototype.setGlobalPropagator=function(_e){return I(ft,_e,D.instance())},he.prototype.inject=function(_e,Re,Ye){return void 0===Ye&&(Ye=ue),this._getGlobalPropagator().inject(_e,Re,Ye)},he.prototype.extract=function(_e,Re,Ye){return void 0===Ye&&(Ye=j),this._getGlobalPropagator().extract(_e,Re,Ye)},he.prototype.fields=function(){return this._getGlobalPropagator().fields()},he.prototype.disable=function(){c(ft,D.instance())},he.prototype._getGlobalPropagator=function(){return f(ft)||Gi},he}(),fr=te.getInstance(),bi=xt.getInstance();Io.getInstance(),D.instance()},8686:(Q,m,u)=>{Q.exports=u(5454)},4054:(Q,m,u)=>{"use strict";var s=u(9471),b=u(5650),h=u(300),p=u(7790),E=u(4634),d=u(1929),T=u(2984),A=u(5886);Q.exports=function(f){return new Promise(function(v,S){var g=f.data,C=f.headers,R=f.responseType;s.isFormData(g)&&delete C["Content-Type"];var D=new XMLHttpRequest;if(f.auth){var _=f.auth.username||"",N=f.auth.password?unescape(encodeURIComponent(f.auth.password)):"";C.Authorization="Basic "+btoa(_+":"+N)}var P=E(f.baseURL,f.url);function y(){if(D){var U="getAllResponseHeaders"in D?d(D.getAllResponseHeaders()):null;b(v,S,{data:R&&"text"!==R&&"json"!==R?D.response:D.responseText,status:D.status,statusText:D.statusText,headers:U,config:f,request:D}),D=null}}if(D.open(f.method.toUpperCase(),p(P,f.params,f.paramsSerializer),!0),D.timeout=f.timeout,"onloadend"in D?D.onloadend=y:D.onreadystatechange=function(){!D||4!==D.readyState||0===D.status&&(!D.responseURL||0!==D.responseURL.indexOf("file:"))||setTimeout(y)},D.onabort=function(){!D||(S(A("Request aborted",f,"ECONNABORTED",D)),D=null)},D.onerror=function(){S(A("Network Error",f,null,D)),D=null},D.ontimeout=function(){var $="timeout of "+f.timeout+"ms exceeded";f.timeoutErrorMessage&&($=f.timeoutErrorMessage),S(A($,f,f.transitional&&f.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",D)),D=null},s.isStandardBrowserEnv()){var M=(f.withCredentials||T(P))&&f.xsrfCookieName?h.read(f.xsrfCookieName):void 0;M&&(C[f.xsrfHeaderName]=M)}"setRequestHeader"in D&&s.forEach(C,function($,j){void 0===g&&"content-type"===j.toLowerCase()?delete C[j]:D.setRequestHeader(j,$)}),s.isUndefined(f.withCredentials)||(D.withCredentials=!!f.withCredentials),R&&"json"!==R&&(D.responseType=f.responseType),"function"==typeof f.onDownloadProgress&&D.addEventListener("progress",f.onDownloadProgress),"function"==typeof f.onUploadProgress&&D.upload&&D.upload.addEventListener("progress",f.onUploadProgress),f.cancelToken&&f.cancelToken.promise.then(function($){!D||(D.abort(),S($),D=null)}),g||(g=null),D.send(g)})}},5454:(Q,m,u)=>{"use strict";var s=u(9471),b=u(1533),h=u(3227),p=u(4018);function d(A){var I=new h(A),f=b(h.prototype.request,I);return s.extend(f,h.prototype,I),s.extend(f,I),f}var T=d(u(2567));T.Axios=h,T.create=function(I){return d(p(T.defaults,I))},T.Cancel=u(8728),T.CancelToken=u(701),T.isCancel=u(2130),T.all=function(I){return Promise.all(I)},T.spread=u(8908),T.isAxiosError=u(9541),Q.exports=T,Q.exports.default=T},8728:Q=>{"use strict";function m(u){this.message=u}m.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},m.prototype.__CANCEL__=!0,Q.exports=m},701:(Q,m,u)=>{"use strict";var s=u(8728);function b(h){if("function"!=typeof h)throw new TypeError("executor must be a function.");var p;this.promise=new Promise(function(T){p=T});var E=this;h(function(T){E.reason||(E.reason=new s(T),p(E.reason))})}b.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},b.source=function(){var p;return{token:new b(function(T){p=T}),cancel:p}},Q.exports=b},2130:Q=>{"use strict";Q.exports=function(u){return!(!u||!u.__CANCEL__)}},3227:(Q,m,u)=>{"use strict";var s=u(9471),b=u(7790),h=u(3976),p=u(6764),E=u(4018),d=u(3558),T=d.validators;function A(I){this.defaults=I,this.interceptors={request:new h,response:new h}}A.prototype.request=function(f){"string"==typeof f?(f=arguments[1]||{}).url=arguments[0]:f=f||{},(f=E(this.defaults,f)).method=f.method?f.method.toLowerCase():this.defaults.method?this.defaults.method.toLowerCase():"get";var c=f.transitional;void 0!==c&&d.assertOptions(c,{silentJSONParsing:T.transitional(T.boolean,"1.0.0"),forcedJSONParsing:T.transitional(T.boolean,"1.0.0"),clarifyTimeoutError:T.transitional(T.boolean,"1.0.0")},!1);var v=[],S=!0;this.interceptors.request.forEach(function(y){"function"==typeof y.runWhen&&!1===y.runWhen(f)||(S=S&&y.synchronous,v.unshift(y.fulfilled,y.rejected))});var C,g=[];if(this.interceptors.response.forEach(function(y){g.push(y.fulfilled,y.rejected)}),!S){var R=[p,void 0];for(Array.prototype.unshift.apply(R,v),R=R.concat(g),C=Promise.resolve(f);R.length;)C=C.then(R.shift(),R.shift());return C}for(var D=f;v.length;){var _=v.shift(),N=v.shift();try{D=_(D)}catch(P){N(P);break}}try{C=p(D)}catch(P){return Promise.reject(P)}for(;g.length;)C=C.then(g.shift(),g.shift());return C},A.prototype.getUri=function(f){return f=E(this.defaults,f),b(f.url,f.params,f.paramsSerializer).replace(/^\?/,"")},s.forEach(["delete","get","head","options"],function(f){A.prototype[f]=function(c,v){return this.request(E(v||{},{method:f,url:c,data:(v||{}).data}))}}),s.forEach(["post","put","patch"],function(f){A.prototype[f]=function(c,v,S){return this.request(E(S||{},{method:f,url:c,data:v}))}}),Q.exports=A},3976:(Q,m,u)=>{"use strict";var s=u(9471);function b(){this.handlers=[]}b.prototype.use=function(p,E,d){return this.handlers.push({fulfilled:p,rejected:E,synchronous:!!d&&d.synchronous,runWhen:d?d.runWhen:null}),this.handlers.length-1},b.prototype.eject=function(p){this.handlers[p]&&(this.handlers[p]=null)},b.prototype.forEach=function(p){s.forEach(this.handlers,function(d){null!==d&&p(d)})},Q.exports=b},4634:(Q,m,u)=>{"use strict";var s=u(5164),b=u(1540);Q.exports=function(p,E){return p&&!s(E)?b(p,E):E}},5886:(Q,m,u)=>{"use strict";var s=u(9570);Q.exports=function(h,p,E,d,T){var A=new Error(h);return s(A,p,E,d,T)}},6764:(Q,m,u)=>{"use strict";var s=u(9471),b=u(4284),h=u(2130),p=u(2567);function E(d){d.cancelToken&&d.cancelToken.throwIfRequested()}Q.exports=function(T){return E(T),T.headers=T.headers||{},T.data=b.call(T,T.data,T.headers,T.transformRequest),T.headers=s.merge(T.headers.common||{},T.headers[T.method]||{},T.headers),s.forEach(["delete","get","head","post","put","patch","common"],function(f){delete T.headers[f]}),(T.adapter||p.adapter)(T).then(function(f){return E(T),f.data=b.call(T,f.data,f.headers,T.transformResponse),f},function(f){return h(f)||(E(T),f&&f.response&&(f.response.data=b.call(T,f.response.data,f.response.headers,T.transformResponse))),Promise.reject(f)})}},9570:Q=>{"use strict";Q.exports=function(u,s,b,h,p){return u.config=s,b&&(u.code=b),u.request=h,u.response=p,u.isAxiosError=!0,u.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},u}},4018:(Q,m,u)=>{"use strict";var s=u(9471);Q.exports=function(h,p){p=p||{};var E={},d=["url","method","data"],T=["headers","auth","proxy","params"],A=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],I=["validateStatus"];function f(g,C){return s.isPlainObject(g)&&s.isPlainObject(C)?s.merge(g,C):s.isPlainObject(C)?s.merge({},C):s.isArray(C)?C.slice():C}function c(g){s.isUndefined(p[g])?s.isUndefined(h[g])||(E[g]=f(void 0,h[g])):E[g]=f(h[g],p[g])}s.forEach(d,function(C){s.isUndefined(p[C])||(E[C]=f(void 0,p[C]))}),s.forEach(T,c),s.forEach(A,function(C){s.isUndefined(p[C])?s.isUndefined(h[C])||(E[C]=f(void 0,h[C])):E[C]=f(void 0,p[C])}),s.forEach(I,function(C){C in p?E[C]=f(h[C],p[C]):C in h&&(E[C]=f(void 0,h[C]))});var v=d.concat(T).concat(A).concat(I),S=Object.keys(h).concat(Object.keys(p)).filter(function(C){return-1===v.indexOf(C)});return s.forEach(S,c),E}},5650:(Q,m,u)=>{"use strict";var s=u(5886);Q.exports=function(h,p,E){var d=E.config.validateStatus;E.status&&d&&!d(E.status)?p(s("Request failed with status code "+E.status,E.config,null,E.request,E)):h(E)}},4284:(Q,m,u)=>{"use strict";var s=u(9471),b=u(2567);Q.exports=function(p,E,d){var T=this||b;return s.forEach(d,function(I){p=I.call(T,p,E)}),p}},2567:(Q,m,u)=>{"use strict";var s=u(9471),b=u(2196),h=u(9570),p={"Content-Type":"application/x-www-form-urlencoded"};function E(I,f){!s.isUndefined(I)&&s.isUndefined(I["Content-Type"])&&(I["Content-Type"]=f)}var I,A={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(I=u(4054)),I),transformRequest:[function(f,c){return b(c,"Accept"),b(c,"Content-Type"),s.isFormData(f)||s.isArrayBuffer(f)||s.isBuffer(f)||s.isStream(f)||s.isFile(f)||s.isBlob(f)?f:s.isArrayBufferView(f)?f.buffer:s.isURLSearchParams(f)?(E(c,"application/x-www-form-urlencoded;charset=utf-8"),f.toString()):s.isObject(f)||c&&"application/json"===c["Content-Type"]?(E(c,"application/json"),function(I,f,c){if(s.isString(I))try{return(0,JSON.parse)(I),s.trim(I)}catch(v){if("SyntaxError"!==v.name)throw v}return(0,JSON.stringify)(I)}(f)):f}],transformResponse:[function(f){var c=this.transitional,g=!(c&&c.silentJSONParsing)&&"json"===this.responseType;if(g||c&&c.forcedJSONParsing&&s.isString(f)&&f.length)try{return JSON.parse(f)}catch(C){if(g)throw"SyntaxError"===C.name?h(C,this,"E_JSON_PARSE"):C}return f}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(f){return f>=200&&f<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};s.forEach(["delete","get","head"],function(f){A.headers[f]={}}),s.forEach(["post","put","patch"],function(f){A.headers[f]=s.merge(p)}),Q.exports=A},1533:Q=>{"use strict";Q.exports=function(u,s){return function(){for(var h=new Array(arguments.length),p=0;p<h.length;p++)h[p]=arguments[p];return u.apply(s,h)}}},7790:(Q,m,u)=>{"use strict";var s=u(9471);function b(h){return encodeURIComponent(h).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}Q.exports=function(p,E,d){if(!E)return p;var T;if(d)T=d(E);else if(s.isURLSearchParams(E))T=E.toString();else{var A=[];s.forEach(E,function(c,v){null==c||(s.isArray(c)?v+="[]":c=[c],s.forEach(c,function(g){s.isDate(g)?g=g.toISOString():s.isObject(g)&&(g=JSON.stringify(g)),A.push(b(v)+"="+b(g))}))}),T=A.join("&")}if(T){var I=p.indexOf("#");-1!==I&&(p=p.slice(0,I)),p+=(-1===p.indexOf("?")?"?":"&")+T}return p}},1540:Q=>{"use strict";Q.exports=function(u,s){return s?u.replace(/\/+$/,"")+"/"+s.replace(/^\/+/,""):u}},300:(Q,m,u)=>{"use strict";var s=u(9471);Q.exports=s.isStandardBrowserEnv()?{write:function(p,E,d,T,A,I){var f=[];f.push(p+"="+encodeURIComponent(E)),s.isNumber(d)&&f.push("expires="+new Date(d).toGMTString()),s.isString(T)&&f.push("path="+T),s.isString(A)&&f.push("domain="+A),!0===I&&f.push("secure"),document.cookie=f.join("; ")},read:function(p){var E=document.cookie.match(new RegExp("(^|;\\s*)("+p+")=([^;]*)"));return E?decodeURIComponent(E[3]):null},remove:function(p){this.write(p,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},5164:Q=>{"use strict";Q.exports=function(u){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(u)}},9541:Q=>{"use strict";Q.exports=function(u){return"object"==typeof u&&!0===u.isAxiosError}},2984:(Q,m,u)=>{"use strict";var s=u(9471);Q.exports=s.isStandardBrowserEnv()?function(){var E,h=/(msie|trident)/i.test(navigator.userAgent),p=document.createElement("a");function d(T){var A=T;return h&&(p.setAttribute("href",A),A=p.href),p.setAttribute("href",A),{href:p.href,protocol:p.protocol?p.protocol.replace(/:$/,""):"",host:p.host,search:p.search?p.search.replace(/^\?/,""):"",hash:p.hash?p.hash.replace(/^#/,""):"",hostname:p.hostname,port:p.port,pathname:"/"===p.pathname.charAt(0)?p.pathname:"/"+p.pathname}}return E=d(window.location.href),function(A){var I=s.isString(A)?d(A):A;return I.protocol===E.protocol&&I.host===E.host}}():function(){return!0}},2196:(Q,m,u)=>{"use strict";var s=u(9471);Q.exports=function(h,p){s.forEach(h,function(d,T){T!==p&&T.toUpperCase()===p.toUpperCase()&&(h[p]=d,delete h[T])})}},1929:(Q,m,u)=>{"use strict";var s=u(9471),b=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];Q.exports=function(p){var d,T,A,E={};return p&&s.forEach(p.split("\n"),function(f){if(A=f.indexOf(":"),d=s.trim(f.substr(0,A)).toLowerCase(),T=s.trim(f.substr(A+1)),d){if(E[d]&&b.indexOf(d)>=0)return;E[d]="set-cookie"===d?(E[d]?E[d]:[]).concat([T]):E[d]?E[d]+", "+T:T}}),E}},8908:Q=>{"use strict";Q.exports=function(u){return function(b){return u.apply(null,b)}}},3558:(Q,m,u)=>{"use strict";var s=u(8593),b={};["object","boolean","number","function","string","symbol"].forEach(function(T,A){b[T]=function(f){return typeof f===T||"a"+(A<1?"n ":" ")+T}});var h={},p=s.version.split(".");function E(T,A){for(var I=A?A.split("."):p,f=T.split("."),c=0;c<3;c++){if(I[c]>f[c])return!0;if(I[c]<f[c])return!1}return!1}b.transitional=function(A,I,f){var c=I&&E(I);function v(S,g){return"[Axios v"+s.version+"] Transitional option '"+S+"'"+g+(f?". "+f:"")}return function(S,g,C){if(!1===A)throw new Error(v(g," has been removed in "+I));return c&&!h[g]&&(h[g]=!0,console.warn(v(g," has been deprecated since v"+I+" and will be removed in the near future"))),!A||A(S,g,C)}},Q.exports={isOlderVersion:E,assertOptions:function(T,A,I){if("object"!=typeof T)throw new TypeError("options must be an object");for(var f=Object.keys(T),c=f.length;c-- >0;){var v=f[c],S=A[v];if(S){var g=T[v],C=void 0===g||S(g,v,T);if(!0!==C)throw new TypeError("option "+v+" must be "+C)}else if(!0!==I)throw Error("Unknown option "+v)}},validators:b}},9471:(Q,m,u)=>{"use strict";var s=u(1533),b=Object.prototype.toString;function h(j){return"[object Array]"===b.call(j)}function p(j){return void 0===j}function c(j){return null!==j&&"object"==typeof j}function v(j){if("[object Object]"!==b.call(j))return!1;var ue=Object.getPrototypeOf(j);return null===ue||ue===Object.prototype}function R(j){return"[object Function]"===b.call(j)}function y(j,ue){if(null!=j)if("object"!=typeof j&&(j=[j]),h(j))for(var Z=0,Y=j.length;Z<Y;Z++)ue.call(null,j[Z],Z,j);else for(var W in j)Object.prototype.hasOwnProperty.call(j,W)&&ue.call(null,j[W],W,j)}Q.exports={isArray:h,isArrayBuffer:function(j){return"[object ArrayBuffer]"===b.call(j)},isBuffer:function(j){return null!==j&&!p(j)&&null!==j.constructor&&!p(j.constructor)&&"function"==typeof j.constructor.isBuffer&&j.constructor.isBuffer(j)},isFormData:function(j){return"undefined"!=typeof FormData&&j instanceof FormData},isArrayBufferView:function(j){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(j):j&&j.buffer&&j.buffer instanceof ArrayBuffer},isString:function(j){return"string"==typeof j},isNumber:function(j){return"number"==typeof j},isObject:c,isPlainObject:v,isUndefined:p,isDate:function(j){return"[object Date]"===b.call(j)},isFile:function(j){return"[object File]"===b.call(j)},isBlob:function(j){return"[object Blob]"===b.call(j)},isFunction:R,isStream:function(j){return c(j)&&R(j.pipe)},isURLSearchParams:function(j){return"undefined"!=typeof URLSearchParams&&j instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:y,merge:function M(){var j={};function ue(W,ce){j[ce]=v(j[ce])&&v(W)?M(j[ce],W):v(W)?M({},W):h(W)?W.slice():W}for(var Z=0,Y=arguments.length;Z<Y;Z++)y(arguments[Z],ue);return j},extend:function(j,ue,Z){return y(ue,function(W,ce){j[ce]=Z&&"function"==typeof W?s(W,Z):W}),j},trim:function(j){return j.trim?j.trim():j.replace(/^\s+|\s+$/g,"")},stripBOM:function(j){return 65279===j.charCodeAt(0)&&(j=j.slice(1)),j}}},3105:Q=>{"use strict";var s,m="object"==typeof Reflect?Reflect:null,u=m&&"function"==typeof m.apply?m.apply:function(P,y,M){return Function.prototype.apply.call(P,y,M)};s=m&&"function"==typeof m.ownKeys?m.ownKeys:Object.getOwnPropertySymbols?function(P){return Object.getOwnPropertyNames(P).concat(Object.getOwnPropertySymbols(P))}:function(P){return Object.getOwnPropertyNames(P)};var h=Number.isNaN||function(P){return P!=P};function p(){p.init.call(this)}Q.exports=p,Q.exports.once=function(N,P){return new Promise(function(y,M){function U(j){N.removeListener(P,$),M(j)}function $(){"function"==typeof N.removeListener&&N.removeListener("error",U),y([].slice.call(arguments))}_(N,P,$,{once:!0}),"error"!==P&&function(N,P,y){"function"==typeof N.on&&_(N,"error",P,{once:!0})}(N,U)})},p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var E=10;function d(N){if("function"!=typeof N)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}function T(N){return void 0===N._maxListeners?p.defaultMaxListeners:N._maxListeners}function A(N,P,y,M){var U,$,j;if(d(y),void 0===($=N._events)?($=N._events=Object.create(null),N._eventsCount=0):(void 0!==$.newListener&&(N.emit("newListener",P,y.listener?y.listener:y),$=N._events),j=$[P]),void 0===j)j=$[P]=y,++N._eventsCount;else if("function"==typeof j?j=$[P]=M?[y,j]:[j,y]:M?j.unshift(y):j.push(y),(U=T(N))>0&&j.length>U&&!j.warned){j.warned=!0;var ue=new Error("Possible EventEmitter memory leak detected. "+j.length+" "+String(P)+" listeners added. Use emitter.setMaxListeners() to increase limit");ue.name="MaxListenersExceededWarning",ue.emitter=N,ue.type=P,ue.count=j.length,function(N){console&&console.warn&&console.warn(N)}(ue)}return N}function I(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(N,P,y){var M={fired:!1,wrapFn:void 0,target:N,type:P,listener:y},U=I.bind(M);return U.listener=y,M.wrapFn=U,U}function c(N,P,y){var M=N._events;if(void 0===M)return[];var U=M[P];return void 0===U?[]:"function"==typeof U?y?[U.listener||U]:[U]:y?function(N){for(var P=new Array(N.length),y=0;y<P.length;++y)P[y]=N[y].listener||N[y];return P}(U):S(U,U.length)}function v(N){var P=this._events;if(void 0!==P){var y=P[N];if("function"==typeof y)return 1;if(void 0!==y)return y.length}return 0}function S(N,P){for(var y=new Array(P),M=0;M<P;++M)y[M]=N[M];return y}function _(N,P,y,M){if("function"==typeof N.on)M.once?N.once(P,y):N.on(P,y);else{if("function"!=typeof N.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N);N.addEventListener(P,function U($){M.once&&N.removeEventListener(P,U),y($)})}}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(N){if("number"!=typeof N||N<0||h(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");E=N}}),p.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(P){if("number"!=typeof P||P<0||h(P))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+P+".");return this._maxListeners=P,this},p.prototype.getMaxListeners=function(){return T(this)},p.prototype.emit=function(P){for(var y=[],M=1;M<arguments.length;M++)y.push(arguments[M]);var U="error"===P,$=this._events;if(void 0!==$)U=U&&void 0===$.error;else if(!U)return!1;if(U){var j;if(y.length>0&&(j=y[0]),j instanceof Error)throw j;var ue=new Error("Unhandled error."+(j?" ("+j.message+")":""));throw ue.context=j,ue}var Z=$[P];if(void 0===Z)return!1;if("function"==typeof Z)u(Z,this,y);else{var Y=Z.length,W=S(Z,Y);for(M=0;M<Y;++M)u(W[M],this,y)}return!0},p.prototype.on=p.prototype.addListener=function(P,y){return A(this,P,y,!1)},p.prototype.prependListener=function(P,y){return A(this,P,y,!0)},p.prototype.once=function(P,y){return d(y),this.on(P,f(this,P,y)),this},p.prototype.prependOnceListener=function(P,y){return d(y),this.prependListener(P,f(this,P,y)),this},p.prototype.off=p.prototype.removeListener=function(P,y){var M,U,$,j,ue;if(d(y),void 0===(U=this._events))return this;if(void 0===(M=U[P]))return this;if(M===y||M.listener===y)0==--this._eventsCount?this._events=Object.create(null):(delete U[P],U.removeListener&&this.emit("removeListener",P,M.listener||y));else if("function"!=typeof M){for($=-1,j=M.length-1;j>=0;j--)if(M[j]===y||M[j].listener===y){ue=M[j].listener,$=j;break}if($<0)return this;0===$?M.shift():function(N,P){for(;P+1<N.length;P++)N[P]=N[P+1];N.pop()}(M,$),1===M.length&&(U[P]=M[0]),void 0!==U.removeListener&&this.emit("removeListener",P,ue||y)}return this},p.prototype.removeAllListeners=function(P){var y,M,U;if(void 0===(M=this._events))return this;if(void 0===M.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==M[P]&&(0==--this._eventsCount?this._events=Object.create(null):delete M[P]),this;if(0===arguments.length){var j,$=Object.keys(M);for(U=0;U<$.length;++U)"removeListener"!==(j=$[U])&&this.removeAllListeners(j);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(y=M[P]))this.removeListener(P,y);else if(void 0!==y)for(U=y.length-1;U>=0;U--)this.removeListener(P,y[U]);return this},p.prototype.listeners=function(P){return c(this,P,!0)},p.prototype.rawListeners=function(P){return c(this,P,!1)},p.listenerCount=function(N,P){return"function"==typeof N.listenerCount?N.listenerCount(P):v.call(N,P)},p.prototype.listenerCount=v,p.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]}},6099:Q=>{function u(b){this.message=b}(u.prototype=new Error).name="InvalidCharacterError",Q.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(b){var h=String(b).replace(/=+$/,"");if(h.length%4==1)throw new u("'atob' failed: The string to be decoded is not correctly encoded.");for(var E,d,p=0,T=0,A="";d=h.charAt(T++);~d&&(E=p%4?64*E+d:d,p++%4)?A+=String.fromCharCode(255&E>>(-2*p&6)):0)d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d);return A}},4400:(Q,m,u)=>{var s=u(6099);Q.exports=function(h){var p=h.replace(/-/g,"+").replace(/_/g,"/");switch(p.length%4){case 0:break;case 2:p+="==";break;case 3:p+="=";break;default:throw"Illegal base64url string!"}try{return function(h){return decodeURIComponent(s(h).replace(/(.)/g,function(p,E){var d=E.charCodeAt(0).toString(16).toUpperCase();return d.length<2&&(d="0"+d),"%"+d}))}(p)}catch(E){return s(p)}}},4934:(Q,m,u)=>{"use strict";var s=u(4400);function b(h){this.message=h}(b.prototype=new Error).name="InvalidTokenError",Q.exports=function(h,p){if("string"!=typeof h)throw new b("Invalid token specified");var E=!0===(p=p||{}).header?0:1;try{return JSON.parse(s(h.split(".")[E]))}catch(d){throw new b("Invalid token specified: "+d.message)}},Q.exports.InvalidTokenError=b},8228:Q=>{"use strict";var m=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function b(p){if(null==p)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}Q.exports=function(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de","5"===Object.getOwnPropertyNames(p)[0])return!1;for(var E={},d=0;d<10;d++)E["_"+String.fromCharCode(d)]=d;if("0123456789"!==Object.getOwnPropertyNames(E).map(function(I){return E[I]}).join(""))return!1;var A={};return"abcdefghijklmnopqrst".split("").forEach(function(I){A[I]=I}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},A)).join("")}catch(I){return!1}}()?Object.assign:function(p,E){for(var d,A,T=b(p),I=1;I<arguments.length;I++){for(var f in d=Object(arguments[I]))u.call(d,f)&&(T[f]=d[f]);if(m){A=m(d);for(var c=0;c<A.length;c++)s.call(d,A[c])&&(T[A[c]]=d[A[c]])}}return T}},5429:(Q,m,u)=>{"use strict";var b=u(8228),h=60103;if("function"==typeof Symbol&&Symbol.for){var f=Symbol.for;h=f("react.element"),f("react.portal"),f("react.fragment"),f("react.strict_mode"),f("react.profiler"),f("react.provider"),f("react.context"),f("react.forward_ref"),f("react.suspense"),f("react.memo"),f("react.lazy")}"function"==typeof Symbol&&Symbol;function S(te){for(var K="https://reactjs.org/docs/error-decoder.html?invariant="+te,re=1;re<arguments.length;re++)K+="&args[]="+encodeURIComponent(arguments[re]);return"Minified React error #"+te+"; visit "+K+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C={};function R(te,K,re){this.props=te,this.context=K,this.refs=C,this.updater=re||g}function D(){}function _(te,K,re){this.props=te,this.context=K,this.refs=C,this.updater=re||g}R.prototype.isReactComponent={},R.prototype.setState=function(te,K){if("object"!=typeof te&&"function"!=typeof te&&null!=te)throw Error(S(85));this.updater.enqueueSetState(this,te,K,"setState")},R.prototype.forceUpdate=function(te){this.updater.enqueueForceUpdate(this,te,"forceUpdate")},D.prototype=R.prototype;var N=_.prototype=new D;N.constructor=_,b(N,R.prototype),N.isPureReactComponent=!0;var P_current=null,y=Object.prototype.hasOwnProperty,M={key:!0,ref:!0,__self:!0,__source:!0};m.createElement=function(te,K,re){var ve,be={},Be=null,$e=null;if(null!=K)for(ve in void 0!==K.ref&&($e=K.ref),void 0!==K.key&&(Be=""+K.key),K)y.call(K,ve)&&!M.hasOwnProperty(ve)&&(be[ve]=K[ve]);var Oe=arguments.length-2;if(1===Oe)be.children=re;else if(1<Oe){for(var se=Array(Oe),fe=0;fe<Oe;fe++)se[fe]=arguments[fe+2];be.children=se}if(te&&te.defaultProps)for(ve in Oe=te.defaultProps)void 0===be[ve]&&(be[ve]=Oe[ve]);return{$$typeof:h,type:te,key:Be,ref:$e,props:be,_owner:P_current}}},8139:(Q,m,u)=>{"use strict";Q.exports=u(5429)},7941:Q=>{var m=function(u){"use strict";var h,s=Object.prototype,b=s.hasOwnProperty,p="function"==typeof Symbol?Symbol:{},E=p.iterator||"@@iterator",d=p.asyncIterator||"@@asyncIterator",T=p.toStringTag||"@@toStringTag";function A(ne,X,de){return Object.defineProperty(ne,X,{value:de,enumerable:!0,configurable:!0,writable:!0}),ne[X]}try{A({},"")}catch(ne){A=function(X,de,te){return X[de]=te}}function I(ne,X,de,te){var re=Object.create((X&&X.prototype instanceof R?X:R).prototype),ve=new W(te||[]);return re._invoke=function(ne,X,de){var te=c;return function(re,ve){if(te===S)throw new Error("Generator is already running");if(te===g){if("throw"===re)throw ve;return Ce()}for(de.method=re,de.arg=ve;;){var be=de.delegate;if(be){var Be=ue(be,de);if(Be){if(Be===C)continue;return Be}}if("next"===de.method)de.sent=de._sent=de.arg;else if("throw"===de.method){if(te===c)throw te=g,de.arg;de.dispatchException(de.arg)}else"return"===de.method&&de.abrupt("return",de.arg);te=S;var $e=f(ne,X,de);if("normal"===$e.type){if(te=de.done?g:v,$e.arg===C)continue;return{value:$e.arg,done:de.done}}"throw"===$e.type&&(te=g,de.method="throw",de.arg=$e.arg)}}}(ne,de,ve),re}function f(ne,X,de){try{return{type:"normal",arg:ne.call(X,de)}}catch(te){return{type:"throw",arg:te}}}u.wrap=I;var c="suspendedStart",v="suspendedYield",S="executing",g="completed",C={};function R(){}function D(){}function _(){}var N={};A(N,E,function(){return this});var P=Object.getPrototypeOf,y=P&&P(P(ce([])));y&&y!==s&&b.call(y,E)&&(N=y);var M=_.prototype=R.prototype=Object.create(N);function U(ne){["next","throw","return"].forEach(function(X){A(ne,X,function(de){return this._invoke(X,de)})})}function $(ne,X){function de(re,ve,be,Be){var $e=f(ne[re],ne,ve);if("throw"!==$e.type){var Oe=$e.arg,se=Oe.value;return se&&"object"==typeof se&&b.call(se,"__await")?X.resolve(se.__await).then(function(fe){de("next",fe,be,Be)},function(fe){de("throw",fe,be,Be)}):X.resolve(se).then(function(fe){Oe.value=fe,be(Oe)},function(fe){return de("throw",fe,be,Be)})}Be($e.arg)}var te;this._invoke=function(re,ve){function be(){return new X(function(Be,$e){de(re,ve,Be,$e)})}return te=te?te.then(be,be):be()}}function ue(ne,X){var de=ne.iterator[X.method];if(de===h){if(X.delegate=null,"throw"===X.method){if(ne.iterator.return&&(X.method="return",X.arg=h,ue(ne,X),"throw"===X.method))return C;X.method="throw",X.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var te=f(de,ne.iterator,X.arg);if("throw"===te.type)return X.method="throw",X.arg=te.arg,X.delegate=null,C;var K=te.arg;return K?K.done?(X[ne.resultName]=K.value,X.next=ne.nextLoc,"return"!==X.method&&(X.method="next",X.arg=h),X.delegate=null,C):K:(X.method="throw",X.arg=new TypeError("iterator result is not an object"),X.delegate=null,C)}function Z(ne){var X={tryLoc:ne[0]};1 in ne&&(X.catchLoc=ne[1]),2 in ne&&(X.finallyLoc=ne[2],X.afterLoc=ne[3]),this.tryEntries.push(X)}function Y(ne){var X=ne.completion||{};X.type="normal",delete X.arg,ne.completion=X}function W(ne){this.tryEntries=[{tryLoc:"root"}],ne.forEach(Z,this),this.reset(!0)}function ce(ne){if(ne){var X=ne[E];if(X)return X.call(ne);if("function"==typeof ne.next)return ne;if(!isNaN(ne.length)){var de=-1,te=function K(){for(;++de<ne.length;)if(b.call(ne,de))return K.value=ne[de],K.done=!1,K;return K.value=h,K.done=!0,K};return te.next=te}}return{next:Ce}}function Ce(){return{value:h,done:!0}}return D.prototype=_,A(M,"constructor",_),A(_,"constructor",D),D.displayName=A(_,T,"GeneratorFunction"),u.isGeneratorFunction=function(ne){var X="function"==typeof ne&&ne.constructor;return!!X&&(X===D||"GeneratorFunction"===(X.displayName||X.name))},u.mark=function(ne){return Object.setPrototypeOf?Object.setPrototypeOf(ne,_):(ne.__proto__=_,A(ne,T,"GeneratorFunction")),ne.prototype=Object.create(M),ne},u.awrap=function(ne){return{__await:ne}},U($.prototype),A($.prototype,d,function(){return this}),u.AsyncIterator=$,u.async=function(ne,X,de,te,K){void 0===K&&(K=Promise);var re=new $(I(ne,X,de,te),K);return u.isGeneratorFunction(X)?re:re.next().then(function(ve){return ve.done?ve.value:re.next()})},U(M),A(M,T,"Generator"),A(M,E,function(){return this}),A(M,"toString",function(){return"[object Generator]"}),u.keys=function(ne){var X=[];for(var de in ne)X.push(de);return X.reverse(),function te(){for(;X.length;){var K=X.pop();if(K in ne)return te.value=K,te.done=!1,te}return te.done=!0,te}},u.values=ce,W.prototype={constructor:W,reset:function(ne){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(Y),!ne)for(var X in this)"t"===X.charAt(0)&&b.call(this,X)&&!isNaN(+X.slice(1))&&(this[X]=h)},stop:function(){this.done=!0;var X=this.tryEntries[0].completion;if("throw"===X.type)throw X.arg;return this.rval},dispatchException:function(ne){if(this.done)throw ne;var X=this;function de(Be,$e){return re.type="throw",re.arg=ne,X.next=Be,$e&&(X.method="next",X.arg=h),!!$e}for(var te=this.tryEntries.length-1;te>=0;--te){var K=this.tryEntries[te],re=K.completion;if("root"===K.tryLoc)return de("end");if(K.tryLoc<=this.prev){var ve=b.call(K,"catchLoc"),be=b.call(K,"finallyLoc");if(ve&&be){if(this.prev<K.catchLoc)return de(K.catchLoc,!0);if(this.prev<K.finallyLoc)return de(K.finallyLoc)}else if(ve){if(this.prev<K.catchLoc)return de(K.catchLoc,!0)}else{if(!be)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return de(K.finallyLoc)}}}},abrupt:function(ne,X){for(var de=this.tryEntries.length-1;de>=0;--de){var te=this.tryEntries[de];if(te.tryLoc<=this.prev&&b.call(te,"finallyLoc")&&this.prev<te.finallyLoc){var K=te;break}}K&&("break"===ne||"continue"===ne)&&K.tryLoc<=X&&X<=K.finallyLoc&&(K=null);var re=K?K.completion:{};return re.type=ne,re.arg=X,K?(this.method="next",this.next=K.finallyLoc,C):this.complete(re)},complete:function(ne,X){if("throw"===ne.type)throw ne.arg;return"break"===ne.type||"continue"===ne.type?this.next=ne.arg:"return"===ne.type?(this.rval=this.arg=ne.arg,this.method="return",this.next="end"):"normal"===ne.type&&X&&(this.next=X),C},finish:function(ne){for(var X=this.tryEntries.length-1;X>=0;--X){var de=this.tryEntries[X];if(de.finallyLoc===ne)return this.complete(de.completion,de.afterLoc),Y(de),C}},catch:function(ne){for(var X=this.tryEntries.length-1;X>=0;--X){var de=this.tryEntries[X];if(de.tryLoc===ne){var te=de.completion;if("throw"===te.type){var K=te.arg;Y(de)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(ne,X,de){return this.delegate={iterator:ce(ne),resultName:X,nextLoc:de},"next"===this.method&&(this.arg=h),C}},u}(Q.exports);try{regeneratorRuntime=m}catch(u){"object"==typeof globalThis?globalThis.regeneratorRuntime=m:Function("r","regeneratorRuntime = r")(m)}},8952:(Q,m,u)=>{"use strict";function s(t){return"function"==typeof t}let b=!1;const h={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else b&&console.log("RxJS: Back to a better error behavior. Thank you. <3");b=t},get useDeprecatedSynchronousErrorHandling(){return b}};function p(t){setTimeout(()=>{throw t},0)}const E={closed:!0,next(t){},error(t){if(h.useDeprecatedSynchronousErrorHandling)throw t;p(t)},complete(){}},d=Array.isArray||(t=>t&&"number"==typeof t.length);function T(t){return null!==t&&"object"==typeof t}const I=(()=>{function t(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return t.prototype=Object.create(Error.prototype),t})();class f{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:i,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof f)n.remove(this);else if(null!==n)for(let a=0;a<n.length;++a)n[a].remove(this);if(s(i)){r&&(this._unsubscribe=void 0);try{i.call(this)}catch(a){e=a instanceof I?c(a.errors):[a]}}if(d(o)){let a=-1,l=o.length;for(;++a<l;){const w=o[a];if(T(w))try{w.unsubscribe()}catch(F){e=e||[],F instanceof I?e=e.concat(c(F.errors)):e.push(F)}}}if(e)throw new I(e)}add(e){let n=e;if(!e)return f.EMPTY;switch(typeof e){case"function":n=new f(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof f)){const o=n;n=new f,n._subscriptions=[o]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof f){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(e){const n=this._subscriptions;if(n){const r=n.indexOf(e);-1!==r&&n.splice(r,1)}}}var t;function c(t){return t.reduce((e,n)=>e.concat(n instanceof I?n.errors:n),[])}f.EMPTY=((t=new f).closed=!0,t);const v="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class g extends f{constructor(e,n,r){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=E;break;case 1:if(!e){this.destination=E;break}if("object"==typeof e){e instanceof g?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new C(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new C(this,e,n,r)}}[v](){return this}static create(e,n,r){const i=new g(e,n,r);return i.syncErrorThrowable=!1,i}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class C extends g{constructor(e,n,r,i){super(),this._parentSubscriber=e;let o,a=this;s(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==E&&(a=Object.create(n),s(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=r,this._complete=i}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:n}=this;h.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable?this.__tryOrSetError(n,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:n}=this,{useDeprecatedSynchronousErrorHandling:r}=h;if(this._error)r&&n.syncErrorThrowable?(this.__tryOrSetError(n,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(n.syncErrorThrowable)r?(n.syncErrorValue=e,n.syncErrorThrown=!0):p(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;p(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const n=()=>this._complete.call(this._context);h.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,n){try{e.call(this._context,n)}catch(r){if(this.unsubscribe(),h.useDeprecatedSynchronousErrorHandling)throw r;p(r)}}__tryOrSetError(e,n,r){if(!h.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,r)}catch(i){return h.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=i,e.syncErrorThrown=!0,!0):(p(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const _="function"==typeof Symbol&&Symbol.observable||"@@observable";function N(t){return t}let M=(()=>{class t{constructor(n){this._isScalar=!1,n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const{operator:o}=this,a=function(t,e,n){if(t){if(t instanceof g)return t;if(t[v])return t[v]()}return t||e||n?new g(t,e,n):new g(E)}(n,r,i);if(a.add(o?o.call(a,this.source):this.source||h.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),h.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(n){try{return this._subscribe(n)}catch(r){h.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=r),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof g?n:null}return!0}(n)?n.error(r):console.warn(r)}}forEach(n,r){return new(r=U(r))((i,o)=>{let a;a=this.subscribe(l=>{try{n(l)}catch(w){o(w),a&&a.unsubscribe()}},o,i)})}_subscribe(n){const{source:r}=this;return r&&r.subscribe(n)}[_](){return this}pipe(...n){return 0===n.length?this:function(t){return 0===t.length?N:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}(n)(this)}toPromise(n){return new(n=U(n))((r,i)=>{let o;this.subscribe(a=>o=a,a=>i(a),()=>r(o))})}}return t.create=e=>new t(e),t})();function U(t){if(t||(t=h.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const j=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class ue extends f{constructor(e,n){super(),this.subject=e,this.subscriber=n,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,n=e.observers;if(this.subject=null,!n||0===n.length||e.isStopped||e.closed)return;const r=n.indexOf(this.subscriber);-1!==r&&n.splice(r,1)}}class Z extends g{constructor(e){super(e),this.destination=e}}let Y=(()=>{class t extends M{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[v](){return new Z(this)}lift(n){const r=new W(this,this);return r.operator=n,r}next(n){if(this.closed)throw new j;if(!this.isStopped){const{observers:r}=this,i=r.length,o=r.slice();for(let a=0;a<i;a++)o[a].next(n)}}error(n){if(this.closed)throw new j;this.hasError=!0,this.thrownError=n,this.isStopped=!0;const{observers:r}=this,i=r.length,o=r.slice();for(let a=0;a<i;a++)o[a].error(n);this.observers.length=0}complete(){if(this.closed)throw new j;this.isStopped=!0;const{observers:n}=this,r=n.length,i=n.slice();for(let o=0;o<r;o++)i[o].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(n){if(this.closed)throw new j;return super._trySubscribe(n)}_subscribe(n){if(this.closed)throw new j;return this.hasError?(n.error(this.thrownError),f.EMPTY):this.isStopped?(n.complete(),f.EMPTY):(this.observers.push(n),new ue(this,n))}asObservable(){const n=new M;return n.source=this,n}}return t.create=(e,n)=>new W(e,n),t})();class W extends Y{constructor(e,n){super(),this.destination=e,this.source=n}next(e){const{destination:n}=this;n&&n.next&&n.next(e)}error(e){const{destination:n}=this;n&&n.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:n}=this;return n?this.source.subscribe(e):f.EMPTY}}function ce(t){return t&&"function"==typeof t.schedule}function Ce(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new ne(t,e))}}class ne{constructor(e,n){this.project=e,this.thisArg=n}call(e,n){return n.subscribe(new X(e,this.project,this.thisArg))}}class X extends g{constructor(e,n,r){super(e),this.project=n,this.count=0,this.thisArg=r||this}_next(e){let n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(n)}}const de=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()},re="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",$e=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Oe(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const se=t=>{if(t&&"function"==typeof t[_])return(t=>e=>{const n=t[_]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)})(t);if($e(t))return de(t);if(Oe(t))return(t=>e=>(t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,p),e))(t);if(t&&"function"==typeof t[re])return(t=>e=>{const n=t[re]();for(;;){let r;try{r=n.next()}catch(i){return e.error(i),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e})(t);{const n=`You provided ${T(t)?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(n)}};function Te(t,e){return new M(n=>{const r=new f;let i=0;return r.add(e.schedule(function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()})),r})}function Ie(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[_]}(t))return function(t,e){return new M(n=>{const r=new f;return r.add(e.schedule(()=>{const i=t[_]();r.add(i.subscribe({next(o){r.add(e.schedule(()=>n.next(o)))},error(o){r.add(e.schedule(()=>n.error(o)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(Oe(t))return function(t,e){return new M(n=>{const r=new f;return r.add(e.schedule(()=>t.then(i=>{r.add(e.schedule(()=>{n.next(i),r.add(e.schedule(()=>n.complete()))}))},i=>{r.add(e.schedule(()=>n.error(i)))}))),r})}(t,e);if($e(t))return Te(t,e);if(function(t){return t&&"function"==typeof t[re]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new M(n=>{const r=new f;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[re](),r.add(e.schedule(function(){if(n.closed)return;let o,a;try{const l=i.next();o=l.value,a=l.done}catch(l){return void n.error(l)}a?n.complete():(n.next(o),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof M?t:new M(se(t))}class We extends g{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class Ge extends g{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function at(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(at((i,o)=>Ie(t(i,o)).pipe(Ce((a,l)=>e(i,a,o,l))),n)):("number"==typeof e&&(n=e),r=>r.lift(new tt(t,n)))}class tt{constructor(e,n=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=n}call(e,n){return n.subscribe(new vt(e,this.project,this.concurrent))}}class vt extends Ge{constructor(e,n,r=Number.POSITIVE_INFINITY){super(e),this.project=n,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let n;const r=this.index++;try{n=this.project(e,r)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(n)}_innerSub(e){const n=new We(this),r=this.destination;r.add(n);const i=function(t,e){if(e.closed)return;if(t instanceof M)return t.subscribe(e);let n;try{n=se(t)(e)}catch(r){e.error(r)}return n}(e,n);i!==n&&r.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function De(t=Number.POSITIVE_INFINITY){return at(N,t)}function Ke(t,e){return e?Te(t,e):new M(de(t))}function bt(){return function(e){return e.lift(new Nt(e))}}class Nt{constructor(e){this.connectable=e}call(e,n){const{connectable:r}=this;r._refCount++;const i=new ot(e,r),o=n.subscribe(i);return i.closed||(i.connection=r.connect()),o}}class ot extends g{constructor(e,n){super(e),this.connectable=n}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const n=e._refCount;if(n<=0)return void(this.connection=null);if(e._refCount=n-1,n>1)return void(this.connection=null);const{connection:r}=this,i=e._connection;this.connection=null,i&&(!r||i===r)&&i.unsubscribe()}}class Xt extends M{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new f,e.add(this.source.subscribe(new dr(this.getSubject(),this))),e.closed&&(this._connection=null,e=f.EMPTY)),e}refCount(){return bt()(this)}}const gn=(()=>{const t=Xt.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class dr extends Z{constructor(e,n){super(e),this.connectable=n}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const n=e._connection;e._refCount=0,e._subject=null,e._connection=null,n&&n.unsubscribe()}}}function ei(){return new Y}function xt(t){for(let e in t)if(t[e]===xt)return e;throw Error("Could not find renamed property on target object.")}function It(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(It).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Lt(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const Lr=xt({__forward_ref__:xt});function Ti(t){return t.__forward_ref__=Ti,t.toString=function(){return It(this())},t}function ft(t){return function(t){return"function"==typeof t&&t.hasOwnProperty(Lr)&&t.__forward_ref__===Ti}(t)?t():t}class fr extends Error{constructor(e,n){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(e,n)),this.code=e}}function In(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():function(t){return"string"==typeof t?t:null==t?"":String(t)}(t)}function Ye(t,e){const n=e?` in ${e}`:"";throw new fr("201",`No provider for ${In(t)} found${n}`)}function kn(t,e){null==t&&function(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function Jt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Rr(t){return{providers:t.providers||[],imports:t.imports||[]}}function Mr(t){return Mo(t,co)||Mo(t,Wi)}function Mo(t,e){return t.hasOwnProperty(e)?t[e]:null}function ns(t){return t&&(t.hasOwnProperty(Ao)||t.hasOwnProperty(Po))?t[Ao]:null}const co=xt({\u0275prov:xt}),Ao=xt({\u0275inj:xt}),Wi=xt({ngInjectableDef:xt}),Po=xt({ngInjectorDef:xt});var Ct=(()=>((Ct=Ct||{})[Ct.Default=0]="Default",Ct[Ct.Host=1]="Host",Ct[Ct.Self=2]="Self",Ct[Ct.SkipSelf=4]="SkipSelf",Ct[Ct.Optional=8]="Optional",Ct))();let rr;function _r(t){const e=rr;return rr=t,e}function Oo(t,e,n){const r=Mr(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Ct.Optional?null:void 0!==e?e:void Ye(It(t),"Injector")}function Sr(t){return{toString:t}.toString()}var ir=(()=>((ir=ir||{})[ir.OnPush=0]="OnPush",ir[ir.Default=1]="Default",ir))(),dn=(()=>((dn=dn||{})[dn.Emulated=0]="Emulated",dn[dn.None=2]="None",dn[dn.ShadowDom=3]="ShadowDom",dn))();const ya="undefined"!=typeof globalThis&&globalThis,ko="undefined"!=typeof window&&window,ss="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Si="undefined"!=typeof global&&global,Yt=ya||Si||ko||ss,Ii={},Zt=[],yn=xt({\u0275cmp:xt}),zi=xt({\u0275dir:xt}),No=xt({\u0275pipe:xt}),fo=xt({\u0275mod:xt}),as=xt({\u0275loc:xt}),hr=xt({\u0275fac:xt}),wi=xt({__NG_ELEMENT_ID__:xt});let va=0;function Ki(t){return Sr(()=>{const n={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===ir.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Zt,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||dn.Emulated,id:"c",styles:t.styles||Zt,_:null,setInput:null,schemas:t.schemas||null,tView:null},i=t.directives,o=t.features,a=t.pipes;return r.id+=va++,r.inputs=Lo(t.inputs,n),r.outputs=Lo(t.outputs),o&&o.forEach(l=>l(r)),r.directiveDefs=i?()=>("function"==typeof i?i():i).map(Qi):null,r.pipeDefs=a?()=>("function"==typeof a?a():a).map(ti):null,r})}function Qi(t){return an(t)||function(t){return t[zi]||null}(t)}function ti(t){return function(t){return t[No]||null}(t)}const ls={};function Ur(t){return Sr(()=>{const e={type:t.type,bootstrap:t.bootstrap||Zt,declarations:t.declarations||Zt,imports:t.imports||Zt,exports:t.exports||Zt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(ls[t.id]=t.type),e})}function Lo(t,e){if(null==t)return Ii;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}const Nn=Ki;function an(t){return t[yn]||null}function Qn(t,e){const n=t[fo]||null;if(!n&&!0===e)throw new Error(`Type ${It(t)} does not have '\u0275mod' property.`);return n}function Ae(t){return Array.isArray(t)&&"object"==typeof t[1]}function He(t){return Array.isArray(t)&&!0===t[1]}function je(t){return 0!=(8&t.flags)}function Fe(t){return 2==(2&t.flags)}function ut(t){return 1==(1&t.flags)}function ht(t){return null!==t.template}function pt(t){return 0!=(512&t[2])}function Yi(t,e){return t.hasOwnProperty(hr)?t[hr]:null}class ju{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function fs(t){return t.type.prototype.ngOnChanges&&(t.setInput=Hu),Rc}function Rc(){const t=hs(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===Ii)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function Hu(t,e,n,r){const i=hs(t)||function(t,e){return t[$u]=e}(t,{previous:Ii,current:null}),o=i.current||(i.current={}),a=i.previous,l=this.declaredInputs[n],w=a[l];o[l]=new ju(w&&w.currentValue,e,a===Ii),t[r]=e}const $u="__ngSimpleChanges__";function hs(t){return t[$u]||null}let ba;function vn(t){return!!t.listen}const Wu={createRenderer:(t,e)=>void 0!==ba?ba:"undefined"!=typeof document?document:void 0};function bn(t){for(;Array.isArray(t);)t=t[0];return t}function sr(t,e){return bn(e[t.index])}function _a(t,e){return t.data[e]}function Zn(t,e){const n=e[t];return Ae(n)?n:n[0]}function ms(t){return 128==(128&t[2])}function Xn(t,e){return null==e?null:t[e]}function Ku(t){t[18]=0}function Sa(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Rt={lFrame:Oa(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Qu(){return Rt.bindingsEnabled}function Je(){return Rt.lFrame.lView}function $t(){return Rt.lFrame.tView}function Ia(t){return Rt.lFrame.contextLView=t,t[8]}function En(){let t=Yu();for(;null!==t&&64===t.type;)t=t.parent;return t}function Yu(){return Rt.lFrame.currentTNode}function Hr(t,e){const n=Rt.lFrame;n.currentTNode=t,n.isParent=e}function wa(){return Rt.lFrame.isParent}function ys(){return Rt.isInCheckNoChangesMode}function vs(t){Rt.isInCheckNoChangesMode=t}function qc(t,e){const n=Rt.lFrame;n.bindingIndex=n.bindingRootIndex=t,Ra(e)}function Ra(t){Rt.lFrame.currentDirectiveIndex=t}function Aa(t){Rt.lFrame.currentQueryIndex=t}function Wc(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function tl(t,e,n){if(n&Ct.SkipSelf){let i=e,o=t;for(;!(i=i.parent,null!==i||n&Ct.Host||(i=Wc(o),null===i||(o=o[15],10&i.type))););if(null===i)return!1;e=i,t=o}const r=Rt.lFrame=Pa();return r.currentTNode=e,r.lView=t,!0}function Cs(t){const e=Pa(),n=t[1];Rt.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Pa(){const t=Rt.lFrame,e=null===t?null:t.child;return null===e?Oa(t):e}function Oa(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function nl(){const t=Rt.lFrame;return Rt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ka=nl;function Zi(){const t=nl();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function er(){return Rt.lFrame.selectedIndex}function Oi(t){Rt.lFrame.selectedIndex=t}function Ts(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const o=t.data[n].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:l,ngAfterViewInit:w,ngAfterViewChecked:F,ngOnDestroy:B}=o;a&&(t.contentHooks||(t.contentHooks=[])).push(-n,a),l&&((t.contentHooks||(t.contentHooks=[])).push(n,l),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,l)),w&&(t.viewHooks||(t.viewHooks=[])).push(-n,w),F&&((t.viewHooks||(t.viewHooks=[])).push(n,F),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,F)),null!=B&&(t.destroyHooks||(t.destroyHooks=[])).push(n,B)}}function bs(t,e,n){x(t,e,3,n)}function V(t,e,n,r){(3&t[2])===n&&x(t,e,n,r)}function O(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function x(t,e,n,r){const o=null!=r?r:-1,a=e.length-1;let l=0;for(let w=void 0!==r?65535&t[18]:0;w<a;w++)if("number"==typeof e[w+1]){if(l=e[w],null!=r&&l>=r)break}else e[w]<0&&(t[18]+=65536),(l<o||-1==o)&&(H(t,n,e,w),t[18]=(4294901760&t[18])+w+2),w++}function H(t,e,n,r){const i=n[r]<0,o=n[r+1],l=t[i?-n[r]:n[r]];if(i){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{o.call(l)}finally{}}}else try{o.call(l)}finally{}}const z=-1;class ae{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function ct(t,e,n){const r=vn(t);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const a=n[i++],l=n[i++],w=n[i++];r?t.setAttribute(e,l,w,a):e.setAttributeNS(a,l,w)}else{const a=o,l=n[++i];Bt(a)?r&&t.setProperty(e,a,l):r?t.setAttribute(e,a,l):e.setAttribute(a,l),i++}}return i}function Tt(t){return 3===t||4===t||6===t}function Bt(t){return 64===t.charCodeAt(0)}function hn(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||en(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function en(t,e,n,r,i){let o=0,a=t.length;if(-1===e)a=-1;else for(;o<t.length;){const l=t[o++];if("number"==typeof l){if(l===e){a=-1;break}if(l>e){a=o-1;break}}}for(;o<t.length;){const l=t[o];if("number"==typeof l)break;if(l===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(t.splice(a,0,e),o=a+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function mn(t){return t!==z}function Tn(t){return 32767&t}function gr(t,e){let n=function(t){return t>>16}(t),r=e;for(;n>0;)r=r[15],n--;return r}let Xi=!0;function eo(t){const e=Xi;return Xi=t,e}let Y0=0;function xa(t,e){const n=ed(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Xc(r.data,t),Xc(e,null),Xc(r.blueprint,null));const i=rl(t,e),o=t.injectorIndex;if(mn(i)){const a=Tn(i),l=gr(i,e),w=l[1].data;for(let F=0;F<8;F++)e[o+F]=l[a+F]|w[a+F]}return e[o+8]=i,o}function Xc(t,e){t.push(0,0,0,0,0,0,0,0,e)}function ed(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function rl(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){const o=i[1],a=o.type;if(r=2===a?o.declTNode:1===a?i[6]:null,null===r)return z;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return z}function il(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(wi)&&(r=n[wi]),null==r&&(r=n[wi]=Y0++);const i=255&r;e.data[t+(i>>5)]|=1<<i}(t,e,n)}function dp(t,e,n){if(n&Ct.Optional)return t;Ye(e,"NodeInjector")}function fp(t,e,n,r){if(n&Ct.Optional&&void 0===r&&(r=null),0==(n&(Ct.Self|Ct.Host))){const i=t[9],o=_r(void 0);try{return i?i.get(e,r,n&Ct.Optional):Oo(e,r,n&Ct.Optional)}finally{_r(o)}}return dp(r,e,n)}function hp(t,e,n,r=Ct.Default,i){if(null!==t){const o=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(wi)?t[wi]:void 0;return"number"==typeof e?e>=0?255&e:eT:e}(n);if("function"==typeof o){if(!tl(e,t,r))return r&Ct.Host?dp(i,n,r):fp(e,n,r,i);try{const a=o(r);if(null!=a||r&Ct.Optional)return a;Ye(n)}finally{ka()}}else if("number"==typeof o){let a=null,l=ed(t,e),w=z,F=r&Ct.Host?e[16][6]:null;for((-1===l||r&Ct.SkipSelf)&&(w=-1===l?rl(t,e):e[l+8],w!==z&&mp(r,!1)?(a=e[1],l=Tn(w),e=gr(w,e)):l=-1);-1!==l;){const B=e[1];if(gp(o,l,B.data)){const J=tT(l,e,n,a,r,F);if(J!==pp)return J}w=e[l+8],w!==z&&mp(r,e[1].data[l+8]===F)&&gp(o,l,e)?(a=B,l=Tn(w),e=gr(w,e)):l=-1}}}return fp(e,n,r,i)}const pp={};function eT(){return new Es(En(),Je())}function tT(t,e,n,r,i,o){const a=e[1],l=a.data[t+8],B=function(t,e,n,r,i){const o=t.providerIndexes,a=e.data,l=1048575&o,w=t.directiveStart,B=o>>20,ee=i?l+B:t.directiveEnd;for(let le=r?l:l+B;le<ee;le++){const pe=a[le];if(le<w&&n===pe||le>=w&&pe.type===n)return le}if(i){const le=a[w];if(le&&ht(le)&&le.type===n)return w}return null}(l,a,n,null==r?Fe(l)&&Xi:r!=a&&0!=(3&l.type),i&Ct.Host&&o===l);return null!==B?La(e,a,B,l):pp}function La(t,e,n,r){let i=t[n];const o=e.data;if(function(t){return t instanceof ae}(i)){const a=i;a.resolving&&function(t,e){throw new fr("200",`Circular dependency in DI detected for ${t}`)}(In(o[n]));const l=eo(a.canSeeViewProviders);a.resolving=!0;const w=a.injectImpl?_r(a.injectImpl):null;tl(t,r,Ct.Default);try{i=t[n]=a.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){const a=fs(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,a),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,a)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{null!==w&&_r(w),eo(l),a.resolving=!1,ka()}}return i}function gp(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function mp(t,e){return!(t&Ct.Self||t&Ct.Host&&e)}class Es{constructor(e,n){this._tNode=e,this._lView=n}get(e,n){return hp(this._tNode,this._lView,e,void 0,n)}}const Ss="__parameters__";function Vo(t,e,n){return Sr(()=>{const r=function(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;const a=new i(...o);return l.annotation=a,l;function l(w,F,B){const J=w.hasOwnProperty(Ss)?w[Ss]:Object.defineProperty(w,Ss,{value:[]})[Ss];for(;J.length<=B;)J.push(null);return(J[B]=J[B]||[]).push(a),w}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class ln{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Jt({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}function ki(t,e){t.forEach(n=>Array.isArray(n)?ki(n,e):e(n))}function al(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Bo(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const Ba={},ad="__NG_DI_FLAG__",Ds="ngTempTokenPath",gT=/\n/gm,ud="__source",ld=xt({provide:String,useValue:xt});let ja;function Rs(t){const e=ja;return ja=t,e}function yT(t,e=Ct.Default){if(void 0===ja)throw new Error("inject() must be called from an injection context");return null===ja?Oo(t,void 0,e):ja.get(t,e&Ct.Optional?null:void 0,e)}function Gt(t,e=Ct.Default){return(rr||yT)(ft(t),e)}function jo(t){const e=[];for(let n=0;n<t.length;n++){const r=ft(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let i,o=Ct.Default;for(let a=0;a<r.length;a++){const l=r[a],w=vT(l);"number"==typeof w?-1===w?i=l.token:o|=w:i=l}e.push(Gt(i,o))}else e.push(Gt(r))}return e}function Ha(t,e){return t[ad]=e,t.prototype[ad]=e,t}function vT(t){return t[ad]}function Ep(t,e,n,r){const i=t[Ds];throw e[ud]&&i.unshift(e[ud]),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=It(e);if(Array.isArray(e))i=e.map(It).join(" -> ");else if("object"==typeof e){let o=[];for(let a in e)if(e.hasOwnProperty(a)){let l=e[a];o.push(a+":"+("string"==typeof l?JSON.stringify(l):It(l)))}i=`{${o.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(gT,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[Ds]=null,t}const $a=Ha(Vo("Inject",t=>({token:t})),-1),Ni=Ha(Vo("Optional"),8),Ho=Ha(Vo("SkipSelf"),4),Hp="__ngContext__";function ar(t,e){t[Hp]=e}function vd(t){const e=function(t){return t[Hp]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function pl(t){return t.ngOriginalError}function db(t,...e){t.error(...e)}class qo{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e),r=this._findContext(e),i=function(t){return t&&t.ngErrorLogger||db}(e);i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}_findContext(e){return e?function(t){return t.ngDebugContext}(e)||this._findContext(pl(e)):null}_findOriginalError(e){let n=e&&pl(e);for(;n&&pl(n);)n=pl(n);return n||null}}const Yp=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Yt))();function Fi(t){return t instanceof Function?t():t}var Nr=(()=>((Nr=Nr||{})[Nr.Important=1]="Important",Nr[Nr.DashCase=2]="DashCase",Nr))();function bd(t,e){return undefined(t,e)}function Qa(t){const e=t[3];return He(e)?e[3]:e}function Ed(t){return ng(t[13])}function _d(t){return ng(t[4])}function ng(t){for(;null!==t&&!He(t);)t=t[4];return t}function Os(t,e,n,r,i){if(null!=r){let o,a=!1;He(r)?o=r:Ae(r)&&(a=!0,r=r[0]);const l=bn(r);0===t&&null!==n?null==i?ug(e,n,l):Go(e,n,l,i||null,!0):1===t&&null!==n?Go(e,n,l,i||null,!0):2===t?function(t,e,n){const r=ml(t,e);r&&function(t,e,n,r){vn(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,l,a):3===t&&e.destroyNode(l),null!=o&&function(t,e,n,r,i){const o=n[7];o!==bn(n)&&Os(e,t,r,o,i);for(let l=10;l<n.length;l++){const w=n[l];Ja(w[1],w,t,e,r,o)}}(e,t,o,n,i)}}function Id(t,e,n){return vn(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function ig(t,e){const n=t[9],r=n.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,Sa(i,-1)),n.splice(r,1)}function wd(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&ig(i,r),e>0&&(t[n-1][4]=r[4]);const o=Bo(t,10+e);!function(t,e){Ja(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const a=o[19];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function og(t,e){if(!(256&e[2])){const n=e[11];vn(n)&&n.destroyNode&&Ja(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Dd(t[1],t);for(;e;){let n=null;if(Ae(e))n=e[13];else{const r=e[10];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)Ae(e)&&Dd(e[1],e),e=e[3];null===e&&(e=t),Ae(e)&&Dd(e[1],e),n=e&&e[4]}e=n}}(e)}}function Dd(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof ae)){const o=n[r+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){const l=i[o[a]],w=o[a+1];try{w.call(l)}finally{}}else try{o.call(i)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const a=n[o+1],l="function"==typeof a?a(e):bn(e[a]),w=r[i=n[o+2]],F=n[o+3];"boolean"==typeof F?l.removeEventListener(n[o],w,F):F>=0?r[i=F]():r[i=-F].unsubscribe(),o+=2}else{const a=r[i=n[o+1]];n[o].call(a)}if(null!==r){for(let o=i+1;o<r.length;o++)r[o]();e[7]=null}}(t,e),1===e[1].type&&vn(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&He(e[3])){n!==e[3]&&ig(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function sg(t,e,n){return function(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const i=t.data[r.directiveStart].encapsulation;if(i===dn.None||i===dn.Emulated)return null}return sr(r,n)}(t,e.parent,n)}function Go(t,e,n,r,i){vn(t)?t.insertBefore(e,n,r,i):e.insertBefore(n,r,i)}function ug(t,e,n){vn(t)?t.appendChild(e,n):e.appendChild(n)}function lg(t,e,n,r,i){null!==r?Go(t,e,n,r,i):ug(t,e,n)}function ml(t,e){return vn(t)?t.parentNode(e):e.parentNode}let fg=function(t,e,n){return 40&t.type?sr(t,n):null};function yl(t,e,n,r){const i=sg(t,r,e),o=e[11],l=function(t,e,n){return fg(t,e,n)}(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(n))for(let w=0;w<n.length;w++)lg(o,i,n[w],l,!1);else lg(o,i,n,l,!1)}function vl(t,e){if(null!==e){const n=e.type;if(3&n)return sr(e,t);if(4&n)return Md(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return vl(t,r);{const i=t[e.index];return He(i)?Md(-1,i):bn(i)}}if(32&n)return bd(e,t)()||bn(t[e.index]);{const r=pg(t,e);return null!==r?Array.isArray(r)?r[0]:vl(Qa(t[16]),r):vl(t,e.next)}}return null}function pg(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Md(t,e){const n=10+t+1;if(n<e.length){const r=e[n],i=r[1].firstChild;if(null!==i)return vl(r,i)}return e[7]}function Ad(t,e,n,r,i,o,a){for(;null!=n;){const l=r[n.index],w=n.type;if(a&&0===e&&(l&&ar(bn(l),r),n.flags|=4),64!=(64&n.flags))if(8&w)Ad(t,e,n.child,r,i,o,!1),Os(e,t,i,l,o);else if(32&w){const F=bd(n,r);let B;for(;B=F();)Os(e,t,i,B,o);Os(e,t,i,l,o)}else 16&w?mg(t,e,r,n,i,o):Os(e,t,i,l,o);n=a?n.projectionNext:n.next}}function Ja(t,e,n,r,i,o){Ad(n,r,t.firstChild,e,i,o,!1)}function mg(t,e,n,r,i,o){const a=n[16],w=a[6].projection[r.projection];if(Array.isArray(w))for(let F=0;F<w.length;F++)Os(e,t,i,w[F],o);else Ad(t,e,w,a[3],i,o,!0)}function yg(t,e,n){vn(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Pd(t,e,n){vn(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function vg(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const o=e.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}n=i+1}}const Cg="ng-template";function Fb(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==vg(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function Tg(t){return 4===t.type&&t.value!==Cg}function Ub(t,e,n){return e===(4!==t.type||n?t.value:Cg)}function Vb(t,e,n){let r=4;const i=t.attrs||[],o=function(t){for(let e=0;e<t.length;e++)if(Tt(t[e]))return e;return t.length}(i);let a=!1;for(let l=0;l<e.length;l++){const w=e[l];if("number"!=typeof w){if(!a)if(4&r){if(r=2|1&r,""!==w&&!Ub(t,w,n)||""===w&&1===e.length){if(oi(r))return!1;a=!0}}else{const F=8&r?w:e[++l];if(8&r&&null!==t.attrs){if(!Fb(t.attrs,F,n)){if(oi(r))return!1;a=!0}continue}const J=Bb(8&r?"class":w,i,Tg(t),n);if(-1===J){if(oi(r))return!1;a=!0;continue}if(""!==F){let ee;ee=J>o?"":i[J+1].toLowerCase();const le=8&r?ee:null;if(le&&-1!==vg(le,F,0)||2&r&&F!==ee){if(oi(r))return!1;a=!0}}}}else{if(!a&&!oi(r)&&!oi(w))return!1;if(a&&oi(w))continue;a=!1,r=w|1&r}}return oi(r)||a}function oi(t){return 0==(1&t)}function Bb(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let o=!1;for(;i<e.length;){const a=e[i];if(a===t)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){let l=e[++i];for(;"string"==typeof l;)l=e[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function bg(t,e,n=!1){for(let r=0;r<e.length;r++)if(Vb(t,e[r],n))return!0;return!1}function Eg(t,e){return t?":not("+e.trim()+")":e}function Gb(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let a=t[n];if("string"==typeof a)if(2&r){const l=t[++n];i+="["+a+(l.length>0?'="'+l+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""!==i&&!oi(a)&&(e+=Eg(o,i),i=""),r=a,o=o||!oi(r);n++}return""!==i&&(e+=Eg(o,i)),e}const Pt={};function Cl(t){_g($t(),Je(),er()+t,ys())}function _g(t,e,n,r){if(!r)if(3==(3&e[2])){const o=t.preOrderCheckHooks;null!==o&&bs(e,o,n)}else{const o=t.preOrderHooks;null!==o&&V(e,o,0,n)}Oi(n)}function kg(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const a=t.data[o];Aa(i),a.contentQueries(2,e[o],o)}}}function Ya(t,e,n,r,i,o,a,l,w,F){const B=e.blueprint.slice();return B[0]=i,B[2]=140|r,Ku(B),B[3]=B[15]=t,B[8]=n,B[10]=a||t&&t[10],B[11]=l||t&&t[11],B[12]=w||t&&t[12]||null,B[9]=F||t&&t[9]||null,B[6]=o,B[16]=2==e.type?t[16]:B,B}function ks(t,e,n,r,i){let o=t.data[e];if(null===o)o=function(t,e,n,r,i){const o=Yu(),a=wa(),w=t.data[e]=function(t,e,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=w),null!==o&&(a?null==o.child&&null!==w.parent&&(o.child=w):null===o.next&&(o.next=w)),w}(t,e,n,r,i),Rt.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const a=function(){const t=Rt.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();o.injectorIndex=null===a?-1:a.injectorIndex}return Hr(o,!0),o}function Ns(t,e,n,r){if(0===n)return-1;const i=e.length;for(let o=0;o<n;o++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Za(t,e,n){Cs(e);try{const r=t.viewQuery;null!==r&&Jd(1,r,n);const i=t.template;null!==i&&Ng(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&kg(t,e),t.staticViewQueries&&Jd(2,t.viewQuery,n);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)SE(t,e[n])}(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,Zi()}}function xs(t,e,n,r){const i=e[2];if(256==(256&i))return;Cs(e);const o=ys();try{Ku(e),function(t){Rt.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&Ng(t,e,n,2,r);const a=3==(3&i);if(!o)if(a){const F=t.preOrderCheckHooks;null!==F&&bs(e,F,null)}else{const F=t.preOrderHooks;null!==F&&V(e,F,0,null),O(e,0)}if(function(t){for(let e=Ed(t);null!==e;e=_d(e)){if(!e[2])continue;const n=e[9];for(let r=0;r<n.length;r++){const i=n[r],o=i[3];0==(1024&i[2])&&Sa(o,1),i[2]|=1024}}}(e),function(t){for(let e=Ed(t);null!==e;e=_d(e))for(let n=10;n<e.length;n++){const r=e[n],i=r[1];ms(r)&&xs(i,r,i.template,r[8])}}(e),null!==t.contentQueries&&kg(t,e),!o)if(a){const F=t.contentCheckHooks;null!==F&&bs(e,F)}else{const F=t.contentHooks;null!==F&&V(e,F,1),O(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)Oi(~i);else{const o=i,a=n[++r],l=n[++r];qc(a,o),l(2,e[o])}}}finally{Oi(-1)}}(t,e);const l=t.components;null!==l&&function(t,e){for(let n=0;n<e.length;n++)_E(t,e[n])}(e,l);const w=t.viewQuery;if(null!==w&&Jd(2,w,r),!o)if(a){const F=t.viewCheckHooks;null!==F&&bs(e,F)}else{const F=t.viewHooks;null!==F&&V(e,F,2),O(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Sa(e[3],-1))}finally{Zi()}}function iE(t,e,n,r){const i=e[10],o=!ys(),a=function(t){return 4==(4&t[2])}(e);try{o&&!a&&i.begin&&i.begin(),a&&Za(t,e,r),xs(t,e,n,r)}finally{o&&!a&&i.end&&i.end()}}function Ng(t,e,n,r,i){const o=er(),a=2&r;try{Oi(-1),a&&e.length>20&&_g(t,e,20,ys()),n(r,i)}finally{Oi(o)}}function Hd(t,e,n){!Qu()||(function(t,e,n,r){const i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||xa(n,e),ar(r,e);const a=n.initialInputs;for(let l=i;l<o;l++){const w=t.data[l],F=ht(w);F&&vE(e,n,w);const B=La(e,t,l,n);ar(B,e),null!==a&&CE(0,l-i,B,w,0,a),F&&(Zn(n.index,e)[8]=B)}}(t,e,n,sr(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,a=n.index,l=Rt.lFrame.currentDirectiveIndex;try{Oi(a);for(let w=r;w<i;w++){const F=t.data[w],B=e[w];Ra(w),(null!==F.hostBindings||0!==F.hostVars||null!==F.hostAttrs)&&$g(F,B)}}finally{Oi(-1),Ra(l)}}(t,e,n))}function $d(t,e,n=sr){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],l=-1===a?n(e,t):t[a];t[i++]=l}}}function Lg(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=_l(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function _l(t,e,n,r,i,o,a,l,w,F){const B=20+r,J=B+i,ee=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Pt);return n}(B,J),le="function"==typeof F?F():F;return ee[1]={type:t,blueprint:ee,template:n,queries:null,viewQuery:l,declTNode:e,data:ee.slice().fill(null,B),bindingStartIndex:B,expandoStartIndex:J,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:w,consts:le,incompleteFirstPass:!1}}function Bg(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function qd(t,e,n,r){let i=!1;if(Qu()){const o=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const a=r[o];bg(n,a.selectors,!1)&&(i||(i=[]),il(xa(n,e),t,a.type),ht(a)?(qg(t,n),i.unshift(a)):i.push(a))}return i}(t,e,n),a=null===r?null:{"":-1};if(null!==o){i=!0,Gg(n,t.data.length,o.length);for(let B=0;B<o.length;B++){const J=o[B];J.providersResolver&&J.providersResolver(J)}let l=!1,w=!1,F=Ns(t,e,o.length,null);for(let B=0;B<o.length;B++){const J=o[B];n.mergedAttrs=hn(n.mergedAttrs,J.hostAttrs),Wg(t,n,e,F,J),yE(F,J,a),null!==J.contentQueries&&(n.flags|=8),(null!==J.hostBindings||null!==J.hostAttrs||0!==J.hostVars)&&(n.flags|=128);const ee=J.type.prototype;!l&&(ee.ngOnChanges||ee.ngOnInit||ee.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),l=!0),!w&&(ee.ngOnChanges||ee.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),w=!0),F++}!function(t,e){const r=e.directiveEnd,i=t.data,o=e.attrs,a=[];let l=null,w=null;for(let F=e.directiveStart;F<r;F++){const B=i[F],J=B.inputs,ee=null===o||Tg(e)?null:TE(J,o);a.push(ee),l=Bg(J,F,l),w=Bg(B.outputs,F,w)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=16),l.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=a,e.inputs=l,e.outputs=w}(t,n)}a&&function(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const o=n[e[i+1]];if(null==o)throw new fr("301",`Export of name '${e[i+1]}' not found!`);r.push(e[i],o)}}}(n,r,a)}return n.mergedAttrs=hn(n.mergedAttrs,n.attrs),i}function Hg(t,e,n,r,i,o){const a=o.hostBindings;if(a){let l=t.hostBindingOpCodes;null===l&&(l=t.hostBindingOpCodes=[]);const w=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(l)!=w&&l.push(w),l.push(r,i,a)}}function $g(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function qg(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function yE(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ht(e)&&(n[""]=t)}}function Gg(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Wg(t,e,n,r,i){t.data[r]=i;const o=i.factory||(i.factory=Yi(i.type)),a=new ae(o,ht(i),null);t.blueprint[r]=a,n[r]=a,Hg(t,e,0,r,Ns(t,n,i.hostVars,Pt),i)}function vE(t,e,n){const r=sr(e,t),i=Lg(n),o=t[10],a=Sl(t,Ya(t,i,null,n.onPush?64:16,r,e,o,o.createRenderer(r,n),null,null));t[e.index]=a}function CE(t,e,n,r,i,o){const a=o[e];if(null!==a){const l=r.setInput;for(let w=0;w<a.length;){const F=a[w++],B=a[w++],J=a[w++];null!==l?r.setInput(n,J,F,B):n[B]=J}}}function TE(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function zg(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function _E(t,e){const n=Zn(e,t);if(ms(n)){const r=n[1];80&n[2]?xs(r,n,r.template,n[8]):n[5]>0&&Wd(n)}}function Wd(t){for(let r=Ed(t);null!==r;r=_d(r))for(let i=10;i<r.length;i++){const o=r[i];if(1024&o[2]){const a=o[1];xs(a,o,a.template,o[8])}else o[5]>0&&Wd(o)}const n=t[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=Zn(n[r],t);ms(i)&&i[5]>0&&Wd(i)}}function SE(t,e){const n=Zn(e,t),r=n[1];(function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(r,n),Za(r,n,n[8])}function Sl(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function zd(t){for(;t;){t[2]|=64;const e=Qa(t);if(pt(t)&&!e)return t;t=e}return null}function Qd(t,e,n){const r=e[10];r.begin&&r.begin();try{xs(t,e,t.template,n)}catch(i){throw Zg(e,i),i}finally{r.end&&r.end()}}function Kg(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=vd(n),i=r[1];iE(i,r,i.template,n)}}(t[8])}function Jd(t,e,n){Aa(0),e(t,n)}const ME=(()=>Promise.resolve(null))();function Qg(t){return t[7]||(t[7]=[])}function Jg(t){return t.cleanup||(t.cleanup=[])}function Zg(t,e){const n=t[9],r=n?n.get(qo,null):null;r&&r.handleError(e)}function Xg(t,e,n,r,i){for(let o=0;o<n.length;){const a=n[o++],l=n[o++],w=e[a],F=t.data[a];null!==F.setInput?F.setInput(w,i,r,l):w[l]=i}}function Il(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(null!==e)for(let a=0;a<e.length;a++){const l=e[a];"number"==typeof l?o=l:1==o?i=Lt(i,l):2==o&&(r=Lt(r,l+": "+e[++a]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}const Ls=new ln("INJECTOR",-1);class em{get(e,n=Ba){if(n===Ba){const r=new Error(`NullInjectorError: No provider for ${It(e)}!`);throw r.name="NullInjectorError",r}return n}}const Xa=new ln("Set Injector scope."),eu={},OE={};let Yd;function tm(){return void 0===Yd&&(Yd=new em),Yd}function nm(t,e=null,n=null,r){return new NE(t,n,e||tm(),r)}class NE{constructor(e,n,r,i=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];n&&ki(n,l=>this.processProvider(l,e,n)),ki([e],l=>this.processInjectorType(l,[],o)),this.records.set(Ls,Fs(void 0,this));const a=this.records.get(Xa);this.scope=null!=a?a.value:null,this.source=i||("object"==typeof e?null:It(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,n=Ba,r=Ct.Default){this.assertNotDestroyed();const i=Rs(this),o=_r(void 0);try{if(!(r&Ct.SkipSelf)){let l=this.records.get(e);if(void 0===l){const w=function(t){return"function"==typeof t||"object"==typeof t&&t instanceof ln}(e)&&Mr(e);l=w&&this.injectableDefInScope(w)?Fs(Zd(e),eu):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(r&Ct.Self?tm():this.parent).get(e,n=r&Ct.Optional&&n===Ba?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[Ds]=a[Ds]||[]).unshift(It(e)),i)throw a;return Ep(a,e,"R3InjectorError",this.source)}throw a}finally{_r(o),Rs(i)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((r,i)=>e.push(It(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,n,r){if(!(e=ft(e)))return!1;let i=ns(e);const o=null==i&&e.ngModule||void 0,a=void 0===o?e:o,l=-1!==r.indexOf(a);if(void 0!==o&&(i=ns(o)),null==i)return!1;if(null!=i.imports&&!l){let B;r.push(a);try{ki(i.imports,J=>{this.processInjectorType(J,n,r)&&(void 0===B&&(B=[]),B.push(J))})}finally{}if(void 0!==B)for(let J=0;J<B.length;J++){const{ngModule:ee,providers:le}=B[J];ki(le,pe=>this.processProvider(pe,ee,le||Zt))}}this.injectorDefTypes.add(a);const w=Yi(a)||(()=>new a);this.records.set(a,Fs(w,eu));const F=i.providers;if(null!=F&&!l){const B=e;ki(F,J=>this.processProvider(J,B,F))}return void 0!==o&&void 0!==e.providers}processProvider(e,n,r){let i=Us(e=ft(e))?e:ft(e&&e.provide);const o=function(t,e,n){return im(t)?Fs(void 0,t.useValue):Fs(function(t,e,n){let r;if(Us(t)){const i=ft(t);return Yi(i)||Zd(i)}if(im(t))r=()=>ft(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...jo(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>Gt(ft(t.useExisting));else{const i=ft(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return Yi(i)||Zd(i);r=()=>new i(...jo(t.deps))}return r}(t),eu)}(e);if(Us(e)||!0!==e.multi)this.records.get(i);else{let a=this.records.get(i);a||(a=Fs(void 0,eu,!0),a.factory=()=>jo(a.multi),this.records.set(i,a)),i=e,a.multi.push(e)}this.records.set(i,o)}hydrate(e,n){return n.value===eu&&(n.value=OE,n.value=n.factory()),"object"==typeof n.value&&n.value&&function(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=ft(e.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function Zd(t){const e=Mr(t),n=null!==e?e.factory:Yi(t);if(null!==n)return n;if(t instanceof ln)throw new Error(`Token ${It(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const r=function(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?");throw new Error(`Can't resolve all parameters for ${It(t)}: (${r.join(", ")}).`)}const n=function(t){const e=t&&(t[co]||t[Wi]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Fs(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function im(t){return null!==t&&"object"==typeof t&&ld in t}function Us(t){return"function"==typeof t}const om=function(t,e,n){return function(t,e=null,n=null,r){const i=nm(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};class sn{static create(e,n){return Array.isArray(e)?om(e,n,""):om(e.providers,e.parent,e.name||"")}}function t_(t,e){Ts(vd(t)[1],En())}sn.THROW_IF_NOT_FOUND=Ba,sn.NULL=new em,sn.\u0275prov=Jt({token:sn,providedIn:"any",factory:()=>Gt(Ls)}),sn.__NG_ELEMENT_ID__=-1;let wl=null;function Vs(){if(!wl){const t=Yt.Symbol;if(t&&t.iterator)wl=t.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<e.length;++n){const r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(wl=r)}}}return wl}function nu(t){return!!sf(t)&&(Array.isArray(t)||!(t instanceof Map)&&Vs()in t)}function sf(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Rl(t,e,n,r,i,o,a,l){const w=Je(),F=$t(),B=t+20,J=F.firstCreatePass?function(t,e,n,r,i,o,a,l,w){const F=e.consts,B=ks(e,t,4,a||null,Xn(F,l));qd(e,n,B,Xn(F,w)),Ts(e,B);const J=B.tViews=_l(2,B,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,F);return null!==e.queries&&(e.queries.template(e,B),J.queries=e.queries.embeddedTView(B)),B}(B,F,w,e,n,r,i,o,a):F.data[B];Hr(J,!1);const ee=w[11].createComment("");yl(F,w,ee,J),ar(ee,w),Sl(w,w[B]=zg(ee,w,ee,J)),ut(J)&&Hd(F,w,J),null!=a&&$d(w,J,l)}function qt(t,e=Ct.Default){const n=Je();return null===n?Gt(t,e):hp(En(),n,ft(t),e)}function iu(t,e,n){const r=Je();return function(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}(r,Rt.lFrame.bindingIndex++,e)&&function(t,e,n,r,i,o,a,l){const w=sr(e,n);let B,F=e.inputs;!l&&null!=F&&(B=F[r])?(Xg(t,n,B,r,i),Fe(e)&&function(t,e){const n=Zn(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=a?a(i,e.value||"",r):i,vn(o)?o.setProperty(w,r,i):Bt(r)||(w.setProperty?w.setProperty(r,i):w[r]=i))}($t(),function(){const t=Rt.lFrame;return _a(t.tView,t.selectedIndex)}(),r,t,e,r[11],n,!1),iu}function df(t,e,n,r,i){const a=i?"class":"style";Xg(t,n,e.inputs[a],a,r)}function Bi(t,e,n,r){const i=Je(),o=$t(),a=20+t,l=i[11],w=i[a]=Id(l,e,Rt.lFrame.currentNamespace),F=o.firstCreatePass?function(t,e,n,r,i,o,a){const l=e.consts,F=ks(e,t,2,i,Xn(l,o));return qd(e,n,F,Xn(l,a)),null!==F.attrs&&Il(F,F.attrs,!1),null!==F.mergedAttrs&&Il(F,F.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,F),F}(a,o,i,0,e,n,r):o.data[a];Hr(F,!0);const B=F.mergedAttrs;null!==B&&ct(l,w,B);const J=F.classes;null!==J&&Pd(l,w,J);const ee=F.styles;null!==ee&&yg(l,w,ee),64!=(64&F.flags)&&yl(o,i,w,F),0===Rt.lFrame.elementDepthCount&&ar(w,i),Rt.lFrame.elementDepthCount++,ut(F)&&(Hd(o,i,F),function(t,e,n){if(je(e)){const i=e.directiveEnd;for(let o=e.directiveStart;o<i;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}}(o,F,i)),null!==r&&$d(i,F)}function ji(){let t=En();wa()?Rt.lFrame.isParent=!1:(t=t.parent,Hr(t,!1));const e=t;Rt.lFrame.elementDepthCount--;const n=$t();n.firstCreatePass&&(Ts(n,t),je(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&df(n,e,Je(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&df(n,e,Je(),e.stylesWithoutHost,!1)}function ff(){return Je()}function hf(t){return!!t&&"function"==typeof t.then}const Qm=function(t){return!!t&&"function"==typeof t.subscribe};function Al(t,e,n,r){const i=Je(),o=$t(),a=En();return function(t,e,n,r,i,o,a,l){const w=ut(r),B=t.firstCreatePass&&Jg(t),J=e[8],ee=Qg(e);let le=!0;if(3&r.type||l){const Se=sr(r,e),Ze=l?l(Se):Se,qe=ee.length,gt=l?Et=>l(bn(Et[r.index])):r.index;if(vn(n)){let Et=null;if(!l&&w&&(Et=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const a=i[o];if(a===n&&i[o+1]===r){const l=e[7],w=i[o+2];return l.length>w?l[w]:null}"string"==typeof a&&(o+=2)}return null}(t,e,i,r.index)),null!==Et)(Et.__ngLastListenerFn__||Et).__ngNextListenerFn__=o,Et.__ngLastListenerFn__=o,le=!1;else{o=pf(r,e,J,o,!1);const jt=n.listen(Ze,i,o);ee.push(o,jt),B&&B.push(i,gt,qe,qe+1)}}else o=pf(r,e,J,o,!0),Ze.addEventListener(i,o,a),ee.push(o),B&&B.push(i,gt,qe,a)}else o=pf(r,e,J,o,!1);const pe=r.outputs;let xe;if(le&&null!==pe&&(xe=pe[i])){const Se=xe.length;if(Se)for(let Ze=0;Ze<Se;Ze+=2){const $n=e[xe[Ze]][xe[Ze+1]].subscribe(o),Xr=ee.length;ee.push(o,$n),B&&B.push(i,r.index,Xr,-(Xr+1))}}}(o,i,i[11],a,t,e,!!n,r),Al}function Zm(t,e,n,r){try{return!1!==n(r)}catch(i){return Zg(t,i),!1}}function pf(t,e,n,r,i){return function o(a){if(a===Function)return r;const l=2&t.flags?Zn(t.index,e):e;0==(32&e[2])&&zd(l);let w=Zm(e,0,r,a),F=o.__ngNextListenerFn__;for(;F;)w=Zm(e,0,F,a)&&w,F=F.__ngNextListenerFn__;return i&&!1===w&&(a.preventDefault(),a.returnValue=!1),w}}function Pl(t=1){return function(t){return(Rt.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Rt.lFrame.contextLView))[8]}(t)}function su(t,e=""){const n=Je(),r=$t(),i=t+20,o=r.firstCreatePass?ks(r,i,1,e,null):r.data[i],a=n[i]=function(t,e){return vn(t)?t.createText(e):t.createTextNode(e)}(n[11],e);yl(r,n,a,o),Hr(o,!1)}const zo=void 0;var DS=["en",[["a","p"],["AM","PM"],zo],[["AM","PM"],zo,zo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],zo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],zo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",zo,"{1} 'at' {0}",zo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Ys={};function qy(t){return t in Ys||(Ys[t]=Yt.ng&&Yt.ng.common&&Yt.ng.common.locales&&Yt.ng.common.locales[t]),Ys[t]}var dt=(()=>((dt=dt||{})[dt.LocaleId=0]="LocaleId",dt[dt.DayPeriodsFormat=1]="DayPeriodsFormat",dt[dt.DayPeriodsStandalone=2]="DayPeriodsStandalone",dt[dt.DaysFormat=3]="DaysFormat",dt[dt.DaysStandalone=4]="DaysStandalone",dt[dt.MonthsFormat=5]="MonthsFormat",dt[dt.MonthsStandalone=6]="MonthsStandalone",dt[dt.Eras=7]="Eras",dt[dt.FirstDayOfWeek=8]="FirstDayOfWeek",dt[dt.WeekendRange=9]="WeekendRange",dt[dt.DateFormat=10]="DateFormat",dt[dt.TimeFormat=11]="TimeFormat",dt[dt.DateTimeFormat=12]="DateTimeFormat",dt[dt.NumberSymbols=13]="NumberSymbols",dt[dt.NumberFormats=14]="NumberFormats",dt[dt.CurrencyCode=15]="CurrencyCode",dt[dt.CurrencySymbol=16]="CurrencySymbol",dt[dt.CurrencyName=17]="CurrencyName",dt[dt.Currencies=18]="Currencies",dt[dt.Directionality=19]="Directionality",dt[dt.PluralCase=20]="PluralCase",dt[dt.ExtraData=21]="ExtraData",dt))();const kl="en-US";let Gy=kl;function vf(t){kn(t,"Expected localeId to be defined"),"string"==typeof t&&(Gy=t.toLowerCase().replace(/_/g,"-"))}class mv{}const vv="ngComponent";class RI{resolveComponentFactory(e){throw function(t){const e=Error(`No component factory found for ${It(t)}. Did you add it to @NgModule.entryComponents?`);return e[vv]=t,e}(e)}}class Ko{}function Ul(...t){}function Xs(t,e){return new di(sr(t,e))}Ko.NULL=new RI;const PI=function(){return Xs(En(),Je())};let di=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=PI,t})();class Vl{}let wf=(()=>{class t{}return t.\u0275prov=Jt({token:t,providedIn:"root",factory:()=>null}),t})();class Df{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const bv=new Df("12.2.2");class Ev{constructor(){}supports(e){return nu(e)}create(e){return new FI(e)}}const LI=(t,e)=>e;class FI{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||LI}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,o=null;for(;n||r;){const a=!r||n&&n.currentIndex<Sv(r,i,o)?n:r,l=Sv(a,i,o),w=a.currentIndex;if(a===r)i--,r=r._nextRemoved;else if(n=n._next,null==a.previousIndex)i++;else{o||(o=[]);const F=l-i,B=w-i;if(F!=B){for(let ee=0;ee<F;ee++){const le=ee<o.length?o[ee]:o[ee]=0,pe=le+ee;B<=pe&&pe<F&&(o[ee]=le+1)}o[a.previousIndex]=B-F}}l!==w&&e(a,l,w)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!nu(e))throw new Error(`Error trying to diff '${It(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,o,a,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let l=0;l<this.length;l++)o=e[l],a=this._trackByFn(l,o),null!==n&&Object.is(n.trackById,a)?(r&&(n=this._verifyReinsertion(n,o,a,l)),Object.is(n.item,o)||this._addIdentityChange(n,o)):(n=this._mismatch(n,o,a,l),r=!0),n=n._next}else i=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Vs()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,l=>{a=this._trackByFn(i,l),null!==n&&Object.is(n.trackById,a)?(r&&(n=this._verifyReinsertion(n,l,a,i)),Object.is(n.item,l)||this._addIdentityChange(n,l)):(n=this._mismatch(n,l,a,i),r=!0),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,o,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,o,i)):e=this._addAfter(new UI(n,r),o,i),e}_verifyReinsertion(e,n,r,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==o?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,o=e._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const i=null===n?this._itHead:n._next;return e._next=i,e._prev=n,null===i?this._itTail=e:i._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new _v),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _v),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class UI{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class VI{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class _v{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new VI,this.map.set(n,r)),r.add(e)}get(e,n){const i=this.map.get(e);return i?i.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Sv(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Iv{constructor(){}supports(e){return e instanceof Map||sf(e)}create(){return new BI}}class BI{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let n;for(n=this._mapHead;null!==n;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}diff(e){if(e){if(!(e instanceof Map||sf(e)))throw new Error(`Error trying to diff '${It(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(n&&n.key===i)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const o=this._getOrCreateRecordForKey(i,r);n=this._insertBeforeOrAppend(n,o)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){const r=e._prev;return n._next=e,n._prev=r,e._prev=n,r&&(r._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,n);const o=i._prev,a=i._next;return o&&(o._next=a),a&&(a._prev=o),i._next=null,i._prev=null,i}const r=new jI(e);return this._records.set(e,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(r=>n(e[r],r))}}class jI{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function wv(){return new du([new Ev])}let du=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(null!=r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||wv()),deps:[[t,new Ho,new Ni]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(null!=r)return r;throw new Error(`Cannot find a differ supporting object '${n}' of type '${function(t){return t.name||typeof t}(n)}'`)}}return t.\u0275prov=Jt({token:t,providedIn:"root",factory:wv}),t})();function Dv(){return new ea([new Iv])}let ea=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||Dv()),deps:[[t,new Ho,new Ni]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(r)return r;throw new Error(`Cannot find a differ supporting object '${n}'`)}}return t.\u0275prov=Jt({token:t,providedIn:"root",factory:Dv}),t})();function Bl(t,e,n,r,i=!1){for(;null!==n;){const o=e[n.index];if(null!==o&&r.push(bn(o)),He(o))for(let l=10;l<o.length;l++){const w=o[l],F=w[1].firstChild;null!==F&&Bl(w[1],w,F,r)}const a=n.type;if(8&a)Bl(t,e,n.child,r);else if(32&a){const l=bd(n,e);let w;for(;w=l();)r.push(w)}else if(16&a){const l=pg(e,n);if(Array.isArray(l))r.push(...l);else{const w=Qa(e[16]);Bl(w[1],w,l,r,!0)}}n=i?n.projectionNext:n.next}return r}class fu{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return Bl(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(He(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(wd(e,r),Bo(n,r))}this._attachedToViewContainer=!1}og(this._lView[1],this._lView)}onDestroy(e){!function(t,e,n,r){const i=Qg(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&Jg(t).push(r,i.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){zd(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Qd(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){vs(!0);try{Qd(t,e,n)}finally{vs(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(t,e){Ja(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class $I extends fu{constructor(e){super(e),this._view=e}detectChanges(){Kg(this._view)}checkNoChanges(){!function(t){vs(!0);try{Kg(t)}finally{vs(!1)}}(this._view)}get context(){return null}}const QI=[new Iv],YI=new du([new Ev]),ZI=new ea(QI),ew=function(){return function(t,e){return 4&t.type?new nw(e,t,Xs(t,e)):null}(En(),Je())};let oo=(()=>{class t{}return t.__NG_ELEMENT_ID__=ew,t})();const tw=oo,nw=class extends tw{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(e){const n=this._declarationTContainer.tViews,r=Ya(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(r[19]=o.createEmbeddedView(n)),Za(n,r,e),new fu(r)}};class Qo{}const sw=function(){return function(t,e){let n;const r=e[t.index];if(He(r))n=r;else{let i;if(8&t.type)i=bn(r);else{const o=e[11];i=o.createComment("");const a=sr(t,e);Go(o,ml(o,a),i,function(t,e){return vn(t)?t.nextSibling(e):e.nextSibling}(o,a),!1)}e[t.index]=n=zg(r,e,i,t),Sl(e,n)}return new Rv(n,t,e)}(En(),Je())};let qi=(()=>{class t{}return t.__NG_ELEMENT_ID__=sw,t})();const uw=qi,Rv=class extends uw{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Xs(this._hostTNode,this._hostLView)}get injector(){return new Es(this._hostTNode,this._hostLView)}get parentInjector(){const e=rl(this._hostTNode,this._hostLView);if(mn(e)){const n=gr(e,this._hostLView),r=Tn(e);return new Es(n[1].data[r+8],n)}return new Es(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=Mv(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,r){const i=e.createEmbeddedView(n||{});return this.insert(i,r),i}createComponent(e,n,r,i,o){const a=r||this.parentInjector;if(!o&&null==e.ngModule&&a){const w=a.get(Qo,null);w&&(o=w)}const l=e.create(a,i,void 0,o);return this.insert(l.hostView,n),l}insert(e,n){const r=e._lView,i=r[1];if(function(t){return He(t[3])}(r)){const B=this.indexOf(e);if(-1!==B)this.detach(B);else{const J=r[3],ee=new Rv(J,J[6],J[3]);ee.detach(ee.indexOf(e))}}const o=this._adjustIndex(n),a=this._lContainer;!function(t,e,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-10?(e[4]=n[i],al(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const a=e[17];null!==a&&n!==a&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(a,e);const l=e[19];null!==l&&l.insertView(t),e[2]|=128}(i,r,a,o);const l=Md(o,a),w=r[11],F=ml(w,a[7]);return null!==F&&function(t,e,n,r,i,o){r[0]=i,r[6]=e,Ja(t,r,n,1,i,o)}(i,a[6],w,r,F,l),e.attachToViewContainerRef(),al(Rf(a),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=Mv(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=wd(this._lContainer,n);r&&(Bo(Rf(this._lContainer),n),og(r[1],r))}detach(e){const n=this._adjustIndex(e,-1),r=wd(this._lContainer,n);return r&&null!=Bo(Rf(this._lContainer),n)?new fu(r):null}_adjustIndex(e,n=0){return null==e?this.length+n:e}};function Mv(t){return t[8]}function Rf(t){return t[8]||(t[8]=[])}const ia={};class Jv extends Ko{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=an(e);return new Zv(n,this.ngModule)}}function Yv(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const iD=new ln("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Yp});class Zv extends mv{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function(t){return t.map(Gb).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return Yv(this.componentDef.inputs)}get outputs(){return Yv(this.componentDef.outputs)}create(e,n,r,i){const o=(i=i||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const o=t.get(n,ia,i);return o!==ia||r===ia?o:e.get(n,r,i)}}}(e,i.injector):e,a=o.get(Vl,Wu),l=o.get(wf,null),w=a.createRenderer(null,this.componentDef),F=this.componentDef.selectors[0][0]||"div",B=r?function(t,e,n){if(vn(t))return t.selectRootElement(e,n===dn.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(w,r,this.componentDef.encapsulation):Id(a.createRenderer(null,this.componentDef),F,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(F)),J=this.componentDef.onPush?576:528,ee=function(t,e){return{components:[],scheduler:t||Yp,clean:ME,playerHandler:e||null,flags:0}}(),le=_l(0,null,null,1,0,null,null,null,null,null),pe=Ya(null,le,ee,J,null,null,a,w,l,o);let xe,Se;Cs(pe);try{const Ze=function(t,e,n,r,i,o){const a=n[1];n[20]=t;const w=ks(a,20,2,"#host",null),F=w.mergedAttrs=e.hostAttrs;null!==F&&(Il(w,F,!0),null!==t&&(ct(i,t,F),null!==w.classes&&Pd(i,t,w.classes),null!==w.styles&&yg(i,t,w.styles)));const B=r.createRenderer(t,e),J=Ya(n,Lg(e),null,e.onPush?64:16,n[20],w,r,B,o||null,null);return a.firstCreatePass&&(il(xa(w,n),a,e.type),qg(a,w),Gg(w,n.length,1)),Sl(n,J),n[20]=J}(B,this.componentDef,pe,a,w);if(B)if(r)ct(w,B,["ng-version",bv.full]);else{const{attrs:qe,classes:gt}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!oi(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);qe&&ct(w,B,qe),gt&&gt.length>0&&Pd(w,B,gt.join(" "))}if(Se=_a(le,20),void 0!==n){const qe=Se.projection=[];for(let gt=0;gt<this.ngContentSelectors.length;gt++){const Et=n[gt];qe.push(null!=Et?Array.from(Et):null)}}xe=function(t,e,n,r,i){const o=n[1],a=function(t,e,n){const r=En();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Wg(t,r,e,Ns(t,e,1,null),n));const i=La(e,t,r.directiveStart,r);ar(i,e);const o=sr(r,e);return o&&ar(o,e),i}(o,n,e);if(r.components.push(a),t[8]=a,i&&i.forEach(w=>w(a,e)),e.contentQueries){const w=En();e.contentQueries(1,a,w.directiveStart)}const l=En();return!o.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Oi(l.index),Hg(n[1],l,0,l.directiveStart,l.directiveEnd,e),$g(e,a)),a}(Ze,this.componentDef,pe,ee,[t_]),Za(le,pe,null)}finally{Zi()}return new aD(this.componentType,xe,Xs(Se,pe),pe,Se)}}class aD extends class{}{constructor(e,n,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.instance=n,this.hostView=this.changeDetectorRef=new $I(i),this.componentType=e}get injector(){return new Es(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const oa=new Map;class cD extends Qo{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Jv(this);const r=Qn(e),i=function(t){return t[as]||null}(e);i&&vf(i),this._bootstrapComponents=Fi(r.bootstrap),this._r3Injector=nm(e,n,[{provide:Qo,useValue:this},{provide:Ko,useValue:this.componentFactoryResolver}],It(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,n=sn.THROW_IF_NOT_FOUND,r=Ct.Default){return e===sn||e===Qo||e===Ls?this:this._r3Injector.get(e,n,r)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class jf extends class{}{constructor(e){super(),this.moduleType=e,null!==Qn(e)&&function(t){const e=new Set;!function n(r){const i=Qn(r,!0),o=i.id;null!==o&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${It(e)} vs ${It(e.name)}`)}(o,oa.get(o),r),oa.set(o,r));const a=Fi(i.imports);for(const l of a)e.has(l)||(e.add(l),n(l))}(t)}(e)}create(e){return new cD(this.moduleType,e)}}function Hf(t){return e=>{setTimeout(t,void 0,e)}}const so=class extends Y{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){var i,o,a;let l=e,w=n||(()=>null),F=r;if(e&&"object"==typeof e){const J=e;l=null===(i=J.next)||void 0===i?void 0:i.bind(J),w=null===(o=J.error)||void 0===o?void 0:o.bind(J),F=null===(a=J.complete)||void 0===a?void 0:a.bind(J)}this.__isAsync&&(w=Hf(w),l&&(l=Hf(l)),F&&(F=Hf(F)));const B=super.subscribe({next:l,error:w,complete:F});return e instanceof f&&e.add(B),B}};Symbol;const Ql=new ln("Application Initializer");let aa=(()=>{class t{constructor(n){this.appInits=n,this.resolve=Ul,this.reject=Ul,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const o=this.appInits[i]();if(hf(o))n.push(o);else if(Qm(o)){const a=new Promise((l,w)=>{o.subscribe({complete:l,error:w})});n.push(a)}}Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(Gt(Ql,8))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();const Su=new ln("AppId"),gR={provide:Su,useFactory:function(){return`${Xf()}${Xf()}${Xf()}`},deps:[]};function Xf(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const RC=new ln("Platform Initializer"),eh=new ln("Platform ID"),mR=new ln("appBootstrapListener");let th=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();const bo=new ln("LocaleId"),MC=new ln("DefaultCurrencyCode");class vR{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}const nh=function(t){return new jf(t)},CR=nh,TR=function(t){return Promise.resolve(nh(t))},AC=function(t){const e=nh(t),r=Fi(Qn(t).declarations).reduce((i,o)=>{const a=an(o);return a&&i.push(new Zv(a)),i},[]);return new vR(e,r)},bR=AC,ER=function(t){return Promise.resolve(AC(t))};let Yl=(()=>{class t{constructor(){this.compileModuleSync=CR,this.compileModuleAsync=TR,this.compileModuleAndAllComponentsSync=bR,this.compileModuleAndAllComponentsAsync=ER}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();const IR=(()=>Promise.resolve(0))();function rh(t){"undefined"==typeof Zone?IR.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class tr{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new so(!1),this.onMicrotaskEmpty=new so(!1),this.onStable=new so(!1),this.onError=new so(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let t=Yt.requestAnimationFrame,e=Yt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Yt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,oh(t),t.isCheckStableRunning=!0,ih(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),oh(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,o,a,l)=>{try{return PC(t),n.invokeTask(i,o,a,l)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&e(),OC(t)}},onInvoke:(n,r,i,o,a,l,w)=>{try{return PC(t),n.invoke(i,o,a,l,w)}finally{t.shouldCoalesceRunChangeDetection&&e(),OC(t)}},onHasTask:(n,r,i,o)=>{n.hasTask(i,o),r===i&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,oh(t),ih(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,i,o)=>(n.handleError(i,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!tr.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(tr.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+i,e,DR,Ul,Ul);try{return o.runTask(a,n,r)}finally{o.cancelTask(a)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const DR={};function ih(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function oh(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function PC(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function OC(t){t._nesting--,ih(t)}class AR{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new so,this.onMicrotaskEmpty=new so,this.onStable=new so,this.onError=new so}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}let sh=(()=>{class t{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{tr.assertNotInAngularZone(),rh(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())rh(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,r,i){return[]}}return t.\u0275fac=function(n){return new(n||t)(Gt(tr))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})(),kC=(()=>{class t{constructor(){this._applications=new Map,ah.addToWindow(this)}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return ah.findTestabilityInTree(this,n,r)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();class PR{addToWindow(e){}findTestabilityInTree(e,n,r){return null}}let ah=new PR,NC=!0,xC=!1;let pi;const FC=new ln("AllowMultipleToken");function UC(t,e,n=[]){const r=`Platform: ${e}`,i=new ln(r);return(o=[])=>{let a=VC();if(!a||a.injector.get(FC,!1))if(t)t(n.concat(o).concat({provide:i,useValue:!0}));else{const l=n.concat(o).concat({provide:i,useValue:!0},{provide:Xa,useValue:"platform"});!function(t){if(pi&&!pi.destroyed&&!pi.injector.get(FC,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");pi=t.get(BC);const e=t.get(RC,null);e&&e.forEach(n=>n())}(sn.create({providers:l,name:r}))}return function(t){const e=VC();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function VC(){return pi&&!pi.destroyed?pi:null}let BC=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const l=function(t,e){let n;return n="noop"===t?new AR:("zone.js"===t?void 0:t)||new tr({enableLongStackTrace:(xC=!0,NC),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),w=[{provide:tr,useValue:l}];return l.run(()=>{const F=sn.create({providers:w,parent:this.injector,name:n.moduleType.name}),B=n.create(F),J=B.injector.get(qo,null);if(!J)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return l.runOutsideAngular(()=>{const ee=l.onError.subscribe({next:le=>{J.handleError(le)}});B.onDestroy(()=>{uh(this._modules,B),ee.unsubscribe()})}),function(t,e,n){try{const r=n();return hf(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(J,l,()=>{const ee=B.injector.get(aa);return ee.runInitializers(),ee.donePromise.then(()=>(vf(B.injector.get(bo,kl)||kl),this._moduleDoBootstrap(B),B))})})}bootstrapModule(n,r=[]){const i=jC({},r);return function(t,e,n){const r=new jf(n);return Promise.resolve(r)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,i))}_moduleDoBootstrap(n){const r=n.injector.get(Iu);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new Error(`The module ${It(n.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(Gt(sn))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();function jC(t,e){return Array.isArray(e)?e.reduce(jC,t):Object.assign(Object.assign({},t),e)}let Iu=(()=>{class t{constructor(n,r,i,o,a){this._zone=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const l=new M(F=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{F.next(this._stable),F.complete()})}),w=new M(F=>{let B;this._zone.runOutsideAngular(()=>{B=this._zone.onStable.subscribe(()=>{tr.assertNotInAngularZone(),rh(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,F.next(!0))})})});const J=this._zone.onUnstable.subscribe(()=>{tr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{F.next(!1)}))});return()=>{B.unsubscribe(),J.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return ce(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof M?t[0]:De(e)(Ke(t,n))}(l,w.pipe(t=>bt()(function(t,e){return function(r){let i;i="function"==typeof t?t:function(){return t};const o=Object.create(r,gn);return o.source=r,o.subjectFactory=i,o}}(ei)(t))))}bootstrap(n,r){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=n instanceof mv?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(i.componentType);const o=function(t){return t.isBoundToModule}(i)?void 0:this._injector.get(Qo),l=i.create(sn.NULL,[],r||i.selector,o),w=l.location.nativeElement,F=l.injector.get(sh,null),B=F&&l.injector.get(kC);return F&&B&&B.registerApplication(w,F),l.onDestroy(()=>{this.detachView(l.hostView),uh(this.components,l),B&&B.unregisterApplication(w)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;uh(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(mR,[]).concat(this._bootstrapListeners).forEach(i=>i(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(n){return new(n||t)(Gt(tr),Gt(sn),Gt(qo),Gt(Ko),Gt(aa))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();function uh(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const iM=UC(null,"core",[{provide:eh,useValue:"unknown"},{provide:BC,deps:[sn]},{provide:kC,deps:[]},{provide:th,deps:[]}]),lM=[{provide:Iu,useClass:Iu,deps:[tr,sn,qo,Ko,aa]},{provide:iD,deps:[tr],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(n){e.push(n)}}},{provide:aa,useClass:aa,deps:[[new Ni,Ql]]},{provide:Yl,useClass:Yl,deps:[]},gR,{provide:du,useFactory:function(){return YI},deps:[]},{provide:ea,useFactory:function(){return ZI},deps:[]},{provide:bo,useFactory:function(t){return vf(t=t||"undefined"!=typeof $localize&&$localize.locale||kl),t},deps:[[new $a(bo),new Ni,new Ho]]},{provide:MC,useValue:"USD"}];let dM=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(Gt(Iu))},t.\u0275mod=Ur({type:t}),t.\u0275inj=Rr({providers:lM}),t})(),ac=null;function Au(){return ac}const nr=new ln("DocumentToken");var xn=(()=>((xn=xn||{})[xn.Zero=0]="Zero",xn[xn.One=1]="One",xn[xn.Two=2]="Two",xn[xn.Few=3]="Few",xn[xn.Many=4]="Many",xn[xn.Other=5]="Other",xn))();const CA=function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=qy(e);if(n)return n;const r=e.split("-")[0];if(n=qy(r),n)return n;if("en"===r)return DS;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[dt.PluralCase]};class yc{}let KA=(()=>{class t extends yc{constructor(n){super(),this.locale=n}getPluralCategory(n,r){switch(CA(r||this.locale)(n)){case xn.Zero:return"zero";case xn.One:return"one";case xn.Two:return"two";case xn.Few:return"few";case xn.Many:return"many";default:return"other"}}}return t.\u0275fac=function(n){return new(n||t)(Gt(bo))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})(),w0=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new tP,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){D0("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){D0("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(qt(qi),qt(oo))},t.\u0275dir=Nn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class tP{constructor(){this.$implicit=null,this.ngIf=null}}function D0(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${It(e)}'.`)}let DP=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Ur({type:t}),t.\u0275inj=Rr({providers:[{provide:yc,useClass:KA}]}),t})();class xh extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(t){ac||(ac=t)}(new xh)}onAndCancel(e,n,r){return e.addEventListener(n,r,!1),()=>{e.removeEventListener(n,r,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=(ku=ku||document.querySelector("base"),ku?ku.getAttribute("href"):null);return null==n?null:function(t){vc=vc||document.createElement("a"),vc.setAttribute("href",t);const e=vc.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){ku=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,o]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}(document.cookie,e)}}let vc,ku=null;const O0=new ln("TRANSITION_ID"),FP=[{provide:Ql,useFactory:function(t,e,n){return()=>{n.get(aa).donePromise.then(()=>{const r=Au(),i=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<i.length;o++)r.remove(i[o])})}},deps:[O0,nr,sn],multi:!0}];class Lh{static init(){!function(t){ah=t}(new Lh)}addToWindow(e){Yt.getAngularTestability=(r,i=!0)=>{const o=e.findTestabilityInTree(r,i);if(null==o)throw new Error("Could not find testability for element.");return o},Yt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Yt.getAllAngularRootElements=()=>e.getAllRootElements(),Yt.frameworkStabilizers||(Yt.frameworkStabilizers=[]),Yt.frameworkStabilizers.push(r=>{const i=Yt.getAllAngularTestabilities();let o=i.length,a=!1;const l=function(w){a=a||w,o--,0==o&&r(a)};i.forEach(function(w){w.whenStable(l)})})}findTestabilityInTree(e,n,r){if(null==n)return null;const i=e.getTestability(n);return null!=i?i:r?Au().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null}}let UP=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();const Nu=new ln("EventManagerPlugins");let Tc=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>i.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}addGlobalEventListener(n,r,i){return this._findPluginFor(r).addGlobalEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const i=this._plugins;for(let o=0;o<i.length;o++){const a=i[o];if(a.supports(n))return this._eventNameToPlugin.set(n,a),a}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(Gt(Nu),Gt(tr))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();class Fh{constructor(e){this._doc=e}addGlobalEventListener(e,n,r){const i=Au().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${n}`);return this.addEventListener(i,n,r)}}let N0=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})(),xu=(()=>{class t extends N0{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,i){n.forEach(o=>{const a=this._doc.createElement("style");a.textContent=o,i.push(r.appendChild(a))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(x0),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(n,i,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(x0))}}return t.\u0275fac=function(n){return new(n||t)(Gt(nr))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();function x0(t){Au().remove(t)}const Uh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Vh=/%COMP%/g;function bc(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?bc(t,i,n):(i=i.replace(Vh,t),n.push(i))}return n}function U0(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Bh=(()=>{class t{constructor(n,r,i){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new jh(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case dn.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new XP(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(n),i}case 1:case dn.ShadowDom:return new eO(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const i=bc(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(Gt(Tc),Gt(xu),Gt(Su))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();class jh{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,n){return n?document.createElementNS(Uh[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){e.appendChild(n)}insertBefore(e,n,r){e&&e.insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const o=Uh[i];o?e.setAttributeNS(o,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=Uh[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Nr.DashCase|Nr.Important)?e.style.setProperty(n,r,i&Nr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Nr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,U0(r)):this.eventManager.addEventListener(e,n,U0(r))}}class XP extends jh{constructor(e,n,r,i){super(e),this.component=r;const o=bc(i+"-"+r.id,r.styles,[]);n.addStyles(o),this.contentAttr=function(t){return"_ngcontent-%COMP%".replace(Vh,t)}(i+"-"+r.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(Vh,t)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}class eO extends jh{constructor(e,n,r,i){super(e),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=bc(i.id,i.styles,[]);for(let a=0;a<o.length;a++){const l=document.createElement("style");l.textContent=o[a],this.shadowRoot.appendChild(l)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let tO=(()=>{class t extends Fh{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}}return t.\u0275fac=function(n){return new(n||t)(Gt(nr))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();const j0=["alt","control","meta","shift"],uO={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},H0={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},lO={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let cO=(()=>{class t extends Fh{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const o=t.parseEventName(r),a=t.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Au().onAndCancel(n,o.domEventName,a))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=t._normalizeKey(r.pop());let a="";if(j0.forEach(w=>{const F=r.indexOf(w);F>-1&&(r.splice(F,1),a+=w+".")}),a+=o,0!=r.length||0===o.length)return null;const l={};return l.domEventName=i,l.fullKey=a,l}static getEventFullKey(n){let r="",i=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&H0.hasOwnProperty(e)&&(e=H0[e]))}return uO[e]||e}(n);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),j0.forEach(o=>{o!=i&&lO[o](n)&&(r+=o+".")}),r+=i,r}static eventCallback(n,r,i){return o=>{t.getEventFullKey(o)===n&&i.runGuarded(()=>r(o))}}static _normalizeKey(n){switch(n){case"esc":return"escape";default:return n}}}return t.\u0275fac=function(n){return new(n||t)(Gt(nr))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac}),t})();const vO=UC(iM,"browser",[{provide:eh,useValue:"browser"},{provide:RC,useValue:function(){xh.makeCurrent(),Lh.init()},multi:!0},{provide:nr,useFactory:function(){return function(t){ba=t}(document),document},deps:[]}]),CO=[[],{provide:Xa,useValue:"root"},{provide:qo,useFactory:function(){return new qo},deps:[]},{provide:Nu,useClass:tO,multi:!0,deps:[nr,tr,eh]},{provide:Nu,useClass:cO,multi:!0,deps:[nr]},[],{provide:Bh,useClass:Bh,deps:[Tc,xu,Su]},{provide:Vl,useExisting:Bh},{provide:N0,useExisting:xu},{provide:xu,useClass:xu,deps:[nr]},{provide:sh,useClass:sh,deps:[tr]},{provide:Tc,useClass:Tc,deps:[Nu,tr]},{provide:class{},useClass:UP,deps:[]},[]];let TO=(()=>{class t{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:t,providers:[{provide:Su,useValue:n.appId},{provide:O0,useExisting:Su},FP]}}}return t.\u0275fac=function(n){return new(n||t)(Gt(t,12))},t.\u0275mod=Ur({type:t}),t.\u0275inj=Rr({providers:CO,imports:[DP,dM]}),t})();"undefined"!=typeof window&&window;var Ec=u(8239),RO=u(5436);class Wh{constructor(){this.middlewares={}}static getInstance(){return this._instance||(this._instance=new Wh),this._instance}subscribe(e,n){this.middlewares[e]=n}create(){return console.log("[CustomStore][create]"),window.WebChat.createStore({},({dispatch:n})=>r=>i=>{let o=i;if(i&&i.payload)for(const a of Object.keys(this.middlewares)){const l=this.middlewares[a];if(l.applicable(o)){const w=l.apply(o);w.dispatchAction&&n(w.dispatchAction),w.nextAction&&(o=w.nextAction)}}return r(o)})}}var ca=u(8139);const q0=t=>{if(t){const e=t.split(/\s/).reduce((n,r)=>n+r.slice(0,1),"");return e.length>1?e.substring(0,2).toUpperCase():t.substring(0,2).toUpperCase()}return""};var da=(()=>(function(t){t.Sending="sending",t.SendFailed="send failed",t.Sent="sent"}(da||(da={})),da))();class LO{constructor(e){this.dataMaskingRules=e,console.log("[DataMaskingRules]"),console.log(this.dataMaskingRules)}applicable(e){const{text:n}=e.payload;return!!(Object.keys(this.dataMaskingRules).length>0&&n&&"WEB_CHAT/SEND_MESSAGE"===e.type)}apply(e){return{dispatchAction:null,nextAction:this.applyDataMasking(e)}}applyDataMasking(e){let{text:r}=e.payload;if(Object.keys(this.dataMaskingRules).length>0)for(const i of Object.values(this.dataMaskingRules)){const o=new RegExp(i,"g");let a;for(;a=o.exec(r);){const l=a[0].replace(/./g,"#");r=r.replace(a[0],l)}}return e.payload.text=r,e}}const _c_omnichannelConfig_orgId="d367c413-e0b9-408b-ae1c-382499b369ae",_c_omnichannelConfig_orgUrl="https://omnichannel-crm.omnichannelengagementhub.com",_c_omnichannelConfig_widgetId="3a352b95-5d67-4e47-af28-eca029b03928";let zh=(()=>{class t{}return t.canUploadAttachment=!1,t})();function Sc(t,e){return new M(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let o=0,a=0;for(let l=0;l<r;l++){const w=Ie(t[l]);let F=!1;n.add(w.subscribe({next:B=>{F||(F=!0,a++),i[l]=B},error:B=>n.error(B),complete:()=>{o++,(o===r||!F)&&(a===r&&n.next(e?e.reduce((B,J,ee)=>(B[J]=i[ee],B),{}):i),n.complete())}}))}})}class $O extends f{constructor(e,n){super()}schedule(e,n=0){return this}}class qO extends $O{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){if(this.closed)return this;this.state=e;const r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(i,this.id,n),this}requestAsyncId(e,n,r=0){return setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!==r&&this.delay===r&&!1===this.pending)return n;clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,r=!1;try{this.work(e)}catch(o){r=!0,i=!!o&&o||new Error(o)}if(r)return this.unsubscribe(),i}_unsubscribe(){const e=this.id,n=this.scheduler,r=n.actions,i=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&r.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null}}let G0=(()=>{class t{constructor(n,r=t.now){this.SchedulerAction=n,this.now=r}schedule(n,r=0,i){return new this.SchedulerAction(this,n).schedule(i,r)}}return t.now=()=>Date.now(),t})();class So extends G0{constructor(e,n=G0.now){super(e,()=>So.delegate&&So.delegate!==this?So.delegate.now():n()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,n=0,r){return So.delegate&&So.delegate!==this?So.delegate.schedule(e,n,r):super.schedule(e,n,r)}flush(e){const{actions:n}=this;if(this.active)return void n.push(e);let r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this.active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}const zO=new class extends So{}(class extends qO{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!==r&&r>0||null===r&&this.delay>0?super.requestAsyncId(e,n,r):e.flush(this)}}),KO=new M(t=>t.complete());class Zr{constructor(e,n,r){this.kind=e,this.value=n,this.error=r,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,n,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return n&&n(this.error);case"C":return r&&r()}}accept(e,n,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,n,r)}toObservable(){switch(this.kind){case"N":return function(...t){let e=t[t.length-1];return ce(e)?(t.pop(),Te(t,e)):Ke(t)}(this.value);case"E":return function(t,e){return new M(n=>n.error(t))}(this.error);case"C":return function(t){return t?function(t){return new M(e=>t.schedule(()=>e.complete()))}(t):KO}()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new Zr("N",e):Zr.undefinedValueNotification}static createError(e){return new Zr("E",void 0,e)}static createComplete(){return Zr.completeNotification}}Zr.completeNotification=new Zr("C"),Zr.undefinedValueNotification=new Zr("N",void 0);class Ic extends g{constructor(e,n,r=0){super(e),this.scheduler=n,this.delay=r}static dispatch(e){const{notification:n,destination:r}=e;n.observe(r),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(Ic.dispatch,this.delay,new t1(e,this.destination)))}_next(e){this.scheduleMessage(Zr.createNext(e))}_error(e){this.scheduleMessage(Zr.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(Zr.createComplete()),this.unsubscribe()}}class t1{constructor(e,n){this.notification=e,this.destination=n}}class W0 extends Y{constructor(e=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r){super(),this.scheduler=r,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new n1(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;let a;if(this.closed)throw new j;if(this.isStopped||this.hasError?a=f.EMPTY:(this.observers.push(e),a=new ue(this,e)),i&&e.add(e=new Ic(e,i)),n)for(let l=0;l<o&&!e.closed;l++)e.next(r[l]);else for(let l=0;l<o&&!e.closed;l++)e.next(r[l].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),a}_getNow(){return(this.scheduler||zO).now()}_trimBufferThenGetEvents(){const e=this._getNow(),n=this._bufferSize,r=this._windowTime,i=this._events,o=i.length;let a=0;for(;a<o&&!(e-i[a].time<r);)a++;return o>n&&(a=Math.max(a,o-n)),a>0&&i.splice(0,a),i}}class n1{constructor(e,n){this.time=e,this.value=n}}let r1=(()=>{class t{constructor(n){this.document=n,this._loadedLibraries={}}lazyLoad(){return function(...t){if(1===t.length){const e=t[0];if(d(e))return Sc(e,null);if(T(e)&&Object.getPrototypeOf(e)===Object.prototype){const n=Object.keys(e);return Sc(n.map(r=>e[r]),n)}}if("function"==typeof t[t.length-1]){const e=t.pop();return Sc(t=1===t.length&&d(t[0])?t[0]:t,null).pipe(Ce(n=>e(...n)))}return Sc(t,null)}([this.loadScript("https://cdn.botframework.com/botframework-webchat/4.9.2/webchat.js")])}loadScript(n){if(this._loadedLibraries[n])return this._loadedLibraries[n].asObservable();this._loadedLibraries[n]=new W0;const r=this.document.createElement("script");return r.type="text/javascript",r.async=!0,r.src=n,r.onload=()=>{this._loadedLibraries[n].next(),this._loadedLibraries[n].complete()},this.document.body.appendChild(r),this._loadedLibraries[n].asObservable()}loadStyle(n){if(this._loadedLibraries[n])return this._loadedLibraries[n].asObservable();this._loadedLibraries[n]=new W0;const r=this.document.createElement("link");return r.type="text/css",r.href=n,r.rel="stylesheet",r.onload=()=>{this._loadedLibraries[n].next(),this._loadedLibraries[n].complete()},document.getElementsByTagName("head")[0].appendChild(r),this._loadedLibraries[n].asObservable()}}return t.\u0275fac=function(n){return new(n||t)(Gt(nr))},t.\u0275prov=Jt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function i1(t,e){1&t&&(Bi(0,"div",8),Bi(1,"span",9),su(2," \u{1f440} "),ji(),ji())}function o1(t,e){if(1&t){const n=ff();Bi(0,"div",3),Bi(1,"div",4),su(2,"LiveChat with Omnichannel Chat SDK "),Bi(3,"span",5),Al("click",function(){return Ia(n),Pl().endChat()}),su(4," \u274c "),ji(),ji(),Rl(5,i1,3,0,"div",6),function(t,e,n,r){Bi(t,e,n,r),ji()}(6,"div",7),ji()}if(2&t){const n=Pl();Cl(5),iu("ngIf",n.loading)}}function s1(t,e){if(1&t){const n=ff();Bi(0,"div",10),Al("click",function(){return Ia(n),Pl().startChat()}),Bi(1,"span"),su(2," \u{1f44b} "),ji(),ji()}}const z0=(()=>{const t={orgId:_c_omnichannelConfig_orgId||"",orgUrl:_c_omnichannelConfig_orgUrl||"",widgetId:_c_omnichannelConfig_widgetId||""},e=new URLSearchParams(window.location.search);return null!==e.get("orgUrl")&&(t.orgUrl=e.get("orgUrl")),null!==e.get("orgId")&&(t.orgId=e.get("orgId")),null!==e.get("widgetId")&&(t.widgetId=e.get("widgetId")),t})(),K0=(()=>{const t={telemetry:{disable:!1,ariaTelemetryKey:""}},e=new URLSearchParams(window.location.search);return null!==e.get("telemetry")&&(t.telemetry.disable="true"!=e.get("telemetry")),null!==e.get("ariaTelemetryKey")&&(t.telemetry.ariaTelemetryKey=e.get("ariaTelemetryKey")||""),t})(),Q0=(()=>{const t={disable:!0},e=new URLSearchParams(window.location.search);return null!==e.get("debug")&&(t.disable="true"!=e.get("debug")),t})();console.log("%c [OmnichannelConfig]","background-color:#001433;color:#fff"),console.log(z0),console.log("%c [debugConfig]","background-color:#001433;color:#fff"),console.log(Q0),console.log("%c [telemetryConfig]","background-color:#001433;color:#fff"),console.log(K0);const a1=(console.log("[createAvatarMiddleware]"),()=>e=>n=>{console.log("[AvatarMiddleware]");const{activity:{channelData:{tags:r},from:{name:i},text:o},fromUser:a}=n;return console.log(n),r&&r.includes("system")?(console.log(`[AvatarMiddleware][Message][System] ${o}`),ca.createElement("div",null,"\u2757")):null!=a&&(a?a?(console.log(`[AvatarMiddleware][Message][Customer] ${o}`),ca.createElement("div",{className:"webchat__avatar"},ca.createElement("p",{className:"webchat__avatar_initials"}," ",q0(i)||"CU","  "))):e(n):(console.log(`[AvatarMiddleware][Message][Agent] ${o}`),ca.createElement("div",{className:"webchat__avatar"},ca.createElement("p",{className:"webchat__avatar_initials"}," ",q0(i)," "))))}),u1=(console.log("[createActivityMiddleware]"),()=>e=>n=>{if(console.log("%c [ActivityMiddleware]","background: #2a9fd4; color: #fff"),console.log(n),n.activity){if(n.activity.channelData&&n.activity.channelData.tags&&n.activity.channelData.tags.includes("system"))return console.log(`%c [ActivityMiddleware][Message][System] ${n.activity.text}`,"background: #2a9fd4; color: #fff"),r=>ca.createElement("div",{key:n.activity.id,className:"system-message"},e(n)(r));if(void 0===n.activity.text||null==n.activity.text)return e(n);"bot"===n.activity.from.role&&console.log(`%c [ActivityMiddleware][Message][Agent] ${n.activity.text}`,"background: #2a9fd4; color: #fff"),"user"===n.activity.from.role&&console.log(`%c [ActivityMiddleware][Message][Customer] ${n.activity.text}`,"background: #2a9fd4; color: #fff")}return e(n)}),l1=()=>e=>n=>{console.log("%c [activityStatusMiddleware]","background: #238636; color: #fff"),console.log(n);let r="";(t=>t.activity.channelData&&t.activity.channelData.tags&&t.activity.channelData.tags.includes("system"))(n)?r="System":(t=>"bot"===t.activity.from.role)(n)?r="Agent":(t=>"user"===t.activity.from.role)(n)&&(r="Customer"),console.log(`%c [activityStatusMiddleware][Message][${r}] ${n.activity.text}`,"background: #238636; color: #fff"),n.sendState===da.Sent?console.log(`%c [activityStatusMiddleware][Message][${r}][Status] Sent!`,"background: #238636; color: #fff"):n.sendState===da.Sending?console.log(`%c [activityStatusMiddleware][Message][${r}][Status] Sending...`,"background: #238636; color: #fff"):n.sendState===da.SendFailed&&console.log(`%c [activityStatusMiddleware][Message][${r}][Status] Failed :(`,"background: #238636; color: #fff")},J0={bubbleBorderRadius:10,bubbleNubSize:10,bubbleNubOffset:15,bubbleFromUserBorderRadius:10,bubbleFromUserNubSize:10,bubbleFromUserNubOffset:15,bubbleFromUserBackground:"rgb(246, 246, 246)"};let d1=(()=>{class t{constructor(n,r){this.webChatControlService=n,this.document=r,this.title="angular-botframework-webchat-control",this.webChat=null,this.chatSDK=null,this.chatAdapter=null,this.loading=!1,this.hasChatStarted=!1,this.webChatStore=null}ngOnInit(){var n=this;return(0,Ec.Z)(function*(){console.log("[ngOnInit]"),n.webChatControlService.lazyLoad().subscribe(function(){var r=(0,Ec.Z)(function*(i){n.webChat=window.WebChat;const o=Object.assign({},K0),a=new RO.Mg(z0,o);a.setDebug(!Q0.disable),yield a.initialize(),n.chatSDK=a,n.webChat=window.WebChat,(t=>{zh.canUploadAttachment="true"===t.LiveWSAndLiveChatEngJoin.msdyn_enablefileattachmentsforcustomers||!1})(yield a.getLiveChatConfig()),J0.hideUploadButton=!zh.canUploadAttachment;const w=localStorage.getItem("liveChatContext");w&&Object.keys(JSON.parse(w)).length>0&&(console.log("[liveChatContext]"),console.log(w))});return function(i){return r.apply(this,arguments)}}())})()}startChat(){var n=this;return(0,Ec.Z)(function*(){var r,i,o,a;console.log("[startChat]");const l=yield null===(r=n.chatSDK)||void 0===r?void 0:r.getDataMaskingRules();console.log(l);const w=(console.log("[createCustomStore]"),Wh.getInstance());n.webChatStore=w.create(),w.subscribe("DataMasking",(t=>(console.log("[createDataMaskingMiddleware]"),new LO(t)))(l));const F={},B=localStorage.getItem("liveChatContext");B&&Object.keys(JSON.parse(B)).length>0&&(console.log("[liveChatContext]"),F.liveChatContext=JSON.parse(B)),n.hasChatStarted=!0,n.loading=!0,yield null===(i=n.chatSDK)||void 0===i?void 0:i.startChat(F);const J=yield null===(o=n.chatSDK)||void 0===o?void 0:o.getCurrentLiveChatContext();J&&Object.keys(J).length&&localStorage.setItem("liveChatContext",JSON.stringify(J));const ee=yield null===(a=n.chatSDK)||void 0===a?void 0:a.createChatAdapter();n.chatAdapter=ee,n.loading=!1,n.webChat.renderWebChat({directLine:ee,sendTypingIndicator:!0,styleOptions:J0,store:n.webChatStore,avatarMiddleware:a1,activityMiddleware:u1,activityStatusMiddleware:l1},n.document.getElementById("chat-container"))})()}endChat(){var n=this;return(0,Ec.Z)(function*(){var r;console.log("[endChat]"),yield null===(r=n.chatSDK)||void 0===r?void 0:r.endChat(),n.hasChatStarted=!1;const i=n.document.getElementById("chat-container");for(;i.firstChild;)i.firstChild.remove()})()}}return t.\u0275fac=function(n){return new(n||t)(qt(r1),qt(nr))},t.\u0275cmp=Ki({type:t,selectors:[["app-root"]],decls:3,vars:2,consts:[["id","root"],["id","chat-root",4,"ngIf"],["id","chat-button",3,"click",4,"ngIf"],["id","chat-root"],[1,"chat-header"],[3,"click"],["id","loading-screen",4,"ngIf"],["id","chat-container"],["id","loading-screen"],["id","loader"],["id","chat-button",3,"click"]],template:function(n,r){1&n&&(Bi(0,"div",0),Rl(1,o1,7,1,"div",1),Rl(2,s1,3,0,"div",2),ji()),2&n&&(Cl(1),iu("ngIf",r.hasChatStarted),Cl(1),iu("ngIf",!r.hasChatStarted&&!r.loading))},directives:[w0],styles:['body[_ngcontent-%COMP%]{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}code[_ngcontent-%COMP%]{font-family:source-code-pro,Menlo,Monaco,Consolas,"Courier New",monospace}#chat-root[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:400px;max-width:400px;min-height:600px;max-height:600px;width:400px;height:600px;position:fixed;right:0;bottom:0;border-radius:4px;margin:0 20px 60px 0;box-shadow:0 0 15px 2px #161b224d;font-family:"Segoe UI",Arial,sans-serif}#chat-container[_ngcontent-%COMP%]{width:100%;height:100%}.chat-header[_ngcontent-%COMP%]{border-bottom:#E6E6E6 solid 1px;padding:10px;display:flex;justify-content:space-between;cursor:pointer}#loading-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:400px;max-width:400px;min-height:600px;max-height:600px;width:400px;height:600px;position:fixed;right:0;bottom:0;border-radius:4px;margin:0 20px 60px 0;box-shadow:0 0 15px 2px #161b224d;align-items:center;justify-content:center}@keyframes spin{to{transform:rotate(360deg)}}#loader[_ngcontent-%COMP%]{font-size:120px;animation:spin 2s linear infinite}#chat-button[_ngcontent-%COMP%]{position:fixed;right:0;bottom:0;border-radius:32px;background-color:#0078d4;box-shadow:0 0 5px 2px #0078d4;padding:10px;margin:0 20px 20px 0;color:#fff;font-size:32px;cursor:pointer}#chat-button[_ngcontent-%COMP%]:hover{box-shadow:0 0 20px 2px #0078d4;transition:all 2s}']}),t})(),f1=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Ur({type:t,bootstrap:[d1]}),t.\u0275inj=Rr({providers:[],imports:[[TO]]}),t})();(function(){if(xC)throw new Error("Cannot enable prod mode after platform setup.");NC=!1})(),vO().bootstrapModule(f1).catch(t=>console.error(t))},1907:Q=>{function m(s,b,h,p,E,d,T){try{var A=s[d](T),I=A.value}catch(f){return void h(f)}A.done?b(I):Promise.resolve(I).then(p,E)}Q.exports=function(s){return function(){var b=this,h=arguments;return new Promise(function(p,E){var d=s.apply(b,h);function T(I){m(d,p,E,T,A,"next",I)}function A(I){m(d,p,E,T,A,"throw",I)}T(void 0)})}},Q.exports.__esModule=!0,Q.exports.default=Q.exports},8884:Q=>{Q.exports=function(u,s){if(!(u instanceof s))throw new TypeError("Cannot call a class as a function")},Q.exports.__esModule=!0,Q.exports.default=Q.exports},2805:Q=>{function m(s,b){for(var h=0;h<b.length;h++){var p=b[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(s,p.key,p)}}Q.exports=function(s,b,h){return b&&m(s.prototype,b),h&&m(s,h),Object.defineProperty(s,"prototype",{writable:!1}),s},Q.exports.__esModule=!0,Q.exports.default=Q.exports},1819:Q=>{Q.exports=function(u,s,b){return s in u?Object.defineProperty(u,s,{value:b,enumerable:!0,configurable:!0,writable:!0}):u[s]=b,u},Q.exports.__esModule=!0,Q.exports.default=Q.exports},1127:Q=>{Q.exports=function(u){return u&&u.__esModule?u:{default:u}},Q.exports.__esModule=!0,Q.exports.default=Q.exports},1298:Q=>{function m(u){return Q.exports=m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Q.exports.__esModule=!0,Q.exports.default=Q.exports,m(u)}Q.exports=m,Q.exports.__esModule=!0,Q.exports.default=Q.exports},6533:(Q,m,u)=>{Q.exports=u(7941)},4762:(Q,m,u)=>{"use strict";function p(Z,Y){var W={};for(var ce in Z)Object.prototype.hasOwnProperty.call(Z,ce)&&Y.indexOf(ce)<0&&(W[ce]=Z[ce]);if(null!=Z&&"function"==typeof Object.getOwnPropertySymbols){var Ce=0;for(ce=Object.getOwnPropertySymbols(Z);Ce<ce.length;Ce++)Y.indexOf(ce[Ce])<0&&Object.prototype.propertyIsEnumerable.call(Z,ce[Ce])&&(W[ce[Ce]]=Z[ce[Ce]])}return W}function D(Z){return this instanceof D?(this.v=Z,this):new D(Z)}function _(Z,Y,W){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ce,ce=W.apply(Z,Y||[]),ne=[];return Ce={},X("next"),X("throw"),X("return"),Ce[Symbol.asyncIterator]=function(){return this},Ce;function X(be){ce[be]&&(Ce[be]=function(Be){return new Promise(function($e,Oe){ne.push([be,Be,$e,Oe])>1||de(be,Be)})})}function de(be,Be){try{!function(be){be.value instanceof D?Promise.resolve(be.value.v).then(K,re):ve(ne[0][2],be)}(ce[be](Be))}catch($e){ve(ne[0][3],$e)}}function K(be){de("next",be)}function re(be){de("throw",be)}function ve(be,Be){be(Be),ne.shift(),ne.length&&de(ne[0][0],ne[0][1])}}function N(Z){var Y,W;return Y={},ce("next"),ce("throw",function(Ce){throw Ce}),ce("return"),Y[Symbol.iterator]=function(){return this},Y;function ce(Ce,ne){Y[Ce]=Z[Ce]?function(X){return(W=!W)?{value:D(Z[Ce](X)),done:"return"===Ce}:ne?ne(X):X}:ne}}function P(Z){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var W,Y=Z[Symbol.asyncIterator];return Y?Y.call(Z):(Z=function(Z){var Y="function"==typeof Symbol&&Symbol.iterator,W=Y&&Z[Y],ce=0;if(W)return W.call(Z);if(Z&&"number"==typeof Z.length)return{next:function(){return Z&&ce>=Z.length&&(Z=void 0),{value:Z&&Z[ce++],done:!Z}}};throw new TypeError(Y?"Object is not iterable.":"Symbol.iterator is not defined.")}(Z),W={},ce("next"),ce("throw"),ce("return"),W[Symbol.asyncIterator]=function(){return this},W);function ce(ne){W[ne]=Z[ne]&&function(X){return new Promise(function(de,te){!function(ne,X,de,te){Promise.resolve(te).then(function(K){ne({value:K,done:de})},X)}(de,te,(X=Z[ne](X)).done,X.value)})}}}u.d(m,{_T:()=>p,qq:()=>D,FC:()=>_,V2:()=>N,KL:()=>P})},8239:(Q,m,u)=>{"use strict";function s(h,p,E,d,T,A,I){try{var f=h[A](I),c=f.value}catch(v){return void E(v)}f.done?p(c):Promise.resolve(c).then(d,T)}function b(h){return function(){var p=this,E=arguments;return new Promise(function(d,T){var A=h.apply(p,E);function I(c){s(A,d,T,I,f,"next",c)}function f(c){s(A,d,T,I,f,"throw",c)}I(void 0)})}}u.d(m,{Z:()=>b})},2861:Q=>{"use strict";Q.exports={i8:"1.1.1"}},6638:Q=>{"use strict";Q.exports={i8:"1.1.0"}},1528:Q=>{"use strict";Q.exports={i8:"0.3.0"}},5500:Q=>{"use strict";Q.exports={i8:"0.1.0"}},8464:Q=>{"use strict";Q.exports=JSON.parse('{"i8":"1.1.1-main.6b72ca1"}')},5233:Q=>{"use strict";Q.exports={i8:"0.1.2"}},8593:Q=>{"use strict";Q.exports=JSON.parse('{"_from":"axios@^0.21.4","_id":"axios@0.21.4","_inBundle":false,"_integrity":"sha512-ut5vewkiu8jjGBdqpM44XxjuCjq9LAKeHVmoVfHVzy8eHgxxq8SbAVQNovDA8mVi05kP0Ea/n/UzcSHcTJQfNg==","_location":"/axios","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"axios@^0.21.4","name":"axios","escapedName":"axios","rawSpec":"^0.21.4","saveSpec":null,"fetchSpec":"^0.21.4"},"_requiredBy":["/@microsoft/ocsdk","/@microsoft/omnichannel-ic3core"],"_resolved":"https://registry.npmjs.org/axios/-/axios-0.21.4.tgz","_shasum":"c67b90dc0568e5c1cf2b0b858c43ba28e2eda575","_spec":"axios@^0.21.4","_where":"/home/runner/work/omnichannel-demos/omnichannel-demos/angular-botframework-webchat-control/node_modules/@microsoft/ocsdk","author":{"name":"Matt Zabriskie"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"bugs":{"url":"https://github.com/axios/axios/issues"},"bundleDependencies":false,"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}],"dependencies":{"follow-redirects":"^1.14.0"},"deprecated":false,"description":"Promise based HTTP client for the browser and node.js","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"homepage":"https://axios-http.com","jsdelivr":"dist/axios.min.js","keywords":["xhr","http","ajax","promise","node"],"license":"MIT","main":"index.js","name":"axios","repository":{"type":"git","url":"git+https://github.com/axios/axios.git"},"scripts":{"build":"NODE_ENV=production grunt build","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","examples":"node ./examples/server.js","fix":"eslint --fix lib/**/*.js","postversion":"git push && git push --tags","preversion":"npm test","start":"node ./sandbox/server.js","test":"grunt test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},"typings":"./index.d.ts","unpkg":"dist/axios.min.js","version":"0.21.4"}')}},Q=>{Q(Q.s=8952)}]);