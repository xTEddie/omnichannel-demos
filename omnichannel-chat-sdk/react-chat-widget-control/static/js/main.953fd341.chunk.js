(this["webpackJsonpreact-chat-widget-control"]=this["webpackJsonpreact-chat-widget-control"]||[]).push([[0],{174:function(e,t,n){"use strict";n.r(t);var a=n(5),o=n.n(a),c=n(43),r=n.n(c),l=(n(79),n(4)),s=n.n(l),i=n(74),u=n(14),d=n(33),g=n(6),h=n(32),f=function(){var e={orgId:"d367c413-e0b9-408b-ae1c-382499b369ae",orgUrl:"https://omnichannel-crm.omnichannelengagementhub.com",widgetId:"3a352b95-5d67-4e47-af28-eca029b03928"},t=new URLSearchParams(window.location.search);return null!==t.get("orgUrl")&&(e.orgUrl=t.get("orgUrl")),null!==t.get("orgId")&&(e.orgId=t.get("orgId")),null!==t.get("widgetId")&&(e.widgetId=t.get("widgetId")),e},b=function(){var e={telemetry:{disable:!0,ariaTelemetryKey:""}},t=new URLSearchParams(window.location.search);return null!==t.get("telemetry")&&(e.telemetry.disable="true"!=t.get("telemetry")),null!==t.get("ariaTelemetryKey")&&(e.telemetry.ariaTelemetryKey=t.get("ariaTelemetryKey")||""),e},v=function(){var e={disable:!0},t=new URLSearchParams(window.location.search);return null!==t.get("debug")&&(e.disable="true"!=t.get("debug")),e},m=(n(172),n(9)),p=f(),O=b(),j=v();console.log("%c [OmnichannelConfig]","background-color:#001433;color:#fff"),console.log(p),console.log("%c [telemetryConfig]","background-color:#001433;color:#fff"),console.log(O),console.log("%c [debugConfig]","background-color:#001433;color:#fff"),console.log(j);var w=[{label:"Attachment",value:"Attachment"}];var x=function(){var e=Object(a.useState)(),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),r=Object(d.a)(c,2),l=r[0],f=r[1],b=Object(a.useState)(!1),v=Object(d.a)(b,2),x=v[0],C=v[1];Object(a.useEffect)((function(){(function(){var e=Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new h.OmnichannelChatSDK(p,Object(i.a)({},O))).setDebug(!j.disable),e.next=4,t.initialize();case 4:o(t),(n=localStorage.getItem("liveChatContext"))&&Object.keys(JSON.parse(n)).length>0&&(console.log("[liveChatContext]"),console.log(n)),Object(g.setQuickButtons)(w);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var k=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("New message incoming! ".concat(t)),e.next=3,null===n||void 0===n?void 0:n.sendMessage({content:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=Object(a.useCallback)(function(){var e=Object(u.a)(s.a.mark((function e(t){var a,o,c,r,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[onWidgetClick]"),a=Object(g.isWidgetOpened)(),f(a),x||!a){e.next=21;break}return console.log("[StartChat]"),o={},(c=localStorage.getItem("liveChatContext"))&&Object.keys(JSON.parse(c)).length>0&&(console.log("[liveChatContext]"),o.liveChatContext=JSON.parse(c)),e.next=10,null===n||void 0===n?void 0:n.startChat(o);case 10:return e.next=12,null===n||void 0===n?void 0:n.getChatToken();case 12:return r=e.sent,console.log("[chatToken]"),console.log(r),e.next=17,null===n||void 0===n?void 0:n.getCurrentLiveChatContext();case 17:l=e.sent,localStorage.setItem("liveChatContext",JSON.stringify(l)),null===n||void 0===n||n.onNewMessage(function(){var e=Object(u.a)(s.a.mark((function e(t){var a,o,c,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(h.isSystemMessage)(t)){e.next=4;break}Object(g.addResponseMessage)(t.content),e.next=29;break;case 4:if(!Object(h.isCustomerMessage)(t)){e.next=18;break}if(!t.fileMetadata){e.next=15;break}return console.log("[onNewMessage][Attachment][User] ".concat(t.fileMetadata.name)),e.next=9,null===n||void 0===n?void 0:n.downloadFileAttachment(t.fileMetadata);case 9:a=e.sent,(o=new FileReader).readAsDataURL(a),o.onloadend=function(){Object(g.addUserMessage)("![attachment](".concat(o.result,")"))},e.next=16;break;case 15:Object(g.addUserMessage)(t.content);case 16:e.next=29;break;case 18:if(!t.fileMetadata){e.next=28;break}return console.log("[onNewMessage][Attachment][Agent] ".concat(t.fileMetadata.name)),e.next=22,null===n||void 0===n?void 0:n.downloadFileAttachment(t.fileMetadata);case 22:c=e.sent,(r=new FileReader).readAsDataURL(c),r.onloadend=function(){Object(g.addResponseMessage)("![attachment](".concat(r.result,")"))},e.next=29;break;case 28:Object(g.addResponseMessage)(t.content);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{rehydrate:!0}),C(!0);case 21:if(!x||a){e.next=28;break}return console.log("[CloseChat]"),e.next=25,null===n||void 0===n?void 0:n.endChat();case 25:localStorage.removeItem("liveChatContext"),Object(g.dropMessages)(),C(!1);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[x,n,l]),M=Object(a.useCallback)(Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[sendTypingEvent]"),e.next=3,null===n||void 0===n?void 0:n.sendTypingEvent();case 3:case"end":return e.stop()}}),e)}))),[n]);return Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:" Omnichannel Chat SDK "}),Object(m.jsx)("div",{onClick:y,children:Object(m.jsx)(g.Widget,{title:"Live Chat",subtitle:"via omnichannel-sdk & react-chat-widget control",handleNewUserMessage:k,handleQuickButtonClicked:function(e){if(console.log("[handleQuickButtonClicked]"),"Attachment"===e){var t=document.createElement("input");t.setAttribute("type","file"),t.click(),t.onchange=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.files[0],console.log(a),console.log("[UploadFileAttachment]"),null===n||void 0===n||n.uploadFileAttachment(a),(o=new FileReader).readAsDataURL(a),o.onloadend=function(){Object(g.addUserMessage)("![attachment](".concat(o.result,")"))};case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},handleTextInputChange:M})})]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,175)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),c(e),r(e)}))};r.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(x,{})}),document.getElementById("root")),C()},79:function(e,t,n){}},[[174,1,2]]]);
//# sourceMappingURL=main.953fd341.chunk.js.map