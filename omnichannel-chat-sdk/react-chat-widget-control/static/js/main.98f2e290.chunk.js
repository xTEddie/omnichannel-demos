(this["webpackJsonpreact-chat-widget-control"]=this["webpackJsonpreact-chat-widget-control"]||[]).push([[0],{246:function(e,t,n){},292:function(e,t){},294:function(e,t){},304:function(e,t){},306:function(e,t){},333:function(e,t){},334:function(e,t){},339:function(e,t){},341:function(e,t){},348:function(e,t){},367:function(e,t){},455:function(e,t,n){"use strict";n.r(t);var a=n(28),o=n.n(a),c=n(136),r=n.n(c),i=(n(246),n(0)),l=n.n(i),s=n(232),u=n(2),d=n(14),g=n(30),f=n(99),h=function(){var e={orgId:"d367c413-e0b9-408b-ae1c-382499b369ae",orgUrl:"https://omnichannel-crm.omnichannelengagementhub.com",widgetId:"3a352b95-5d67-4e47-af28-eca029b03928"},t=new URLSearchParams(window.location.search);return null!==t.get("orgUrl")&&(e.orgUrl=t.get("orgUrl")),null!==t.get("orgId")&&(e.orgId=t.get("orgId")),null!==t.get("widgetId")&&(e.widgetId=t.get("widgetId")),e},b=function(){var e={telemetry:{disable:!1,ariaTelemetryKey:""}},t=new URLSearchParams(window.location.search);return null!==t.get("telemetry")&&(e.telemetry.disable="true"!=t.get("telemetry")),null!==t.get("ariaTelemetryKey")&&(e.telemetry.ariaTelemetryKey=t.get("ariaTelemetryKey")||""),e},v=function(){var e={disable:!0},t=new URLSearchParams(window.location.search);return null!==t.get("debug")&&(e.disable="true"!=t.get("debug")),e},m=n(1),p=function e(){Object(m.a)(this,e)};p.liveChatVersion=1,p.canUploadAttachment=!1;var C=function(e){var t=e.LiveChatVersion,n="true"===e.LiveWSAndLiveChatEngJoin.msdyn_enablefileattachmentsforcustomers||!1;return p.liveChatVersion=parseInt(t)||1,p.canUploadAttachment=n,p},O=(n(452),n(37)),j=h(),w=b(),x=v();console.log("%c [OmnichannelConfig]","background-color:#001433;color:#fff"),console.log(j),console.log("%c [telemetryConfig]","background-color:#001433;color:#fff"),console.log(w),console.log("%c [debugConfig]","background-color:#001433;color:#fff"),console.log(x);var k=function(){var e=[];return p.canUploadAttachment&&e.push({label:"Attachment",value:"Attachment"}),e};var y=function(){var e=Object(a.useState)(),t=Object(d.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),r=Object(d.a)(c,2),i=r[0],h=r[1],b=Object(a.useState)(!1),v=Object(d.a)(b,2),m=v[0],p=v[1];Object(a.useEffect)((function(){var e=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new f.OmnichannelChatSDK(j,Object(s.a)({},w))).setDebug(!x.disable),e.next=4,t.initialize();case 4:return o(t),e.next=7,t.getLiveChatConfig();case 7:n=e.sent,C(n),(a=localStorage.getItem("liveChatContext"))&&Object.keys(JSON.parse(a)).length>0&&(console.log("[liveChatContext]"),console.log(a)),c=k(),Object(g.setQuickButtons)(c);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var y=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("New message incoming! ".concat(t)),e.next=3,null===n||void 0===n?void 0:n.sendMessage({content:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=Object(a.useCallback)(function(){var e=Object(u.a)(l.a.mark((function e(t){var a,o,c,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[onWidgetClick]"),a=Object(g.isWidgetOpened)(),h(a),m||!a){e.next=21;break}return console.log("[StartChat]"),o={},(c=localStorage.getItem("liveChatContext"))&&Object.keys(JSON.parse(c)).length>0&&(console.log("[liveChatContext]"),o.liveChatContext=JSON.parse(c)),e.next=10,null===n||void 0===n?void 0:n.startChat(o);case 10:return e.next=12,null===n||void 0===n?void 0:n.getChatToken();case 12:return r=e.sent,console.log("[chatToken]"),console.log(r),e.next=17,null===n||void 0===n?void 0:n.getCurrentLiveChatContext();case 17:i=e.sent,localStorage.setItem("liveChatContext",JSON.stringify(i)),null===n||void 0===n||n.onNewMessage(function(){var e=Object(u.a)(l.a.mark((function e(t){var a,o,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(f.isSystemMessage)(t)){e.next=4;break}Object(g.addResponseMessage)(t.content),e.next=29;break;case 4:if(!Object(f.isCustomerMessage)(t)){e.next=18;break}if(!t.fileMetadata){e.next=15;break}return console.log("[onNewMessage][Attachment][User] ".concat(t.fileMetadata.name)),e.next=9,null===n||void 0===n?void 0:n.downloadFileAttachment(t.fileMetadata);case 9:a=e.sent,(o=new FileReader).readAsDataURL(a),o.onloadend=function(){Object(g.addUserMessage)("![attachment](".concat(o.result,")"))},e.next=16;break;case 15:Object(g.addUserMessage)(t.content);case 16:e.next=29;break;case 18:if(!t.fileMetadata){e.next=28;break}return console.log("[onNewMessage][Attachment][Agent] ".concat(t.fileMetadata.name)),e.next=22,null===n||void 0===n?void 0:n.downloadFileAttachment(t.fileMetadata);case 22:c=e.sent,(r=new FileReader).readAsDataURL(c),r.onloadend=function(){Object(g.addResponseMessage)("![attachment](".concat(r.result,")"))},e.next=29;break;case 28:Object(g.addResponseMessage)(t.content);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{rehydrate:!0}),p(!0);case 21:if(!m||a){e.next=28;break}return console.log("[CloseChat]"),e.next=25,null===n||void 0===n?void 0:n.endChat();case 25:localStorage.removeItem("liveChatContext"),Object(g.dropMessages)(),p(!1);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[m,n,i]),S=Object(a.useCallback)(Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[sendTypingEvent]"),e.next=3,null===n||void 0===n?void 0:n.sendTypingEvent();case 3:case"end":return e.stop()}}),e)}))),[n]);return Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:" Omnichannel Chat SDK "}),Object(O.jsx)("div",{onClick:M,children:Object(O.jsx)(g.Widget,{title:"Live Chat",subtitle:"via omnichannel-sdk & react-chat-widget control",handleNewUserMessage:y,handleQuickButtonClicked:function(e){if(console.log("[handleQuickButtonClicked]"),"Attachment"===e){var t=document.createElement("input");t.setAttribute("type","file"),t.click(),t.onchange=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.files[0],console.log(a),console.log("[UploadFileAttachment]"),null===n||void 0===n||n.uploadFileAttachment(a),(o=new FileReader).readAsDataURL(a),o.onloadend=function(){Object(g.addUserMessage)("![attachment](".concat(o.result,")"))};case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},handleTextInputChange:S})})]})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,462)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),c(e),r(e)}))};r.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(y,{})}),document.getElementById("root")),M()}},[[455,1,2]]]);
//# sourceMappingURL=main.98f2e290.chunk.js.map